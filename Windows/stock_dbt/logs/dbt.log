[0m19:21:30.848417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186924EA840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186924E8BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018692929070>]}


============================== 19:21:30.850409 | 2c4f1cfa-639f-40fe-95c5-e986eaf88f84 ==============================
[0m19:21:30.850409 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:21:30.851912 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\tekal\\Downloads\\Sem 1\\DATA226\\sjsu-data226\\week8\\airflow\\stock_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\tekal\\Downloads\\Sem 1\\DATA226\\sjsu-data226\\week8\\airflow\\stock_dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:21:30.864279 [info ] [MainThread]: dbt version: 1.8.7
[0m19:21:30.865279 [info ] [MainThread]: python version: 3.12.5
[0m19:21:30.865279 [info ] [MainThread]: python path: C:\Users\tekal\AppData\Local\Programs\Python\Python312\python.exe
[0m19:21:30.865279 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m19:21:30.867288 [info ] [MainThread]: Using profiles dir at C:\Users\tekal\Downloads\Sem 1\DATA226\sjsu-data226\week8\airflow\stock_dbt
[0m19:21:30.867288 [info ] [MainThread]: Using profiles.yml file at C:\Users\tekal\Downloads\Sem 1\DATA226\sjsu-data226\week8\airflow\stock_dbt\profiles.yml
[0m19:21:30.867288 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\tekal\Downloads\Sem 1\DATA226\sjsu-data226\week8\airflow\stock_dbt\dbt_project.yml
[0m19:21:30.925675 [info ] [MainThread]: Configuration:
[0m19:21:30.927440 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m19:21:30.927440 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:21:30.927440 [info ] [MainThread]: Required dependencies:
[0m19:21:30.928534 [debug] [MainThread]: Executing "git --help"
[0m19:21:30.959798 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:21:30.960799 [debug] [MainThread]: STDERR: "b''"
[0m19:21:30.960799 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:21:30.960799 [info ] [MainThread]: Connection test skipped since no profile was found
[0m19:21:30.961799 [info ] [MainThread]: [31m1 check failed:[0m
[0m19:21:30.961799 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'stock_dbt'


[0m19:21:30.962804 [debug] [MainThread]: Command `dbt debug` failed at 19:21:30.961799 after 0.28 seconds
[0m19:21:30.962804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018692AD5220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018691FFAB40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018692D52C00>]}
[0m19:21:30.962804 [debug] [MainThread]: Flushing usage events
[0m19:21:58.376787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EA6F1B920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EA6F191C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EA6F1BE60>]}


============================== 19:21:58.376787 | 0482a766-96be-41f0-b6be-26232d5a2894 ==============================
[0m19:21:58.376787 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:21:58.386647 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\tekal\\Downloads\\Sem 1\\DATA226\\sjsu-data226\\week8\\airflow\\stock_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\tekal\\Downloads\\Sem 1\\DATA226\\sjsu-data226\\week8\\airflow\\stock_dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:21:58.396829 [info ] [MainThread]: dbt version: 1.8.7
[0m19:21:58.396829 [info ] [MainThread]: python version: 3.12.5
[0m19:21:58.396829 [info ] [MainThread]: python path: C:\Users\tekal\AppData\Local\Programs\Python\Python312\python.exe
[0m19:21:58.396829 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m19:21:58.396829 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_ACCOUNT'
[0m19:21:58.396829 [debug] [MainThread]: Command `dbt debug` failed at 19:21:58.396829 after 0.16 seconds
[0m19:21:58.396829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EA70C57F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EA6659D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EA6F1BE60>]}
[0m19:21:58.396829 [debug] [MainThread]: Flushing usage events
[0m19:22:52.506707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289306BD2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289308F2090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289309C3530>]}


============================== 19:22:52.506707 | 020727e5-40fe-445e-96c6-05c41868d5d4 ==============================
[0m19:22:52.506707 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:22:52.506707 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\tekal\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\tekal\\Downloads\\Sem 1\\DATA226\\sjsu-data226\\week8\\airflow\\stock_dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:22:52.525872 [info ] [MainThread]: dbt version: 1.8.7
[0m19:22:52.527054 [info ] [MainThread]: python version: 3.12.5
[0m19:22:52.527054 [info ] [MainThread]: python path: C:\Users\tekal\AppData\Local\Programs\Python\Python312\python.exe
[0m19:22:52.527054 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m19:22:53.121766 [info ] [MainThread]: Using profiles dir at C:\Users\tekal\.dbt
[0m19:22:53.122765 [info ] [MainThread]: Using profiles.yml file at C:\Users\tekal\.dbt\profiles.yml
[0m19:22:53.122765 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\tekal\Downloads\Sem 1\DATA226\sjsu-data226\week8\airflow\stock_dbt\dbt_project.yml
[0m19:22:53.123757 [info ] [MainThread]: adapter type: snowflake
[0m19:22:53.123757 [info ] [MainThread]: adapter version: 1.8.4
[0m19:22:53.180819 [info ] [MainThread]: Configuration:
[0m19:22:53.181938 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:22:53.181938 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:22:53.181938 [info ] [MainThread]: Required dependencies:
[0m19:22:53.182824 [debug] [MainThread]: Executing "git --help"
[0m19:22:53.201916 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:22:53.201916 [debug] [MainThread]: STDERR: "b''"
[0m19:22:53.201916 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:22:53.201916 [info ] [MainThread]: Connection:
[0m19:22:53.201916 [info ] [MainThread]:   account: oqkqedn-jzb09886
[0m19:22:53.201916 [info ] [MainThread]:   user: adityatekale
[0m19:22:53.201916 [info ] [MainThread]:   database: dev
[0m19:22:53.201916 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m19:22:53.206146 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m19:22:53.206146 [info ] [MainThread]:   schema: analytics
[0m19:22:53.206146 [info ] [MainThread]:   authenticator: None
[0m19:22:53.207189 [info ] [MainThread]:   oauth_client_id: None
[0m19:22:53.207189 [info ] [MainThread]:   query_tag: None
[0m19:22:53.207189 [info ] [MainThread]:   client_session_keep_alive: False
[0m19:22:53.207189 [info ] [MainThread]:   host: None
[0m19:22:53.209229 [info ] [MainThread]:   port: None
[0m19:22:53.209229 [info ] [MainThread]:   proxy_host: None
[0m19:22:53.209229 [info ] [MainThread]:   proxy_port: None
[0m19:22:53.209229 [info ] [MainThread]:   protocol: None
[0m19:22:53.209229 [info ] [MainThread]:   connect_retries: 1
[0m19:22:53.209229 [info ] [MainThread]:   connect_timeout: None
[0m19:22:53.209229 [info ] [MainThread]:   retry_on_database_errors: False
[0m19:22:53.209229 [info ] [MainThread]:   retry_all: False
[0m19:22:53.209229 [info ] [MainThread]:   insecure_mode: False
[0m19:22:53.209229 [info ] [MainThread]:   reuse_connections: None
[0m19:22:53.209229 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:22:53.209229 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m19:22:53.209229 [debug] [MainThread]: Using snowflake connection "debug"
[0m19:22:53.209229 [debug] [MainThread]: On debug: select 1 as id
[0m19:22:53.209229 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:22:54.225391 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.010 seconds
[0m19:22:54.226391 [debug] [MainThread]: On debug: Close
[0m19:22:54.339701 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:22:54.341704 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:22:54.343678 [debug] [MainThread]: Command `dbt debug` succeeded at 19:22:54.342672 after 1.98 seconds
[0m19:22:54.343678 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:22:54.343678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028961BA5670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289306BD2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028962D817C0>]}
[0m19:22:54.344698 [debug] [MainThread]: Flushing usage events
[0m19:23:01.579465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A161E3230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A15925250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A161E3050>]}


============================== 19:23:01.582466 | 452c0a1e-9510-4497-ade8-9201664c1f06 ==============================
[0m19:23:01.582466 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:23:01.582466 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\tekal\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\tekal\\Downloads\\Sem 1\\DATA226\\sjsu-data226\\week8\\airflow\\stock_dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:23:02.232746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '452c0a1e-9510-4497-ade8-9201664c1f06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A1534C9B0>]}
[0m19:23:02.274823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '452c0a1e-9510-4497-ade8-9201664c1f06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A15E539E0>]}
[0m19:23:02.275768 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:23:02.297891 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:23:02.297891 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:23:02.297891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '452c0a1e-9510-4497-ade8-9201664c1f06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A485AD280>]}
[0m19:23:03.869163 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:23:03.869163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '452c0a1e-9510-4497-ade8-9201664c1f06', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A473FFC20>]}
[0m19:23:04.069122 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.stock_prediction
- models.stock_prediction.tranformations
- models.stock_prediction.raw_data
[0m19:23:04.075124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '452c0a1e-9510-4497-ade8-9201664c1f06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A48A0AE10>]}
[0m19:23:04.140322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '452c0a1e-9510-4497-ade8-9201664c1f06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A487D8FE0>]}
[0m19:23:04.140322 [info ] [MainThread]: Found 5 models, 4 snapshots, 27 data tests, 1 source, 459 macros
[0m19:23:04.140322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '452c0a1e-9510-4497-ade8-9201664c1f06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A161E2CC0>]}
[0m19:23:04.142850 [info ] [MainThread]: 
[0m19:23:04.142850 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:23:04.145839 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m19:23:04.152698 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m19:23:04.153699 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m19:23:04.153699 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:23:04.885801 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.732 seconds
[0m19:23:04.887317 [debug] [ThreadPool]: On list_dev: Close
[0m19:23:05.033424 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_snapshot'
[0m19:23:05.038948 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m19:23:05.038948 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m19:23:05.039948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:23:05.705944 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.674 seconds
[0m19:23:05.716236 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m19:23:05.852333 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m19:23:05.856065 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m19:23:05.856065 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m19:23:05.856065 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:23:06.522336 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.665 seconds
[0m19:23:06.524342 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m19:23:06.647792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '452c0a1e-9510-4497-ade8-9201664c1f06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A48A1EDE0>]}
[0m19:23:06.648793 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:23:06.649848 [info ] [MainThread]: 
[0m19:23:06.654668 [debug] [Thread-1 (]: Began running node model.stock_dbt.stock_prices
[0m19:23:06.656173 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stock_prices ............................. [RUN]
[0m19:23:06.656173 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.stock_dbt.stock_prices'
[0m19:23:06.657177 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.stock_prices
[0m19:23:06.661184 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.stock_prices"
[0m19:23:06.662177 [debug] [Thread-1 (]: Began executing node model.stock_dbt.stock_prices
[0m19:23:06.677555 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.stock_prices"
[0m19:23:06.678617 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.stock_prices"
[0m19:23:06.678617 [debug] [Thread-1 (]: On model.stock_dbt.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.stock_prices"} */
create or replace   view dev.analytics.stock_prices
  
   as (
    SELECT
    symbol,
    date,
    open,
    high,
    low,
    close,
    volume
FROM dev.raw_data.stock_prices
  );
[0m19:23:06.678617 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:23:07.442385 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.763 seconds
[0m19:23:07.457031 [debug] [Thread-1 (]: On model.stock_dbt.stock_prices: Close
[0m19:23:07.575996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '452c0a1e-9510-4497-ade8-9201664c1f06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A15A495E0>]}
[0m19:23:07.575996 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stock_prices ........................ [[32mSUCCESS 1[0m in 0.92s]
[0m19:23:07.577047 [debug] [Thread-1 (]: Finished running node model.stock_dbt.stock_prices
[0m19:23:07.577047 [debug] [Thread-1 (]: Began running node model.stock_dbt.avg_true_range
[0m19:23:07.577047 [info ] [Thread-1 (]: 2 of 5 START sql view model analytics.avg_true_range ........................... [RUN]
[0m19:23:07.578155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.stock_prices, now model.stock_dbt.avg_true_range)
[0m19:23:07.578155 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.avg_true_range
[0m19:23:07.580155 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.avg_true_range"
[0m19:23:07.590511 [debug] [Thread-1 (]: Began executing node model.stock_dbt.avg_true_range
[0m19:23:07.595168 [debug] [Thread-1 (]: Dropping relation "DEV"."ANALYTICS"."AVG_TRUE_RANGE" because it is of type table
[0m19:23:07.598267 [debug] [Thread-1 (]: Applying DROP to: "DEV"."ANALYTICS"."AVG_TRUE_RANGE"
[0m19:23:07.601263 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.avg_true_range"
[0m19:23:07.602412 [debug] [Thread-1 (]: On model.stock_dbt.avg_true_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.avg_true_range"} */
drop table if exists "DEV"."ANALYTICS"."AVG_TRUE_RANGE" cascade
[0m19:23:07.602412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:08.218318 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.616 seconds
[0m19:23:08.219319 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.avg_true_range"
[0m19:23:08.221316 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.avg_true_range"
[0m19:23:08.221316 [debug] [Thread-1 (]: On model.stock_dbt.avg_true_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.avg_true_range"} */
create or replace   view dev.analytics.avg_true_range
  
   as (
    WITH averageTrueRanges AS (
    SELECT
        date,
        symbol,
        close,
        ABS(close - LAG(close) OVER (PARTITION BY symbol ORDER BY date)) AS true_range
    FROM dev.analytics.stock_prices
),
atr AS (
    SELECT
        date,
        symbol,
        AVG(true_range) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS atr_14d
    FROM averageTrueRanges
)
SELECT 
    date, 
    symbol, 
    COALESCE(atr_14d, 0) AS atr_14d
FROM atr
ORDER BY date, symbol
  );
[0m19:23:08.460998 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.239 seconds
[0m19:23:08.462007 [debug] [Thread-1 (]: On model.stock_dbt.avg_true_range: Close
[0m19:23:08.574907 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '452c0a1e-9510-4497-ade8-9201664c1f06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A488C5FD0>]}
[0m19:23:08.574907 [info ] [Thread-1 (]: 2 of 5 OK created sql view model analytics.avg_true_range ...................... [[32mSUCCESS 1[0m in 1.00s]
[0m19:23:08.575878 [debug] [Thread-1 (]: Finished running node model.stock_dbt.avg_true_range
[0m19:23:08.575878 [debug] [Thread-1 (]: Began running node model.stock_dbt.bollinger
[0m19:23:08.576933 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.bollinger ................................ [RUN]
[0m19:23:08.576933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.avg_true_range, now model.stock_dbt.bollinger)
[0m19:23:08.576933 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.bollinger
[0m19:23:08.579160 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.bollinger"
[0m19:23:08.579160 [debug] [Thread-1 (]: Began executing node model.stock_dbt.bollinger
[0m19:23:08.581080 [debug] [Thread-1 (]: Dropping relation "DEV"."ANALYTICS"."BOLLINGER" because it is of type table
[0m19:23:08.582080 [debug] [Thread-1 (]: Applying DROP to: "DEV"."ANALYTICS"."BOLLINGER"
[0m19:23:08.582080 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.bollinger"
[0m19:23:08.583079 [debug] [Thread-1 (]: On model.stock_dbt.bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.bollinger"} */
drop table if exists "DEV"."ANALYTICS"."BOLLINGER" cascade
[0m19:23:08.583079 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:09.178571 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.595 seconds
[0m19:23:09.181567 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.bollinger"
[0m19:23:09.183573 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.bollinger"
[0m19:23:09.183573 [debug] [Thread-1 (]: On model.stock_dbt.bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.bollinger"} */
create or replace   view dev.analytics.bollinger
  
   as (
    WITH bollinger AS (
    SELECT
        symbol,
        date,
        close,
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) AS sma_20d,
        STDDEV(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) AS stddev_20d
    FROM dev.analytics.stock_prices
)

SELECT
    symbol,
    date,
    close,
    COALESCE(sma_20d, 0) AS sma_20d,
    COALESCE(sma_20d + (2 * stddev_20d), 0) AS upper_band,
    COALESCE(sma_20d - (2 * stddev_20d), 0) AS lower_band
FROM bollinger
ORDER BY symbol, date
  );
[0m19:23:09.542425 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.359 seconds
[0m19:23:09.544416 [debug] [Thread-1 (]: On model.stock_dbt.bollinger: Close
[0m19:23:09.658371 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '452c0a1e-9510-4497-ade8-9201664c1f06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A48F43CB0>]}
[0m19:23:09.659371 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.bollinger ........................... [[32mSUCCESS 1[0m in 1.08s]
[0m19:23:09.660365 [debug] [Thread-1 (]: Finished running node model.stock_dbt.bollinger
[0m19:23:09.660365 [debug] [Thread-1 (]: Began running node model.stock_dbt.moving_average
[0m19:23:09.661371 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.moving_average ........................... [RUN]
[0m19:23:09.661371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.bollinger, now model.stock_dbt.moving_average)
[0m19:23:09.662370 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.moving_average
[0m19:23:09.664371 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.moving_average"
[0m19:23:09.664371 [debug] [Thread-1 (]: Began executing node model.stock_dbt.moving_average
[0m19:23:09.666898 [debug] [Thread-1 (]: Dropping relation "DEV"."ANALYTICS"."MOVING_AVERAGE" because it is of type table
[0m19:23:09.667896 [debug] [Thread-1 (]: Applying DROP to: "DEV"."ANALYTICS"."MOVING_AVERAGE"
[0m19:23:09.668896 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.moving_average"
[0m19:23:09.668896 [debug] [Thread-1 (]: On model.stock_dbt.moving_average: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.moving_average"} */
drop table if exists "DEV"."ANALYTICS"."MOVING_AVERAGE" cascade
[0m19:23:09.668896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:10.330358 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.662 seconds
[0m19:23:10.332363 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.moving_average"
[0m19:23:10.334364 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.moving_average"
[0m19:23:10.335869 [debug] [Thread-1 (]: On model.stock_dbt.moving_average: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.moving_average"} */
create or replace   view dev.analytics.moving_average
  
   as (
    WITH stock_data AS (
    SELECT
        symbol,
        date,
        close
    FROM dev.analytics.stock_prices -- assuming 'stock_prices' is the name of the raw table model in dbt
)

SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
    ) AS moving_avg_5d,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
    ) AS moving_avg_20d
FROM stock_data
ORDER BY symbol, date
  );
[0m19:23:10.669979 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.334 seconds
[0m19:23:10.671979 [debug] [Thread-1 (]: On model.stock_dbt.moving_average: Close
[0m19:23:10.886067 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '452c0a1e-9510-4497-ade8-9201664c1f06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A48F41160>]}
[0m19:23:10.886067 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.moving_average ...................... [[32mSUCCESS 1[0m in 1.22s]
[0m19:23:10.893360 [debug] [Thread-1 (]: Finished running node model.stock_dbt.moving_average
[0m19:23:10.894285 [debug] [Thread-1 (]: Began running node model.stock_dbt.rsi_calculation
[0m19:23:10.894822 [info ] [Thread-1 (]: 5 of 5 START sql view model analytics.rsi_calculation .......................... [RUN]
[0m19:23:10.896597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.moving_average, now model.stock_dbt.rsi_calculation)
[0m19:23:10.897181 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.rsi_calculation
[0m19:23:10.900584 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.rsi_calculation"
[0m19:23:10.901914 [debug] [Thread-1 (]: Began executing node model.stock_dbt.rsi_calculation
[0m19:23:10.904226 [debug] [Thread-1 (]: Dropping relation "DEV"."ANALYTICS"."RSI_CALCULATION" because it is of type table
[0m19:23:10.906024 [debug] [Thread-1 (]: Applying DROP to: "DEV"."ANALYTICS"."RSI_CALCULATION"
[0m19:23:10.906024 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.rsi_calculation"
[0m19:23:10.906569 [debug] [Thread-1 (]: On model.stock_dbt.rsi_calculation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.rsi_calculation"} */
drop table if exists "DEV"."ANALYTICS"."RSI_CALCULATION" cascade
[0m19:23:10.906569 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:11.544938 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.638 seconds
[0m19:23:11.545934 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.rsi_calculation"
[0m19:23:11.547452 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.rsi_calculation"
[0m19:23:11.547452 [debug] [Thread-1 (]: On model.stock_dbt.rsi_calculation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.rsi_calculation"} */
create or replace   view dev.analytics.rsi_calculation
  
   as (
    WITH stock_data AS (
    SELECT
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM dev.analytics.stock_prices
),

price_changes AS (
    SELECT
        symbol,
        date,
        close,
        CASE 
            WHEN close > prev_close THEN close - prev_close
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close < prev_close THEN prev_close - close
            ELSE 0 
        END AS loss
    FROM stock_data
),

average_gains_losses AS (
    SELECT
        symbol,
        date,
        close,
        -- Calculate the average gain over the last 14 days, including the current row
        AVG(gain) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain,
        -- Calculate the average loss over the last 14 days, including the current row
        AVG(loss) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss
    FROM price_changes
)

SELECT
    symbol,
    date,
    close,
    avg_gain,
    avg_loss,
    -- Calculate RSI, using COALESCE to set to 0 if result is NULL
    COALESCE(100 - (100 / (1 + (NULLIF(avg_gain, 0) / NULLIF(avg_loss, 0)))), 0) AS rsi_14d
FROM average_gains_losses
ORDER BY symbol, date
  );
[0m19:23:11.900525 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.353 seconds
[0m19:23:11.901438 [debug] [Thread-1 (]: On model.stock_dbt.rsi_calculation: Close
[0m19:23:12.038631 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '452c0a1e-9510-4497-ade8-9201664c1f06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A48DED3A0>]}
[0m19:23:12.038631 [info ] [Thread-1 (]: 5 of 5 OK created sql view model analytics.rsi_calculation ..................... [[32mSUCCESS 1[0m in 1.14s]
[0m19:23:12.039632 [debug] [Thread-1 (]: Finished running node model.stock_dbt.rsi_calculation
[0m19:23:12.040630 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:23:12.040630 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m19:23:12.040630 [debug] [MainThread]: Connection 'list_dev_analytics' was properly closed.
[0m19:23:12.040630 [debug] [MainThread]: Connection 'model.stock_dbt.rsi_calculation' was properly closed.
[0m19:23:12.041639 [info ] [MainThread]: 
[0m19:23:12.041639 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 7.90 seconds (7.90s).
[0m19:23:12.042637 [debug] [MainThread]: Command end result
[0m19:23:12.070871 [info ] [MainThread]: 
[0m19:23:12.070871 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:23:12.070871 [info ] [MainThread]: 
[0m19:23:12.071872 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m19:23:12.072872 [debug] [MainThread]: Command `dbt run` succeeded at 19:23:12.072872 after 10.63 seconds
[0m19:23:12.072872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A16331B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A16333A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A163331A0>]}
[0m19:23:12.072872 [debug] [MainThread]: Flushing usage events
[0m19:23:17.201706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179CF3F0260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179CF3F01A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179CF3F0A40>]}


============================== 19:23:17.205586 | 110f3834-1814-4227-9fb9-0d009be71e1f ==============================
[0m19:23:17.205586 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:23:17.205586 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\tekal\\Downloads\\Sem 1\\DATA226\\sjsu-data226\\week8\\airflow\\stock_dbt\\logs', 'profiles_dir': 'C:\\Users\\tekal\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m19:23:17.858376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '110f3834-1814-4227-9fb9-0d009be71e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179FFB0A9F0>]}
[0m19:23:17.898045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '110f3834-1814-4227-9fb9-0d009be71e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001798017D010>]}
[0m19:23:17.898045 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:23:17.901755 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:23:18.009758 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:23:18.009758 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:23:18.013864 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.stock_prediction.tranformations
- models.stock_prediction
- models.stock_prediction.raw_data
[0m19:23:18.038682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '110f3834-1814-4227-9fb9-0d009be71e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179CF4218B0>]}
[0m19:23:18.128039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '110f3834-1814-4227-9fb9-0d009be71e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017981C8EB10>]}
[0m19:23:18.128039 [info ] [MainThread]: Found 5 models, 4 snapshots, 27 data tests, 1 source, 459 macros
[0m19:23:18.129033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '110f3834-1814-4227-9fb9-0d009be71e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017981828F50>]}
[0m19:23:18.130032 [info ] [MainThread]: 
[0m19:23:18.131031 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:23:18.134031 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_analytics'
[0m19:23:18.142627 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m19:23:18.142627 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m19:23:18.143569 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:23:18.873197 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.730 seconds
[0m19:23:18.876944 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m19:23:19.077539 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m19:23:19.080619 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m19:23:19.080619 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m19:23:19.081940 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:23:19.654307 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.574 seconds
[0m19:23:19.657837 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m19:23:19.774170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '110f3834-1814-4227-9fb9-0d009be71e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017980662E70>]}
[0m19:23:19.774170 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:23:19.775759 [info ] [MainThread]: 
[0m19:23:19.777386 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m19:23:19.777386 [info ] [Thread-1 (]: 1 of 27 START test not_null_avg_true_range_atr_14d ............................. [RUN]
[0m19:23:19.777386 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad'
[0m19:23:19.777386 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m19:23:19.785919 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad"
[0m19:23:19.785919 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m19:23:19.801578 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad"
[0m19:23:19.801578 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad"
[0m19:23:19.801578 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select atr_14d
from dev.analytics.avg_true_range
where atr_14d is null



      
    ) dbt_internal_test
[0m19:23:19.801578 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:23:20.955567 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.151 seconds
[0m19:23:20.963263 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad: Close
[0m19:23:21.105588 [info ] [Thread-1 (]: 1 of 27 PASS not_null_avg_true_range_atr_14d ................................... [[32mPASS[0m in 1.33s]
[0m19:23:21.105588 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m19:23:21.105588 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_avg_true_range_date.4e418b835d
[0m19:23:21.105588 [info ] [Thread-1 (]: 2 of 27 START test not_null_avg_true_range_date ................................ [RUN]
[0m19:23:21.105588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad, now test.stock_dbt.not_null_avg_true_range_date.4e418b835d)
[0m19:23:21.105588 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_avg_true_range_date.4e418b835d
[0m19:23:21.105588 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_avg_true_range_date.4e418b835d"
[0m19:23:21.115717 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_avg_true_range_date.4e418b835d
[0m19:23:21.116891 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_avg_true_range_date.4e418b835d"
[0m19:23:21.117890 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_avg_true_range_date.4e418b835d"
[0m19:23:21.117890 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_date.4e418b835d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_avg_true_range_date.4e418b835d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.avg_true_range
where date is null



      
    ) dbt_internal_test
[0m19:23:21.117890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:21.897869 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.780 seconds
[0m19:23:21.899869 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_date.4e418b835d: Close
[0m19:23:22.027053 [info ] [Thread-1 (]: 2 of 27 PASS not_null_avg_true_range_date ...................................... [[32mPASS[0m in 0.92s]
[0m19:23:22.029054 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_avg_true_range_date.4e418b835d
[0m19:23:22.029054 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1
[0m19:23:22.030056 [info ] [Thread-1 (]: 3 of 27 START test not_null_avg_true_range_symbol .............................. [RUN]
[0m19:23:22.030056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_avg_true_range_date.4e418b835d, now test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1)
[0m19:23:22.031051 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1
[0m19:23:22.034157 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1"
[0m19:23:22.036752 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1
[0m19:23:22.037798 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1"
[0m19:23:22.038745 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1"
[0m19:23:22.038745 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.avg_true_range
where symbol is null



      
    ) dbt_internal_test
[0m19:23:22.039759 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:22.684711 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.645 seconds
[0m19:23:22.686399 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1: Close
[0m19:23:22.795473 [info ] [Thread-1 (]: 3 of 27 PASS not_null_avg_true_range_symbol .................................... [[32mPASS[0m in 0.77s]
[0m19:23:22.795473 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1
[0m19:23:22.796612 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_close.4ccb16a429
[0m19:23:22.796612 [info ] [Thread-1 (]: 4 of 27 START test not_null_bollinger_close .................................... [RUN]
[0m19:23:22.796612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1, now test.stock_dbt.not_null_bollinger_close.4ccb16a429)
[0m19:23:22.797612 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_close.4ccb16a429
[0m19:23:22.799613 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_close.4ccb16a429"
[0m19:23:22.800268 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_close.4ccb16a429
[0m19:23:22.801283 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_close.4ccb16a429"
[0m19:23:22.802348 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_close.4ccb16a429"
[0m19:23:22.802348 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_close.4ccb16a429: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_close.4ccb16a429"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.bollinger
where close is null



      
    ) dbt_internal_test
[0m19:23:22.802348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:23.379179 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.577 seconds
[0m19:23:23.381182 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_close.4ccb16a429: Close
[0m19:23:23.496751 [info ] [Thread-1 (]: 4 of 27 PASS not_null_bollinger_close .......................................... [[32mPASS[0m in 0.70s]
[0m19:23:23.497729 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_close.4ccb16a429
[0m19:23:23.498612 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_date.9d77bdd20c
[0m19:23:23.498612 [info ] [Thread-1 (]: 5 of 27 START test not_null_bollinger_date ..................................... [RUN]
[0m19:23:23.498612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_close.4ccb16a429, now test.stock_dbt.not_null_bollinger_date.9d77bdd20c)
[0m19:23:23.499711 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_date.9d77bdd20c
[0m19:23:23.501717 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_date.9d77bdd20c"
[0m19:23:23.501717 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_date.9d77bdd20c
[0m19:23:23.505679 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_date.9d77bdd20c"
[0m19:23:23.505679 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_date.9d77bdd20c"
[0m19:23:23.505679 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_date.9d77bdd20c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_date.9d77bdd20c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.bollinger
where date is null



      
    ) dbt_internal_test
[0m19:23:23.505679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:24.140635 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.633 seconds
[0m19:23:24.141638 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_date.9d77bdd20c: Close
[0m19:23:24.281263 [info ] [Thread-1 (]: 5 of 27 PASS not_null_bollinger_date ........................................... [[32mPASS[0m in 0.78s]
[0m19:23:24.281263 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_date.9d77bdd20c
[0m19:23:24.282263 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e
[0m19:23:24.282263 [info ] [Thread-1 (]: 6 of 27 START test not_null_bollinger_lower_band ............................... [RUN]
[0m19:23:24.282698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_date.9d77bdd20c, now test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e)
[0m19:23:24.282698 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e
[0m19:23:24.284701 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e"
[0m19:23:24.285710 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e
[0m19:23:24.287014 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e"
[0m19:23:24.288014 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e"
[0m19:23:24.288014 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select lower_band
from dev.analytics.bollinger
where lower_band is null



      
    ) dbt_internal_test
[0m19:23:24.288014 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:24.915663 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.627 seconds
[0m19:23:24.917389 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e: Close
[0m19:23:25.066655 [info ] [Thread-1 (]: 6 of 27 PASS not_null_bollinger_lower_band ..................................... [[32mPASS[0m in 0.78s]
[0m19:23:25.067666 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e
[0m19:23:25.067666 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3
[0m19:23:25.067666 [info ] [Thread-1 (]: 7 of 27 START test not_null_bollinger_sma_20d .................................. [RUN]
[0m19:23:25.068658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e, now test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3)
[0m19:23:25.068658 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3
[0m19:23:25.070658 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3"
[0m19:23:25.071659 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3
[0m19:23:25.073658 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3"
[0m19:23:25.084108 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3"
[0m19:23:25.084108 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sma_20d
from dev.analytics.bollinger
where sma_20d is null



      
    ) dbt_internal_test
[0m19:23:25.084108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:25.681159 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.597 seconds
[0m19:23:25.684086 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3: Close
[0m19:23:25.833199 [info ] [Thread-1 (]: 7 of 27 PASS not_null_bollinger_sma_20d ........................................ [[32mPASS[0m in 0.76s]
[0m19:23:25.833199 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3
[0m19:23:25.833199 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_symbol.a932e30f82
[0m19:23:25.835712 [info ] [Thread-1 (]: 8 of 27 START test not_null_bollinger_symbol ................................... [RUN]
[0m19:23:25.835712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3, now test.stock_dbt.not_null_bollinger_symbol.a932e30f82)
[0m19:23:25.835712 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_symbol.a932e30f82
[0m19:23:25.837747 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_symbol.a932e30f82"
[0m19:23:25.837747 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_symbol.a932e30f82
[0m19:23:25.837747 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_symbol.a932e30f82"
[0m19:23:25.841182 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_symbol.a932e30f82"
[0m19:23:25.841182 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_symbol.a932e30f82: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_symbol.a932e30f82"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.bollinger
where symbol is null



      
    ) dbt_internal_test
[0m19:23:25.841182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:26.447863 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.606 seconds
[0m19:23:26.449856 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_symbol.a932e30f82: Close
[0m19:23:26.549439 [info ] [Thread-1 (]: 8 of 27 PASS not_null_bollinger_symbol ......................................... [[32mPASS[0m in 0.71s]
[0m19:23:26.549439 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_symbol.a932e30f82
[0m19:23:26.550435 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_upper_band.e4db87564c
[0m19:23:26.550435 [info ] [Thread-1 (]: 9 of 27 START test not_null_bollinger_upper_band ............................... [RUN]
[0m19:23:26.550435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_symbol.a932e30f82, now test.stock_dbt.not_null_bollinger_upper_band.e4db87564c)
[0m19:23:26.550435 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_upper_band.e4db87564c
[0m19:23:26.553440 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_upper_band.e4db87564c"
[0m19:23:26.554441 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_upper_band.e4db87564c
[0m19:23:26.555435 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_upper_band.e4db87564c"
[0m19:23:26.565938 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_upper_band.e4db87564c"
[0m19:23:26.565938 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_upper_band.e4db87564c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_upper_band.e4db87564c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select upper_band
from dev.analytics.bollinger
where upper_band is null



      
    ) dbt_internal_test
[0m19:23:26.565938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:27.222943 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.657 seconds
[0m19:23:27.223945 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_upper_band.e4db87564c: Close
[0m19:23:27.336446 [info ] [Thread-1 (]: 9 of 27 PASS not_null_bollinger_upper_band ..................................... [[32mPASS[0m in 0.79s]
[0m19:23:27.337471 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_upper_band.e4db87564c
[0m19:23:27.337471 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_close.6d037dd588
[0m19:23:27.337471 [info ] [Thread-1 (]: 10 of 27 START test not_null_moving_average_close .............................. [RUN]
[0m19:23:27.338464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_upper_band.e4db87564c, now test.stock_dbt.not_null_moving_average_close.6d037dd588)
[0m19:23:27.339446 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_close.6d037dd588
[0m19:23:27.343497 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_close.6d037dd588"
[0m19:23:27.344491 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_close.6d037dd588
[0m19:23:27.347010 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_close.6d037dd588"
[0m19:23:27.348017 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_close.6d037dd588"
[0m19:23:27.348017 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_close.6d037dd588: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_close.6d037dd588"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.moving_average
where close is null



      
    ) dbt_internal_test
[0m19:23:27.349019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:27.973577 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.625 seconds
[0m19:23:27.974576 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_close.6d037dd588: Close
[0m19:23:28.088919 [info ] [Thread-1 (]: 10 of 27 PASS not_null_moving_average_close .................................... [[32mPASS[0m in 0.75s]
[0m19:23:28.089992 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_close.6d037dd588
[0m19:23:28.089992 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_date.3ad00158b5
[0m19:23:28.090995 [info ] [Thread-1 (]: 11 of 27 START test not_null_moving_average_date ............................... [RUN]
[0m19:23:28.090995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_close.6d037dd588, now test.stock_dbt.not_null_moving_average_date.3ad00158b5)
[0m19:23:28.090995 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_date.3ad00158b5
[0m19:23:28.093995 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_date.3ad00158b5"
[0m19:23:28.093995 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_date.3ad00158b5
[0m19:23:28.096500 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_date.3ad00158b5"
[0m19:23:28.097511 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_date.3ad00158b5"
[0m19:23:28.099024 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_date.3ad00158b5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_date.3ad00158b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.moving_average
where date is null



      
    ) dbt_internal_test
[0m19:23:28.099024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:28.764582 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.665 seconds
[0m19:23:28.766085 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_date.3ad00158b5: Close
[0m19:23:28.901620 [info ] [Thread-1 (]: 11 of 27 PASS not_null_moving_average_date ..................................... [[32mPASS[0m in 0.81s]
[0m19:23:28.901620 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_date.3ad00158b5
[0m19:23:28.905632 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m19:23:28.905632 [info ] [Thread-1 (]: 12 of 27 START test not_null_moving_average_moving_avg_20d ..................... [RUN]
[0m19:23:28.905632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_date.3ad00158b5, now test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22)
[0m19:23:28.905632 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m19:23:28.905632 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m19:23:28.905632 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m19:23:28.905632 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m19:23:28.905632 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m19:23:28.905632 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg_20d
from dev.analytics.moving_average
where moving_avg_20d is null



      
    ) dbt_internal_test
[0m19:23:28.905632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:29.473278 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.561 seconds
[0m19:23:29.477481 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22: Close
[0m19:23:29.613591 [info ] [Thread-1 (]: 12 of 27 PASS not_null_moving_average_moving_avg_20d ........................... [[32mPASS[0m in 0.71s]
[0m19:23:29.614593 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m19:23:29.614593 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m19:23:29.615591 [info ] [Thread-1 (]: 13 of 27 START test not_null_moving_average_moving_avg_5d ...................... [RUN]
[0m19:23:29.615591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22, now test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca)
[0m19:23:29.615591 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m19:23:29.662678 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m19:23:29.662678 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m19:23:29.664679 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m19:23:29.665671 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m19:23:29.665671 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg_5d
from dev.analytics.moving_average
where moving_avg_5d is null



      
    ) dbt_internal_test
[0m19:23:29.665671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:30.447707 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.782 seconds
[0m19:23:30.448708 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca: Close
[0m19:23:30.578927 [info ] [Thread-1 (]: 13 of 27 PASS not_null_moving_average_moving_avg_5d ............................ [[32mPASS[0m in 0.96s]
[0m19:23:30.578927 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m19:23:30.579929 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_symbol.75a6f7473c
[0m19:23:30.579929 [info ] [Thread-1 (]: 14 of 27 START test not_null_moving_average_symbol ............................. [RUN]
[0m19:23:30.579929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca, now test.stock_dbt.not_null_moving_average_symbol.75a6f7473c)
[0m19:23:30.579929 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_symbol.75a6f7473c
[0m19:23:30.584011 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_symbol.75a6f7473c"
[0m19:23:30.584011 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_symbol.75a6f7473c
[0m19:23:30.586523 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_symbol.75a6f7473c"
[0m19:23:30.588315 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_symbol.75a6f7473c"
[0m19:23:30.588315 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_symbol.75a6f7473c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_symbol.75a6f7473c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.moving_average
where symbol is null



      
    ) dbt_internal_test
[0m19:23:30.588315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:31.249982 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.661 seconds
[0m19:23:31.250975 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_symbol.75a6f7473c: Close
[0m19:23:31.362407 [info ] [Thread-1 (]: 14 of 27 PASS not_null_moving_average_symbol ................................... [[32mPASS[0m in 0.78s]
[0m19:23:31.363413 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_symbol.75a6f7473c
[0m19:23:31.364409 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42
[0m19:23:31.364409 [info ] [Thread-1 (]: 15 of 27 START test not_null_rsi_calculation_avg_gain .......................... [RUN]
[0m19:23:31.365412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_symbol.75a6f7473c, now test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42)
[0m19:23:31.365412 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42
[0m19:23:31.368448 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m19:23:31.370442 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42
[0m19:23:31.372954 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m19:23:31.372954 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m19:23:31.372954 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_gain
from dev.analytics.rsi_calculation
where avg_gain is null



      
    ) dbt_internal_test
[0m19:23:31.373957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:32.029490 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.656 seconds
[0m19:23:32.030490 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42: Close
[0m19:23:32.159898 [info ] [Thread-1 (]: 15 of 27 PASS not_null_rsi_calculation_avg_gain ................................ [[32mPASS[0m in 0.79s]
[0m19:23:32.160893 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42
[0m19:23:32.161886 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m19:23:32.161886 [info ] [Thread-1 (]: 16 of 27 START test not_null_rsi_calculation_avg_loss .......................... [RUN]
[0m19:23:32.162886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42, now test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19)
[0m19:23:32.162886 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m19:23:32.165401 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m19:23:32.176270 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m19:23:32.177278 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m19:23:32.179432 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m19:23:32.179432 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_loss
from dev.analytics.rsi_calculation
where avg_loss is null



      
    ) dbt_internal_test
[0m19:23:32.179432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:32.836591 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.657 seconds
[0m19:23:32.837594 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19: Close
[0m19:23:32.951258 [info ] [Thread-1 (]: 16 of 27 PASS not_null_rsi_calculation_avg_loss ................................ [[32mPASS[0m in 0.79s]
[0m19:23:32.952474 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m19:23:32.952474 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d
[0m19:23:32.952474 [info ] [Thread-1 (]: 17 of 27 START test not_null_rsi_calculation_close ............................. [RUN]
[0m19:23:32.953653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19, now test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d)
[0m19:23:32.953653 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d
[0m19:23:32.957895 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d"
[0m19:23:32.958830 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d
[0m19:23:32.959916 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d"
[0m19:23:32.961808 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d"
[0m19:23:32.961808 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.rsi_calculation
where close is null



      
    ) dbt_internal_test
[0m19:23:32.961808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:33.656450 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.694 seconds
[0m19:23:33.660448 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d: Close
[0m19:23:33.785470 [info ] [Thread-1 (]: 17 of 27 PASS not_null_rsi_calculation_close ................................... [[32mPASS[0m in 0.83s]
[0m19:23:33.785470 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d
[0m19:23:33.785470 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76
[0m19:23:33.785470 [info ] [Thread-1 (]: 18 of 27 START test not_null_rsi_calculation_date .............................. [RUN]
[0m19:23:33.785470 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d, now test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76)
[0m19:23:33.785470 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76
[0m19:23:33.796949 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76"
[0m19:23:33.807187 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76
[0m19:23:33.807917 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76"
[0m19:23:33.811238 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76"
[0m19:23:33.811238 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.rsi_calculation
where date is null



      
    ) dbt_internal_test
[0m19:23:33.811238 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:34.471703 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.660 seconds
[0m19:23:34.475625 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76: Close
[0m19:23:34.589618 [info ] [Thread-1 (]: 18 of 27 PASS not_null_rsi_calculation_date .................................... [[32mPASS[0m in 0.80s]
[0m19:23:34.590618 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76
[0m19:23:34.590618 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m19:23:34.591613 [info ] [Thread-1 (]: 19 of 27 START test not_null_rsi_calculation_rsi_14d ........................... [RUN]
[0m19:23:34.591613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76, now test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8)
[0m19:23:34.591613 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m19:23:34.594610 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m19:23:34.595610 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m19:23:34.598640 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m19:23:34.599644 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m19:23:34.599644 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from dev.analytics.rsi_calculation
where rsi_14d is null



      
    ) dbt_internal_test
[0m19:23:34.599644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:35.254500 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.654 seconds
[0m19:23:35.257948 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8: Close
[0m19:23:35.370988 [info ] [Thread-1 (]: 19 of 27 PASS not_null_rsi_calculation_rsi_14d ................................. [[32mPASS[0m in 0.78s]
[0m19:23:35.371988 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m19:23:35.371988 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84
[0m19:23:35.372991 [info ] [Thread-1 (]: 20 of 27 START test not_null_rsi_calculation_symbol ............................ [RUN]
[0m19:23:35.372991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8, now test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84)
[0m19:23:35.372991 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84
[0m19:23:35.375508 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m19:23:35.376551 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84
[0m19:23:35.377599 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m19:23:35.378595 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m19:23:35.378595 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.rsi_calculation
where symbol is null



      
    ) dbt_internal_test
[0m19:23:35.379595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:35.985539 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.606 seconds
[0m19:23:35.988643 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84: Close
[0m19:23:36.100879 [info ] [Thread-1 (]: 20 of 27 PASS not_null_rsi_calculation_symbol .................................. [[32mPASS[0m in 0.73s]
[0m19:23:36.102634 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84
[0m19:23:36.102634 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_close.d7e232e1ba
[0m19:23:36.102634 [info ] [Thread-1 (]: 21 of 27 START test not_null_stock_prices_close ................................ [RUN]
[0m19:23:36.103637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84, now test.stock_dbt.not_null_stock_prices_close.d7e232e1ba)
[0m19:23:36.103637 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_close.d7e232e1ba
[0m19:23:36.106685 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_close.d7e232e1ba"
[0m19:23:36.107699 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_close.d7e232e1ba
[0m19:23:36.108709 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_close.d7e232e1ba"
[0m19:23:36.109973 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_close.d7e232e1ba"
[0m19:23:36.109973 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_close.d7e232e1ba: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_close.d7e232e1ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.stock_prices
where close is null



      
    ) dbt_internal_test
[0m19:23:36.111087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:36.752844 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.642 seconds
[0m19:23:36.753844 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_close.d7e232e1ba: Close
[0m19:23:36.875388 [info ] [Thread-1 (]: 21 of 27 PASS not_null_stock_prices_close ...................................... [[32mPASS[0m in 0.77s]
[0m19:23:36.875388 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_close.d7e232e1ba
[0m19:23:36.876396 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_date.98a7527501
[0m19:23:36.876396 [info ] [Thread-1 (]: 22 of 27 START test not_null_stock_prices_date ................................. [RUN]
[0m19:23:36.876396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_close.d7e232e1ba, now test.stock_dbt.not_null_stock_prices_date.98a7527501)
[0m19:23:36.876396 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_date.98a7527501
[0m19:23:36.880535 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_date.98a7527501"
[0m19:23:36.880535 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_date.98a7527501
[0m19:23:36.882534 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_date.98a7527501"
[0m19:23:36.882534 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_date.98a7527501"
[0m19:23:36.883535 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_date.98a7527501: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_date.98a7527501"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.stock_prices
where date is null



      
    ) dbt_internal_test
[0m19:23:36.883535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:37.585432 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.702 seconds
[0m19:23:37.587365 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_date.98a7527501: Close
[0m19:23:37.698056 [info ] [Thread-1 (]: 22 of 27 PASS not_null_stock_prices_date ....................................... [[32mPASS[0m in 0.82s]
[0m19:23:37.699059 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_date.98a7527501
[0m19:23:37.699059 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc
[0m19:23:37.699059 [info ] [Thread-1 (]: 23 of 27 START test not_null_stock_prices_high ................................. [RUN]
[0m19:23:37.699059 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_date.98a7527501, now test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc)
[0m19:23:37.700063 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc
[0m19:23:37.701367 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc"
[0m19:23:37.702972 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc
[0m19:23:37.703991 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc"
[0m19:23:37.706407 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc"
[0m19:23:37.706407 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select high
from dev.analytics.stock_prices
where high is null



      
    ) dbt_internal_test
[0m19:23:37.706407 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:38.282233 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.575 seconds
[0m19:23:38.285832 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc: Close
[0m19:23:38.427833 [info ] [Thread-1 (]: 23 of 27 PASS not_null_stock_prices_high ....................................... [[32mPASS[0m in 0.73s]
[0m19:23:38.428404 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc
[0m19:23:38.428404 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_low.e65294ca15
[0m19:23:38.428404 [info ] [Thread-1 (]: 24 of 27 START test not_null_stock_prices_low .................................. [RUN]
[0m19:23:38.429408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc, now test.stock_dbt.not_null_stock_prices_low.e65294ca15)
[0m19:23:38.429408 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_low.e65294ca15
[0m19:23:38.431414 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_low.e65294ca15"
[0m19:23:38.432411 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_low.e65294ca15
[0m19:23:38.434414 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_low.e65294ca15"
[0m19:23:38.436291 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_low.e65294ca15"
[0m19:23:38.437307 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_low.e65294ca15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_low.e65294ca15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select low
from dev.analytics.stock_prices
where low is null



      
    ) dbt_internal_test
[0m19:23:38.437307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:39.146725 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.710 seconds
[0m19:23:39.149736 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_low.e65294ca15: Close
[0m19:23:39.280905 [info ] [Thread-1 (]: 24 of 27 PASS not_null_stock_prices_low ........................................ [[32mPASS[0m in 0.85s]
[0m19:23:39.281899 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_low.e65294ca15
[0m19:23:39.281899 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_open.e09b13f215
[0m19:23:39.281899 [info ] [Thread-1 (]: 25 of 27 START test not_null_stock_prices_open ................................. [RUN]
[0m19:23:39.282898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_low.e65294ca15, now test.stock_dbt.not_null_stock_prices_open.e09b13f215)
[0m19:23:39.282898 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_open.e09b13f215
[0m19:23:39.286407 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_open.e09b13f215"
[0m19:23:39.287406 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_open.e09b13f215
[0m19:23:39.288412 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_open.e09b13f215"
[0m19:23:39.289405 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_open.e09b13f215"
[0m19:23:39.289405 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_open.e09b13f215: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_open.e09b13f215"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from dev.analytics.stock_prices
where open is null



      
    ) dbt_internal_test
[0m19:23:39.289405 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:39.901413 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.615 seconds
[0m19:23:39.905303 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_open.e09b13f215: Close
[0m19:23:40.055211 [info ] [Thread-1 (]: 25 of 27 PASS not_null_stock_prices_open ....................................... [[32mPASS[0m in 0.77s]
[0m19:23:40.056222 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_open.e09b13f215
[0m19:23:40.056222 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8
[0m19:23:40.057219 [info ] [Thread-1 (]: 26 of 27 START test not_null_stock_prices_symbol ............................... [RUN]
[0m19:23:40.058228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_open.e09b13f215, now test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8)
[0m19:23:40.058228 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8
[0m19:23:40.063230 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8"
[0m19:23:40.064312 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8
[0m19:23:40.067016 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8"
[0m19:23:40.068086 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8"
[0m19:23:40.068086 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.stock_prices
where symbol is null



      
    ) dbt_internal_test
[0m19:23:40.068086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:40.727489 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.659 seconds
[0m19:23:40.731120 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8: Close
[0m19:23:40.848384 [info ] [Thread-1 (]: 26 of 27 PASS not_null_stock_prices_symbol ..................................... [[32mPASS[0m in 0.79s]
[0m19:23:40.849429 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8
[0m19:23:40.850012 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_volume.71420bc956
[0m19:23:40.850012 [info ] [Thread-1 (]: 27 of 27 START test not_null_stock_prices_volume ............................... [RUN]
[0m19:23:40.851188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8, now test.stock_dbt.not_null_stock_prices_volume.71420bc956)
[0m19:23:40.851188 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_volume.71420bc956
[0m19:23:40.854553 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_volume.71420bc956"
[0m19:23:40.856102 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_volume.71420bc956
[0m19:23:40.857709 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_volume.71420bc956"
[0m19:23:40.859254 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_volume.71420bc956"
[0m19:23:40.859783 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_volume.71420bc956: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_volume.71420bc956"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume
from dev.analytics.stock_prices
where volume is null



      
    ) dbt_internal_test
[0m19:23:40.859783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:41.518949 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.659 seconds
[0m19:23:41.521933 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_volume.71420bc956: Close
[0m19:23:41.741385 [info ] [Thread-1 (]: 27 of 27 PASS not_null_stock_prices_volume ..................................... [[32mPASS[0m in 0.89s]
[0m19:23:41.742385 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_volume.71420bc956
[0m19:23:41.744856 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:23:41.745367 [debug] [MainThread]: Connection 'list_dev_snapshot' was properly closed.
[0m19:23:41.745367 [debug] [MainThread]: Connection 'test.stock_dbt.not_null_stock_prices_volume.71420bc956' was properly closed.
[0m19:23:41.745367 [info ] [MainThread]: 
[0m19:23:41.746378 [info ] [MainThread]: Finished running 27 data tests in 0 hours 0 minutes and 23.61 seconds (23.61s).
[0m19:23:41.750383 [debug] [MainThread]: Command end result
[0m19:23:41.770533 [info ] [MainThread]: 
[0m19:23:41.771533 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:23:41.771533 [info ] [MainThread]: 
[0m19:23:41.772529 [info ] [MainThread]: Done. PASS=27 WARN=0 ERROR=0 SKIP=0 TOTAL=27
[0m19:23:41.773533 [debug] [MainThread]: Command `dbt test` succeeded at 19:23:41.773533 after 24.70 seconds
[0m19:23:41.773533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179CF135B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179CE750530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179FFCBA990>]}
[0m19:23:41.773533 [debug] [MainThread]: Flushing usage events
[0m19:24:23.537053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C993864C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C993866900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C994075220>]}


============================== 19:24:23.539053 | 7864858e-c8fa-4c38-ac83-2b8221eed32c ==============================
[0m19:24:23.539053 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:24:23.540055 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\tekal\\Downloads\\Sem 1\\DATA226\\sjsu-data226\\week8\\airflow\\stock_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\tekal\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:24:24.173090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7864858e-c8fa-4c38-ac83-2b8221eed32c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C993ECB1A0>]}
[0m19:24:24.204784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7864858e-c8fa-4c38-ac83-2b8221eed32c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9C420DD00>]}
[0m19:24:24.204784 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:24:24.220216 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:24:24.321835 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:24:24.321835 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:24:24.325341 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.stock_prediction
- models.stock_prediction.raw_data
- models.stock_prediction.tranformations
[0m19:24:24.350939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7864858e-c8fa-4c38-ac83-2b8221eed32c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9C4D32450>]}
[0m19:24:24.417709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7864858e-c8fa-4c38-ac83-2b8221eed32c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9C6970C80>]}
[0m19:24:24.418211 [info ] [MainThread]: Found 5 models, 4 snapshots, 27 data tests, 1 source, 459 macros
[0m19:24:24.418726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7864858e-c8fa-4c38-ac83-2b8221eed32c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9C5273380>]}
[0m19:24:24.419778 [info ] [MainThread]: 
[0m19:24:24.420291 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:24:24.422538 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m19:24:24.431783 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m19:24:24.431783 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m19:24:24.431783 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:25.163755 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.732 seconds
[0m19:24:25.164753 [debug] [ThreadPool]: On list_dev: Close
[0m19:24:25.348215 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_analytics'
[0m19:24:25.353537 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m19:24:25.353537 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m19:24:25.353537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:25.923924 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.570 seconds
[0m19:24:25.925428 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m19:24:26.060303 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m19:24:26.062313 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m19:24:26.063304 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m19:24:26.063304 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:24:26.728298 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.665 seconds
[0m19:24:26.729298 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m19:24:26.845644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7864858e-c8fa-4c38-ac83-2b8221eed32c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C991D96630>]}
[0m19:24:26.845644 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:24:26.846651 [info ] [MainThread]: 
[0m19:24:26.848651 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.snapshot_atr
[0m19:24:26.848651 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshot.snapshot_atr .................................... [RUN]
[0m19:24:26.848651 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.stock_dbt.snapshot_atr'
[0m19:24:26.849663 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.snapshot_atr
[0m19:24:26.853668 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.snapshot_atr
[0m19:24:26.886851 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m19:24:26.886851 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
[0m19:24:26.886851 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:24:27.487805 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.601 seconds
[0m19:24:27.504630 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m19:24:27.504630 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.avg_true_range


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m19:24:28.427218 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.913 seconds
[0m19:24:28.428912 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m19:24:28.429465 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
[0m19:24:28.501738 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.075 seconds
[0m19:24:28.506703 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m19:24:28.506703 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
[0m19:24:28.595349 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.088 seconds
[0m19:24:28.596855 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m19:24:28.596855 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
[0m19:24:28.683255 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.085 seconds
[0m19:24:28.685764 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m19:24:28.686765 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
[0m19:24:28.780971 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.094 seconds
[0m19:24:28.786490 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m19:24:28.786490 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
[0m19:24:28.852685 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.065 seconds
[0m19:24:28.868314 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m19:24:28.868314 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.avg_true_range


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m19:24:29.080310 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.211 seconds
[0m19:24:29.083311 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m19:24:29.084821 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m19:24:29.149572 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.065 seconds
[0m19:24:29.150573 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.snapshot_atr"
[0m19:24:29.152039 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m19:24:29.153043 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
BEGIN
[0m19:24:29.263353 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.111 seconds
[0m19:24:29.263353 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m19:24:29.264856 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_ATR" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATE", "SYMBOL", "ATR_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATE", "SYMBOL", "ATR_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m19:24:29.687844 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.422 seconds
[0m19:24:29.687844 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m19:24:29.688844 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
COMMIT
[0m19:24:29.975134 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.287 seconds
[0m19:24:29.994619 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: Close
[0m19:24:30.098849 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7864858e-c8fa-4c38-ac83-2b8221eed32c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9C6C3CAD0>]}
[0m19:24:30.099848 [info ] [Thread-1 (]: 1 of 4 OK snapshotted snapshot.snapshot_atr .................................... [[32mSUCCESS 0[0m in 3.25s]
[0m19:24:30.099848 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.snapshot_atr
[0m19:24:30.100847 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.snapshot_bollinger
[0m19:24:30.100847 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshot.snapshot_bollinger .............................. [RUN]
[0m19:24:30.100847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_dbt.snapshot_atr, now snapshot.stock_dbt.snapshot_bollinger)
[0m19:24:30.101840 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.snapshot_bollinger
[0m19:24:30.104657 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.snapshot_bollinger
[0m19:24:30.106665 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m19:24:30.106665 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
[0m19:24:30.107672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:30.692089 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.585 seconds
[0m19:24:30.699570 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m19:24:30.700568 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.bollinger


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m19:24:31.616476 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.915 seconds
[0m19:24:31.618476 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m19:24:31.618476 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
[0m19:24:31.695499 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.077 seconds
[0m19:24:31.698010 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m19:24:31.698010 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
[0m19:24:31.766676 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.069 seconds
[0m19:24:31.770676 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m19:24:31.770676 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
[0m19:24:31.842351 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.071 seconds
[0m19:24:31.843358 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m19:24:31.843358 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
[0m19:24:31.921616 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.077 seconds
[0m19:24:31.928130 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m19:24:31.928130 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
[0m19:24:32.025140 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.096 seconds
[0m19:24:32.032703 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m19:24:32.032703 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.bollinger


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m19:24:32.244653 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.212 seconds
[0m19:24:32.245693 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m19:24:32.246696 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m19:24:32.315647 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.069 seconds
[0m19:24:32.315647 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.snapshot_bollinger"
[0m19:24:32.317639 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m19:24:32.318640 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
BEGIN
[0m19:24:32.427882 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.109 seconds
[0m19:24:32.427882 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m19:24:32.427882 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "SMA_20D", "UPPER_BAND", "LOWER_BAND", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "SMA_20D", "UPPER_BAND", "LOWER_BAND", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m19:24:32.918484 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.490 seconds
[0m19:24:32.919501 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m19:24:32.920499 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
COMMIT
[0m19:24:33.188822 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.268 seconds
[0m19:24:33.191821 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: Close
[0m19:24:33.328918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7864858e-c8fa-4c38-ac83-2b8221eed32c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9C6BE08C0>]}
[0m19:24:33.330915 [info ] [Thread-1 (]: 2 of 4 OK snapshotted snapshot.snapshot_bollinger .............................. [[32mSUCCESS 0[0m in 3.23s]
[0m19:24:33.331915 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.snapshot_bollinger
[0m19:24:33.332993 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.snapshot_moving_avg
[0m19:24:33.334006 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshot.snapshot_moving_avg ............................. [RUN]
[0m19:24:33.334515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_dbt.snapshot_bollinger, now snapshot.stock_dbt.snapshot_moving_avg)
[0m19:24:33.334515 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.snapshot_moving_avg
[0m19:24:33.338528 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.snapshot_moving_avg
[0m19:24:33.345735 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m19:24:33.346190 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
[0m19:24:33.346190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:33.940849 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.594 seconds
[0m19:24:33.946349 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m19:24:33.947352 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.moving_average


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m19:24:34.916277 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.969 seconds
[0m19:24:34.918974 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m19:24:34.918974 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
[0m19:24:35.021551 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.102 seconds
[0m19:24:35.026226 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m19:24:35.026226 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
[0m19:24:35.091442 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.064 seconds
[0m19:24:35.094956 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m19:24:35.095970 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
[0m19:24:35.168920 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.072 seconds
[0m19:24:35.173007 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m19:24:35.173007 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
[0m19:24:35.278580 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.108 seconds
[0m19:24:35.284449 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m19:24:35.284857 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
[0m19:24:35.365507 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.081 seconds
[0m19:24:35.368495 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m19:24:35.369496 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.moving_average


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m19:24:35.596533 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.227 seconds
[0m19:24:35.597535 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m19:24:35.597535 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m19:24:35.668981 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.071 seconds
[0m19:24:35.670001 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.snapshot_moving_avg"
[0m19:24:35.672343 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m19:24:35.672343 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
BEGIN
[0m19:24:35.830841 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.158 seconds
[0m19:24:35.830841 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m19:24:35.831849 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "MOVING_AVG_5D", "MOVING_AVG_20D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "MOVING_AVG_5D", "MOVING_AVG_20D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m19:24:36.296640 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.465 seconds
[0m19:24:36.297647 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m19:24:36.297647 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
COMMIT
[0m19:24:36.594734 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.297 seconds
[0m19:24:36.597102 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: Close
[0m19:24:36.713758 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7864858e-c8fa-4c38-ac83-2b8221eed32c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9906C8D10>]}
[0m19:24:36.714758 [info ] [Thread-1 (]: 3 of 4 OK snapshotted snapshot.snapshot_moving_avg ............................. [[32mSUCCESS 0[0m in 3.38s]
[0m19:24:36.714758 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.snapshot_moving_avg
[0m19:24:36.714758 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.snapshot_rsi
[0m19:24:36.716215 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshot.snapshot_rsi .................................... [RUN]
[0m19:24:36.716215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_dbt.snapshot_moving_avg, now snapshot.stock_dbt.snapshot_rsi)
[0m19:24:36.716215 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.snapshot_rsi
[0m19:24:36.718371 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.snapshot_rsi
[0m19:24:36.722370 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m19:24:36.722370 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m19:24:36.722370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:37.424556 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.702 seconds
[0m19:24:37.428763 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m19:24:37.428763 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.rsi_calculation


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m19:24:38.272611 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.843 seconds
[0m19:24:38.277288 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m19:24:38.277288 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m19:24:38.366615 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.088 seconds
[0m19:24:38.370615 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m19:24:38.370615 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m19:24:38.480046 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.109 seconds
[0m19:24:38.482046 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m19:24:38.482046 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m19:24:38.559596 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.077 seconds
[0m19:24:38.561596 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m19:24:38.562607 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m19:24:38.641913 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.080 seconds
[0m19:24:38.645441 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m19:24:38.646454 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m19:24:38.750008 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.103 seconds
[0m19:24:38.754667 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m19:24:38.754667 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.rsi_calculation


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m19:24:38.974542 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.216 seconds
[0m19:24:38.975045 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m19:24:38.976049 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m19:24:39.045971 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.070 seconds
[0m19:24:39.047977 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.snapshot_rsi"
[0m19:24:39.049971 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m19:24:39.049971 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
BEGIN
[0m19:24:39.246486 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.196 seconds
[0m19:24:39.246486 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m19:24:39.246486 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_RSI" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "AVG_GAIN", "AVG_LOSS", "RSI_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "AVG_GAIN", "AVG_LOSS", "RSI_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m19:24:39.635821 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.389 seconds
[0m19:24:39.636880 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m19:24:39.637874 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
COMMIT
[0m19:24:39.956069 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.318 seconds
[0m19:24:39.958082 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: Close
[0m19:24:40.078533 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7864858e-c8fa-4c38-ac83-2b8221eed32c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9C6DF40B0>]}
[0m19:24:40.080527 [info ] [Thread-1 (]: 4 of 4 OK snapshotted snapshot.snapshot_rsi .................................... [[32mSUCCESS 0[0m in 3.36s]
[0m19:24:40.081388 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.snapshot_rsi
[0m19:24:40.083417 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:24:40.084416 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m19:24:40.084416 [debug] [MainThread]: Connection 'list_dev_snapshot' was properly closed.
[0m19:24:40.085447 [debug] [MainThread]: Connection 'snapshot.stock_dbt.snapshot_rsi' was properly closed.
[0m19:24:40.085447 [info ] [MainThread]: 
[0m19:24:40.086441 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 15.67 seconds (15.67s).
[0m19:24:40.087441 [debug] [MainThread]: Command end result
[0m19:24:40.110179 [info ] [MainThread]: 
[0m19:24:40.110179 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:24:40.111168 [info ] [MainThread]: 
[0m19:24:40.111168 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:24:40.112167 [debug] [MainThread]: Command `dbt snapshot` succeeded at 19:24:40.112167 after 16.72 seconds
[0m19:24:40.112167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9934602F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9C6D4DB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9C6D4D5B0>]}
[0m19:24:40.113167 [debug] [MainThread]: Flushing usage events
[0m19:26:58.044075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002001FF52420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002002304BB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002001FEFD220>]}


============================== 19:26:58.047380 | e20fb8cc-0a43-479a-a1e7-a1c403394b36 ==============================
[0m19:26:58.047380 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:26:58.047380 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\tekal\\Downloads\\Sem 1\\DATA226\\sjsu-data226\\week8\\airflow\\stock_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\tekal\\Downloads\\Sem 1\\DATA226\\sjsu-data226\\week8\\airflow\\stock_dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m19:26:58.138420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e20fb8cc-0a43-479a-a1e7-a1c403394b36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200239334A0>]}
[0m19:26:58.161591 [debug] [MainThread]: Command `dbt clean` succeeded at 19:26:58.161591 after 0.28 seconds
[0m19:26:58.161591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020022EA0140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200235567E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020023E69610>]}
[0m19:26:58.163100 [debug] [MainThread]: Flushing usage events
[0m04:04:45.260532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9a6c46a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9a6c478f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9a6c476e0>]}


============================== 04:04:45.265992 | a6c85ff4-1c56-496b-870c-d4b759df2870 ==============================
[0m04:04:45.265992 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:04:45.267123 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/stock_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/stock_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/stock_dbt --project-dir /opt/airflow/stock_dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:04:45.922679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6c85ff4-1c56-496b-870c-d4b759df2870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa94d563920>]}
[0m04:04:45.959534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6c85ff4-1c56-496b-870c-d4b759df2870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9a5a2e9f0>]}
[0m04:04:45.962117 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:04:45.970486 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:04:45.979546 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m04:04:45.980677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a6c85ff4-1c56-496b-870c-d4b759df2870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9a6765670>]}
[0m04:04:46.978310 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m04:04:46.979687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a6c85ff4-1c56-496b-870c-d4b759df2870', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa94d1bc2f0>]}
[0m04:04:47.255358 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.stock_prediction
- models.stock_prediction.raw_data
- models.stock_prediction.tranformations
[0m04:04:47.265089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6c85ff4-1c56-496b-870c-d4b759df2870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93cd9e480>]}
[0m04:04:47.402051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6c85ff4-1c56-496b-870c-d4b759df2870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa94cfd1340>]}
[0m04:04:47.404576 [info ] [MainThread]: Found 5 models, 4 snapshots, 27 data tests, 1 source, 459 macros
[0m04:04:47.406632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6c85ff4-1c56-496b-870c-d4b759df2870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa94d043470>]}
[0m04:04:47.411506 [info ] [MainThread]: 
[0m04:04:47.413312 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:04:47.417629 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m04:04:47.428863 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m04:04:47.430845 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m04:04:47.432319 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:04:48.438194 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.006 seconds
[0m04:04:48.440331 [debug] [ThreadPool]: On list_dev: Close
[0m04:04:48.562647 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m04:04:48.569961 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m04:04:48.571534 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m04:04:48.572474 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:04:49.003032 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.430 seconds
[0m04:04:49.007491 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m04:04:49.124634 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m04:04:49.129318 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m04:04:49.131048 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m04:04:49.132970 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:04:49.515315 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.382 seconds
[0m04:04:49.519246 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m04:04:49.646353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6c85ff4-1c56-496b-870c-d4b759df2870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa94d0199a0>]}
[0m04:04:49.648720 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:04:49.650470 [info ] [MainThread]: 
[0m04:04:49.657733 [debug] [Thread-1 (]: Began running node model.stock_dbt.stock_prices
[0m04:04:49.658988 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stock_prices ............................. [RUN]
[0m04:04:49.660117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now model.stock_dbt.stock_prices)
[0m04:04:49.660951 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.stock_prices
[0m04:04:49.666937 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.stock_prices"
[0m04:04:49.684900 [debug] [Thread-1 (]: Began executing node model.stock_dbt.stock_prices
[0m04:04:49.706324 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.stock_prices"
[0m04:04:49.732996 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.stock_prices"
[0m04:04:49.734313 [debug] [Thread-1 (]: On model.stock_dbt.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.stock_prices"} */
create or replace   view dev.analytics.stock_prices
  
   as (
    SELECT
    symbol,
    date,
    open,
    high,
    low,
    close,
    volume
FROM dev.raw_data.stock_prices
  );
[0m04:04:49.736117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:04:50.441123 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.706 seconds
[0m04:04:50.460230 [debug] [Thread-1 (]: On model.stock_dbt.stock_prices: Close
[0m04:04:50.585401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6c85ff4-1c56-496b-870c-d4b759df2870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa94d459550>]}
[0m04:04:50.587851 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stock_prices ........................ [[32mSUCCESS 1[0m in 0.92s]
[0m04:04:50.589902 [debug] [Thread-1 (]: Finished running node model.stock_dbt.stock_prices
[0m04:04:50.592116 [debug] [Thread-1 (]: Began running node model.stock_dbt.avg_true_range
[0m04:04:50.593144 [info ] [Thread-1 (]: 2 of 5 START sql view model analytics.avg_true_range ........................... [RUN]
[0m04:04:50.594465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.stock_prices, now model.stock_dbt.avg_true_range)
[0m04:04:50.595561 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.avg_true_range
[0m04:04:50.599036 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.avg_true_range"
[0m04:04:50.624778 [debug] [Thread-1 (]: Began executing node model.stock_dbt.avg_true_range
[0m04:04:50.627499 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.avg_true_range"
[0m04:04:50.641477 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.avg_true_range"
[0m04:04:50.642347 [debug] [Thread-1 (]: On model.stock_dbt.avg_true_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.avg_true_range"} */
create or replace   view dev.analytics.avg_true_range
  
   as (
    WITH averageTrueRanges AS (
    SELECT
        date,
        symbol,
        close,
        ABS(close - LAG(close) OVER (PARTITION BY symbol ORDER BY date)) AS true_range
    FROM dev.analytics.stock_prices
),
atr AS (
    SELECT
        date,
        symbol,
        AVG(true_range) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS atr_14d
    FROM averageTrueRanges
)
SELECT 
    date, 
    symbol, 
    COALESCE(atr_14d, 0) AS atr_14d
FROM atr
ORDER BY date, symbol
  );
[0m04:04:50.643160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:04:51.316296 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.673 seconds
[0m04:04:51.319472 [debug] [Thread-1 (]: On model.stock_dbt.avg_true_range: Close
[0m04:04:51.443835 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6c85ff4-1c56-496b-870c-d4b759df2870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93c398fe0>]}
[0m04:04:51.445877 [info ] [Thread-1 (]: 2 of 5 OK created sql view model analytics.avg_true_range ...................... [[32mSUCCESS 1[0m in 0.85s]
[0m04:04:51.447991 [debug] [Thread-1 (]: Finished running node model.stock_dbt.avg_true_range
[0m04:04:51.449851 [debug] [Thread-1 (]: Began running node model.stock_dbt.bollinger
[0m04:04:51.451708 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.bollinger ................................ [RUN]
[0m04:04:51.453275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.avg_true_range, now model.stock_dbt.bollinger)
[0m04:04:51.454780 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.bollinger
[0m04:04:51.458154 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.bollinger"
[0m04:04:51.475140 [debug] [Thread-1 (]: Began executing node model.stock_dbt.bollinger
[0m04:04:51.478213 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.bollinger"
[0m04:04:51.494756 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.bollinger"
[0m04:04:51.496677 [debug] [Thread-1 (]: On model.stock_dbt.bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.bollinger"} */
create or replace   view dev.analytics.bollinger
  
   as (
    WITH bollinger AS (
    SELECT
        symbol,
        date,
        close,
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) AS sma_20d,
        STDDEV(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) AS stddev_20d
    FROM dev.analytics.stock_prices
)

SELECT
    symbol,
    date,
    close,
    COALESCE(sma_20d, 0) AS sma_20d,
    COALESCE(sma_20d + (2 * stddev_20d), 0) AS upper_band,
    COALESCE(sma_20d - (2 * stddev_20d), 0) AS lower_band
FROM bollinger
ORDER BY symbol, date
  );
[0m04:04:51.498030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:04:52.206117 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.708 seconds
[0m04:04:52.208770 [debug] [Thread-1 (]: On model.stock_dbt.bollinger: Close
[0m04:04:52.348109 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6c85ff4-1c56-496b-870c-d4b759df2870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9a62f5f70>]}
[0m04:04:52.349850 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.bollinger ........................... [[32mSUCCESS 1[0m in 0.89s]
[0m04:04:52.351285 [debug] [Thread-1 (]: Finished running node model.stock_dbt.bollinger
[0m04:04:52.352291 [debug] [Thread-1 (]: Began running node model.stock_dbt.moving_average
[0m04:04:52.353537 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.moving_average ........................... [RUN]
[0m04:04:52.354335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.bollinger, now model.stock_dbt.moving_average)
[0m04:04:52.355579 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.moving_average
[0m04:04:52.358543 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.moving_average"
[0m04:04:52.366327 [debug] [Thread-1 (]: Began executing node model.stock_dbt.moving_average
[0m04:04:52.368963 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.moving_average"
[0m04:04:52.378414 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.moving_average"
[0m04:04:52.379556 [debug] [Thread-1 (]: On model.stock_dbt.moving_average: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.moving_average"} */
create or replace   view dev.analytics.moving_average
  
   as (
    WITH stock_data AS (
    SELECT
        symbol,
        date,
        close
    FROM dev.analytics.stock_prices -- assuming 'stock_prices' is the name of the raw table model in dbt
)

SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
    ) AS moving_avg_5d,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
    ) AS moving_avg_20d
FROM stock_data
ORDER BY symbol, date
  );
[0m04:04:52.380844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:04:53.028399 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.648 seconds
[0m04:04:53.032830 [debug] [Thread-1 (]: On model.stock_dbt.moving_average: Close
[0m04:04:53.140266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6c85ff4-1c56-496b-870c-d4b759df2870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93cc4de80>]}
[0m04:04:53.142208 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.moving_average ...................... [[32mSUCCESS 1[0m in 0.79s]
[0m04:04:53.144742 [debug] [Thread-1 (]: Finished running node model.stock_dbt.moving_average
[0m04:04:53.145934 [debug] [Thread-1 (]: Began running node model.stock_dbt.rsi_calculation
[0m04:04:53.147256 [info ] [Thread-1 (]: 5 of 5 START sql view model analytics.rsi_calculation .......................... [RUN]
[0m04:04:53.148418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.moving_average, now model.stock_dbt.rsi_calculation)
[0m04:04:53.149257 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.rsi_calculation
[0m04:04:53.152126 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.rsi_calculation"
[0m04:04:53.161455 [debug] [Thread-1 (]: Began executing node model.stock_dbt.rsi_calculation
[0m04:04:53.174412 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.rsi_calculation"
[0m04:04:53.187079 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.rsi_calculation"
[0m04:04:53.188382 [debug] [Thread-1 (]: On model.stock_dbt.rsi_calculation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.rsi_calculation"} */
create or replace   view dev.analytics.rsi_calculation
  
   as (
    WITH stock_data AS (
    SELECT
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM dev.analytics.stock_prices
),

price_changes AS (
    SELECT
        symbol,
        date,
        close,
        CASE 
            WHEN close > prev_close THEN close - prev_close
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close < prev_close THEN prev_close - close
            ELSE 0 
        END AS loss
    FROM stock_data
),

average_gains_losses AS (
    SELECT
        symbol,
        date,
        close,
        -- Calculate the average gain over the last 14 days, including the current row
        AVG(gain) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain,
        -- Calculate the average loss over the last 14 days, including the current row
        AVG(loss) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss
    FROM price_changes
)

SELECT
    symbol,
    date,
    close,
    avg_gain,
    avg_loss,
    -- Calculate RSI, using COALESCE to set to 0 if result is NULL
    COALESCE(100 - (100 / (1 + (NULLIF(avg_gain, 0) / NULLIF(avg_loss, 0)))), 0) AS rsi_14d
FROM average_gains_losses
ORDER BY symbol, date
  );
[0m04:04:53.189740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:04:53.781269 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.592 seconds
[0m04:04:53.784631 [debug] [Thread-1 (]: On model.stock_dbt.rsi_calculation: Close
[0m04:04:53.935337 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6c85ff4-1c56-496b-870c-d4b759df2870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa93c2285c0>]}
[0m04:04:53.938093 [info ] [Thread-1 (]: 5 of 5 OK created sql view model analytics.rsi_calculation ..................... [[32mSUCCESS 1[0m in 0.79s]
[0m04:04:53.940316 [debug] [Thread-1 (]: Finished running node model.stock_dbt.rsi_calculation
[0m04:04:53.943477 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:04:53.944471 [debug] [MainThread]: Connection 'model.stock_dbt.rsi_calculation' was properly closed.
[0m04:04:53.946086 [info ] [MainThread]: 
[0m04:04:53.947543 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 6.53 seconds (6.53s).
[0m04:04:53.949523 [debug] [MainThread]: Command end result
[0m04:04:53.998031 [info ] [MainThread]: 
[0m04:04:53.999447 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:04:54.001154 [info ] [MainThread]: 
[0m04:04:54.002731 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m04:04:54.004662 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.80351, "process_user_time": 3.889051, "process_kernel_time": 3.190237, "process_mem_max_rss": "261512", "process_in_blocks": "21200", "process_out_blocks": "3816"}
[0m04:04:54.006605 [debug] [MainThread]: Command `dbt run` succeeded at 04:04:54.006521 after 8.81 seconds
[0m04:04:54.008369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9a79bef00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9a7b45d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9a7b446b0>]}
[0m04:04:54.010017 [debug] [MainThread]: Flushing usage events
[0m04:04:55.984000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff987b8c7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff986363770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff98648fe30>]}


============================== 04:04:55.988660 | 83c6f54f-70ec-4a2a-9ec1-1d65516181f7 ==============================
[0m04:04:55.988660 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:04:55.990505 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/stock_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/stock_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/stock_dbt --project-dir /opt/airflow/stock_dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:04:56.593010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83c6f54f-70ec-4a2a-9ec1-1d65516181f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff92cd77260>]}
[0m04:04:56.629474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83c6f54f-70ec-4a2a-9ec1-1d65516181f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff986817140>]}
[0m04:04:56.632810 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:04:56.641506 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:04:56.920638 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:04:56.921721 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:04:56.926216 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.stock_prediction.raw_data
- models.stock_prediction
- models.stock_prediction.tranformations
[0m04:04:56.962018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83c6f54f-70ec-4a2a-9ec1-1d65516181f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff92cb95340>]}
[0m04:04:57.112553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83c6f54f-70ec-4a2a-9ec1-1d65516181f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff92c5e7290>]}
[0m04:04:57.113835 [info ] [MainThread]: Found 5 models, 4 snapshots, 27 data tests, 1 source, 459 macros
[0m04:04:57.115209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83c6f54f-70ec-4a2a-9ec1-1d65516181f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff985f90800>]}
[0m04:04:57.118320 [info ] [MainThread]: 
[0m04:04:57.120129 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:04:57.124712 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_analytics'
[0m04:04:57.137225 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m04:04:57.138679 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m04:04:57.139952 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:04:57.842305 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.702 seconds
[0m04:04:57.846058 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m04:04:58.002355 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m04:04:58.007152 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m04:04:58.008763 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m04:04:58.010161 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:04:58.436029 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.426 seconds
[0m04:04:58.438281 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m04:04:58.552905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83c6f54f-70ec-4a2a-9ec1-1d65516181f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff987a38ce0>]}
[0m04:04:58.555313 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:04:58.556785 [info ] [MainThread]: 
[0m04:04:58.563899 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m04:04:58.565248 [info ] [Thread-1 (]: 1 of 27 START test not_null_avg_true_range_atr_14d ............................. [RUN]
[0m04:04:58.567277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad)
[0m04:04:58.568887 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m04:04:58.580738 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad"
[0m04:04:58.606949 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m04:04:58.622434 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad"
[0m04:04:58.648442 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad"
[0m04:04:58.650621 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select atr_14d
from dev.analytics.avg_true_range
where atr_14d is null



      
    ) dbt_internal_test
[0m04:04:58.652354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:04:59.581846 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.930 seconds
[0m04:04:59.599486 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad: Close
[0m04:04:59.731732 [info ] [Thread-1 (]: 1 of 27 PASS not_null_avg_true_range_atr_14d ................................... [[32mPASS[0m in 1.16s]
[0m04:04:59.735329 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m04:04:59.736662 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_avg_true_range_date.4e418b835d
[0m04:04:59.737615 [info ] [Thread-1 (]: 2 of 27 START test not_null_avg_true_range_date ................................ [RUN]
[0m04:04:59.738811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad, now test.stock_dbt.not_null_avg_true_range_date.4e418b835d)
[0m04:04:59.739744 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_avg_true_range_date.4e418b835d
[0m04:04:59.743198 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_avg_true_range_date.4e418b835d"
[0m04:04:59.752974 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_avg_true_range_date.4e418b835d
[0m04:04:59.756241 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_avg_true_range_date.4e418b835d"
[0m04:04:59.772226 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_avg_true_range_date.4e418b835d"
[0m04:04:59.773340 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_date.4e418b835d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_avg_true_range_date.4e418b835d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.avg_true_range
where date is null



      
    ) dbt_internal_test
[0m04:04:59.774118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:05:00.381805 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.608 seconds
[0m04:05:00.384385 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_date.4e418b835d: Close
[0m04:05:00.568282 [info ] [Thread-1 (]: 2 of 27 PASS not_null_avg_true_range_date ...................................... [[32mPASS[0m in 0.83s]
[0m04:05:00.570137 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_avg_true_range_date.4e418b835d
[0m04:05:00.571508 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1
[0m04:05:00.572405 [info ] [Thread-1 (]: 3 of 27 START test not_null_avg_true_range_symbol .............................. [RUN]
[0m04:05:00.574183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_avg_true_range_date.4e418b835d, now test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1)
[0m04:05:00.575351 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1
[0m04:05:00.578865 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1"
[0m04:05:00.597132 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1
[0m04:05:00.600201 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1"
[0m04:05:00.613398 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1"
[0m04:05:00.614499 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.avg_true_range
where symbol is null



      
    ) dbt_internal_test
[0m04:05:00.615357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:05:01.107976 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.492 seconds
[0m04:05:01.111794 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1: Close
[0m04:05:01.234936 [info ] [Thread-1 (]: 3 of 27 PASS not_null_avg_true_range_symbol .................................... [[32mPASS[0m in 0.66s]
[0m04:05:01.236945 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1
[0m04:05:01.238046 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_close.4ccb16a429
[0m04:05:01.238791 [info ] [Thread-1 (]: 4 of 27 START test not_null_bollinger_close .................................... [RUN]
[0m04:05:01.239793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1, now test.stock_dbt.not_null_bollinger_close.4ccb16a429)
[0m04:05:01.240756 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_close.4ccb16a429
[0m04:05:01.244084 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_close.4ccb16a429"
[0m04:05:01.256675 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_close.4ccb16a429
[0m04:05:01.259838 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_close.4ccb16a429"
[0m04:05:01.270247 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_close.4ccb16a429"
[0m04:05:01.271734 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_close.4ccb16a429: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_close.4ccb16a429"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.bollinger
where close is null



      
    ) dbt_internal_test
[0m04:05:01.273090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:05:01.695420 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.422 seconds
[0m04:05:01.699452 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_close.4ccb16a429: Close
[0m04:05:01.829330 [info ] [Thread-1 (]: 4 of 27 PASS not_null_bollinger_close .......................................... [[32mPASS[0m in 0.59s]
[0m04:05:01.832160 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_close.4ccb16a429
[0m04:05:01.833480 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_date.9d77bdd20c
[0m04:05:01.835125 [info ] [Thread-1 (]: 5 of 27 START test not_null_bollinger_date ..................................... [RUN]
[0m04:05:01.836678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_close.4ccb16a429, now test.stock_dbt.not_null_bollinger_date.9d77bdd20c)
[0m04:05:01.837880 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_date.9d77bdd20c
[0m04:05:01.841951 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_date.9d77bdd20c"
[0m04:05:01.853861 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_date.9d77bdd20c
[0m04:05:01.856556 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_date.9d77bdd20c"
[0m04:05:01.868486 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_date.9d77bdd20c"
[0m04:05:01.869768 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_date.9d77bdd20c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_date.9d77bdd20c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.bollinger
where date is null



      
    ) dbt_internal_test
[0m04:05:01.871012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:05:02.431823 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.561 seconds
[0m04:05:02.434586 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_date.9d77bdd20c: Close
[0m04:05:02.551555 [info ] [Thread-1 (]: 5 of 27 PASS not_null_bollinger_date ........................................... [[32mPASS[0m in 0.71s]
[0m04:05:02.554654 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_date.9d77bdd20c
[0m04:05:02.555905 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e
[0m04:05:02.557126 [info ] [Thread-1 (]: 6 of 27 START test not_null_bollinger_lower_band ............................... [RUN]
[0m04:05:02.558460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_date.9d77bdd20c, now test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e)
[0m04:05:02.559324 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e
[0m04:05:02.562972 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e"
[0m04:05:02.568383 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e
[0m04:05:02.570462 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e"
[0m04:05:02.584732 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e"
[0m04:05:02.585768 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select lower_band
from dev.analytics.bollinger
where lower_band is null



      
    ) dbt_internal_test
[0m04:05:02.586955 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:05:03.070415 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.483 seconds
[0m04:05:03.075810 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e: Close
[0m04:05:03.204772 [info ] [Thread-1 (]: 6 of 27 PASS not_null_bollinger_lower_band ..................................... [[32mPASS[0m in 0.65s]
[0m04:05:03.207291 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e
[0m04:05:03.208590 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3
[0m04:05:03.210260 [info ] [Thread-1 (]: 7 of 27 START test not_null_bollinger_sma_20d .................................. [RUN]
[0m04:05:03.211754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e, now test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3)
[0m04:05:03.212800 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3
[0m04:05:03.216415 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3"
[0m04:05:03.224502 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3
[0m04:05:03.227271 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3"
[0m04:05:03.248123 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3"
[0m04:05:03.249347 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sma_20d
from dev.analytics.bollinger
where sma_20d is null



      
    ) dbt_internal_test
[0m04:05:03.250616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:05:03.767815 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.517 seconds
[0m04:05:03.773154 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3: Close
[0m04:05:03.895902 [info ] [Thread-1 (]: 7 of 27 PASS not_null_bollinger_sma_20d ........................................ [[32mPASS[0m in 0.68s]
[0m04:05:03.898637 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3
[0m04:05:03.899779 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_symbol.a932e30f82
[0m04:05:03.901248 [info ] [Thread-1 (]: 8 of 27 START test not_null_bollinger_symbol ................................... [RUN]
[0m04:05:03.902606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3, now test.stock_dbt.not_null_bollinger_symbol.a932e30f82)
[0m04:05:03.903489 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_symbol.a932e30f82
[0m04:05:03.907306 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_symbol.a932e30f82"
[0m04:05:03.912721 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_symbol.a932e30f82
[0m04:05:03.914718 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_symbol.a932e30f82"
[0m04:05:03.929816 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_symbol.a932e30f82"
[0m04:05:03.931131 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_symbol.a932e30f82: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_symbol.a932e30f82"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.bollinger
where symbol is null



      
    ) dbt_internal_test
[0m04:05:03.932514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:05:04.364325 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.432 seconds
[0m04:05:04.367142 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_symbol.a932e30f82: Close
[0m04:05:04.490014 [info ] [Thread-1 (]: 8 of 27 PASS not_null_bollinger_symbol ......................................... [[32mPASS[0m in 0.59s]
[0m04:05:04.493070 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_symbol.a932e30f82
[0m04:05:04.494869 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_upper_band.e4db87564c
[0m04:05:04.496025 [info ] [Thread-1 (]: 9 of 27 START test not_null_bollinger_upper_band ............................... [RUN]
[0m04:05:04.497856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_symbol.a932e30f82, now test.stock_dbt.not_null_bollinger_upper_band.e4db87564c)
[0m04:05:04.499240 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_upper_band.e4db87564c
[0m04:05:04.503307 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_upper_band.e4db87564c"
[0m04:05:04.512470 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_upper_band.e4db87564c
[0m04:05:04.515686 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_upper_band.e4db87564c"
[0m04:05:04.523929 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_upper_band.e4db87564c"
[0m04:05:04.524804 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_upper_band.e4db87564c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_upper_band.e4db87564c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select upper_band
from dev.analytics.bollinger
where upper_band is null



      
    ) dbt_internal_test
[0m04:05:04.525993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:05:04.985337 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.459 seconds
[0m04:05:04.990651 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_upper_band.e4db87564c: Close
[0m04:05:05.124516 [info ] [Thread-1 (]: 9 of 27 PASS not_null_bollinger_upper_band ..................................... [[32mPASS[0m in 0.63s]
[0m04:05:05.127307 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_upper_band.e4db87564c
[0m04:05:05.128495 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_close.6d037dd588
[0m04:05:05.129769 [info ] [Thread-1 (]: 10 of 27 START test not_null_moving_average_close .............................. [RUN]
[0m04:05:05.131043 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_upper_band.e4db87564c, now test.stock_dbt.not_null_moving_average_close.6d037dd588)
[0m04:05:05.132306 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_close.6d037dd588
[0m04:05:05.135932 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_close.6d037dd588"
[0m04:05:05.151421 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_close.6d037dd588
[0m04:05:05.154453 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_close.6d037dd588"
[0m04:05:05.166253 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_close.6d037dd588"
[0m04:05:05.167197 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_close.6d037dd588: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_close.6d037dd588"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.moving_average
where close is null



      
    ) dbt_internal_test
[0m04:05:05.168438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:05:05.634732 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.466 seconds
[0m04:05:05.640394 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_close.6d037dd588: Close
[0m04:05:05.785925 [info ] [Thread-1 (]: 10 of 27 PASS not_null_moving_average_close .................................... [[32mPASS[0m in 0.65s]
[0m04:05:05.788386 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_close.6d037dd588
[0m04:05:05.789648 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_date.3ad00158b5
[0m04:05:05.790525 [info ] [Thread-1 (]: 11 of 27 START test not_null_moving_average_date ............................... [RUN]
[0m04:05:05.791749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_close.6d037dd588, now test.stock_dbt.not_null_moving_average_date.3ad00158b5)
[0m04:05:05.792580 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_date.3ad00158b5
[0m04:05:05.796170 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_date.3ad00158b5"
[0m04:05:05.805052 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_date.3ad00158b5
[0m04:05:05.807317 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_date.3ad00158b5"
[0m04:05:05.814264 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_date.3ad00158b5"
[0m04:05:05.815083 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_date.3ad00158b5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_date.3ad00158b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.moving_average
where date is null



      
    ) dbt_internal_test
[0m04:05:05.816507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:05:06.609762 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.793 seconds
[0m04:05:06.614169 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_date.3ad00158b5: Close
[0m04:05:06.894850 [info ] [Thread-1 (]: 11 of 27 PASS not_null_moving_average_date ..................................... [[32mPASS[0m in 1.10s]
[0m04:05:06.897390 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_date.3ad00158b5
[0m04:05:06.898562 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m04:05:06.899407 [info ] [Thread-1 (]: 12 of 27 START test not_null_moving_average_moving_avg_20d ..................... [RUN]
[0m04:05:06.900865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_date.3ad00158b5, now test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22)
[0m04:05:06.901667 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m04:05:06.905234 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m04:05:06.923980 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m04:05:06.926847 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m04:05:06.945161 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m04:05:06.947563 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg_20d
from dev.analytics.moving_average
where moving_avg_20d is null



      
    ) dbt_internal_test
[0m04:05:06.949847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:05:07.720700 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.771 seconds
[0m04:05:07.726094 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22: Close
[0m04:05:07.960555 [info ] [Thread-1 (]: 12 of 27 PASS not_null_moving_average_moving_avg_20d ........................... [[32mPASS[0m in 1.06s]
[0m04:05:07.963211 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m04:05:07.964411 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m04:05:07.966331 [info ] [Thread-1 (]: 13 of 27 START test not_null_moving_average_moving_avg_5d ...................... [RUN]
[0m04:05:07.967775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22, now test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca)
[0m04:05:07.969240 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m04:05:07.972884 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m04:05:07.981085 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m04:05:07.984028 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m04:05:08.013742 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m04:05:08.015754 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg_5d
from dev.analytics.moving_average
where moving_avg_5d is null



      
    ) dbt_internal_test
[0m04:05:08.017969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:05:08.473346 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.455 seconds
[0m04:05:08.477279 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca: Close
[0m04:05:08.648490 [info ] [Thread-1 (]: 13 of 27 PASS not_null_moving_average_moving_avg_5d ............................ [[32mPASS[0m in 0.68s]
[0m04:05:08.650900 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m04:05:08.652603 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_symbol.75a6f7473c
[0m04:05:08.653520 [info ] [Thread-1 (]: 14 of 27 START test not_null_moving_average_symbol ............................. [RUN]
[0m04:05:08.654797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca, now test.stock_dbt.not_null_moving_average_symbol.75a6f7473c)
[0m04:05:08.656153 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_symbol.75a6f7473c
[0m04:05:08.659362 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_symbol.75a6f7473c"
[0m04:05:08.668549 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_symbol.75a6f7473c
[0m04:05:08.679954 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_symbol.75a6f7473c"
[0m04:05:08.690488 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_symbol.75a6f7473c"
[0m04:05:08.691615 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_symbol.75a6f7473c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_symbol.75a6f7473c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.moving_average
where symbol is null



      
    ) dbt_internal_test
[0m04:05:08.692610 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:05:09.583719 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.891 seconds
[0m04:05:09.588447 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_symbol.75a6f7473c: Close
[0m04:05:09.736224 [info ] [Thread-1 (]: 14 of 27 PASS not_null_moving_average_symbol ................................... [[32mPASS[0m in 1.08s]
[0m04:05:09.738942 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_symbol.75a6f7473c
[0m04:05:09.740771 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42
[0m04:05:09.742316 [info ] [Thread-1 (]: 15 of 27 START test not_null_rsi_calculation_avg_gain .......................... [RUN]
[0m04:05:09.744025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_symbol.75a6f7473c, now test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42)
[0m04:05:09.745629 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42
[0m04:05:09.749735 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m04:05:09.756603 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42
[0m04:05:09.758903 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m04:05:09.782777 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m04:05:09.784158 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_gain
from dev.analytics.rsi_calculation
where avg_gain is null



      
    ) dbt_internal_test
[0m04:05:09.785869 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:05:10.768095 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.982 seconds
[0m04:05:10.771725 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42: Close
[0m04:05:11.018932 [info ] [Thread-1 (]: 15 of 27 PASS not_null_rsi_calculation_avg_gain ................................ [[32mPASS[0m in 1.27s]
[0m04:05:11.021826 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42
[0m04:05:11.023489 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m04:05:11.024533 [info ] [Thread-1 (]: 16 of 27 START test not_null_rsi_calculation_avg_loss .......................... [RUN]
[0m04:05:11.026054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42, now test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19)
[0m04:05:11.026974 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m04:05:11.030247 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m04:05:11.051340 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m04:05:11.054158 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m04:05:11.063534 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m04:05:11.064436 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_loss
from dev.analytics.rsi_calculation
where avg_loss is null



      
    ) dbt_internal_test
[0m04:05:11.065426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:05:11.601959 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.536 seconds
[0m04:05:11.606443 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19: Close
[0m04:05:11.734004 [info ] [Thread-1 (]: 16 of 27 PASS not_null_rsi_calculation_avg_loss ................................ [[32mPASS[0m in 0.71s]
[0m04:05:11.737147 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m04:05:11.738266 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d
[0m04:05:11.739367 [info ] [Thread-1 (]: 17 of 27 START test not_null_rsi_calculation_close ............................. [RUN]
[0m04:05:11.740433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19, now test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d)
[0m04:05:11.741304 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d
[0m04:05:11.744803 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d"
[0m04:05:11.757539 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d
[0m04:05:11.760886 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d"
[0m04:05:11.774584 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d"
[0m04:05:11.779695 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.rsi_calculation
where close is null



      
    ) dbt_internal_test
[0m04:05:11.781589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:05:12.221062 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.439 seconds
[0m04:05:12.225731 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d: Close
[0m04:05:12.453711 [info ] [Thread-1 (]: 17 of 27 PASS not_null_rsi_calculation_close ................................... [[32mPASS[0m in 0.71s]
[0m04:05:12.456077 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d
[0m04:05:12.457153 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76
[0m04:05:12.458129 [info ] [Thread-1 (]: 18 of 27 START test not_null_rsi_calculation_date .............................. [RUN]
[0m04:05:12.459655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d, now test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76)
[0m04:05:12.460602 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76
[0m04:05:12.507959 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76"
[0m04:05:12.529113 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76
[0m04:05:12.532485 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76"
[0m04:05:12.552677 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76"
[0m04:05:12.554204 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.rsi_calculation
where date is null



      
    ) dbt_internal_test
[0m04:05:12.555542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:05:13.069259 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.514 seconds
[0m04:05:13.073461 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76: Close
[0m04:05:13.204570 [info ] [Thread-1 (]: 18 of 27 PASS not_null_rsi_calculation_date .................................... [[32mPASS[0m in 0.74s]
[0m04:05:13.207663 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76
[0m04:05:13.209914 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m04:05:13.211187 [info ] [Thread-1 (]: 19 of 27 START test not_null_rsi_calculation_rsi_14d ........................... [RUN]
[0m04:05:13.212542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76, now test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8)
[0m04:05:13.214035 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m04:05:13.218661 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m04:05:13.231785 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m04:05:13.234996 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m04:05:13.250839 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m04:05:13.251795 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from dev.analytics.rsi_calculation
where rsi_14d is null



      
    ) dbt_internal_test
[0m04:05:13.252682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:05:13.752146 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.499 seconds
[0m04:05:13.757354 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8: Close
[0m04:05:13.883994 [info ] [Thread-1 (]: 19 of 27 PASS not_null_rsi_calculation_rsi_14d ................................. [[32mPASS[0m in 0.67s]
[0m04:05:13.887065 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m04:05:13.889304 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84
[0m04:05:13.891246 [info ] [Thread-1 (]: 20 of 27 START test not_null_rsi_calculation_symbol ............................ [RUN]
[0m04:05:13.892843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8, now test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84)
[0m04:05:13.894384 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84
[0m04:05:13.898629 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m04:05:13.911126 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84
[0m04:05:13.914321 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m04:05:13.946969 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m04:05:13.949165 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.rsi_calculation
where symbol is null



      
    ) dbt_internal_test
[0m04:05:13.950789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:05:14.441585 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.491 seconds
[0m04:05:14.445270 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84: Close
[0m04:05:14.566908 [info ] [Thread-1 (]: 20 of 27 PASS not_null_rsi_calculation_symbol .................................. [[32mPASS[0m in 0.67s]
[0m04:05:14.568876 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84
[0m04:05:14.570049 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_close.d7e232e1ba
[0m04:05:14.571551 [info ] [Thread-1 (]: 21 of 27 START test not_null_stock_prices_close ................................ [RUN]
[0m04:05:14.573181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84, now test.stock_dbt.not_null_stock_prices_close.d7e232e1ba)
[0m04:05:14.574575 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_close.d7e232e1ba
[0m04:05:14.578112 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_close.d7e232e1ba"
[0m04:05:14.585499 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_close.d7e232e1ba
[0m04:05:14.587633 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_close.d7e232e1ba"
[0m04:05:14.610202 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_close.d7e232e1ba"
[0m04:05:14.611510 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_close.d7e232e1ba: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_close.d7e232e1ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.stock_prices
where close is null



      
    ) dbt_internal_test
[0m04:05:14.612559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:05:15.052132 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.439 seconds
[0m04:05:15.056376 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_close.d7e232e1ba: Close
[0m04:05:15.178752 [info ] [Thread-1 (]: 21 of 27 PASS not_null_stock_prices_close ...................................... [[32mPASS[0m in 0.61s]
[0m04:05:15.180738 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_close.d7e232e1ba
[0m04:05:15.182429 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_date.98a7527501
[0m04:05:15.183926 [info ] [Thread-1 (]: 22 of 27 START test not_null_stock_prices_date ................................. [RUN]
[0m04:05:15.185120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_close.d7e232e1ba, now test.stock_dbt.not_null_stock_prices_date.98a7527501)
[0m04:05:15.186022 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_date.98a7527501
[0m04:05:15.190468 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_date.98a7527501"
[0m04:05:15.208342 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_date.98a7527501
[0m04:05:15.210708 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_date.98a7527501"
[0m04:05:15.224046 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_date.98a7527501"
[0m04:05:15.225589 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_date.98a7527501: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_date.98a7527501"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.stock_prices
where date is null



      
    ) dbt_internal_test
[0m04:05:15.226468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:05:15.620352 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.394 seconds
[0m04:05:15.624311 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_date.98a7527501: Close
[0m04:05:15.741158 [info ] [Thread-1 (]: 22 of 27 PASS not_null_stock_prices_date ....................................... [[32mPASS[0m in 0.56s]
[0m04:05:15.745030 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_date.98a7527501
[0m04:05:15.747938 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc
[0m04:05:15.749951 [info ] [Thread-1 (]: 23 of 27 START test not_null_stock_prices_high ................................. [RUN]
[0m04:05:15.751207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_date.98a7527501, now test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc)
[0m04:05:15.752093 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc
[0m04:05:15.755688 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc"
[0m04:05:15.763919 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc
[0m04:05:15.765952 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc"
[0m04:05:15.778058 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc"
[0m04:05:15.779573 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select high
from dev.analytics.stock_prices
where high is null



      
    ) dbt_internal_test
[0m04:05:15.781539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:05:16.197197 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.415 seconds
[0m04:05:16.202813 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc: Close
[0m04:05:16.329535 [info ] [Thread-1 (]: 23 of 27 PASS not_null_stock_prices_high ....................................... [[32mPASS[0m in 0.58s]
[0m04:05:16.332411 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc
[0m04:05:16.334028 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_low.e65294ca15
[0m04:05:16.335147 [info ] [Thread-1 (]: 24 of 27 START test not_null_stock_prices_low .................................. [RUN]
[0m04:05:16.336227 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc, now test.stock_dbt.not_null_stock_prices_low.e65294ca15)
[0m04:05:16.337142 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_low.e65294ca15
[0m04:05:16.340333 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_low.e65294ca15"
[0m04:05:16.360235 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_low.e65294ca15
[0m04:05:16.365887 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_low.e65294ca15"
[0m04:05:16.382850 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_low.e65294ca15"
[0m04:05:16.384017 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_low.e65294ca15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_low.e65294ca15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select low
from dev.analytics.stock_prices
where low is null



      
    ) dbt_internal_test
[0m04:05:16.385620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:05:16.770561 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.385 seconds
[0m04:05:16.775509 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_low.e65294ca15: Close
[0m04:05:16.985507 [info ] [Thread-1 (]: 24 of 27 PASS not_null_stock_prices_low ........................................ [[32mPASS[0m in 0.65s]
[0m04:05:16.989559 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_low.e65294ca15
[0m04:05:16.990905 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_open.e09b13f215
[0m04:05:16.992027 [info ] [Thread-1 (]: 25 of 27 START test not_null_stock_prices_open ................................. [RUN]
[0m04:05:16.993723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_low.e65294ca15, now test.stock_dbt.not_null_stock_prices_open.e09b13f215)
[0m04:05:16.994972 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_open.e09b13f215
[0m04:05:16.999032 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_open.e09b13f215"
[0m04:05:17.009212 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_open.e09b13f215
[0m04:05:17.012550 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_open.e09b13f215"
[0m04:05:17.035246 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_open.e09b13f215"
[0m04:05:17.036684 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_open.e09b13f215: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_open.e09b13f215"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from dev.analytics.stock_prices
where open is null



      
    ) dbt_internal_test
[0m04:05:17.037919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:05:17.634909 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.597 seconds
[0m04:05:17.637486 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_open.e09b13f215: Close
[0m04:05:17.810167 [info ] [Thread-1 (]: 25 of 27 PASS not_null_stock_prices_open ....................................... [[32mPASS[0m in 0.82s]
[0m04:05:17.812192 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_open.e09b13f215
[0m04:05:17.813790 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8
[0m04:05:17.814885 [info ] [Thread-1 (]: 26 of 27 START test not_null_stock_prices_symbol ............................... [RUN]
[0m04:05:17.816187 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_open.e09b13f215, now test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8)
[0m04:05:17.817559 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8
[0m04:05:17.822393 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8"
[0m04:05:17.834874 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8
[0m04:05:17.837942 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8"
[0m04:05:17.863056 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8"
[0m04:05:17.865842 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.stock_prices
where symbol is null



      
    ) dbt_internal_test
[0m04:05:17.867169 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:05:18.263424 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.396 seconds
[0m04:05:18.267059 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8: Close
[0m04:05:18.435263 [info ] [Thread-1 (]: 26 of 27 PASS not_null_stock_prices_symbol ..................................... [[32mPASS[0m in 0.62s]
[0m04:05:18.437097 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8
[0m04:05:18.438285 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_volume.71420bc956
[0m04:05:18.439351 [info ] [Thread-1 (]: 27 of 27 START test not_null_stock_prices_volume ............................... [RUN]
[0m04:05:18.440262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8, now test.stock_dbt.not_null_stock_prices_volume.71420bc956)
[0m04:05:18.441134 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_volume.71420bc956
[0m04:05:18.445372 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_volume.71420bc956"
[0m04:05:18.453680 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_volume.71420bc956
[0m04:05:18.455891 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_volume.71420bc956"
[0m04:05:18.464848 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_volume.71420bc956"
[0m04:05:18.466394 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_volume.71420bc956: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_volume.71420bc956"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume
from dev.analytics.stock_prices
where volume is null



      
    ) dbt_internal_test
[0m04:05:18.468032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:05:19.110084 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.642 seconds
[0m04:05:19.114971 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_volume.71420bc956: Close
[0m04:05:19.239970 [info ] [Thread-1 (]: 27 of 27 PASS not_null_stock_prices_volume ..................................... [[32mPASS[0m in 0.80s]
[0m04:05:19.242177 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_volume.71420bc956
[0m04:05:19.244224 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:05:19.245109 [debug] [MainThread]: Connection 'test.stock_dbt.not_null_stock_prices_volume.71420bc956' was properly closed.
[0m04:05:19.246052 [info ] [MainThread]: 
[0m04:05:19.248135 [info ] [MainThread]: Finished running 27 data tests in 0 hours 0 minutes and 22.13 seconds (22.13s).
[0m04:05:19.251848 [debug] [MainThread]: Command end result
[0m04:05:19.320186 [info ] [MainThread]: 
[0m04:05:19.321759 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:05:19.322917 [info ] [MainThread]: 
[0m04:05:19.324619 [info ] [MainThread]: Done. PASS=27 WARN=0 ERROR=0 SKIP=0 TOTAL=27
[0m04:05:19.326663 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 23.41682, "process_user_time": 3.935156, "process_kernel_time": 3.043988, "process_mem_max_rss": "255004", "process_in_blocks": "8", "process_out_blocks": "8"}
[0m04:05:19.328572 [debug] [MainThread]: Command `dbt test` succeeded at 04:05:19.328486 after 23.42 seconds
[0m04:05:19.329646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9864b0620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff987fed670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff92cf07e30>]}
[0m04:05:19.330540 [debug] [MainThread]: Flushing usage events
[0m04:05:21.191266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5622821ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5622821cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5622821e50>]}


============================== 04:05:21.195656 | 36fd3c57-8c4d-435c-86c2-2f9049f934a6 ==============================
[0m04:05:21.195656 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:05:21.197506 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/stock_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/stock_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/stock_dbt --project-dir /opt/airflow/stock_dbt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:05:21.768755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36fd3c57-8c4d-435c-86c2-2f9049f934a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55c8fc7410>]}
[0m04:05:21.808950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36fd3c57-8c4d-435c-86c2-2f9049f934a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55c9172b70>]}
[0m04:05:21.810646 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:05:21.819658 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:05:22.098482 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:05:22.099670 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:05:22.103935 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.stock_prediction.tranformations
- models.stock_prediction
- models.stock_prediction.raw_data
[0m04:05:22.138716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36fd3c57-8c4d-435c-86c2-2f9049f934a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55c93900e0>]}
[0m04:05:22.245347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36fd3c57-8c4d-435c-86c2-2f9049f934a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55c8fc6b70>]}
[0m04:05:22.246833 [info ] [MainThread]: Found 5 models, 4 snapshots, 27 data tests, 1 source, 459 macros
[0m04:05:22.248849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36fd3c57-8c4d-435c-86c2-2f9049f934a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55c8fe58e0>]}
[0m04:05:22.257790 [info ] [MainThread]: 
[0m04:05:22.259303 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:05:22.263408 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m04:05:22.275140 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m04:05:22.276805 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m04:05:22.278236 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:05:22.831304 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.553 seconds
[0m04:05:22.833583 [debug] [ThreadPool]: On list_dev: Close
[0m04:05:22.960375 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m04:05:22.969883 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m04:05:22.971118 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m04:05:22.971992 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:05:23.421118 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.449 seconds
[0m04:05:23.425788 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m04:05:23.560515 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m04:05:23.564113 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m04:05:23.565861 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m04:05:23.567584 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:05:24.027950 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.460 seconds
[0m04:05:24.033461 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m04:05:24.172985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36fd3c57-8c4d-435c-86c2-2f9049f934a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55c97f07a0>]}
[0m04:05:24.175039 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:05:24.176159 [info ] [MainThread]: 
[0m04:05:24.183673 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.snapshot_atr
[0m04:05:24.185321 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshot.snapshot_atr .................................... [RUN]
[0m04:05:24.186618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now snapshot.stock_dbt.snapshot_atr)
[0m04:05:24.187620 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.snapshot_atr
[0m04:05:24.194068 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.snapshot_atr
[0m04:05:24.231321 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:05:24.233617 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
[0m04:05:24.235534 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:05:24.597290 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.362 seconds
[0m04:05:24.634991 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:05:24.637713 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.avg_true_range


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m04:05:25.476638 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.837 seconds
[0m04:05:25.479535 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:05:25.480535 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
[0m04:05:25.565176 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.083 seconds
[0m04:05:25.571148 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:05:25.572175 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
[0m04:05:25.656073 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.083 seconds
[0m04:05:25.661355 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:05:25.664990 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
[0m04:05:25.746093 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.079 seconds
[0m04:05:25.752235 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:05:25.754075 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
[0m04:05:25.828925 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.073 seconds
[0m04:05:25.838419 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:05:25.841400 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
[0m04:05:26.033991 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.189 seconds
[0m04:05:26.053369 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:05:26.055730 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.avg_true_range


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m04:05:26.234450 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.176 seconds
[0m04:05:26.241277 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:05:26.242858 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m04:05:26.345679 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.101 seconds
[0m04:05:26.348978 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.snapshot_atr"
[0m04:05:26.368386 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:05:26.369485 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
BEGIN
[0m04:05:26.480834 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.110 seconds
[0m04:05:26.483040 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:05:26.485364 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_ATR" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATE", "SYMBOL", "ATR_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATE", "SYMBOL", "ATR_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m04:05:27.202677 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.715 seconds
[0m04:05:27.205539 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:05:27.207250 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
COMMIT
[0m04:05:27.603462 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.394 seconds
[0m04:05:27.622717 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: Close
[0m04:05:27.812358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36fd3c57-8c4d-435c-86c2-2f9049f934a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f562316de50>]}
[0m04:05:27.814725 [info ] [Thread-1 (]: 1 of 4 OK snapshotted snapshot.snapshot_atr .................................... [[32mSUCCESS 0[0m in 3.62s]
[0m04:05:27.816118 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.snapshot_atr
[0m04:05:27.817111 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.snapshot_bollinger
[0m04:05:27.818243 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshot.snapshot_bollinger .............................. [RUN]
[0m04:05:27.819760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_dbt.snapshot_atr, now snapshot.stock_dbt.snapshot_bollinger)
[0m04:05:27.820719 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.snapshot_bollinger
[0m04:05:27.823618 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.snapshot_bollinger
[0m04:05:27.827706 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:05:27.828400 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
[0m04:05:27.829159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:05:28.502954 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.674 seconds
[0m04:05:28.511217 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:05:28.513421 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.bollinger


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m04:05:29.319515 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.804 seconds
[0m04:05:29.325567 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:05:29.327300 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
[0m04:05:29.451941 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.123 seconds
[0m04:05:29.457061 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:05:29.458428 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
[0m04:05:29.547838 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.088 seconds
[0m04:05:29.554536 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:05:29.557158 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
[0m04:05:29.662646 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.103 seconds
[0m04:05:29.669348 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:05:29.672472 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
[0m04:05:29.770147 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.095 seconds
[0m04:05:29.776951 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:05:29.778884 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
[0m04:05:29.872087 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.091 seconds
[0m04:05:29.879617 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:05:29.881087 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.bollinger


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m04:05:30.057572 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.175 seconds
[0m04:05:30.061204 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:05:30.063267 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m04:05:30.147371 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.082 seconds
[0m04:05:30.150851 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.snapshot_bollinger"
[0m04:05:30.161733 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:05:30.162640 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
BEGIN
[0m04:05:30.311651 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.148 seconds
[0m04:05:30.315189 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:05:30.317617 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "SMA_20D", "UPPER_BAND", "LOWER_BAND", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "SMA_20D", "UPPER_BAND", "LOWER_BAND", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m04:05:30.806104 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.486 seconds
[0m04:05:30.807630 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:05:30.809029 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
COMMIT
[0m04:05:31.178218 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.368 seconds
[0m04:05:31.181122 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: Close
[0m04:05:31.292762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36fd3c57-8c4d-435c-86c2-2f9049f934a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55c92189b0>]}
[0m04:05:31.294818 [info ] [Thread-1 (]: 2 of 4 OK snapshotted snapshot.snapshot_bollinger .............................. [[32mSUCCESS 0[0m in 3.47s]
[0m04:05:31.296550 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.snapshot_bollinger
[0m04:05:31.298140 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.snapshot_moving_avg
[0m04:05:31.299168 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshot.snapshot_moving_avg ............................. [RUN]
[0m04:05:31.300670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_dbt.snapshot_bollinger, now snapshot.stock_dbt.snapshot_moving_avg)
[0m04:05:31.301539 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.snapshot_moving_avg
[0m04:05:31.304978 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.snapshot_moving_avg
[0m04:05:31.309345 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:05:31.310366 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
[0m04:05:31.311603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:05:31.912154 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.600 seconds
[0m04:05:31.919112 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:05:31.920548 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.moving_average


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m04:05:32.726791 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.805 seconds
[0m04:05:32.730595 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:05:32.731993 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
[0m04:05:32.827087 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.093 seconds
[0m04:05:32.830905 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:05:32.831568 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
[0m04:05:32.954997 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.122 seconds
[0m04:05:32.959474 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:05:32.960681 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
[0m04:05:33.126180 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.164 seconds
[0m04:05:33.130076 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:05:33.131446 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
[0m04:05:33.216991 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.085 seconds
[0m04:05:33.220623 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:05:33.221940 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
[0m04:05:33.288341 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.065 seconds
[0m04:05:33.293037 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:05:33.294457 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.moving_average


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m04:05:33.476768 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.181 seconds
[0m04:05:33.479179 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:05:33.480663 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m04:05:33.564557 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.083 seconds
[0m04:05:33.565774 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:05:33.574299 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:05:33.575432 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
BEGIN
[0m04:05:33.716828 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.140 seconds
[0m04:05:33.719061 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:05:33.720327 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "MOVING_AVG_5D", "MOVING_AVG_20D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "MOVING_AVG_5D", "MOVING_AVG_20D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m04:05:34.175704 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.454 seconds
[0m04:05:34.177600 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:05:34.179127 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
COMMIT
[0m04:05:34.538833 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.358 seconds
[0m04:05:34.541579 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: Close
[0m04:05:34.646679 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36fd3c57-8c4d-435c-86c2-2f9049f934a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55c81bd7c0>]}
[0m04:05:34.648758 [info ] [Thread-1 (]: 3 of 4 OK snapshotted snapshot.snapshot_moving_avg ............................. [[32mSUCCESS 0[0m in 3.35s]
[0m04:05:34.650635 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.snapshot_moving_avg
[0m04:05:34.651553 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.snapshot_rsi
[0m04:05:34.652697 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshot.snapshot_rsi .................................... [RUN]
[0m04:05:34.654253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_dbt.snapshot_moving_avg, now snapshot.stock_dbt.snapshot_rsi)
[0m04:05:34.655140 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.snapshot_rsi
[0m04:05:34.657941 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.snapshot_rsi
[0m04:05:34.662108 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:05:34.663041 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m04:05:34.663829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:05:35.196581 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.533 seconds
[0m04:05:35.202382 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:05:35.203637 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.rsi_calculation


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m04:05:36.128925 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.924 seconds
[0m04:05:36.132529 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:05:36.133647 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m04:05:36.242758 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.108 seconds
[0m04:05:36.247391 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:05:36.249809 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m04:05:36.350721 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.099 seconds
[0m04:05:36.356414 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:05:36.358409 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m04:05:36.465020 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.105 seconds
[0m04:05:36.469449 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:05:36.471003 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m04:05:36.549986 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.077 seconds
[0m04:05:36.553871 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:05:36.554959 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m04:05:36.647725 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.092 seconds
[0m04:05:36.652330 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:05:36.653699 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.rsi_calculation


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m04:05:36.845108 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.190 seconds
[0m04:05:36.849858 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:05:36.851834 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m04:05:36.937314 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.084 seconds
[0m04:05:36.940279 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.snapshot_rsi"
[0m04:05:36.948189 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:05:36.949201 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
BEGIN
[0m04:05:37.103027 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.152 seconds
[0m04:05:37.104898 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:05:37.106258 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_RSI" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "AVG_GAIN", "AVG_LOSS", "RSI_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "AVG_GAIN", "AVG_LOSS", "RSI_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m04:05:37.561648 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.454 seconds
[0m04:05:37.563165 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:05:37.563967 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
COMMIT
[0m04:05:37.879724 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.315 seconds
[0m04:05:37.882602 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: Close
[0m04:05:37.996059 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36fd3c57-8c4d-435c-86c2-2f9049f934a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55c82a0e60>]}
[0m04:05:37.997142 [info ] [Thread-1 (]: 4 of 4 OK snapshotted snapshot.snapshot_rsi .................................... [[32mSUCCESS 0[0m in 3.34s]
[0m04:05:37.999111 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.snapshot_rsi
[0m04:05:38.000946 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:05:38.002345 [debug] [MainThread]: Connection 'snapshot.stock_dbt.snapshot_rsi' was properly closed.
[0m04:05:38.003702 [info ] [MainThread]: 
[0m04:05:38.004996 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 15.74 seconds (15.74s).
[0m04:05:38.006707 [debug] [MainThread]: Command end result
[0m04:05:38.111769 [info ] [MainThread]: 
[0m04:05:38.113234 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:05:38.115135 [info ] [MainThread]: 
[0m04:05:38.117209 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m04:05:38.118879 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 17.000187, "process_user_time": 3.148861, "process_kernel_time": 3.022471, "process_mem_max_rss": "227136", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m04:05:38.120640 [debug] [MainThread]: Command `dbt snapshot` succeeded at 04:05:38.120497 after 17.00 seconds
[0m04:05:38.122371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55c8c80f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55cc79fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55c8dc7590>]}
[0m04:05:38.124323 [debug] [MainThread]: Flushing usage events
[0m04:08:18.378058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b65ce53d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b656b3530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b65ce54c0>]}


============================== 04:08:18.383915 | 21e7e784-6781-496b-ac29-51aebb61a62a ==============================
[0m04:08:18.383915 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:08:18.385464 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/stock_dbt', 'log_path': '/opt/airflow/stock_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/stock_dbt --project-dir /opt/airflow/stock_dbt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:08:19.000510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21e7e784-6781-496b-ac29-51aebb61a62a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b6550dbe0>]}
[0m04:08:19.038508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21e7e784-6781-496b-ac29-51aebb61a62a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b07d8b230>]}
[0m04:08:19.042391 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:08:19.051552 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:08:19.137643 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m04:08:19.140070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '21e7e784-6781-496b-ac29-51aebb61a62a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b65d4ca40>]}
[0m04:08:20.098863 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m04:08:20.100999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '21e7e784-6781-496b-ac29-51aebb61a62a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b079cc320>]}
[0m04:08:20.380686 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.stock_prediction.tranformations
- models.stock_prediction
- models.stock_prediction.raw_data
[0m04:08:20.392503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21e7e784-6781-496b-ac29-51aebb61a62a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b079aefc0>]}
[0m04:08:20.509946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21e7e784-6781-496b-ac29-51aebb61a62a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b07a95550>]}
[0m04:08:20.510996 [info ] [MainThread]: Found 5 models, 4 snapshots, 27 data tests, 1 source, 459 macros
[0m04:08:20.511796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21e7e784-6781-496b-ac29-51aebb61a62a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0e33b350>]}
[0m04:08:20.514295 [info ] [MainThread]: 
[0m04:08:20.515957 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:08:20.521144 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m04:08:20.531660 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m04:08:20.534201 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m04:08:20.535943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:08:21.119251 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.583 seconds
[0m04:08:21.122261 [debug] [ThreadPool]: On list_dev: Close
[0m04:08:21.239409 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m04:08:21.248916 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m04:08:21.251023 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m04:08:21.252384 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:08:21.727262 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.475 seconds
[0m04:08:21.730979 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m04:08:21.847495 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m04:08:21.850930 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m04:08:21.852571 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m04:08:21.854382 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:08:22.285362 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.431 seconds
[0m04:08:22.287987 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m04:08:22.420491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21e7e784-6781-496b-ac29-51aebb61a62a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b07b86e70>]}
[0m04:08:22.422130 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:08:22.423919 [info ] [MainThread]: 
[0m04:08:22.430712 [debug] [Thread-1 (]: Began running node model.stock_dbt.stock_prices
[0m04:08:22.431757 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stock_prices ............................. [RUN]
[0m04:08:22.433104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now model.stock_dbt.stock_prices)
[0m04:08:22.434045 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.stock_prices
[0m04:08:22.440012 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.stock_prices"
[0m04:08:22.448804 [debug] [Thread-1 (]: Began executing node model.stock_dbt.stock_prices
[0m04:08:22.471381 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.stock_prices"
[0m04:08:22.500035 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.stock_prices"
[0m04:08:22.501517 [debug] [Thread-1 (]: On model.stock_dbt.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.stock_prices"} */
create or replace   view dev.analytics.stock_prices
  
   as (
    SELECT
    symbol,
    date,
    open,
    high,
    low,
    close,
    volume
FROM dev.raw_data.stock_prices
  );
[0m04:08:22.502902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:08:23.147814 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.645 seconds
[0m04:08:23.167404 [debug] [Thread-1 (]: On model.stock_dbt.stock_prices: Close
[0m04:08:23.283629 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21e7e784-6781-496b-ac29-51aebb61a62a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b07d888c0>]}
[0m04:08:23.286482 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stock_prices ........................ [[32mSUCCESS 1[0m in 0.85s]
[0m04:08:23.288575 [debug] [Thread-1 (]: Finished running node model.stock_dbt.stock_prices
[0m04:08:23.290482 [debug] [Thread-1 (]: Began running node model.stock_dbt.avg_true_range
[0m04:08:23.291836 [info ] [Thread-1 (]: 2 of 5 START sql view model analytics.avg_true_range ........................... [RUN]
[0m04:08:23.293677 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.stock_prices, now model.stock_dbt.avg_true_range)
[0m04:08:23.295319 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.avg_true_range
[0m04:08:23.298834 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.avg_true_range"
[0m04:08:23.308309 [debug] [Thread-1 (]: Began executing node model.stock_dbt.avg_true_range
[0m04:08:23.310718 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.avg_true_range"
[0m04:08:23.324959 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.avg_true_range"
[0m04:08:23.325955 [debug] [Thread-1 (]: On model.stock_dbt.avg_true_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.avg_true_range"} */
create or replace   view dev.analytics.avg_true_range
  
   as (
    WITH averageTrueRanges AS (
    SELECT
        date,
        symbol,
        close,
        ABS(close - LAG(close) OVER (PARTITION BY symbol ORDER BY date)) AS true_range
    FROM dev.analytics.stock_prices
),
atr AS (
    SELECT
        date,
        symbol,
        AVG(true_range) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS atr_14d
    FROM averageTrueRanges
)
SELECT 
    date, 
    symbol, 
    COALESCE(atr_14d, 0) AS atr_14d
FROM atr
ORDER BY date, symbol
  );
[0m04:08:23.327321 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:08:23.898869 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.572 seconds
[0m04:08:23.902118 [debug] [Thread-1 (]: On model.stock_dbt.avg_true_range: Close
[0m04:08:24.039956 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21e7e784-6781-496b-ac29-51aebb61a62a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9aa2d4d760>]}
[0m04:08:24.042427 [info ] [Thread-1 (]: 2 of 5 OK created sql view model analytics.avg_true_range ...................... [[32mSUCCESS 1[0m in 0.75s]
[0m04:08:24.044396 [debug] [Thread-1 (]: Finished running node model.stock_dbt.avg_true_range
[0m04:08:24.045852 [debug] [Thread-1 (]: Began running node model.stock_dbt.bollinger
[0m04:08:24.047031 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.bollinger ................................ [RUN]
[0m04:08:24.048427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.avg_true_range, now model.stock_dbt.bollinger)
[0m04:08:24.049634 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.bollinger
[0m04:08:24.052812 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.bollinger"
[0m04:08:24.062687 [debug] [Thread-1 (]: Began executing node model.stock_dbt.bollinger
[0m04:08:24.066259 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.bollinger"
[0m04:08:24.081794 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.bollinger"
[0m04:08:24.083440 [debug] [Thread-1 (]: On model.stock_dbt.bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.bollinger"} */
create or replace   view dev.analytics.bollinger
  
   as (
    WITH bollinger AS (
    SELECT
        symbol,
        date,
        close,
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) AS sma_20d,
        STDDEV(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) AS stddev_20d
    FROM dev.analytics.stock_prices
)

SELECT
    symbol,
    date,
    close,
    COALESCE(sma_20d, 0) AS sma_20d,
    COALESCE(sma_20d + (2 * stddev_20d), 0) AS upper_band,
    COALESCE(sma_20d - (2 * stddev_20d), 0) AS lower_band
FROM bollinger
ORDER BY symbol, date
  );
[0m04:08:24.085213 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:08:24.704987 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.620 seconds
[0m04:08:24.708254 [debug] [Thread-1 (]: On model.stock_dbt.bollinger: Close
[0m04:08:24.830108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21e7e784-6781-496b-ac29-51aebb61a62a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b65190a70>]}
[0m04:08:24.832382 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.bollinger ........................... [[32mSUCCESS 1[0m in 0.78s]
[0m04:08:24.834182 [debug] [Thread-1 (]: Finished running node model.stock_dbt.bollinger
[0m04:08:24.835875 [debug] [Thread-1 (]: Began running node model.stock_dbt.moving_average
[0m04:08:24.837271 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.moving_average ........................... [RUN]
[0m04:08:24.838783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.bollinger, now model.stock_dbt.moving_average)
[0m04:08:24.840240 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.moving_average
[0m04:08:24.843286 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.moving_average"
[0m04:08:24.855607 [debug] [Thread-1 (]: Began executing node model.stock_dbt.moving_average
[0m04:08:24.858679 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.moving_average"
[0m04:08:24.869804 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.moving_average"
[0m04:08:24.871124 [debug] [Thread-1 (]: On model.stock_dbt.moving_average: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.moving_average"} */
create or replace   view dev.analytics.moving_average
  
   as (
    WITH stock_data AS (
    SELECT
        symbol,
        date,
        close
    FROM dev.analytics.stock_prices -- assuming 'stock_prices' is the name of the raw table model in dbt
)

SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
    ) AS moving_avg_5d,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
    ) AS moving_avg_20d
FROM stock_data
ORDER BY symbol, date
  );
[0m04:08:24.872255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:08:25.591611 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.719 seconds
[0m04:08:25.595521 [debug] [Thread-1 (]: On model.stock_dbt.moving_average: Close
[0m04:08:25.712237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21e7e784-6781-496b-ac29-51aebb61a62a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b07a962a0>]}
[0m04:08:25.713692 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.moving_average ...................... [[32mSUCCESS 1[0m in 0.87s]
[0m04:08:25.715436 [debug] [Thread-1 (]: Finished running node model.stock_dbt.moving_average
[0m04:08:25.716919 [debug] [Thread-1 (]: Began running node model.stock_dbt.rsi_calculation
[0m04:08:25.718120 [info ] [Thread-1 (]: 5 of 5 START sql view model analytics.rsi_calculation .......................... [RUN]
[0m04:08:25.718814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.moving_average, now model.stock_dbt.rsi_calculation)
[0m04:08:25.719655 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.rsi_calculation
[0m04:08:25.722618 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.rsi_calculation"
[0m04:08:25.734688 [debug] [Thread-1 (]: Began executing node model.stock_dbt.rsi_calculation
[0m04:08:25.738122 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.rsi_calculation"
[0m04:08:25.748524 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.rsi_calculation"
[0m04:08:25.749731 [debug] [Thread-1 (]: On model.stock_dbt.rsi_calculation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.rsi_calculation"} */
create or replace   view dev.analytics.rsi_calculation
  
   as (
    WITH stock_data AS (
    SELECT
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM dev.analytics.stock_prices
),

price_changes AS (
    SELECT
        symbol,
        date,
        close,
        CASE 
            WHEN close > prev_close THEN close - prev_close
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close < prev_close THEN prev_close - close
            ELSE 0 
        END AS loss
    FROM stock_data
),

average_gains_losses AS (
    SELECT
        symbol,
        date,
        close,
        -- Calculate the average gain over the last 14 days, including the current row
        AVG(gain) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain,
        -- Calculate the average loss over the last 14 days, including the current row
        AVG(loss) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss
    FROM price_changes
)

SELECT
    symbol,
    date,
    close,
    avg_gain,
    avg_loss,
    -- Calculate RSI, using COALESCE to set to 0 if result is NULL
    COALESCE(100 - (100 / (1 + (NULLIF(avg_gain, 0) / NULLIF(avg_loss, 0)))), 0) AS rsi_14d
FROM average_gains_losses
ORDER BY symbol, date
  );
[0m04:08:25.750896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:08:26.351707 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.601 seconds
[0m04:08:26.356099 [debug] [Thread-1 (]: On model.stock_dbt.rsi_calculation: Close
[0m04:08:26.479770 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21e7e784-6781-496b-ac29-51aebb61a62a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9aa2e5b3e0>]}
[0m04:08:26.481780 [info ] [Thread-1 (]: 5 of 5 OK created sql view model analytics.rsi_calculation ..................... [[32mSUCCESS 1[0m in 0.76s]
[0m04:08:26.484061 [debug] [Thread-1 (]: Finished running node model.stock_dbt.rsi_calculation
[0m04:08:26.486683 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:08:26.488349 [debug] [MainThread]: Connection 'model.stock_dbt.rsi_calculation' was properly closed.
[0m04:08:26.490277 [info ] [MainThread]: 
[0m04:08:26.492323 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 5.97 seconds (5.97s).
[0m04:08:26.494587 [debug] [MainThread]: Command end result
[0m04:08:26.551470 [info ] [MainThread]: 
[0m04:08:26.552521 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:08:26.553816 [info ] [MainThread]: 
[0m04:08:26.555089 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m04:08:26.557121 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.2593355, "process_user_time": 4.038539, "process_kernel_time": 2.93551, "process_mem_max_rss": "260364", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m04:08:26.558379 [debug] [MainThread]: Command `dbt run` succeeded at 04:08:26.558283 after 8.26 seconds
[0m04:08:26.559621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b657bac00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b657ba2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9aa2d69e20>]}
[0m04:08:26.560603 [debug] [MainThread]: Flushing usage events
[0m04:08:29.447459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9697e7d3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9697fb2420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9697e37590>]}


============================== 04:08:29.453468 | cf3d35eb-e0b9-4cdc-946a-ebf587dc10bb ==============================
[0m04:08:29.453468 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:08:29.454877 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/stock_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/stock_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/stock_dbt --project-dir /opt/airflow/stock_dbt', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:08:30.122786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf3d35eb-e0b9-4cdc-946a-ebf587dc10bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f963bc02de0>]}
[0m04:08:30.161115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf3d35eb-e0b9-4cdc-946a-ebf587dc10bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f963a9bf410>]}
[0m04:08:30.163477 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:08:30.173325 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:08:30.451309 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:08:30.452501 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:08:30.457051 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.stock_prediction
- models.stock_prediction.tranformations
- models.stock_prediction.raw_data
[0m04:08:30.490649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf3d35eb-e0b9-4cdc-946a-ebf587dc10bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9646348ec0>]}
[0m04:08:30.623990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf3d35eb-e0b9-4cdc-946a-ebf587dc10bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f963a336ea0>]}
[0m04:08:30.625057 [info ] [MainThread]: Found 5 models, 4 snapshots, 27 data tests, 1 source, 459 macros
[0m04:08:30.625801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf3d35eb-e0b9-4cdc-946a-ebf587dc10bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f963a7de8a0>]}
[0m04:08:30.629252 [info ] [MainThread]: 
[0m04:08:30.633164 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:08:30.637278 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_snapshot'
[0m04:08:30.650321 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m04:08:30.651699 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m04:08:30.652706 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:08:31.208783 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.556 seconds
[0m04:08:31.214816 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m04:08:31.364956 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m04:08:31.367911 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m04:08:31.369102 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m04:08:31.370602 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:08:31.843344 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.473 seconds
[0m04:08:31.846461 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m04:08:31.968874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf3d35eb-e0b9-4cdc-946a-ebf587dc10bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9698779760>]}
[0m04:08:31.970384 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:08:31.971914 [info ] [MainThread]: 
[0m04:08:31.979985 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m04:08:31.981368 [info ] [Thread-1 (]: 1 of 27 START test not_null_avg_true_range_atr_14d ............................. [RUN]
[0m04:08:31.982591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad)
[0m04:08:31.983805 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m04:08:31.995748 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad"
[0m04:08:32.005985 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m04:08:32.020942 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad"
[0m04:08:32.028916 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad"
[0m04:08:32.029972 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select atr_14d
from dev.analytics.avg_true_range
where atr_14d is null



      
    ) dbt_internal_test
[0m04:08:32.031111 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:08:32.520417 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.489 seconds
[0m04:08:32.527051 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad: Close
[0m04:08:32.659304 [info ] [Thread-1 (]: 1 of 27 PASS not_null_avg_true_range_atr_14d ................................... [[32mPASS[0m in 0.68s]
[0m04:08:32.660976 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m04:08:32.662196 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_avg_true_range_date.4e418b835d
[0m04:08:32.663113 [info ] [Thread-1 (]: 2 of 27 START test not_null_avg_true_range_date ................................ [RUN]
[0m04:08:32.664133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad, now test.stock_dbt.not_null_avg_true_range_date.4e418b835d)
[0m04:08:32.665231 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_avg_true_range_date.4e418b835d
[0m04:08:32.669404 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_avg_true_range_date.4e418b835d"
[0m04:08:32.678245 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_avg_true_range_date.4e418b835d
[0m04:08:32.680564 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_avg_true_range_date.4e418b835d"
[0m04:08:32.689575 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_avg_true_range_date.4e418b835d"
[0m04:08:32.690931 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_date.4e418b835d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_avg_true_range_date.4e418b835d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.avg_true_range
where date is null



      
    ) dbt_internal_test
[0m04:08:32.692380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:08:33.168959 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.477 seconds
[0m04:08:33.171887 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_date.4e418b835d: Close
[0m04:08:33.299436 [info ] [Thread-1 (]: 2 of 27 PASS not_null_avg_true_range_date ...................................... [[32mPASS[0m in 0.63s]
[0m04:08:33.301291 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_avg_true_range_date.4e418b835d
[0m04:08:33.302461 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1
[0m04:08:33.303675 [info ] [Thread-1 (]: 3 of 27 START test not_null_avg_true_range_symbol .............................. [RUN]
[0m04:08:33.304879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_avg_true_range_date.4e418b835d, now test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1)
[0m04:08:33.306191 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1
[0m04:08:33.310608 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1"
[0m04:08:33.319050 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1
[0m04:08:33.321171 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1"
[0m04:08:33.334196 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1"
[0m04:08:33.335173 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.avg_true_range
where symbol is null



      
    ) dbt_internal_test
[0m04:08:33.336269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:08:33.741755 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.405 seconds
[0m04:08:33.745157 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1: Close
[0m04:08:33.867978 [info ] [Thread-1 (]: 3 of 27 PASS not_null_avg_true_range_symbol .................................... [[32mPASS[0m in 0.56s]
[0m04:08:33.870370 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1
[0m04:08:33.872127 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_close.4ccb16a429
[0m04:08:33.873841 [info ] [Thread-1 (]: 4 of 27 START test not_null_bollinger_close .................................... [RUN]
[0m04:08:33.875168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1, now test.stock_dbt.not_null_bollinger_close.4ccb16a429)
[0m04:08:33.876316 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_close.4ccb16a429
[0m04:08:33.880044 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_close.4ccb16a429"
[0m04:08:33.887837 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_close.4ccb16a429
[0m04:08:33.890310 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_close.4ccb16a429"
[0m04:08:33.900395 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_close.4ccb16a429"
[0m04:08:33.901154 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_close.4ccb16a429: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_close.4ccb16a429"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.bollinger
where close is null



      
    ) dbt_internal_test
[0m04:08:33.902536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:08:34.277525 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.375 seconds
[0m04:08:34.281140 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_close.4ccb16a429: Close
[0m04:08:34.402316 [info ] [Thread-1 (]: 4 of 27 PASS not_null_bollinger_close .......................................... [[32mPASS[0m in 0.53s]
[0m04:08:34.404411 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_close.4ccb16a429
[0m04:08:34.406291 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_date.9d77bdd20c
[0m04:08:34.407950 [info ] [Thread-1 (]: 5 of 27 START test not_null_bollinger_date ..................................... [RUN]
[0m04:08:34.409534 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_close.4ccb16a429, now test.stock_dbt.not_null_bollinger_date.9d77bdd20c)
[0m04:08:34.411037 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_date.9d77bdd20c
[0m04:08:34.415430 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_date.9d77bdd20c"
[0m04:08:34.425610 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_date.9d77bdd20c
[0m04:08:34.428198 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_date.9d77bdd20c"
[0m04:08:34.440980 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_date.9d77bdd20c"
[0m04:08:34.442535 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_date.9d77bdd20c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_date.9d77bdd20c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.bollinger
where date is null



      
    ) dbt_internal_test
[0m04:08:34.443591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:08:34.958939 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.515 seconds
[0m04:08:34.962171 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_date.9d77bdd20c: Close
[0m04:08:35.074707 [info ] [Thread-1 (]: 5 of 27 PASS not_null_bollinger_date ........................................... [[32mPASS[0m in 0.66s]
[0m04:08:35.076889 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_date.9d77bdd20c
[0m04:08:35.078562 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e
[0m04:08:35.079875 [info ] [Thread-1 (]: 6 of 27 START test not_null_bollinger_lower_band ............................... [RUN]
[0m04:08:35.081488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_date.9d77bdd20c, now test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e)
[0m04:08:35.082762 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e
[0m04:08:35.087491 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e"
[0m04:08:35.097752 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e
[0m04:08:35.100207 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e"
[0m04:08:35.112629 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e"
[0m04:08:35.113740 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select lower_band
from dev.analytics.bollinger
where lower_band is null



      
    ) dbt_internal_test
[0m04:08:35.115196 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:08:35.692805 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.578 seconds
[0m04:08:35.695550 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e: Close
[0m04:08:35.814780 [info ] [Thread-1 (]: 6 of 27 PASS not_null_bollinger_lower_band ..................................... [[32mPASS[0m in 0.73s]
[0m04:08:35.816930 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e
[0m04:08:35.818340 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3
[0m04:08:35.819266 [info ] [Thread-1 (]: 7 of 27 START test not_null_bollinger_sma_20d .................................. [RUN]
[0m04:08:35.821110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e, now test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3)
[0m04:08:35.822209 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3
[0m04:08:35.826017 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3"
[0m04:08:35.833111 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3
[0m04:08:35.835595 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3"
[0m04:08:35.845846 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3"
[0m04:08:35.846848 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sma_20d
from dev.analytics.bollinger
where sma_20d is null



      
    ) dbt_internal_test
[0m04:08:35.847780 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:08:36.320734 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.473 seconds
[0m04:08:36.324249 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3: Close
[0m04:08:36.447301 [info ] [Thread-1 (]: 7 of 27 PASS not_null_bollinger_sma_20d ........................................ [[32mPASS[0m in 0.63s]
[0m04:08:36.449223 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3
[0m04:08:36.451213 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_symbol.a932e30f82
[0m04:08:36.453124 [info ] [Thread-1 (]: 8 of 27 START test not_null_bollinger_symbol ................................... [RUN]
[0m04:08:36.454212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3, now test.stock_dbt.not_null_bollinger_symbol.a932e30f82)
[0m04:08:36.455512 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_symbol.a932e30f82
[0m04:08:36.459667 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_symbol.a932e30f82"
[0m04:08:36.472054 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_symbol.a932e30f82
[0m04:08:36.474230 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_symbol.a932e30f82"
[0m04:08:36.484142 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_symbol.a932e30f82"
[0m04:08:36.485910 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_symbol.a932e30f82: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_symbol.a932e30f82"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.bollinger
where symbol is null



      
    ) dbt_internal_test
[0m04:08:36.487984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:08:36.890384 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.402 seconds
[0m04:08:36.895456 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_symbol.a932e30f82: Close
[0m04:08:37.023112 [info ] [Thread-1 (]: 8 of 27 PASS not_null_bollinger_symbol ......................................... [[32mPASS[0m in 0.57s]
[0m04:08:37.025534 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_symbol.a932e30f82
[0m04:08:37.027373 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_upper_band.e4db87564c
[0m04:08:37.029129 [info ] [Thread-1 (]: 9 of 27 START test not_null_bollinger_upper_band ............................... [RUN]
[0m04:08:37.030866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_symbol.a932e30f82, now test.stock_dbt.not_null_bollinger_upper_band.e4db87564c)
[0m04:08:37.032495 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_upper_band.e4db87564c
[0m04:08:37.036950 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_upper_band.e4db87564c"
[0m04:08:37.057667 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_upper_band.e4db87564c
[0m04:08:37.060867 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_upper_band.e4db87564c"
[0m04:08:37.077950 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_upper_band.e4db87564c"
[0m04:08:37.079787 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_upper_band.e4db87564c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_upper_band.e4db87564c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select upper_band
from dev.analytics.bollinger
where upper_band is null



      
    ) dbt_internal_test
[0m04:08:37.081634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:08:37.661757 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.580 seconds
[0m04:08:37.666663 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_upper_band.e4db87564c: Close
[0m04:08:37.793194 [info ] [Thread-1 (]: 9 of 27 PASS not_null_bollinger_upper_band ..................................... [[32mPASS[0m in 0.76s]
[0m04:08:37.794995 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_upper_band.e4db87564c
[0m04:08:37.796845 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_close.6d037dd588
[0m04:08:37.798149 [info ] [Thread-1 (]: 10 of 27 START test not_null_moving_average_close .............................. [RUN]
[0m04:08:37.799312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_upper_band.e4db87564c, now test.stock_dbt.not_null_moving_average_close.6d037dd588)
[0m04:08:37.800448 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_close.6d037dd588
[0m04:08:37.805352 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_close.6d037dd588"
[0m04:08:37.821334 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_close.6d037dd588
[0m04:08:37.826891 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_close.6d037dd588"
[0m04:08:37.843042 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_close.6d037dd588"
[0m04:08:37.844375 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_close.6d037dd588: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_close.6d037dd588"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.moving_average
where close is null



      
    ) dbt_internal_test
[0m04:08:37.845999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:08:38.274942 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.429 seconds
[0m04:08:38.277711 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_close.6d037dd588: Close
[0m04:08:38.394726 [info ] [Thread-1 (]: 10 of 27 PASS not_null_moving_average_close .................................... [[32mPASS[0m in 0.60s]
[0m04:08:38.396354 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_close.6d037dd588
[0m04:08:38.397562 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_date.3ad00158b5
[0m04:08:38.398778 [info ] [Thread-1 (]: 11 of 27 START test not_null_moving_average_date ............................... [RUN]
[0m04:08:38.400274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_close.6d037dd588, now test.stock_dbt.not_null_moving_average_date.3ad00158b5)
[0m04:08:38.401201 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_date.3ad00158b5
[0m04:08:38.405007 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_date.3ad00158b5"
[0m04:08:38.413907 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_date.3ad00158b5
[0m04:08:38.416590 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_date.3ad00158b5"
[0m04:08:38.429484 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_date.3ad00158b5"
[0m04:08:38.430753 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_date.3ad00158b5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_date.3ad00158b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.moving_average
where date is null



      
    ) dbt_internal_test
[0m04:08:38.431807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:08:38.833746 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.402 seconds
[0m04:08:38.836959 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_date.3ad00158b5: Close
[0m04:08:38.981011 [info ] [Thread-1 (]: 11 of 27 PASS not_null_moving_average_date ..................................... [[32mPASS[0m in 0.58s]
[0m04:08:38.982801 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_date.3ad00158b5
[0m04:08:38.984447 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m04:08:38.985638 [info ] [Thread-1 (]: 12 of 27 START test not_null_moving_average_moving_avg_20d ..................... [RUN]
[0m04:08:38.986801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_date.3ad00158b5, now test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22)
[0m04:08:38.988285 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m04:08:38.991779 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m04:08:39.002530 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m04:08:39.005290 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m04:08:39.015240 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m04:08:39.016222 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg_20d
from dev.analytics.moving_average
where moving_avg_20d is null



      
    ) dbt_internal_test
[0m04:08:39.017292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:08:39.495950 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.479 seconds
[0m04:08:39.498847 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22: Close
[0m04:08:39.629204 [info ] [Thread-1 (]: 12 of 27 PASS not_null_moving_average_moving_avg_20d ........................... [[32mPASS[0m in 0.64s]
[0m04:08:39.631649 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m04:08:39.633290 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m04:08:39.634445 [info ] [Thread-1 (]: 13 of 27 START test not_null_moving_average_moving_avg_5d ...................... [RUN]
[0m04:08:39.635693 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22, now test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca)
[0m04:08:39.636366 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m04:08:39.639699 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m04:08:39.661054 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m04:08:39.663883 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m04:08:39.671890 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m04:08:39.673928 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg_5d
from dev.analytics.moving_average
where moving_avg_5d is null



      
    ) dbt_internal_test
[0m04:08:39.676469 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:08:40.161554 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.485 seconds
[0m04:08:40.164775 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca: Close
[0m04:08:40.278110 [info ] [Thread-1 (]: 13 of 27 PASS not_null_moving_average_moving_avg_5d ............................ [[32mPASS[0m in 0.64s]
[0m04:08:40.279706 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m04:08:40.281062 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_symbol.75a6f7473c
[0m04:08:40.282628 [info ] [Thread-1 (]: 14 of 27 START test not_null_moving_average_symbol ............................. [RUN]
[0m04:08:40.283891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca, now test.stock_dbt.not_null_moving_average_symbol.75a6f7473c)
[0m04:08:40.284808 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_symbol.75a6f7473c
[0m04:08:40.288988 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_symbol.75a6f7473c"
[0m04:08:40.300109 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_symbol.75a6f7473c
[0m04:08:40.302950 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_symbol.75a6f7473c"
[0m04:08:40.314061 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_symbol.75a6f7473c"
[0m04:08:40.315560 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_symbol.75a6f7473c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_symbol.75a6f7473c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.moving_average
where symbol is null



      
    ) dbt_internal_test
[0m04:08:40.316832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:08:40.798945 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.482 seconds
[0m04:08:40.803262 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_symbol.75a6f7473c: Close
[0m04:08:40.922326 [info ] [Thread-1 (]: 14 of 27 PASS not_null_moving_average_symbol ................................... [[32mPASS[0m in 0.64s]
[0m04:08:40.924364 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_symbol.75a6f7473c
[0m04:08:40.926070 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42
[0m04:08:40.927777 [info ] [Thread-1 (]: 15 of 27 START test not_null_rsi_calculation_avg_gain .......................... [RUN]
[0m04:08:40.928943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_symbol.75a6f7473c, now test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42)
[0m04:08:40.930247 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42
[0m04:08:40.934563 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m04:08:40.946965 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42
[0m04:08:40.950105 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m04:08:40.963203 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m04:08:40.964728 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_gain
from dev.analytics.rsi_calculation
where avg_gain is null



      
    ) dbt_internal_test
[0m04:08:40.966271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:08:41.394423 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.428 seconds
[0m04:08:41.397201 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42: Close
[0m04:08:41.524420 [info ] [Thread-1 (]: 15 of 27 PASS not_null_rsi_calculation_avg_gain ................................ [[32mPASS[0m in 0.60s]
[0m04:08:41.526075 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42
[0m04:08:41.527190 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m04:08:41.528588 [info ] [Thread-1 (]: 16 of 27 START test not_null_rsi_calculation_avg_loss .......................... [RUN]
[0m04:08:41.529869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42, now test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19)
[0m04:08:41.530883 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m04:08:41.534272 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m04:08:41.545593 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m04:08:41.547996 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m04:08:41.563450 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m04:08:41.564932 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_loss
from dev.analytics.rsi_calculation
where avg_loss is null



      
    ) dbt_internal_test
[0m04:08:41.566483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:08:42.063424 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.497 seconds
[0m04:08:42.066029 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19: Close
[0m04:08:42.179342 [info ] [Thread-1 (]: 16 of 27 PASS not_null_rsi_calculation_avg_loss ................................ [[32mPASS[0m in 0.65s]
[0m04:08:42.181581 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m04:08:42.183126 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d
[0m04:08:42.184491 [info ] [Thread-1 (]: 17 of 27 START test not_null_rsi_calculation_close ............................. [RUN]
[0m04:08:42.186281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19, now test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d)
[0m04:08:42.187645 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d
[0m04:08:42.191757 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d"
[0m04:08:42.208181 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d
[0m04:08:42.210837 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d"
[0m04:08:42.224177 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d"
[0m04:08:42.225808 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.rsi_calculation
where close is null



      
    ) dbt_internal_test
[0m04:08:42.227630 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:08:42.713878 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.486 seconds
[0m04:08:42.716298 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d: Close
[0m04:08:42.845227 [info ] [Thread-1 (]: 17 of 27 PASS not_null_rsi_calculation_close ................................... [[32mPASS[0m in 0.66s]
[0m04:08:42.846582 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d
[0m04:08:42.847757 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76
[0m04:08:42.848876 [info ] [Thread-1 (]: 18 of 27 START test not_null_rsi_calculation_date .............................. [RUN]
[0m04:08:42.850075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d, now test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76)
[0m04:08:42.850979 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76
[0m04:08:42.895431 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76"
[0m04:08:42.907083 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76
[0m04:08:42.909795 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76"
[0m04:08:42.922789 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76"
[0m04:08:42.923944 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.rsi_calculation
where date is null



      
    ) dbt_internal_test
[0m04:08:42.925031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:08:43.369694 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.445 seconds
[0m04:08:43.372352 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76: Close
[0m04:08:43.495460 [info ] [Thread-1 (]: 18 of 27 PASS not_null_rsi_calculation_date .................................... [[32mPASS[0m in 0.65s]
[0m04:08:43.496756 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76
[0m04:08:43.497522 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m04:08:43.498718 [info ] [Thread-1 (]: 19 of 27 START test not_null_rsi_calculation_rsi_14d ........................... [RUN]
[0m04:08:43.499666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76, now test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8)
[0m04:08:43.500584 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m04:08:43.504168 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m04:08:43.527042 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m04:08:43.530364 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m04:08:43.543200 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m04:08:43.544602 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from dev.analytics.rsi_calculation
where rsi_14d is null



      
    ) dbt_internal_test
[0m04:08:43.545683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:08:43.980879 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.435 seconds
[0m04:08:43.984043 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8: Close
[0m04:08:44.175227 [info ] [Thread-1 (]: 19 of 27 PASS not_null_rsi_calculation_rsi_14d ................................. [[32mPASS[0m in 0.68s]
[0m04:08:44.176478 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m04:08:44.177925 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84
[0m04:08:44.179198 [info ] [Thread-1 (]: 20 of 27 START test not_null_rsi_calculation_symbol ............................ [RUN]
[0m04:08:44.180645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8, now test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84)
[0m04:08:44.181955 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84
[0m04:08:44.186713 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m04:08:44.195934 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84
[0m04:08:44.198519 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m04:08:44.213115 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m04:08:44.214539 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.rsi_calculation
where symbol is null



      
    ) dbt_internal_test
[0m04:08:44.215740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:08:44.655343 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.440 seconds
[0m04:08:44.658653 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84: Close
[0m04:08:44.767564 [info ] [Thread-1 (]: 20 of 27 PASS not_null_rsi_calculation_symbol .................................. [[32mPASS[0m in 0.59s]
[0m04:08:44.770183 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84
[0m04:08:44.771685 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_close.d7e232e1ba
[0m04:08:44.772759 [info ] [Thread-1 (]: 21 of 27 START test not_null_stock_prices_close ................................ [RUN]
[0m04:08:44.773830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84, now test.stock_dbt.not_null_stock_prices_close.d7e232e1ba)
[0m04:08:44.774744 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_close.d7e232e1ba
[0m04:08:44.778939 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_close.d7e232e1ba"
[0m04:08:44.793967 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_close.d7e232e1ba
[0m04:08:44.796961 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_close.d7e232e1ba"
[0m04:08:44.806547 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_close.d7e232e1ba"
[0m04:08:44.807962 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_close.d7e232e1ba: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_close.d7e232e1ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.stock_prices
where close is null



      
    ) dbt_internal_test
[0m04:08:44.809131 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:08:45.160902 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.352 seconds
[0m04:08:45.163828 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_close.d7e232e1ba: Close
[0m04:08:45.273367 [info ] [Thread-1 (]: 21 of 27 PASS not_null_stock_prices_close ...................................... [[32mPASS[0m in 0.50s]
[0m04:08:45.275547 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_close.d7e232e1ba
[0m04:08:45.276749 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_date.98a7527501
[0m04:08:45.278132 [info ] [Thread-1 (]: 22 of 27 START test not_null_stock_prices_date ................................. [RUN]
[0m04:08:45.279593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_close.d7e232e1ba, now test.stock_dbt.not_null_stock_prices_date.98a7527501)
[0m04:08:45.281423 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_date.98a7527501
[0m04:08:45.286262 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_date.98a7527501"
[0m04:08:45.296835 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_date.98a7527501
[0m04:08:45.299312 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_date.98a7527501"
[0m04:08:45.309057 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_date.98a7527501"
[0m04:08:45.310117 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_date.98a7527501: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_date.98a7527501"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.stock_prices
where date is null



      
    ) dbt_internal_test
[0m04:08:45.311398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:08:45.791486 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.480 seconds
[0m04:08:45.794241 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_date.98a7527501: Close
[0m04:08:45.919293 [info ] [Thread-1 (]: 22 of 27 PASS not_null_stock_prices_date ....................................... [[32mPASS[0m in 0.64s]
[0m04:08:45.921846 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_date.98a7527501
[0m04:08:45.923223 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc
[0m04:08:45.924662 [info ] [Thread-1 (]: 23 of 27 START test not_null_stock_prices_high ................................. [RUN]
[0m04:08:45.925953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_date.98a7527501, now test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc)
[0m04:08:45.927774 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc
[0m04:08:45.932109 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc"
[0m04:08:45.939799 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc
[0m04:08:45.942197 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc"
[0m04:08:45.950223 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc"
[0m04:08:45.951641 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select high
from dev.analytics.stock_prices
where high is null



      
    ) dbt_internal_test
[0m04:08:45.952638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:08:46.437645 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.485 seconds
[0m04:08:46.440347 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc: Close
[0m04:08:46.552024 [info ] [Thread-1 (]: 23 of 27 PASS not_null_stock_prices_high ....................................... [[32mPASS[0m in 0.63s]
[0m04:08:46.554174 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc
[0m04:08:46.555054 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_low.e65294ca15
[0m04:08:46.555999 [info ] [Thread-1 (]: 24 of 27 START test not_null_stock_prices_low .................................. [RUN]
[0m04:08:46.556941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc, now test.stock_dbt.not_null_stock_prices_low.e65294ca15)
[0m04:08:46.557864 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_low.e65294ca15
[0m04:08:46.561506 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_low.e65294ca15"
[0m04:08:46.571805 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_low.e65294ca15
[0m04:08:46.574027 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_low.e65294ca15"
[0m04:08:46.581475 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_low.e65294ca15"
[0m04:08:46.582858 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_low.e65294ca15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_low.e65294ca15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select low
from dev.analytics.stock_prices
where low is null



      
    ) dbt_internal_test
[0m04:08:46.584297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:08:46.946425 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.362 seconds
[0m04:08:46.949128 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_low.e65294ca15: Close
[0m04:08:47.064158 [info ] [Thread-1 (]: 24 of 27 PASS not_null_stock_prices_low ........................................ [[32mPASS[0m in 0.51s]
[0m04:08:47.066735 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_low.e65294ca15
[0m04:08:47.068622 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_open.e09b13f215
[0m04:08:47.069956 [info ] [Thread-1 (]: 25 of 27 START test not_null_stock_prices_open ................................. [RUN]
[0m04:08:47.071879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_low.e65294ca15, now test.stock_dbt.not_null_stock_prices_open.e09b13f215)
[0m04:08:47.073037 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_open.e09b13f215
[0m04:08:47.077953 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_open.e09b13f215"
[0m04:08:47.093963 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_open.e09b13f215
[0m04:08:47.097020 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_open.e09b13f215"
[0m04:08:47.109312 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_open.e09b13f215"
[0m04:08:47.110306 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_open.e09b13f215: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_open.e09b13f215"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from dev.analytics.stock_prices
where open is null



      
    ) dbt_internal_test
[0m04:08:47.111327 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:08:47.543662 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.432 seconds
[0m04:08:47.546419 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_open.e09b13f215: Close
[0m04:08:47.657725 [info ] [Thread-1 (]: 25 of 27 PASS not_null_stock_prices_open ....................................... [[32mPASS[0m in 0.59s]
[0m04:08:47.659417 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_open.e09b13f215
[0m04:08:47.660936 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8
[0m04:08:47.662027 [info ] [Thread-1 (]: 26 of 27 START test not_null_stock_prices_symbol ............................... [RUN]
[0m04:08:47.663166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_open.e09b13f215, now test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8)
[0m04:08:47.664069 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8
[0m04:08:47.668957 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8"
[0m04:08:47.678832 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8
[0m04:08:47.681524 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8"
[0m04:08:47.689095 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8"
[0m04:08:47.690272 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.stock_prices
where symbol is null



      
    ) dbt_internal_test
[0m04:08:47.691664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:08:48.087270 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.396 seconds
[0m04:08:48.090024 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8: Close
[0m04:08:48.227250 [info ] [Thread-1 (]: 26 of 27 PASS not_null_stock_prices_symbol ..................................... [[32mPASS[0m in 0.56s]
[0m04:08:48.228862 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8
[0m04:08:48.229852 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_volume.71420bc956
[0m04:08:48.231006 [info ] [Thread-1 (]: 27 of 27 START test not_null_stock_prices_volume ............................... [RUN]
[0m04:08:48.232946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8, now test.stock_dbt.not_null_stock_prices_volume.71420bc956)
[0m04:08:48.234291 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_volume.71420bc956
[0m04:08:48.238661 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_volume.71420bc956"
[0m04:08:48.246092 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_volume.71420bc956
[0m04:08:48.248534 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_volume.71420bc956"
[0m04:08:48.257347 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_volume.71420bc956"
[0m04:08:48.258508 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_volume.71420bc956: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_volume.71420bc956"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume
from dev.analytics.stock_prices
where volume is null



      
    ) dbt_internal_test
[0m04:08:48.259495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:08:48.646290 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.387 seconds
[0m04:08:48.648720 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_volume.71420bc956: Close
[0m04:08:48.760860 [info ] [Thread-1 (]: 27 of 27 PASS not_null_stock_prices_volume ..................................... [[32mPASS[0m in 0.53s]
[0m04:08:48.762729 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_volume.71420bc956
[0m04:08:48.764673 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:08:48.765631 [debug] [MainThread]: Connection 'test.stock_dbt.not_null_stock_prices_volume.71420bc956' was properly closed.
[0m04:08:48.766809 [info ] [MainThread]: 
[0m04:08:48.767939 [info ] [MainThread]: Finished running 27 data tests in 0 hours 0 minutes and 18.13 seconds (18.13s).
[0m04:08:48.770787 [debug] [MainThread]: Command end result
[0m04:08:48.820800 [info ] [MainThread]: 
[0m04:08:48.821949 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:08:48.823165 [info ] [MainThread]: 
[0m04:08:48.824400 [info ] [MainThread]: Done. PASS=27 WARN=0 ERROR=0 SKIP=0 TOTAL=27
[0m04:08:48.826359 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 19.461535, "process_user_time": 3.802473, "process_kernel_time": 3.068131, "process_mem_max_rss": "265124", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m04:08:48.827624 [debug] [MainThread]: Command `dbt test` succeeded at 04:08:48.827524 after 19.46 seconds
[0m04:08:48.828438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9697fb2420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f963bb09a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9697e87d10>]}
[0m04:08:48.829284 [debug] [MainThread]: Flushing usage events
[0m04:08:51.780989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4775bb0ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4775bb15b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4775bb3350>]}


============================== 04:08:51.786440 | aaaf2a66-0792-4847-8fc3-376161e3f9bf ==============================
[0m04:08:51.786440 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:08:51.787424 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/stock_dbt', 'log_path': '/opt/airflow/stock_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/stock_dbt --project-dir /opt/airflow/stock_dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:08:52.436877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aaaf2a66-0792-4847-8fc3-376161e3f9bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f471cb6a2a0>]}
[0m04:08:52.476712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aaaf2a66-0792-4847-8fc3-376161e3f9bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4776048fe0>]}
[0m04:08:52.479103 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:08:52.488998 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:08:52.802393 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:08:52.803702 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:08:52.809074 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.stock_prediction.raw_data
- models.stock_prediction.tranformations
- models.stock_prediction
[0m04:08:52.849339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aaaf2a66-0792-4847-8fc3-376161e3f9bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f471c3be780>]}
[0m04:08:52.968945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aaaf2a66-0792-4847-8fc3-376161e3f9bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4717f79f70>]}
[0m04:08:52.970214 [info ] [MainThread]: Found 5 models, 4 snapshots, 27 data tests, 1 source, 459 macros
[0m04:08:52.971626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aaaf2a66-0792-4847-8fc3-376161e3f9bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4774b1cb30>]}
[0m04:08:52.974641 [info ] [MainThread]: 
[0m04:08:52.976348 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:08:52.980794 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m04:08:52.992911 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m04:08:52.994616 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m04:08:52.996645 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:08:53.475757 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.479 seconds
[0m04:08:53.481111 [debug] [ThreadPool]: On list_dev: Close
[0m04:08:53.614735 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_snapshot)
[0m04:08:53.624215 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m04:08:53.626114 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m04:08:53.627903 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:08:54.098227 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.470 seconds
[0m04:08:54.101778 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m04:08:54.222350 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m04:08:54.225603 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m04:08:54.227500 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m04:08:54.229022 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:08:54.619009 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.390 seconds
[0m04:08:54.622557 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m04:08:54.733879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aaaf2a66-0792-4847-8fc3-376161e3f9bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f477728cd10>]}
[0m04:08:54.735769 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:08:54.736903 [info ] [MainThread]: 
[0m04:08:54.744087 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.snapshot_atr
[0m04:08:54.745295 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshot.snapshot_atr .................................... [RUN]
[0m04:08:54.746386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now snapshot.stock_dbt.snapshot_atr)
[0m04:08:54.747389 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.snapshot_atr
[0m04:08:54.753457 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.snapshot_atr
[0m04:08:54.799971 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:08:54.805066 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
[0m04:08:54.808793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:08:55.154677 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.346 seconds
[0m04:08:55.191519 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:08:55.193739 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.avg_true_range


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m04:08:56.202594 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.007 seconds
[0m04:08:56.206271 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:08:56.207710 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
[0m04:08:56.299700 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.091 seconds
[0m04:08:56.304327 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:08:56.305829 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
[0m04:08:56.375248 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.068 seconds
[0m04:08:56.379022 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:08:56.380902 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
[0m04:08:56.471961 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.090 seconds
[0m04:08:56.475868 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:08:56.477117 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
[0m04:08:56.594720 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.117 seconds
[0m04:08:56.603345 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:08:56.604836 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
[0m04:08:56.703575 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.098 seconds
[0m04:08:56.721099 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:08:56.723273 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.avg_true_range


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m04:08:56.993606 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.268 seconds
[0m04:08:56.998108 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:08:56.999645 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m04:08:57.080275 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.080 seconds
[0m04:08:57.082000 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.snapshot_atr"
[0m04:08:57.094764 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:08:57.096148 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
BEGIN
[0m04:08:57.278772 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.181 seconds
[0m04:08:57.280135 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:08:57.281274 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_ATR" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATE", "SYMBOL", "ATR_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATE", "SYMBOL", "ATR_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m04:08:57.672127 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.390 seconds
[0m04:08:57.673768 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:08:57.674892 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
COMMIT
[0m04:08:58.099603 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.423 seconds
[0m04:08:58.116037 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: Close
[0m04:08:58.243613 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaaf2a66-0792-4847-8fc3-376161e3f9bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f477647dd00>]}
[0m04:08:58.245847 [info ] [Thread-1 (]: 1 of 4 OK snapshotted snapshot.snapshot_atr .................................... [[32mSUCCESS 0[0m in 3.50s]
[0m04:08:58.247590 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.snapshot_atr
[0m04:08:58.249105 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.snapshot_bollinger
[0m04:08:58.250404 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshot.snapshot_bollinger .............................. [RUN]
[0m04:08:58.251742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_dbt.snapshot_atr, now snapshot.stock_dbt.snapshot_bollinger)
[0m04:08:58.253035 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.snapshot_bollinger
[0m04:08:58.255991 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.snapshot_bollinger
[0m04:08:58.260211 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:08:58.262507 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
[0m04:08:58.264737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:08:58.691486 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.427 seconds
[0m04:08:58.697853 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:08:58.699412 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.bollinger


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m04:08:59.417213 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.716 seconds
[0m04:08:59.421190 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:08:59.422393 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
[0m04:08:59.519751 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.096 seconds
[0m04:08:59.523684 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:08:59.525640 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
[0m04:08:59.620984 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.094 seconds
[0m04:08:59.624929 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:08:59.626648 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
[0m04:08:59.705358 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.077 seconds
[0m04:08:59.709798 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:08:59.711746 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
[0m04:08:59.823506 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.110 seconds
[0m04:08:59.828283 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:08:59.830000 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
[0m04:08:59.927223 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.096 seconds
[0m04:08:59.932052 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:08:59.933124 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.bollinger


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m04:09:00.174098 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.239 seconds
[0m04:09:00.176508 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:09:00.177989 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m04:09:00.248177 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.069 seconds
[0m04:09:00.249608 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.snapshot_bollinger"
[0m04:09:00.262031 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:09:00.263223 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
BEGIN
[0m04:09:00.404051 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.140 seconds
[0m04:09:00.406916 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:09:00.408066 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "SMA_20D", "UPPER_BAND", "LOWER_BAND", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "SMA_20D", "UPPER_BAND", "LOWER_BAND", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m04:09:00.825864 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.417 seconds
[0m04:09:00.827964 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:09:00.829120 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
COMMIT
[0m04:09:01.104742 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.275 seconds
[0m04:09:01.108112 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: Close
[0m04:09:01.210945 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaaf2a66-0792-4847-8fc3-376161e3f9bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4717464aa0>]}
[0m04:09:01.213204 [info ] [Thread-1 (]: 2 of 4 OK snapshotted snapshot.snapshot_bollinger .............................. [[32mSUCCESS 0[0m in 2.96s]
[0m04:09:01.215701 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.snapshot_bollinger
[0m04:09:01.217907 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.snapshot_moving_avg
[0m04:09:01.220225 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshot.snapshot_moving_avg ............................. [RUN]
[0m04:09:01.222565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_dbt.snapshot_bollinger, now snapshot.stock_dbt.snapshot_moving_avg)
[0m04:09:01.224684 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.snapshot_moving_avg
[0m04:09:01.228570 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.snapshot_moving_avg
[0m04:09:01.233445 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:09:01.235717 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
[0m04:09:01.238166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:09:01.565673 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.327 seconds
[0m04:09:01.573107 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:09:01.574059 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.moving_average


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m04:09:02.245784 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.671 seconds
[0m04:09:02.249230 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:09:02.250971 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
[0m04:09:02.344258 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.092 seconds
[0m04:09:02.348433 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:09:02.350300 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
[0m04:09:02.429940 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.078 seconds
[0m04:09:02.434317 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:09:02.435951 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
[0m04:09:02.530046 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.092 seconds
[0m04:09:02.536552 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:09:02.540056 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
[0m04:09:02.643438 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.098 seconds
[0m04:09:02.647963 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:09:02.649804 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
[0m04:09:02.720826 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.068 seconds
[0m04:09:02.726260 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:09:02.728264 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.moving_average


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m04:09:03.053803 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.324 seconds
[0m04:09:03.056213 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:09:03.057791 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m04:09:03.141923 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.083 seconds
[0m04:09:03.143524 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:09:03.151312 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:09:03.152287 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
BEGIN
[0m04:09:03.393855 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.241 seconds
[0m04:09:03.396086 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:09:03.397624 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "MOVING_AVG_5D", "MOVING_AVG_20D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "MOVING_AVG_5D", "MOVING_AVG_20D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m04:09:03.928623 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.530 seconds
[0m04:09:03.930431 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:09:03.931911 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
COMMIT
[0m04:09:04.324489 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.391 seconds
[0m04:09:04.327088 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: Close
[0m04:09:04.570874 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaaf2a66-0792-4847-8fc3-376161e3f9bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f471742e7e0>]}
[0m04:09:04.573336 [info ] [Thread-1 (]: 3 of 4 OK snapshotted snapshot.snapshot_moving_avg ............................. [[32mSUCCESS 0[0m in 3.35s]
[0m04:09:04.575579 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.snapshot_moving_avg
[0m04:09:04.577344 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.snapshot_rsi
[0m04:09:04.579364 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshot.snapshot_rsi .................................... [RUN]
[0m04:09:04.581286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_dbt.snapshot_moving_avg, now snapshot.stock_dbt.snapshot_rsi)
[0m04:09:04.583801 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.snapshot_rsi
[0m04:09:04.589315 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.snapshot_rsi
[0m04:09:04.594557 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:09:04.596382 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m04:09:04.597978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:09:05.332373 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.734 seconds
[0m04:09:05.339074 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:09:05.341024 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.rsi_calculation


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m04:09:06.092072 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.749 seconds
[0m04:09:06.095170 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:09:06.096417 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m04:09:06.204972 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.107 seconds
[0m04:09:06.208727 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:09:06.210297 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m04:09:06.322994 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.111 seconds
[0m04:09:06.327619 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:09:06.330337 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m04:09:06.410145 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.078 seconds
[0m04:09:06.414382 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:09:06.415573 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m04:09:06.507931 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.091 seconds
[0m04:09:06.513204 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:09:06.514613 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m04:09:06.584850 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.069 seconds
[0m04:09:06.589352 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:09:06.590390 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.rsi_calculation


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m04:09:06.801211 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.210 seconds
[0m04:09:06.803723 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:09:06.805386 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m04:09:07.342650 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.536 seconds
[0m04:09:07.344379 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.snapshot_rsi"
[0m04:09:07.358219 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:09:07.359509 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
BEGIN
[0m04:09:07.467231 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.107 seconds
[0m04:09:07.469154 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:09:07.471649 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_RSI" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "AVG_GAIN", "AVG_LOSS", "RSI_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "AVG_GAIN", "AVG_LOSS", "RSI_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m04:09:07.935841 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.462 seconds
[0m04:09:07.937492 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:09:07.938823 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
COMMIT
[0m04:09:08.262405 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.322 seconds
[0m04:09:08.265691 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: Close
[0m04:09:08.380366 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaaf2a66-0792-4847-8fc3-376161e3f9bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47174abd40>]}
[0m04:09:08.383059 [info ] [Thread-1 (]: 4 of 4 OK snapshotted snapshot.snapshot_rsi .................................... [[32mSUCCESS 0[0m in 3.80s]
[0m04:09:08.385451 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.snapshot_rsi
[0m04:09:08.388811 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:09:08.391146 [debug] [MainThread]: Connection 'snapshot.stock_dbt.snapshot_rsi' was properly closed.
[0m04:09:08.393424 [info ] [MainThread]: 
[0m04:09:08.395954 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 15.42 seconds (15.42s).
[0m04:09:08.398740 [debug] [MainThread]: Command end result
[0m04:09:08.545023 [info ] [MainThread]: 
[0m04:09:08.548189 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:09:08.551434 [info ] [MainThread]: 
[0m04:09:08.553260 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m04:09:08.555111 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 16.848, "process_user_time": 3.465138, "process_kernel_time": 2.860116, "process_mem_max_rss": "257936", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m04:09:08.556319 [debug] [MainThread]: Command `dbt snapshot` succeeded at 04:09:08.556243 after 16.85 seconds
[0m04:09:08.557825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4775f08c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4778474ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f471c14f620>]}
[0m04:09:08.560081 [debug] [MainThread]: Flushing usage events
[0m20:55:21.379864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F33F373E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F33F37620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F33F37650>]}


============================== 20:55:21.395786 | 69d606da-e140-451b-b4a6-261beab7c428 ==============================
[0m20:55:21.395786 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:55:21.395786 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\tekal\\Downloads\\Sem 1\\DATA226\\sjsu-data226\\week8\\airflow\\stock_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\tekal\\Downloads\\Sem 1\\DATA226\\sjsu-data226\\week8\\airflow\\stock_dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:55:21.395786 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_ACCOUNT'
[0m20:55:21.395786 [debug] [MainThread]: Command `dbt run` failed at 20:55:21.395786 after 0.25 seconds
[0m20:55:21.395786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F33C827E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F33F37590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F33F37380>]}
[0m20:55:21.395786 [debug] [MainThread]: Flushing usage events
[0m04:56:02.588252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26fd4ca2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26fd486030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26fd485fa0>]}


============================== 04:56:02.598253 | 29140f42-e708-48b7-80d5-fcf5f99ea5a6 ==============================
[0m04:56:02.598253 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:56:02.599822 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/stock_dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/stock_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/stock_dbt --project-dir /opt/airflow/stock_dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:56:03.293473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29140f42-e708-48b7-80d5-fcf5f99ea5a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f269ffa5dc0>]}
[0m04:56:03.328672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29140f42-e708-48b7-80d5-fcf5f99ea5a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26a5613a70>]}
[0m04:56:03.332092 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:56:03.343293 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:56:03.576414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c9cfc38f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c9d6e9310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c9e882d80>]}


============================== 04:56:03.581430 | 29dbe75e-6758-4ce6-afd1-d6782603057d ==============================
[0m04:56:03.581430 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:56:03.582608 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/stock_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/stock_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/stock_dbt --project-dir /opt/airflow/stock_dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:56:03.737174 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:56:03.738362 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:56:03.744874 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.stock_prediction.tranformations
- models.stock_prediction
- models.stock_prediction.raw_data
[0m04:56:03.795918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29140f42-e708-48b7-80d5-fcf5f99ea5a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f269fc55ac0>]}
[0m04:56:03.951238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29140f42-e708-48b7-80d5-fcf5f99ea5a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f269fc555e0>]}
[0m04:56:03.953585 [info ] [MainThread]: Found 5 models, 4 snapshots, 27 data tests, 1 source, 459 macros
[0m04:56:03.955988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29140f42-e708-48b7-80d5-fcf5f99ea5a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f269fbeed50>]}
[0m04:56:03.960521 [info ] [MainThread]: 
[0m04:56:03.962133 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:56:03.966342 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m04:56:03.979206 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m04:56:03.981127 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m04:56:03.982887 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:56:04.201455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29dbe75e-6758-4ce6-afd1-d6782603057d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c3f9e17c0>]}
[0m04:56:04.237699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29dbe75e-6758-4ce6-afd1-d6782603057d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c3ed0e780>]}
[0m04:56:04.239916 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:56:04.249020 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:56:04.552782 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:56:04.553960 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:56:04.558486 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.stock_prediction
- models.stock_prediction.tranformations
- models.stock_prediction.raw_data
[0m04:56:04.590808 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.608 seconds
[0m04:56:04.593072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29dbe75e-6758-4ce6-afd1-d6782603057d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c3eabe1e0>]}
[0m04:56:04.593710 [debug] [ThreadPool]: On list_dev: Close
[0m04:56:04.698895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29dbe75e-6758-4ce6-afd1-d6782603057d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c3e876780>]}
[0m04:56:04.699801 [info ] [MainThread]: Found 5 models, 4 snapshots, 27 data tests, 1 source, 459 macros
[0m04:56:04.707650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29dbe75e-6758-4ce6-afd1-d6782603057d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c3e7a1f40>]}
[0m04:56:04.710470 [info ] [MainThread]: 
[0m04:56:04.710641 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m04:56:04.712282 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:56:04.716101 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m04:56:04.719279 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m04:56:04.720450 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m04:56:04.721693 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:56:04.727678 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m04:56:04.729182 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m04:56:04.730768 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:56:05.183041 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.452 seconds
[0m04:56:05.187717 [debug] [ThreadPool]: On list_dev: Close
[0m04:56:05.207820 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.486 seconds
[0m04:56:05.211591 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m04:56:05.312583 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m04:56:05.321021 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m04:56:05.320966 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m04:56:05.322524 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m04:56:05.323830 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m04:56:05.324643 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:56:05.325475 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m04:56:05.326633 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:56:05.764328 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.440 seconds
[0m04:56:05.766923 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m04:56:05.769467 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.443 seconds
[0m04:56:05.771933 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m04:56:05.887822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29140f42-e708-48b7-80d5-fcf5f99ea5a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f269fc54fb0>]}
[0m04:56:05.889654 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:56:05.891369 [info ] [MainThread]: 
[0m04:56:05.897904 [debug] [Thread-1 (]: Began running node model.stock_dbt.stock_prices
[0m04:56:05.897611 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m04:56:05.899291 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stock_prices ............................. [RUN]
[0m04:56:05.900561 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m04:56:05.900708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now model.stock_dbt.stock_prices)
[0m04:56:05.901691 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m04:56:05.901841 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.stock_prices
[0m04:56:05.902534 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:56:05.907961 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.stock_prices"
[0m04:56:05.915387 [debug] [Thread-1 (]: Began executing node model.stock_dbt.stock_prices
[0m04:56:05.938145 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.stock_prices"
[0m04:56:05.949462 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.stock_prices"
[0m04:56:05.951211 [debug] [Thread-1 (]: On model.stock_dbt.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.stock_prices"} */
create or replace   view dev.analytics.stock_prices
  
   as (
    SELECT
    symbol,
    date,
    open,
    high,
    low,
    close,
    volume
FROM dev.raw_data.stock_prices
  );
[0m04:56:05.952710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:06.273763 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.371 seconds
[0m04:56:06.276772 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m04:56:06.398047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29dbe75e-6758-4ce6-afd1-d6782603057d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c3ec84b00>]}
[0m04:56:06.399853 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:56:06.401200 [info ] [MainThread]: 
[0m04:56:06.407407 [debug] [Thread-1 (]: Began running node model.stock_dbt.stock_prices
[0m04:56:06.409358 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stock_prices ............................. [RUN]
[0m04:56:06.411002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now model.stock_dbt.stock_prices)
[0m04:56:06.411807 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.stock_prices
[0m04:56:06.417580 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.stock_prices"
[0m04:56:06.426643 [debug] [Thread-1 (]: Began executing node model.stock_dbt.stock_prices
[0m04:56:06.447171 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.stock_prices"
[0m04:56:06.458746 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.stock_prices"
[0m04:56:06.459625 [debug] [Thread-1 (]: On model.stock_dbt.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.stock_prices"} */
create or replace   view dev.analytics.stock_prices
  
   as (
    SELECT
    symbol,
    date,
    open,
    high,
    low,
    close,
    volume
FROM dev.raw_data.stock_prices
  );
[0m04:56:06.460521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:06.521263 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.569 seconds
[0m04:56:06.538788 [debug] [Thread-1 (]: On model.stock_dbt.stock_prices: Close
[0m04:56:06.660365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29140f42-e708-48b7-80d5-fcf5f99ea5a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26fddc9dc0>]}
[0m04:56:06.662845 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stock_prices ........................ [[32mSUCCESS 1[0m in 0.76s]
[0m04:56:06.664942 [debug] [Thread-1 (]: Finished running node model.stock_dbt.stock_prices
[0m04:56:06.667024 [debug] [Thread-1 (]: Began running node model.stock_dbt.avg_true_range
[0m04:56:06.668565 [info ] [Thread-1 (]: 2 of 5 START sql view model analytics.avg_true_range ........................... [RUN]
[0m04:56:06.670062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.stock_prices, now model.stock_dbt.avg_true_range)
[0m04:56:06.671659 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.avg_true_range
[0m04:56:06.675189 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.avg_true_range"
[0m04:56:06.682365 [debug] [Thread-1 (]: Began executing node model.stock_dbt.avg_true_range
[0m04:56:06.684904 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.avg_true_range"
[0m04:56:06.696576 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.avg_true_range"
[0m04:56:06.697708 [debug] [Thread-1 (]: On model.stock_dbt.avg_true_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.avg_true_range"} */
create or replace   view dev.analytics.avg_true_range
  
   as (
    WITH averageTrueRanges AS (
    SELECT
        date,
        symbol,
        close,
        ABS(close - LAG(close) OVER (PARTITION BY symbol ORDER BY date)) AS true_range
    FROM dev.analytics.stock_prices
),
atr AS (
    SELECT
        date,
        symbol,
        AVG(true_range) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS atr_14d
    FROM averageTrueRanges
)
SELECT 
    date, 
    symbol, 
    COALESCE(atr_14d, 0) AS atr_14d
FROM atr
ORDER BY date, symbol
  );
[0m04:56:06.698663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:07.102121 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.642 seconds
[0m04:56:07.120140 [debug] [Thread-1 (]: On model.stock_dbt.stock_prices: Close
[0m04:56:07.247470 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29dbe75e-6758-4ce6-afd1-d6782603057d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c3dd5a000>]}
[0m04:56:07.249041 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stock_prices ........................ [[32mSUCCESS 1[0m in 0.84s]
[0m04:56:07.250657 [debug] [Thread-1 (]: Finished running node model.stock_dbt.stock_prices
[0m04:56:07.253597 [debug] [Thread-1 (]: Began running node model.stock_dbt.avg_true_range
[0m04:56:07.255364 [info ] [Thread-1 (]: 2 of 5 START sql view model analytics.avg_true_range ........................... [RUN]
[0m04:56:07.256714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.stock_prices, now model.stock_dbt.avg_true_range)
[0m04:56:07.257894 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.avg_true_range
[0m04:56:07.260533 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.avg_true_range"
[0m04:56:07.268542 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.570 seconds
[0m04:56:07.268651 [debug] [Thread-1 (]: Began executing node model.stock_dbt.avg_true_range
[0m04:56:07.271564 [debug] [Thread-1 (]: On model.stock_dbt.avg_true_range: Close
[0m04:56:07.271855 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.avg_true_range"
[0m04:56:07.286305 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.avg_true_range"
[0m04:56:07.287328 [debug] [Thread-1 (]: On model.stock_dbt.avg_true_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.avg_true_range"} */
create or replace   view dev.analytics.avg_true_range
  
   as (
    WITH averageTrueRanges AS (
    SELECT
        date,
        symbol,
        close,
        ABS(close - LAG(close) OVER (PARTITION BY symbol ORDER BY date)) AS true_range
    FROM dev.analytics.stock_prices
),
atr AS (
    SELECT
        date,
        symbol,
        AVG(true_range) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS atr_14d
    FROM averageTrueRanges
)
SELECT 
    date, 
    symbol, 
    COALESCE(atr_14d, 0) AS atr_14d
FROM atr
ORDER BY date, symbol
  );
[0m04:56:07.288940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:07.394180 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29140f42-e708-48b7-80d5-fcf5f99ea5a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f269edab9b0>]}
[0m04:56:07.396231 [info ] [Thread-1 (]: 2 of 5 OK created sql view model analytics.avg_true_range ...................... [[32mSUCCESS 1[0m in 0.72s]
[0m04:56:07.398460 [debug] [Thread-1 (]: Finished running node model.stock_dbt.avg_true_range
[0m04:56:07.399941 [debug] [Thread-1 (]: Began running node model.stock_dbt.bollinger
[0m04:56:07.401227 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.bollinger ................................ [RUN]
[0m04:56:07.402649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.avg_true_range, now model.stock_dbt.bollinger)
[0m04:56:07.404062 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.bollinger
[0m04:56:07.407175 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.bollinger"
[0m04:56:07.416538 [debug] [Thread-1 (]: Began executing node model.stock_dbt.bollinger
[0m04:56:07.418941 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.bollinger"
[0m04:56:07.428237 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.bollinger"
[0m04:56:07.429520 [debug] [Thread-1 (]: On model.stock_dbt.bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.bollinger"} */
create or replace   view dev.analytics.bollinger
  
   as (
    WITH bollinger AS (
    SELECT
        symbol,
        date,
        close,
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) AS sma_20d,
        STDDEV(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) AS stddev_20d
    FROM dev.analytics.stock_prices
)

SELECT
    symbol,
    date,
    close,
    COALESCE(sma_20d, 0) AS sma_20d,
    COALESCE(sma_20d + (2 * stddev_20d), 0) AS upper_band,
    COALESCE(sma_20d - (2 * stddev_20d), 0) AS lower_band
FROM bollinger
ORDER BY symbol, date
  );
[0m04:56:07.430936 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:07.900501 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.611 seconds
[0m04:56:07.905759 [debug] [Thread-1 (]: On model.stock_dbt.avg_true_range: Close
[0m04:56:08.020305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29dbe75e-6758-4ce6-afd1-d6782603057d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c3dc7f770>]}
[0m04:56:08.023403 [info ] [Thread-1 (]: 2 of 5 OK created sql view model analytics.avg_true_range ...................... [[32mSUCCESS 1[0m in 0.76s]
[0m04:56:08.024332 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.593 seconds
[0m04:56:08.025880 [debug] [Thread-1 (]: Finished running node model.stock_dbt.avg_true_range
[0m04:56:08.027794 [debug] [Thread-1 (]: On model.stock_dbt.bollinger: Close
[0m04:56:08.027543 [debug] [Thread-1 (]: Began running node model.stock_dbt.bollinger
[0m04:56:08.029177 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.bollinger ................................ [RUN]
[0m04:56:08.031049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.avg_true_range, now model.stock_dbt.bollinger)
[0m04:56:08.032432 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.bollinger
[0m04:56:08.036117 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.bollinger"
[0m04:56:08.051906 [debug] [Thread-1 (]: Began executing node model.stock_dbt.bollinger
[0m04:56:08.054201 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.bollinger"
[0m04:56:08.067854 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.bollinger"
[0m04:56:08.069197 [debug] [Thread-1 (]: On model.stock_dbt.bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.bollinger"} */
create or replace   view dev.analytics.bollinger
  
   as (
    WITH bollinger AS (
    SELECT
        symbol,
        date,
        close,
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) AS sma_20d,
        STDDEV(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) AS stddev_20d
    FROM dev.analytics.stock_prices
)

SELECT
    symbol,
    date,
    close,
    COALESCE(sma_20d, 0) AS sma_20d,
    COALESCE(sma_20d + (2 * stddev_20d), 0) AS upper_band,
    COALESCE(sma_20d - (2 * stddev_20d), 0) AS lower_band
FROM bollinger
ORDER BY symbol, date
  );
[0m04:56:08.070026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:08.151199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29140f42-e708-48b7-80d5-fcf5f99ea5a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f269edad040>]}
[0m04:56:08.153670 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.bollinger ........................... [[32mSUCCESS 1[0m in 0.75s]
[0m04:56:08.155654 [debug] [Thread-1 (]: Finished running node model.stock_dbt.bollinger
[0m04:56:08.157776 [debug] [Thread-1 (]: Began running node model.stock_dbt.moving_average
[0m04:56:08.159768 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.moving_average ........................... [RUN]
[0m04:56:08.161940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.bollinger, now model.stock_dbt.moving_average)
[0m04:56:08.163245 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.moving_average
[0m04:56:08.165917 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.moving_average"
[0m04:56:08.181070 [debug] [Thread-1 (]: Began executing node model.stock_dbt.moving_average
[0m04:56:08.184878 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.moving_average"
[0m04:56:08.200206 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.moving_average"
[0m04:56:08.201810 [debug] [Thread-1 (]: On model.stock_dbt.moving_average: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.moving_average"} */
create or replace   view dev.analytics.moving_average
  
   as (
    WITH stock_data AS (
    SELECT
        symbol,
        date,
        close
    FROM dev.analytics.stock_prices -- assuming 'stock_prices' is the name of the raw table model in dbt
)

SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
    ) AS moving_avg_5d,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
    ) AS moving_avg_20d
FROM stock_data
ORDER BY symbol, date
  );
[0m04:56:08.202744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:08.695026 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.625 seconds
[0m04:56:08.698963 [debug] [Thread-1 (]: On model.stock_dbt.bollinger: Close
[0m04:56:08.775461 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.573 seconds
[0m04:56:08.779135 [debug] [Thread-1 (]: On model.stock_dbt.moving_average: Close
[0m04:56:08.861013 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29dbe75e-6758-4ce6-afd1-d6782603057d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c3dd73230>]}
[0m04:56:08.863677 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.bollinger ........................... [[32mSUCCESS 1[0m in 0.83s]
[0m04:56:08.865821 [debug] [Thread-1 (]: Finished running node model.stock_dbt.bollinger
[0m04:56:08.867508 [debug] [Thread-1 (]: Began running node model.stock_dbt.moving_average
[0m04:56:08.868848 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.moving_average ........................... [RUN]
[0m04:56:08.870204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.bollinger, now model.stock_dbt.moving_average)
[0m04:56:08.871433 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.moving_average
[0m04:56:08.875157 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.moving_average"
[0m04:56:08.890875 [debug] [Thread-1 (]: Began executing node model.stock_dbt.moving_average
[0m04:56:08.893988 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.moving_average"
[0m04:56:08.898178 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29140f42-e708-48b7-80d5-fcf5f99ea5a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f269edafcb0>]}
[0m04:56:08.899558 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.moving_average ...................... [[32mSUCCESS 1[0m in 0.74s]
[0m04:56:08.901109 [debug] [Thread-1 (]: Finished running node model.stock_dbt.moving_average
[0m04:56:08.901960 [debug] [Thread-1 (]: Began running node model.stock_dbt.rsi_calculation
[0m04:56:08.902799 [info ] [Thread-1 (]: 5 of 5 START sql view model analytics.rsi_calculation .......................... [RUN]
[0m04:56:08.904459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.moving_average, now model.stock_dbt.rsi_calculation)
[0m04:56:08.905747 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.rsi_calculation
[0m04:56:08.906902 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.moving_average"
[0m04:56:08.908280 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.rsi_calculation"
[0m04:56:08.908475 [debug] [Thread-1 (]: On model.stock_dbt.moving_average: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.moving_average"} */
create or replace   view dev.analytics.moving_average
  
   as (
    WITH stock_data AS (
    SELECT
        symbol,
        date,
        close
    FROM dev.analytics.stock_prices -- assuming 'stock_prices' is the name of the raw table model in dbt
)

SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
    ) AS moving_avg_5d,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
    ) AS moving_avg_20d
FROM stock_data
ORDER BY symbol, date
  );
[0m04:56:08.910163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:08.917604 [debug] [Thread-1 (]: Began executing node model.stock_dbt.rsi_calculation
[0m04:56:08.920250 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.rsi_calculation"
[0m04:56:08.930600 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.rsi_calculation"
[0m04:56:08.931918 [debug] [Thread-1 (]: On model.stock_dbt.rsi_calculation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.rsi_calculation"} */
create or replace   view dev.analytics.rsi_calculation
  
   as (
    WITH stock_data AS (
    SELECT
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM dev.analytics.stock_prices
),

price_changes AS (
    SELECT
        symbol,
        date,
        close,
        CASE 
            WHEN close > prev_close THEN close - prev_close
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close < prev_close THEN prev_close - close
            ELSE 0 
        END AS loss
    FROM stock_data
),

average_gains_losses AS (
    SELECT
        symbol,
        date,
        close,
        -- Calculate the average gain over the last 14 days, including the current row
        AVG(gain) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain,
        -- Calculate the average loss over the last 14 days, including the current row
        AVG(loss) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss
    FROM price_changes
)

SELECT
    symbol,
    date,
    close,
    avg_gain,
    avg_loss,
    -- Calculate RSI, using COALESCE to set to 0 if result is NULL
    COALESCE(100 - (100 / (1 + (NULLIF(avg_gain, 0) / NULLIF(avg_loss, 0)))), 0) AS rsi_14d
FROM average_gains_losses
ORDER BY symbol, date
  );
[0m04:56:08.933596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:09.594916 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.685 seconds
[0m04:56:09.600171 [debug] [Thread-1 (]: On model.stock_dbt.moving_average: Close
[0m04:56:09.667526 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.734 seconds
[0m04:56:09.670795 [debug] [Thread-1 (]: On model.stock_dbt.rsi_calculation: Close
[0m04:56:09.724508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29dbe75e-6758-4ce6-afd1-d6782603057d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c9cba5eb0>]}
[0m04:56:09.726806 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.moving_average ...................... [[32mSUCCESS 1[0m in 0.85s]
[0m04:56:09.728805 [debug] [Thread-1 (]: Finished running node model.stock_dbt.moving_average
[0m04:56:09.730858 [debug] [Thread-1 (]: Began running node model.stock_dbt.rsi_calculation
[0m04:56:09.732592 [info ] [Thread-1 (]: 5 of 5 START sql view model analytics.rsi_calculation .......................... [RUN]
[0m04:56:09.734350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.moving_average, now model.stock_dbt.rsi_calculation)
[0m04:56:09.736201 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.rsi_calculation
[0m04:56:09.739785 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.rsi_calculation"
[0m04:56:09.753313 [debug] [Thread-1 (]: Began executing node model.stock_dbt.rsi_calculation
[0m04:56:09.756148 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.rsi_calculation"
[0m04:56:09.769089 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.rsi_calculation"
[0m04:56:09.770032 [debug] [Thread-1 (]: On model.stock_dbt.rsi_calculation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.rsi_calculation"} */
create or replace   view dev.analytics.rsi_calculation
  
   as (
    WITH stock_data AS (
    SELECT
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM dev.analytics.stock_prices
),

price_changes AS (
    SELECT
        symbol,
        date,
        close,
        CASE 
            WHEN close > prev_close THEN close - prev_close
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close < prev_close THEN prev_close - close
            ELSE 0 
        END AS loss
    FROM stock_data
),

average_gains_losses AS (
    SELECT
        symbol,
        date,
        close,
        -- Calculate the average gain over the last 14 days, including the current row
        AVG(gain) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain,
        -- Calculate the average loss over the last 14 days, including the current row
        AVG(loss) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss
    FROM price_changes
)

SELECT
    symbol,
    date,
    close,
    avg_gain,
    avg_loss,
    -- Calculate RSI, using COALESCE to set to 0 if result is NULL
    COALESCE(100 - (100 / (1 + (NULLIF(avg_gain, 0) / NULLIF(avg_loss, 0)))), 0) AS rsi_14d
FROM average_gains_losses
ORDER BY symbol, date
  );
[0m04:56:09.771079 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:09.787907 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29140f42-e708-48b7-80d5-fcf5f99ea5a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f269f81ae40>]}
[0m04:56:09.789838 [info ] [Thread-1 (]: 5 of 5 OK created sql view model analytics.rsi_calculation ..................... [[32mSUCCESS 1[0m in 0.88s]
[0m04:56:09.791663 [debug] [Thread-1 (]: Finished running node model.stock_dbt.rsi_calculation
[0m04:56:09.793373 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:56:09.794521 [debug] [MainThread]: Connection 'model.stock_dbt.rsi_calculation' was properly closed.
[0m04:56:09.795365 [info ] [MainThread]: 
[0m04:56:09.796413 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 5.83 seconds (5.83s).
[0m04:56:09.797923 [debug] [MainThread]: Command end result
[0m04:56:09.850217 [info ] [MainThread]: 
[0m04:56:09.851525 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:56:09.854056 [info ] [MainThread]: 
[0m04:56:09.855512 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m04:56:09.857786 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.362506, "process_user_time": 3.041782, "process_kernel_time": 2.914223, "process_mem_max_rss": "245984", "process_in_blocks": "43136", "process_out_blocks": "8"}
[0m04:56:09.859580 [debug] [MainThread]: Command `dbt run` succeeded at 04:56:09.859507 after 7.36 seconds
[0m04:56:09.861088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26fd626f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f269fef8590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26fd5fe300>]}
[0m04:56:09.862150 [debug] [MainThread]: Flushing usage events
[0m04:56:10.347868 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.577 seconds
[0m04:56:10.350572 [debug] [Thread-1 (]: On model.stock_dbt.rsi_calculation: Close
[0m04:56:10.473356 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29dbe75e-6758-4ce6-afd1-d6782603057d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c3e96b1d0>]}
[0m04:56:10.474871 [info ] [Thread-1 (]: 5 of 5 OK created sql view model analytics.rsi_calculation ..................... [[32mSUCCESS 1[0m in 0.74s]
[0m04:56:10.476274 [debug] [Thread-1 (]: Finished running node model.stock_dbt.rsi_calculation
[0m04:56:10.477661 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:56:10.479063 [debug] [MainThread]: Connection 'model.stock_dbt.rsi_calculation' was properly closed.
[0m04:56:10.480699 [info ] [MainThread]: 
[0m04:56:10.481585 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 5.77 seconds (5.77s).
[0m04:56:10.483317 [debug] [MainThread]: Command end result
[0m04:56:10.534213 [info ] [MainThread]: 
[0m04:56:10.536231 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:56:10.537121 [info ] [MainThread]: 
[0m04:56:10.537964 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m04:56:10.539091 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.0301313, "process_user_time": 2.965286, "process_kernel_time": 2.904975, "process_mem_max_rss": "263680", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m04:56:10.540508 [debug] [MainThread]: Command `dbt run` succeeded at 04:56:10.540416 after 7.03 seconds
[0m04:56:10.541485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c9d11a120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c9bf83a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c9c6121b0>]}
[0m04:56:10.542733 [debug] [MainThread]: Flushing usage events
[0m04:56:11.889634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22bef36120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22beb54e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22bebe23c0>]}


============================== 04:56:11.894935 | 8f8e3f12-5bcb-48eb-8a31-d272bf32a57c ==============================
[0m04:56:11.894935 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:56:11.896130 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/stock_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/stock_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/stock_dbt --project-dir /opt/airflow/stock_dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:56:12.493162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f8e3f12-5bcb-48eb-8a31-d272bf32a57c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22656e6780>]}
[0m04:56:12.528586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f8e3f12-5bcb-48eb-8a31-d272bf32a57c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2265ed3ce0>]}
[0m04:56:12.531694 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:56:12.541740 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:56:12.566805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2bed06090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2bed061e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2bf62c740>]}


============================== 04:56:12.571757 | 0826a719-2c89-4427-b367-ac6a91ce7d3b ==============================
[0m04:56:12.571757 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:56:12.573852 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/stock_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/stock_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/stock_dbt --project-dir /opt/airflow/stock_dbt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:56:12.892302 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:56:12.894077 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:56:12.899203 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.stock_prediction
- models.stock_prediction.raw_data
- models.stock_prediction.tranformations
[0m04:56:12.932737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f8e3f12-5bcb-48eb-8a31-d272bf32a57c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f226526a8d0>]}
[0m04:56:13.091371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f8e3f12-5bcb-48eb-8a31-d272bf32a57c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22654480b0>]}
[0m04:56:13.093746 [info ] [MainThread]: Found 5 models, 4 snapshots, 27 data tests, 1 source, 459 macros
[0m04:56:13.096125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f8e3f12-5bcb-48eb-8a31-d272bf32a57c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22bea68980>]}
[0m04:56:13.099646 [info ] [MainThread]: 
[0m04:56:13.101570 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:56:13.106022 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_snapshot'
[0m04:56:13.118658 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m04:56:13.120682 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m04:56:13.122503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:56:13.177630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0826a719-2c89-4427-b367-ac6a91ce7d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff26d23c320>]}
[0m04:56:13.213804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0826a719-2c89-4427-b367-ac6a91ce7d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff267bdbf50>]}
[0m04:56:13.216483 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:56:13.228835 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:56:13.489650 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.367 seconds
[0m04:56:13.492585 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m04:56:13.551239 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:56:13.553134 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:56:13.558378 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.stock_prediction
- models.stock_prediction.tranformations
- models.stock_prediction.raw_data
[0m04:56:13.591419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0826a719-2c89-4427-b367-ac6a91ce7d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2654fede0>]}
[0m04:56:13.612320 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m04:56:13.615794 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m04:56:13.618634 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m04:56:13.620790 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:56:13.754919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0826a719-2c89-4427-b367-ac6a91ce7d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff264f4ea20>]}
[0m04:56:13.757973 [info ] [MainThread]: Found 5 models, 4 snapshots, 27 data tests, 1 source, 459 macros
[0m04:56:13.760286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0826a719-2c89-4427-b367-ac6a91ce7d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2be919d30>]}
[0m04:56:13.764474 [info ] [MainThread]: 
[0m04:56:13.767089 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:56:13.772638 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_analytics'
[0m04:56:13.785977 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m04:56:13.788928 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m04:56:13.791836 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:56:14.060156 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.441 seconds
[0m04:56:14.063589 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m04:56:14.187286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f8e3f12-5bcb-48eb-8a31-d272bf32a57c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2264f475f0>]}
[0m04:56:14.189490 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:56:14.191498 [info ] [MainThread]: 
[0m04:56:14.199735 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m04:56:14.201485 [info ] [Thread-1 (]: 1 of 27 START test not_null_avg_true_range_atr_14d ............................. [RUN]
[0m04:56:14.203239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad)
[0m04:56:14.205027 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m04:56:14.217245 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad"
[0m04:56:14.236236 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m04:56:14.246153 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.456 seconds
[0m04:56:14.248776 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m04:56:14.250817 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad"
[0m04:56:14.266129 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad"
[0m04:56:14.267134 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select atr_14d
from dev.analytics.avg_true_range
where atr_14d is null



      
    ) dbt_internal_test
[0m04:56:14.267974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:14.384661 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m04:56:14.388373 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m04:56:14.390185 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m04:56:14.391921 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:56:14.766232 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.374 seconds
[0m04:56:14.769524 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m04:56:14.906125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0826a719-2c89-4427-b367-ac6a91ce7d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff265660980>]}
[0m04:56:14.908373 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:56:14.910060 [info ] [MainThread]: 
[0m04:56:14.918490 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m04:56:14.920515 [info ] [Thread-1 (]: 1 of 27 START test not_null_avg_true_range_atr_14d ............................. [RUN]
[0m04:56:14.922495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad)
[0m04:56:14.924457 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m04:56:14.936397 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad"
[0m04:56:14.955362 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m04:56:14.969709 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad"
[0m04:56:14.992914 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad"
[0m04:56:14.994880 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select atr_14d
from dev.analytics.avg_true_range
where atr_14d is null



      
    ) dbt_internal_test
[0m04:56:14.996444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:15.285960 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.018 seconds
[0m04:56:15.296778 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad: Close
[0m04:56:15.425094 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.428 seconds
[0m04:56:15.426644 [info ] [Thread-1 (]: 1 of 27 PASS not_null_avg_true_range_atr_14d ................................... [[32mPASS[0m in 1.22s]
[0m04:56:15.429283 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m04:56:15.431414 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_avg_true_range_date.4e418b835d
[0m04:56:15.432849 [info ] [Thread-1 (]: 2 of 27 START test not_null_avg_true_range_date ................................ [RUN]
[0m04:56:15.434690 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad: Close
[0m04:56:15.434887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad, now test.stock_dbt.not_null_avg_true_range_date.4e418b835d)
[0m04:56:15.436018 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_avg_true_range_date.4e418b835d
[0m04:56:15.439959 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_avg_true_range_date.4e418b835d"
[0m04:56:15.453562 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_avg_true_range_date.4e418b835d
[0m04:56:15.456308 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_avg_true_range_date.4e418b835d"
[0m04:56:15.474568 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_avg_true_range_date.4e418b835d"
[0m04:56:15.476684 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_date.4e418b835d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_avg_true_range_date.4e418b835d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.avg_true_range
where date is null



      
    ) dbt_internal_test
[0m04:56:15.478280 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:15.549032 [info ] [Thread-1 (]: 1 of 27 PASS not_null_avg_true_range_atr_14d ................................... [[32mPASS[0m in 0.63s]
[0m04:56:15.551050 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m04:56:15.552369 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_avg_true_range_date.4e418b835d
[0m04:56:15.553819 [info ] [Thread-1 (]: 2 of 27 START test not_null_avg_true_range_date ................................ [RUN]
[0m04:56:15.555178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad, now test.stock_dbt.not_null_avg_true_range_date.4e418b835d)
[0m04:56:15.557085 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_avg_true_range_date.4e418b835d
[0m04:56:15.560962 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_avg_true_range_date.4e418b835d"
[0m04:56:15.578307 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_avg_true_range_date.4e418b835d
[0m04:56:15.580829 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_avg_true_range_date.4e418b835d"
[0m04:56:15.591525 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_avg_true_range_date.4e418b835d"
[0m04:56:15.592547 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_date.4e418b835d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_avg_true_range_date.4e418b835d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.avg_true_range
where date is null



      
    ) dbt_internal_test
[0m04:56:15.593884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:16.042624 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.564 seconds
[0m04:56:16.049614 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_date.4e418b835d: Close
[0m04:56:16.052936 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.459 seconds
[0m04:56:16.057592 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_date.4e418b835d: Close
[0m04:56:16.159348 [info ] [Thread-1 (]: 2 of 27 PASS not_null_avg_true_range_date ...................................... [[32mPASS[0m in 0.72s]
[0m04:56:16.161122 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_avg_true_range_date.4e418b835d
[0m04:56:16.162741 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1
[0m04:56:16.164119 [info ] [Thread-1 (]: 3 of 27 START test not_null_avg_true_range_symbol .............................. [RUN]
[0m04:56:16.165914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_avg_true_range_date.4e418b835d, now test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1)
[0m04:56:16.167338 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1
[0m04:56:16.168292 [info ] [Thread-1 (]: 2 of 27 PASS not_null_avg_true_range_date ...................................... [[32mPASS[0m in 0.61s]
[0m04:56:16.169873 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_avg_true_range_date.4e418b835d
[0m04:56:16.171146 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1
[0m04:56:16.171105 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1"
[0m04:56:16.172545 [info ] [Thread-1 (]: 3 of 27 START test not_null_avg_true_range_symbol .............................. [RUN]
[0m04:56:16.173946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_avg_true_range_date.4e418b835d, now test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1)
[0m04:56:16.175894 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1
[0m04:56:16.180404 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1"
[0m04:56:16.183503 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1
[0m04:56:16.185047 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1
[0m04:56:16.186296 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1"
[0m04:56:16.187928 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1"
[0m04:56:16.192954 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1"
[0m04:56:16.193926 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.avg_true_range
where symbol is null



      
    ) dbt_internal_test
[0m04:56:16.193852 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1"
[0m04:56:16.195079 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.avg_true_range
where symbol is null



      
    ) dbt_internal_test
[0m04:56:16.195154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:16.196600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:16.596338 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.400 seconds
[0m04:56:16.600631 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1: Close
[0m04:56:16.660923 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.466 seconds
[0m04:56:16.663375 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1: Close
[0m04:56:16.723535 [info ] [Thread-1 (]: 3 of 27 PASS not_null_avg_true_range_symbol .................................... [[32mPASS[0m in 0.55s]
[0m04:56:16.725770 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1
[0m04:56:16.727365 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_close.4ccb16a429
[0m04:56:16.729331 [info ] [Thread-1 (]: 4 of 27 START test not_null_bollinger_close .................................... [RUN]
[0m04:56:16.731235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1, now test.stock_dbt.not_null_bollinger_close.4ccb16a429)
[0m04:56:16.733055 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_close.4ccb16a429
[0m04:56:16.737409 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_close.4ccb16a429"
[0m04:56:16.757747 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_close.4ccb16a429
[0m04:56:16.760684 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_close.4ccb16a429"
[0m04:56:16.777051 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_close.4ccb16a429"
[0m04:56:16.778618 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_close.4ccb16a429: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_close.4ccb16a429"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.bollinger
where close is null



      
    ) dbt_internal_test
[0m04:56:16.780334 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:16.805142 [info ] [Thread-1 (]: 3 of 27 PASS not_null_avg_true_range_symbol .................................... [[32mPASS[0m in 0.64s]
[0m04:56:16.807674 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1
[0m04:56:16.809448 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_close.4ccb16a429
[0m04:56:16.811054 [info ] [Thread-1 (]: 4 of 27 START test not_null_bollinger_close .................................... [RUN]
[0m04:56:16.812607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1, now test.stock_dbt.not_null_bollinger_close.4ccb16a429)
[0m04:56:16.814236 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_close.4ccb16a429
[0m04:56:16.818488 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_close.4ccb16a429"
[0m04:56:16.837545 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_close.4ccb16a429
[0m04:56:16.841001 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_close.4ccb16a429"
[0m04:56:16.861785 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_close.4ccb16a429"
[0m04:56:16.863770 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_close.4ccb16a429: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_close.4ccb16a429"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.bollinger
where close is null



      
    ) dbt_internal_test
[0m04:56:16.865617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:17.253252 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.473 seconds
[0m04:56:17.256004 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_close.4ccb16a429: Close
[0m04:56:17.290748 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.425 seconds
[0m04:56:17.293859 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_close.4ccb16a429: Close
[0m04:56:17.367671 [info ] [Thread-1 (]: 4 of 27 PASS not_null_bollinger_close .......................................... [[32mPASS[0m in 0.64s]
[0m04:56:17.369581 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_close.4ccb16a429
[0m04:56:17.371061 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_date.9d77bdd20c
[0m04:56:17.373231 [info ] [Thread-1 (]: 5 of 27 START test not_null_bollinger_date ..................................... [RUN]
[0m04:56:17.374902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_close.4ccb16a429, now test.stock_dbt.not_null_bollinger_date.9d77bdd20c)
[0m04:56:17.375932 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_date.9d77bdd20c
[0m04:56:17.380012 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_date.9d77bdd20c"
[0m04:56:17.399238 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_date.9d77bdd20c
[0m04:56:17.402455 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_date.9d77bdd20c"
[0m04:56:17.417818 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_date.9d77bdd20c"
[0m04:56:17.419559 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_date.9d77bdd20c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_date.9d77bdd20c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.bollinger
where date is null



      
    ) dbt_internal_test
[0m04:56:17.420958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:17.426898 [info ] [Thread-1 (]: 4 of 27 PASS not_null_bollinger_close .......................................... [[32mPASS[0m in 0.61s]
[0m04:56:17.428671 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_close.4ccb16a429
[0m04:56:17.430086 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_date.9d77bdd20c
[0m04:56:17.431383 [info ] [Thread-1 (]: 5 of 27 START test not_null_bollinger_date ..................................... [RUN]
[0m04:56:17.432799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_close.4ccb16a429, now test.stock_dbt.not_null_bollinger_date.9d77bdd20c)
[0m04:56:17.433995 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_date.9d77bdd20c
[0m04:56:17.438108 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_date.9d77bdd20c"
[0m04:56:17.451392 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_date.9d77bdd20c
[0m04:56:17.454334 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_date.9d77bdd20c"
[0m04:56:17.473421 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_date.9d77bdd20c"
[0m04:56:17.475007 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_date.9d77bdd20c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_date.9d77bdd20c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.bollinger
where date is null



      
    ) dbt_internal_test
[0m04:56:17.476508 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:17.826269 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.405 seconds
[0m04:56:17.831360 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_date.9d77bdd20c: Close
[0m04:56:17.862176 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.386 seconds
[0m04:56:17.865530 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_date.9d77bdd20c: Close
[0m04:56:17.935162 [info ] [Thread-1 (]: 5 of 27 PASS not_null_bollinger_date ........................................... [[32mPASS[0m in 0.56s]
[0m04:56:17.938186 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_date.9d77bdd20c
[0m04:56:17.940113 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e
[0m04:56:17.942073 [info ] [Thread-1 (]: 6 of 27 START test not_null_bollinger_lower_band ............................... [RUN]
[0m04:56:17.944706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_date.9d77bdd20c, now test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e)
[0m04:56:17.949049 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e
[0m04:56:17.958163 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e"
[0m04:56:17.982419 [info ] [Thread-1 (]: 5 of 27 PASS not_null_bollinger_date ........................................... [[32mPASS[0m in 0.55s]
[0m04:56:17.983686 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e
[0m04:56:17.984651 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_date.9d77bdd20c
[0m04:56:17.986072 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e
[0m04:56:17.987075 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e"
[0m04:56:17.987507 [info ] [Thread-1 (]: 6 of 27 START test not_null_bollinger_lower_band ............................... [RUN]
[0m04:56:17.989276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_date.9d77bdd20c, now test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e)
[0m04:56:17.991131 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e
[0m04:56:17.995849 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e"
[0m04:56:18.005048 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e"
[0m04:56:18.007215 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select lower_band
from dev.analytics.bollinger
where lower_band is null



      
    ) dbt_internal_test
[0m04:56:18.008777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:18.012400 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e
[0m04:56:18.015647 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e"
[0m04:56:18.028167 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e"
[0m04:56:18.029196 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select lower_band
from dev.analytics.bollinger
where lower_band is null



      
    ) dbt_internal_test
[0m04:56:18.030432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:18.420287 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.411 seconds
[0m04:56:18.423883 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e: Close
[0m04:56:18.428649 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.398 seconds
[0m04:56:18.431760 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e: Close
[0m04:56:18.545643 [info ] [Thread-1 (]: 6 of 27 PASS not_null_bollinger_lower_band ..................................... [[32mPASS[0m in 0.60s]
[0m04:56:18.548081 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e
[0m04:56:18.553286 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3
[0m04:56:18.553631 [info ] [Thread-1 (]: 6 of 27 PASS not_null_bollinger_lower_band ..................................... [[32mPASS[0m in 0.56s]
[0m04:56:18.555011 [info ] [Thread-1 (]: 7 of 27 START test not_null_bollinger_sma_20d .................................. [RUN]
[0m04:56:18.555512 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e
[0m04:56:18.556709 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e, now test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3)
[0m04:56:18.556962 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3
[0m04:56:18.558183 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3
[0m04:56:18.558561 [info ] [Thread-1 (]: 7 of 27 START test not_null_bollinger_sma_20d .................................. [RUN]
[0m04:56:18.560104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e, now test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3)
[0m04:56:18.561420 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3
[0m04:56:18.562361 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3"
[0m04:56:18.565571 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3"
[0m04:56:18.574260 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3
[0m04:56:18.584250 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3
[0m04:56:18.585271 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3"
[0m04:56:18.587136 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3"
[0m04:56:18.600085 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3"
[0m04:56:18.601473 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sma_20d
from dev.analytics.bollinger
where sma_20d is null



      
    ) dbt_internal_test
[0m04:56:18.603494 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3"
[0m04:56:18.607147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:18.612002 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sma_20d
from dev.analytics.bollinger
where sma_20d is null



      
    ) dbt_internal_test
[0m04:56:18.614983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:19.072537 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.457 seconds
[0m04:56:19.072538 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.465 seconds
[0m04:56:19.075601 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3: Close
[0m04:56:19.075589 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3: Close
[0m04:56:19.196758 [info ] [Thread-1 (]: 7 of 27 PASS not_null_bollinger_sma_20d ........................................ [[32mPASS[0m in 0.64s]
[0m04:56:19.199187 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3
[0m04:56:19.201307 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_symbol.a932e30f82
[0m04:56:19.203756 [info ] [Thread-1 (]: 8 of 27 START test not_null_bollinger_symbol ................................... [RUN]
[0m04:56:19.206226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3, now test.stock_dbt.not_null_bollinger_symbol.a932e30f82)
[0m04:56:19.208477 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_symbol.a932e30f82
[0m04:56:19.212867 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_symbol.a932e30f82"
[0m04:56:19.234885 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_symbol.a932e30f82
[0m04:56:19.238208 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_symbol.a932e30f82"
[0m04:56:19.251361 [info ] [Thread-1 (]: 7 of 27 PASS not_null_bollinger_sma_20d ........................................ [[32mPASS[0m in 0.69s]
[0m04:56:19.253363 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3
[0m04:56:19.254848 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_symbol.a932e30f82
[0m04:56:19.256354 [info ] [Thread-1 (]: 8 of 27 START test not_null_bollinger_symbol ................................... [RUN]
[0m04:56:19.256780 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_symbol.a932e30f82"
[0m04:56:19.257995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3, now test.stock_dbt.not_null_bollinger_symbol.a932e30f82)
[0m04:56:19.258354 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_symbol.a932e30f82: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_symbol.a932e30f82"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.bollinger
where symbol is null



      
    ) dbt_internal_test
[0m04:56:19.259261 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_symbol.a932e30f82
[0m04:56:19.260228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:19.263710 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_symbol.a932e30f82"
[0m04:56:19.279381 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_symbol.a932e30f82
[0m04:56:19.282478 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_symbol.a932e30f82"
[0m04:56:19.298489 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_symbol.a932e30f82"
[0m04:56:19.300341 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_symbol.a932e30f82: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_symbol.a932e30f82"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.bollinger
where symbol is null



      
    ) dbt_internal_test
[0m04:56:19.302000 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:19.792044 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.532 seconds
[0m04:56:19.795672 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_symbol.a932e30f82: Close
[0m04:56:19.796365 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.494 seconds
[0m04:56:19.798933 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_symbol.a932e30f82: Close
[0m04:56:19.905188 [info ] [Thread-1 (]: 8 of 27 PASS not_null_bollinger_symbol ......................................... [[32mPASS[0m in 0.70s]
[0m04:56:19.909478 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_symbol.a932e30f82
[0m04:56:19.913279 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_upper_band.e4db87564c
[0m04:56:19.913369 [info ] [Thread-1 (]: 8 of 27 PASS not_null_bollinger_symbol ......................................... [[32mPASS[0m in 0.66s]
[0m04:56:19.916396 [info ] [Thread-1 (]: 9 of 27 START test not_null_bollinger_upper_band ............................... [RUN]
[0m04:56:19.916711 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_symbol.a932e30f82
[0m04:56:19.917966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_symbol.a932e30f82, now test.stock_dbt.not_null_bollinger_upper_band.e4db87564c)
[0m04:56:19.918198 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_upper_band.e4db87564c
[0m04:56:19.920990 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_upper_band.e4db87564c
[0m04:56:19.921566 [info ] [Thread-1 (]: 9 of 27 START test not_null_bollinger_upper_band ............................... [RUN]
[0m04:56:19.923643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_symbol.a932e30f82, now test.stock_dbt.not_null_bollinger_upper_band.e4db87564c)
[0m04:56:19.925405 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_upper_band.e4db87564c
[0m04:56:19.925699 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_upper_band.e4db87564c"
[0m04:56:19.929538 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_upper_band.e4db87564c"
[0m04:56:19.936525 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_upper_band.e4db87564c
[0m04:56:19.938890 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_upper_band.e4db87564c
[0m04:56:19.939958 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_upper_band.e4db87564c"
[0m04:56:19.941857 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_upper_band.e4db87564c"
[0m04:56:19.953618 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_upper_band.e4db87564c"
[0m04:56:19.955972 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_upper_band.e4db87564c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_upper_band.e4db87564c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select upper_band
from dev.analytics.bollinger
where upper_band is null



      
    ) dbt_internal_test
[0m04:56:19.957081 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_upper_band.e4db87564c"
[0m04:56:19.957902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:19.958982 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_upper_band.e4db87564c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_upper_band.e4db87564c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select upper_band
from dev.analytics.bollinger
where upper_band is null



      
    ) dbt_internal_test
[0m04:56:19.960933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:20.438447 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.477 seconds
[0m04:56:20.438971 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.481 seconds
[0m04:56:20.441756 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_upper_band.e4db87564c: Close
[0m04:56:20.441597 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_upper_band.e4db87564c: Close
[0m04:56:20.556187 [info ] [Thread-1 (]: 9 of 27 PASS not_null_bollinger_upper_band ..................................... [[32mPASS[0m in 0.63s]
[0m04:56:20.557673 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_upper_band.e4db87564c
[0m04:56:20.558778 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_close.6d037dd588
[0m04:56:20.559801 [info ] [Thread-1 (]: 10 of 27 START test not_null_moving_average_close .............................. [RUN]
[0m04:56:20.561170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_upper_band.e4db87564c, now test.stock_dbt.not_null_moving_average_close.6d037dd588)
[0m04:56:20.562719 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_close.6d037dd588
[0m04:56:20.562555 [info ] [Thread-1 (]: 9 of 27 PASS not_null_bollinger_upper_band ..................................... [[32mPASS[0m in 0.64s]
[0m04:56:20.564035 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_upper_band.e4db87564c
[0m04:56:20.565318 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_close.6d037dd588
[0m04:56:20.566744 [info ] [Thread-1 (]: 10 of 27 START test not_null_moving_average_close .............................. [RUN]
[0m04:56:20.566836 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_close.6d037dd588"
[0m04:56:20.568005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_upper_band.e4db87564c, now test.stock_dbt.not_null_moving_average_close.6d037dd588)
[0m04:56:20.568996 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_close.6d037dd588
[0m04:56:20.572757 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_close.6d037dd588"
[0m04:56:20.576585 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_close.6d037dd588
[0m04:56:20.579401 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_close.6d037dd588"
[0m04:56:20.581961 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_close.6d037dd588
[0m04:56:20.587608 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_close.6d037dd588"
[0m04:56:20.597325 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_close.6d037dd588"
[0m04:56:20.598932 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_close.6d037dd588: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_close.6d037dd588"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.moving_average
where close is null



      
    ) dbt_internal_test
[0m04:56:20.599959 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_close.6d037dd588"
[0m04:56:20.600247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:20.601573 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_close.6d037dd588: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_close.6d037dd588"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.moving_average
where close is null



      
    ) dbt_internal_test
[0m04:56:20.603361 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:21.000709 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.397 seconds
[0m04:56:21.004031 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_close.6d037dd588: Close
[0m04:56:21.023959 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.424 seconds
[0m04:56:21.026418 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_close.6d037dd588: Close
[0m04:56:21.122417 [info ] [Thread-1 (]: 10 of 27 PASS not_null_moving_average_close .................................... [[32mPASS[0m in 0.55s]
[0m04:56:21.125031 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_close.6d037dd588
[0m04:56:21.127019 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_date.3ad00158b5
[0m04:56:21.128964 [info ] [Thread-1 (]: 11 of 27 START test not_null_moving_average_date ............................... [RUN]
[0m04:56:21.130727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_close.6d037dd588, now test.stock_dbt.not_null_moving_average_date.3ad00158b5)
[0m04:56:21.132659 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_date.3ad00158b5
[0m04:56:21.137141 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_date.3ad00158b5"
[0m04:56:21.152375 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_date.3ad00158b5
[0m04:56:21.154012 [info ] [Thread-1 (]: 10 of 27 PASS not_null_moving_average_close .................................... [[32mPASS[0m in 0.59s]
[0m04:56:21.155915 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_close.6d037dd588
[0m04:56:21.156018 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_date.3ad00158b5"
[0m04:56:21.157559 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_date.3ad00158b5
[0m04:56:21.159665 [info ] [Thread-1 (]: 11 of 27 START test not_null_moving_average_date ............................... [RUN]
[0m04:56:21.161649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_close.6d037dd588, now test.stock_dbt.not_null_moving_average_date.3ad00158b5)
[0m04:56:21.162853 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_date.3ad00158b5
[0m04:56:21.167442 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_date.3ad00158b5"
[0m04:56:21.173271 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_date.3ad00158b5"
[0m04:56:21.177516 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_date.3ad00158b5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_date.3ad00158b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.moving_average
where date is null



      
    ) dbt_internal_test
[0m04:56:21.179223 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:21.187020 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_date.3ad00158b5
[0m04:56:21.190173 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_date.3ad00158b5"
[0m04:56:21.206123 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_date.3ad00158b5"
[0m04:56:21.207542 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_date.3ad00158b5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_date.3ad00158b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.moving_average
where date is null



      
    ) dbt_internal_test
[0m04:56:21.208702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:21.613469 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.404 seconds
[0m04:56:21.612874 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.433 seconds
[0m04:56:21.618500 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_date.3ad00158b5: Close
[0m04:56:21.618364 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_date.3ad00158b5: Close
[0m04:56:21.747488 [info ] [Thread-1 (]: 11 of 27 PASS not_null_moving_average_date ..................................... [[32mPASS[0m in 0.59s]
[0m04:56:21.752032 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_date.3ad00158b5
[0m04:56:21.754476 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m04:56:21.756176 [info ] [Thread-1 (]: 12 of 27 START test not_null_moving_average_moving_avg_20d ..................... [RUN]
[0m04:56:21.757469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_date.3ad00158b5, now test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22)
[0m04:56:21.758900 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m04:56:21.759733 [info ] [Thread-1 (]: 11 of 27 PASS not_null_moving_average_date ..................................... [[32mPASS[0m in 0.63s]
[0m04:56:21.761379 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_date.3ad00158b5
[0m04:56:21.762582 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m04:56:21.763462 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m04:56:21.763981 [info ] [Thread-1 (]: 12 of 27 START test not_null_moving_average_moving_avg_20d ..................... [RUN]
[0m04:56:21.765786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_date.3ad00158b5, now test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22)
[0m04:56:21.767766 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m04:56:21.771955 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m04:56:21.776762 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m04:56:21.779311 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m04:56:21.780410 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m04:56:21.782295 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m04:56:21.790312 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m04:56:21.792107 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg_20d
from dev.analytics.moving_average
where moving_avg_20d is null



      
    ) dbt_internal_test
[0m04:56:21.792721 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m04:56:21.793847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:21.794438 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg_20d
from dev.analytics.moving_average
where moving_avg_20d is null



      
    ) dbt_internal_test
[0m04:56:21.796088 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:22.299189 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.505 seconds
[0m04:56:22.302124 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.506 seconds
[0m04:56:22.304153 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22: Close
[0m04:56:22.304784 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22: Close
[0m04:56:22.434005 [info ] [Thread-1 (]: 12 of 27 PASS not_null_moving_average_moving_avg_20d ........................... [[32mPASS[0m in 0.68s]
[0m04:56:22.434994 [info ] [Thread-1 (]: 12 of 27 PASS not_null_moving_average_moving_avg_20d ........................... [[32mPASS[0m in 0.67s]
[0m04:56:22.435590 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m04:56:22.436544 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m04:56:22.436892 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m04:56:22.438588 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m04:56:22.438737 [info ] [Thread-1 (]: 13 of 27 START test not_null_moving_average_moving_avg_5d ...................... [RUN]
[0m04:56:22.440749 [info ] [Thread-1 (]: 13 of 27 START test not_null_moving_average_moving_avg_5d ...................... [RUN]
[0m04:56:22.441251 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22, now test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca)
[0m04:56:22.442504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22, now test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca)
[0m04:56:22.442796 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m04:56:22.444215 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m04:56:22.447102 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m04:56:22.448995 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m04:56:22.455732 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m04:56:22.458027 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m04:56:22.459172 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m04:56:22.461131 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m04:56:22.476163 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m04:56:22.477852 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg_5d
from dev.analytics.moving_average
where moving_avg_5d is null



      
    ) dbt_internal_test
[0m04:56:22.479157 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m04:56:22.479391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:22.480904 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg_5d
from dev.analytics.moving_average
where moving_avg_5d is null



      
    ) dbt_internal_test
[0m04:56:22.482165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:22.937307 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.458 seconds
[0m04:56:22.940125 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca: Close
[0m04:56:22.956055 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.474 seconds
[0m04:56:22.959892 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca: Close
[0m04:56:23.063940 [info ] [Thread-1 (]: 13 of 27 PASS not_null_moving_average_moving_avg_5d ............................ [[32mPASS[0m in 0.62s]
[0m04:56:23.066389 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m04:56:23.068372 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_symbol.75a6f7473c
[0m04:56:23.070202 [info ] [Thread-1 (]: 14 of 27 START test not_null_moving_average_symbol ............................. [RUN]
[0m04:56:23.071967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca, now test.stock_dbt.not_null_moving_average_symbol.75a6f7473c)
[0m04:56:23.073779 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_symbol.75a6f7473c
[0m04:56:23.077746 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_symbol.75a6f7473c"
[0m04:56:23.079596 [info ] [Thread-1 (]: 13 of 27 PASS not_null_moving_average_moving_avg_5d ............................ [[32mPASS[0m in 0.64s]
[0m04:56:23.081336 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m04:56:23.082936 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_symbol.75a6f7473c
[0m04:56:23.084308 [info ] [Thread-1 (]: 14 of 27 START test not_null_moving_average_symbol ............................. [RUN]
[0m04:56:23.085666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca, now test.stock_dbt.not_null_moving_average_symbol.75a6f7473c)
[0m04:56:23.087025 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_symbol.75a6f7473c
[0m04:56:23.090922 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_symbol.75a6f7473c
[0m04:56:23.091207 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_symbol.75a6f7473c"
[0m04:56:23.094131 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_symbol.75a6f7473c"
[0m04:56:23.104752 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_symbol.75a6f7473c
[0m04:56:23.107194 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_symbol.75a6f7473c"
[0m04:56:23.108195 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_symbol.75a6f7473c"
[0m04:56:23.109492 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_symbol.75a6f7473c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_symbol.75a6f7473c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.moving_average
where symbol is null



      
    ) dbt_internal_test
[0m04:56:23.110766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:23.124528 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_symbol.75a6f7473c"
[0m04:56:23.125340 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_symbol.75a6f7473c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_symbol.75a6f7473c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.moving_average
where symbol is null



      
    ) dbt_internal_test
[0m04:56:23.126037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:23.471165 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.360 seconds
[0m04:56:23.473630 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_symbol.75a6f7473c: Close
[0m04:56:23.506216 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.380 seconds
[0m04:56:23.508976 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_symbol.75a6f7473c: Close
[0m04:56:23.602543 [info ] [Thread-1 (]: 14 of 27 PASS not_null_moving_average_symbol ................................... [[32mPASS[0m in 0.53s]
[0m04:56:23.604048 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_symbol.75a6f7473c
[0m04:56:23.605264 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42
[0m04:56:23.606071 [info ] [Thread-1 (]: 15 of 27 START test not_null_rsi_calculation_avg_gain .......................... [RUN]
[0m04:56:23.607070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_symbol.75a6f7473c, now test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42)
[0m04:56:23.607714 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42
[0m04:56:23.611072 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m04:56:23.618027 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42
[0m04:56:23.620728 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m04:56:23.628458 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m04:56:23.629450 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_gain
from dev.analytics.rsi_calculation
where avg_gain is null



      
    ) dbt_internal_test
[0m04:56:23.630315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:23.631020 [info ] [Thread-1 (]: 14 of 27 PASS not_null_moving_average_symbol ................................... [[32mPASS[0m in 0.55s]
[0m04:56:23.632179 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_symbol.75a6f7473c
[0m04:56:23.633698 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42
[0m04:56:23.634928 [info ] [Thread-1 (]: 15 of 27 START test not_null_rsi_calculation_avg_gain .......................... [RUN]
[0m04:56:23.636327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_symbol.75a6f7473c, now test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42)
[0m04:56:23.637314 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42
[0m04:56:23.641044 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m04:56:23.650838 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42
[0m04:56:23.653909 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m04:56:23.669714 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m04:56:23.671385 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_gain
from dev.analytics.rsi_calculation
where avg_gain is null



      
    ) dbt_internal_test
[0m04:56:23.672987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:24.051587 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.421 seconds
[0m04:56:24.054513 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42: Close
[0m04:56:24.082642 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.410 seconds
[0m04:56:24.085895 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42: Close
[0m04:56:24.187136 [info ] [Thread-1 (]: 15 of 27 PASS not_null_rsi_calculation_avg_gain ................................ [[32mPASS[0m in 0.58s]
[0m04:56:24.189220 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42
[0m04:56:24.190952 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m04:56:24.192481 [info ] [Thread-1 (]: 16 of 27 START test not_null_rsi_calculation_avg_loss .......................... [RUN]
[0m04:56:24.193928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42, now test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19)
[0m04:56:24.195270 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m04:56:24.199514 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m04:56:24.205608 [info ] [Thread-1 (]: 15 of 27 PASS not_null_rsi_calculation_avg_gain ................................ [[32mPASS[0m in 0.57s]
[0m04:56:24.207377 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42
[0m04:56:24.208946 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m04:56:24.210347 [info ] [Thread-1 (]: 16 of 27 START test not_null_rsi_calculation_avg_loss .......................... [RUN]
[0m04:56:24.211491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42, now test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19)
[0m04:56:24.212881 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m04:56:24.215240 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m04:56:24.217605 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m04:56:24.218360 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m04:56:24.232475 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m04:56:24.233313 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m04:56:24.234411 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_loss
from dev.analytics.rsi_calculation
where avg_loss is null



      
    ) dbt_internal_test
[0m04:56:24.236362 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:24.236946 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m04:56:24.253604 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m04:56:24.255116 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_loss
from dev.analytics.rsi_calculation
where avg_loss is null



      
    ) dbt_internal_test
[0m04:56:24.256717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:24.738814 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.502 seconds
[0m04:56:24.741348 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19: Close
[0m04:56:24.749885 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.493 seconds
[0m04:56:24.753460 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19: Close
[0m04:56:24.860605 [info ] [Thread-1 (]: 16 of 27 PASS not_null_rsi_calculation_avg_loss ................................ [[32mPASS[0m in 0.67s]
[0m04:56:24.862760 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m04:56:24.864322 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d
[0m04:56:24.866035 [info ] [Thread-1 (]: 17 of 27 START test not_null_rsi_calculation_close ............................. [RUN]
[0m04:56:24.867631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19, now test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d)
[0m04:56:24.868786 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d
[0m04:56:24.873007 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d"
[0m04:56:24.879701 [info ] [Thread-1 (]: 16 of 27 PASS not_null_rsi_calculation_avg_loss ................................ [[32mPASS[0m in 0.67s]
[0m04:56:24.881641 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m04:56:24.883048 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d
[0m04:56:24.884253 [info ] [Thread-1 (]: 17 of 27 START test not_null_rsi_calculation_close ............................. [RUN]
[0m04:56:24.885844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19, now test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d)
[0m04:56:24.886356 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d
[0m04:56:24.887357 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d
[0m04:56:24.889334 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d"
[0m04:56:24.891408 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d"
[0m04:56:24.900939 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d"
[0m04:56:24.901201 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d
[0m04:56:24.902156 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.rsi_calculation
where close is null



      
    ) dbt_internal_test
[0m04:56:24.903230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:24.903993 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d"
[0m04:56:24.913825 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d"
[0m04:56:24.914952 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.rsi_calculation
where close is null



      
    ) dbt_internal_test
[0m04:56:24.915894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:25.343315 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.427 seconds
[0m04:56:25.346414 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d: Close
[0m04:56:25.358792 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.456 seconds
[0m04:56:25.361306 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d: Close
[0m04:56:25.470296 [info ] [Thread-1 (]: 17 of 27 PASS not_null_rsi_calculation_close ................................... [[32mPASS[0m in 0.58s]
[0m04:56:25.473423 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d
[0m04:56:25.474878 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76
[0m04:56:25.475989 [info ] [Thread-1 (]: 18 of 27 START test not_null_rsi_calculation_date .............................. [RUN]
[0m04:56:25.477579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d, now test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76)
[0m04:56:25.479178 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76
[0m04:56:25.490362 [info ] [Thread-1 (]: 17 of 27 PASS not_null_rsi_calculation_close ................................... [[32mPASS[0m in 0.62s]
[0m04:56:25.491501 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d
[0m04:56:25.492477 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76
[0m04:56:25.493355 [info ] [Thread-1 (]: 18 of 27 START test not_null_rsi_calculation_date .............................. [RUN]
[0m04:56:25.494756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d, now test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76)
[0m04:56:25.495538 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76
[0m04:56:25.533250 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76"
[0m04:56:25.542479 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76
[0m04:56:25.544449 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76"
[0m04:56:25.544953 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76"
[0m04:56:25.555385 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76
[0m04:56:25.556901 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76"
[0m04:56:25.557881 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76"
[0m04:56:25.557832 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.rsi_calculation
where date is null



      
    ) dbt_internal_test
[0m04:56:25.558987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:25.568041 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76"
[0m04:56:25.569079 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.rsi_calculation
where date is null



      
    ) dbt_internal_test
[0m04:56:25.569862 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:26.012042 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.453 seconds
[0m04:56:26.015544 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76: Close
[0m04:56:26.060381 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.490 seconds
[0m04:56:26.063025 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76: Close
[0m04:56:26.132445 [info ] [Thread-1 (]: 18 of 27 PASS not_null_rsi_calculation_date .................................... [[32mPASS[0m in 0.65s]
[0m04:56:26.134067 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76
[0m04:56:26.136668 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m04:56:26.138159 [info ] [Thread-1 (]: 19 of 27 START test not_null_rsi_calculation_rsi_14d ........................... [RUN]
[0m04:56:26.139917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76, now test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8)
[0m04:56:26.141119 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m04:56:26.144985 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m04:56:26.157945 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m04:56:26.160929 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m04:56:26.175682 [info ] [Thread-1 (]: 18 of 27 PASS not_null_rsi_calculation_date .................................... [[32mPASS[0m in 0.68s]
[0m04:56:26.175965 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m04:56:26.177282 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from dev.analytics.rsi_calculation
where rsi_14d is null



      
    ) dbt_internal_test
[0m04:56:26.177289 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76
[0m04:56:26.178799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:26.178937 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m04:56:26.180053 [info ] [Thread-1 (]: 19 of 27 START test not_null_rsi_calculation_rsi_14d ........................... [RUN]
[0m04:56:26.181266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76, now test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8)
[0m04:56:26.182511 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m04:56:26.186099 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m04:56:26.196149 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m04:56:26.198710 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m04:56:26.209882 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m04:56:26.211221 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from dev.analytics.rsi_calculation
where rsi_14d is null



      
    ) dbt_internal_test
[0m04:56:26.212070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:26.813663 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.635 seconds
[0m04:56:26.816961 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8: Close
[0m04:56:26.821460 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.609 seconds
[0m04:56:26.824253 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8: Close
[0m04:56:27.065029 [info ] [Thread-1 (]: 19 of 27 PASS not_null_rsi_calculation_rsi_14d ................................. [[32mPASS[0m in 0.93s]
[0m04:56:27.065451 [info ] [Thread-1 (]: 19 of 27 PASS not_null_rsi_calculation_rsi_14d ................................. [[32mPASS[0m in 0.88s]
[0m04:56:27.068007 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m04:56:27.067951 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m04:56:27.069504 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84
[0m04:56:27.069628 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84
[0m04:56:27.070469 [info ] [Thread-1 (]: 20 of 27 START test not_null_rsi_calculation_symbol ............................ [RUN]
[0m04:56:27.070721 [info ] [Thread-1 (]: 20 of 27 START test not_null_rsi_calculation_symbol ............................ [RUN]
[0m04:56:27.071508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8, now test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84)
[0m04:56:27.072121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8, now test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84)
[0m04:56:27.073184 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84
[0m04:56:27.074227 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84
[0m04:56:27.077605 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m04:56:27.078276 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m04:56:27.082512 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84
[0m04:56:27.084132 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84
[0m04:56:27.086084 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m04:56:27.086610 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m04:56:27.105341 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m04:56:27.106974 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.rsi_calculation
where symbol is null



      
    ) dbt_internal_test
[0m04:56:27.107169 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m04:56:27.108571 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:27.108787 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.rsi_calculation
where symbol is null



      
    ) dbt_internal_test
[0m04:56:27.110405 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:27.669806 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.561 seconds
[0m04:56:27.673816 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.563 seconds
[0m04:56:27.673823 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84: Close
[0m04:56:27.676756 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84: Close
[0m04:56:27.874182 [info ] [Thread-1 (]: 20 of 27 PASS not_null_rsi_calculation_symbol .................................. [[32mPASS[0m in 0.80s]
[0m04:56:27.874198 [info ] [Thread-1 (]: 20 of 27 PASS not_null_rsi_calculation_symbol .................................. [[32mPASS[0m in 0.80s]
[0m04:56:27.876654 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84
[0m04:56:27.876760 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84
[0m04:56:27.878625 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_close.d7e232e1ba
[0m04:56:27.878731 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_close.d7e232e1ba
[0m04:56:27.880700 [info ] [Thread-1 (]: 21 of 27 START test not_null_stock_prices_close ................................ [RUN]
[0m04:56:27.880704 [info ] [Thread-1 (]: 21 of 27 START test not_null_stock_prices_close ................................ [RUN]
[0m04:56:27.882437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84, now test.stock_dbt.not_null_stock_prices_close.d7e232e1ba)
[0m04:56:27.882360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84, now test.stock_dbt.not_null_stock_prices_close.d7e232e1ba)
[0m04:56:27.883583 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_close.d7e232e1ba
[0m04:56:27.883627 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_close.d7e232e1ba
[0m04:56:27.887695 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_close.d7e232e1ba"
[0m04:56:27.887964 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_close.d7e232e1ba"
[0m04:56:27.893010 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_close.d7e232e1ba
[0m04:56:27.893788 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_close.d7e232e1ba
[0m04:56:27.895520 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_close.d7e232e1ba"
[0m04:56:27.896568 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_close.d7e232e1ba"
[0m04:56:27.902355 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_close.d7e232e1ba"
[0m04:56:27.903755 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_close.d7e232e1ba: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_close.d7e232e1ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.stock_prices
where close is null



      
    ) dbt_internal_test
[0m04:56:27.904214 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_close.d7e232e1ba"
[0m04:56:27.904720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:27.905295 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_close.d7e232e1ba: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_close.d7e232e1ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.stock_prices
where close is null



      
    ) dbt_internal_test
[0m04:56:27.906405 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:28.716562 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.810 seconds
[0m04:56:28.717416 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.813 seconds
[0m04:56:28.720325 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_close.d7e232e1ba: Close
[0m04:56:28.720696 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_close.d7e232e1ba: Close
[0m04:56:28.865365 [info ] [Thread-1 (]: 21 of 27 PASS not_null_stock_prices_close ...................................... [[32mPASS[0m in 0.98s]
[0m04:56:28.867607 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_close.d7e232e1ba
[0m04:56:28.868581 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_date.98a7527501
[0m04:56:28.869531 [info ] [Thread-1 (]: 22 of 27 START test not_null_stock_prices_date ................................. [RUN]
[0m04:56:28.871207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_close.d7e232e1ba, now test.stock_dbt.not_null_stock_prices_date.98a7527501)
[0m04:56:28.872203 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_date.98a7527501
[0m04:56:28.877448 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_date.98a7527501"
[0m04:56:28.877938 [info ] [Thread-1 (]: 21 of 27 PASS not_null_stock_prices_close ...................................... [[32mPASS[0m in 0.99s]
[0m04:56:28.879461 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_close.d7e232e1ba
[0m04:56:28.880711 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_date.98a7527501
[0m04:56:28.881861 [info ] [Thread-1 (]: 22 of 27 START test not_null_stock_prices_date ................................. [RUN]
[0m04:56:28.883476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_close.d7e232e1ba, now test.stock_dbt.not_null_stock_prices_date.98a7527501)
[0m04:56:28.884798 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_date.98a7527501
[0m04:56:28.888044 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_date.98a7527501
[0m04:56:28.889336 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_date.98a7527501"
[0m04:56:28.890678 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_date.98a7527501"
[0m04:56:28.901314 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_date.98a7527501
[0m04:56:28.902354 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_date.98a7527501"
[0m04:56:28.903437 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_date.98a7527501: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_date.98a7527501"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.stock_prices
where date is null



      
    ) dbt_internal_test
[0m04:56:28.903436 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_date.98a7527501"
[0m04:56:28.907060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:28.917870 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_date.98a7527501"
[0m04:56:28.918891 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_date.98a7527501: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_date.98a7527501"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.stock_prices
where date is null



      
    ) dbt_internal_test
[0m04:56:28.919980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:29.443621 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.524 seconds
[0m04:56:29.446763 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.540 seconds
[0m04:56:29.447308 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_date.98a7527501: Close
[0m04:56:29.449553 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_date.98a7527501: Close
[0m04:56:29.578224 [info ] [Thread-1 (]: 22 of 27 PASS not_null_stock_prices_date ....................................... [[32mPASS[0m in 0.69s]
[0m04:56:29.580743 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_date.98a7527501
[0m04:56:29.582411 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc
[0m04:56:29.584296 [info ] [Thread-1 (]: 23 of 27 START test not_null_stock_prices_high ................................. [RUN]
[0m04:56:29.583882 [info ] [Thread-1 (]: 22 of 27 PASS not_null_stock_prices_date ....................................... [[32mPASS[0m in 0.71s]
[0m04:56:29.586456 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_date.98a7527501
[0m04:56:29.586307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_date.98a7527501, now test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc)
[0m04:56:29.587840 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc
[0m04:56:29.587894 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc
[0m04:56:29.588578 [info ] [Thread-1 (]: 23 of 27 START test not_null_stock_prices_high ................................. [RUN]
[0m04:56:29.589850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_date.98a7527501, now test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc)
[0m04:56:29.590687 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc
[0m04:56:29.591181 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc"
[0m04:56:29.594248 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc"
[0m04:56:29.598523 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc
[0m04:56:29.600273 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc
[0m04:56:29.601164 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc"
[0m04:56:29.602485 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc"
[0m04:56:29.606135 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc"
[0m04:56:29.607135 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc"
[0m04:56:29.607205 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select high
from dev.analytics.stock_prices
where high is null



      
    ) dbt_internal_test
[0m04:56:29.608002 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select high
from dev.analytics.stock_prices
where high is null



      
    ) dbt_internal_test
[0m04:56:29.608043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:29.608979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:30.047786 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.439 seconds
[0m04:56:30.052700 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc: Close
[0m04:56:30.077368 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.469 seconds
[0m04:56:30.080869 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc: Close
[0m04:56:30.172216 [info ] [Thread-1 (]: 23 of 27 PASS not_null_stock_prices_high ....................................... [[32mPASS[0m in 0.58s]
[0m04:56:30.175486 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc
[0m04:56:30.177016 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_low.e65294ca15
[0m04:56:30.178158 [info ] [Thread-1 (]: 24 of 27 START test not_null_stock_prices_low .................................. [RUN]
[0m04:56:30.179574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc, now test.stock_dbt.not_null_stock_prices_low.e65294ca15)
[0m04:56:30.180629 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_low.e65294ca15
[0m04:56:30.184571 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_low.e65294ca15"
[0m04:56:30.192702 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_low.e65294ca15
[0m04:56:30.194986 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_low.e65294ca15"
[0m04:56:30.202447 [info ] [Thread-1 (]: 23 of 27 PASS not_null_stock_prices_high ....................................... [[32mPASS[0m in 0.62s]
[0m04:56:30.211313 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc
[0m04:56:30.213111 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_low.e65294ca15
[0m04:56:30.214695 [info ] [Thread-1 (]: 24 of 27 START test not_null_stock_prices_low .................................. [RUN]
[0m04:56:30.214798 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_low.e65294ca15"
[0m04:56:30.216222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc, now test.stock_dbt.not_null_stock_prices_low.e65294ca15)
[0m04:56:30.217090 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_low.e65294ca15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_low.e65294ca15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select low
from dev.analytics.stock_prices
where low is null



      
    ) dbt_internal_test
[0m04:56:30.220784 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_low.e65294ca15
[0m04:56:30.221136 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:30.225000 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_low.e65294ca15"
[0m04:56:30.236161 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_low.e65294ca15
[0m04:56:30.238561 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_low.e65294ca15"
[0m04:56:30.248239 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_low.e65294ca15"
[0m04:56:30.249108 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_low.e65294ca15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_low.e65294ca15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select low
from dev.analytics.stock_prices
where low is null



      
    ) dbt_internal_test
[0m04:56:30.250274 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:30.639443 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.389 seconds
[0m04:56:30.642591 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_low.e65294ca15: Close
[0m04:56:30.672685 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.451 seconds
[0m04:56:30.676056 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_low.e65294ca15: Close
[0m04:56:30.797439 [info ] [Thread-1 (]: 24 of 27 PASS not_null_stock_prices_low ........................................ [[32mPASS[0m in 0.62s]
[0m04:56:30.798720 [info ] [Thread-1 (]: 24 of 27 PASS not_null_stock_prices_low ........................................ [[32mPASS[0m in 0.58s]
[0m04:56:30.800263 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_low.e65294ca15
[0m04:56:30.800917 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_low.e65294ca15
[0m04:56:30.801789 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_open.e09b13f215
[0m04:56:30.802319 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_open.e09b13f215
[0m04:56:30.803417 [info ] [Thread-1 (]: 25 of 27 START test not_null_stock_prices_open ................................. [RUN]
[0m04:56:30.804014 [info ] [Thread-1 (]: 25 of 27 START test not_null_stock_prices_open ................................. [RUN]
[0m04:56:30.805158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_low.e65294ca15, now test.stock_dbt.not_null_stock_prices_open.e09b13f215)
[0m04:56:30.805526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_low.e65294ca15, now test.stock_dbt.not_null_stock_prices_open.e09b13f215)
[0m04:56:30.806408 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_open.e09b13f215
[0m04:56:30.806394 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_open.e09b13f215
[0m04:56:30.809942 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_open.e09b13f215"
[0m04:56:30.810192 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_open.e09b13f215"
[0m04:56:30.814943 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_open.e09b13f215
[0m04:56:30.816389 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_open.e09b13f215
[0m04:56:30.817123 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_open.e09b13f215"
[0m04:56:30.818755 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_open.e09b13f215"
[0m04:56:30.822390 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_open.e09b13f215"
[0m04:56:30.823223 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_open.e09b13f215: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_open.e09b13f215"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from dev.analytics.stock_prices
where open is null



      
    ) dbt_internal_test
[0m04:56:30.823172 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_open.e09b13f215"
[0m04:56:30.824328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:30.824551 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_open.e09b13f215: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_open.e09b13f215"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from dev.analytics.stock_prices
where open is null



      
    ) dbt_internal_test
[0m04:56:30.825734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:31.204679 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.380 seconds
[0m04:56:31.208008 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_open.e09b13f215: Close
[0m04:56:31.223452 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.398 seconds
[0m04:56:31.226685 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_open.e09b13f215: Close
[0m04:56:31.353101 [info ] [Thread-1 (]: 25 of 27 PASS not_null_stock_prices_open ....................................... [[32mPASS[0m in 0.55s]
[0m04:56:31.352625 [info ] [Thread-1 (]: 25 of 27 PASS not_null_stock_prices_open ....................................... [[32mPASS[0m in 0.55s]
[0m04:56:31.356298 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_open.e09b13f215
[0m04:56:31.356342 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_open.e09b13f215
[0m04:56:31.358230 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8
[0m04:56:31.358160 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8
[0m04:56:31.360206 [info ] [Thread-1 (]: 26 of 27 START test not_null_stock_prices_symbol ............................... [RUN]
[0m04:56:31.359965 [info ] [Thread-1 (]: 26 of 27 START test not_null_stock_prices_symbol ............................... [RUN]
[0m04:56:31.361727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_open.e09b13f215, now test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8)
[0m04:56:31.361942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_open.e09b13f215, now test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8)
[0m04:56:31.363016 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8
[0m04:56:31.363098 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8
[0m04:56:31.368269 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8"
[0m04:56:31.368145 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8"
[0m04:56:31.378499 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8
[0m04:56:31.380409 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8
[0m04:56:31.381907 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8"
[0m04:56:31.383433 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8"
[0m04:56:31.391776 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8"
[0m04:56:31.392873 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.stock_prices
where symbol is null



      
    ) dbt_internal_test
[0m04:56:31.393144 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8"
[0m04:56:31.394023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:31.394243 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.stock_prices
where symbol is null



      
    ) dbt_internal_test
[0m04:56:31.395271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:31.778799 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.383 seconds
[0m04:56:31.782688 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8: Close
[0m04:56:31.819324 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.425 seconds
[0m04:56:31.822675 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8: Close
[0m04:56:31.902219 [info ] [Thread-1 (]: 26 of 27 PASS not_null_stock_prices_symbol ..................................... [[32mPASS[0m in 0.54s]
[0m04:56:31.904179 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8
[0m04:56:31.916159 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_volume.71420bc956
[0m04:56:31.917826 [info ] [Thread-1 (]: 27 of 27 START test not_null_stock_prices_volume ............................... [RUN]
[0m04:56:31.919623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8, now test.stock_dbt.not_null_stock_prices_volume.71420bc956)
[0m04:56:31.921510 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_volume.71420bc956
[0m04:56:31.925721 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_volume.71420bc956"
[0m04:56:31.935299 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_volume.71420bc956
[0m04:56:31.938010 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_volume.71420bc956"
[0m04:56:31.948695 [info ] [Thread-1 (]: 26 of 27 PASS not_null_stock_prices_symbol ..................................... [[32mPASS[0m in 0.59s]
[0m04:56:31.950487 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8
[0m04:56:31.950900 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_volume.71420bc956"
[0m04:56:31.952307 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_volume.71420bc956
[0m04:56:31.953666 [info ] [Thread-1 (]: 27 of 27 START test not_null_stock_prices_volume ............................... [RUN]
[0m04:56:31.952814 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_volume.71420bc956: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_volume.71420bc956"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume
from dev.analytics.stock_prices
where volume is null



      
    ) dbt_internal_test
[0m04:56:31.954947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8, now test.stock_dbt.not_null_stock_prices_volume.71420bc956)
[0m04:56:31.954960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:31.956490 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_volume.71420bc956
[0m04:56:31.961358 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_volume.71420bc956"
[0m04:56:31.973411 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_volume.71420bc956
[0m04:56:31.976111 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_volume.71420bc956"
[0m04:56:31.988315 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_volume.71420bc956"
[0m04:56:31.989664 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_volume.71420bc956: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_volume.71420bc956"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume
from dev.analytics.stock_prices
where volume is null



      
    ) dbt_internal_test
[0m04:56:31.990977 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:32.448353 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.457 seconds
[0m04:56:32.449295 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.494 seconds
[0m04:56:32.450873 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_volume.71420bc956: Close
[0m04:56:32.451701 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_volume.71420bc956: Close
[0m04:56:32.560198 [info ] [Thread-1 (]: 27 of 27 PASS not_null_stock_prices_volume ..................................... [[32mPASS[0m in 0.61s]
[0m04:56:32.563136 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_volume.71420bc956
[0m04:56:32.563456 [info ] [Thread-1 (]: 27 of 27 PASS not_null_stock_prices_volume ..................................... [[32mPASS[0m in 0.64s]
[0m04:56:32.565858 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_volume.71420bc956
[0m04:56:32.566354 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:56:32.567182 [debug] [MainThread]: Connection 'test.stock_dbt.not_null_stock_prices_volume.71420bc956' was properly closed.
[0m04:56:32.567993 [info ] [MainThread]: 
[0m04:56:32.567984 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:56:32.569208 [info ] [MainThread]: Finished running 27 data tests in 0 hours 0 minutes and 19.47 seconds (19.47s).
[0m04:56:32.569294 [debug] [MainThread]: Connection 'test.stock_dbt.not_null_stock_prices_volume.71420bc956' was properly closed.
[0m04:56:32.570184 [info ] [MainThread]: 
[0m04:56:32.571278 [info ] [MainThread]: Finished running 27 data tests in 0 hours 0 minutes and 18.80 seconds (18.80s).
[0m04:56:32.572231 [debug] [MainThread]: Command end result
[0m04:56:32.574389 [debug] [MainThread]: Command end result
[0m04:56:32.649502 [info ] [MainThread]: 
[0m04:56:32.650309 [info ] [MainThread]: 
[0m04:56:32.651210 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:56:32.652148 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:56:32.652999 [info ] [MainThread]: 
[0m04:56:32.653688 [info ] [MainThread]: 
[0m04:56:32.654769 [info ] [MainThread]: Done. PASS=27 WARN=0 ERROR=0 SKIP=0 TOTAL=27
[0m04:56:32.655165 [info ] [MainThread]: Done. PASS=27 WARN=0 ERROR=0 SKIP=0 TOTAL=27
[0m04:56:32.657120 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 20.17441, "process_user_time": 3.737692, "process_kernel_time": 2.856766, "process_mem_max_rss": "238284", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m04:56:32.657557 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 20.856152, "process_user_time": 3.831032, "process_kernel_time": 2.835959, "process_mem_max_rss": "250932", "process_in_blocks": "1976", "process_out_blocks": "8"}
[0m04:56:32.659003 [debug] [MainThread]: Command `dbt test` succeeded at 04:56:32.658917 after 20.18 seconds
[0m04:56:32.659785 [debug] [MainThread]: Command `dbt test` succeeded at 04:56:32.659691 after 20.86 seconds
[0m04:56:32.660348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2c010fec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2c010fd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff26444d220>]}
[0m04:56:32.661851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22bef36120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22beaae3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22bed12ff0>]}
[0m04:56:32.662435 [debug] [MainThread]: Flushing usage events
[0m04:56:32.663632 [debug] [MainThread]: Flushing usage events
[0m04:56:34.605699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9efeb690a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9efea3f9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9efea3dd90>]}


============================== 04:56:34.611468 | e0abf3ca-abbe-400e-b83d-c4313d1d4e2c ==============================
[0m04:56:34.611468 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:56:34.613252 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/stock_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/stock_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/stock_dbt --project-dir /opt/airflow/stock_dbt', 'send_anonymous_usage_stats': 'True'}
[0m04:56:35.224372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0abf3ca-abbe-400e-b83d-c4313d1d4e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ea5832f00>]}
[0m04:56:35.261217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0abf3ca-abbe-400e-b83d-c4313d1d4e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9efe695220>]}
[0m04:56:35.263442 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:56:35.272529 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:56:35.664527 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:56:35.666483 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:56:35.671631 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.stock_prediction
- models.stock_prediction.raw_data
- models.stock_prediction.tranformations
[0m04:56:35.705939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0abf3ca-abbe-400e-b83d-c4313d1d4e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ea518be30>]}
[0m04:56:35.855838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0abf3ca-abbe-400e-b83d-c4313d1d4e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ea531cd10>]}
[0m04:56:35.857283 [info ] [MainThread]: Found 5 models, 4 snapshots, 27 data tests, 1 source, 459 macros
[0m04:56:35.859302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0abf3ca-abbe-400e-b83d-c4313d1d4e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ea4eb1460>]}
[0m04:56:35.866406 [info ] [MainThread]: 
[0m04:56:35.868278 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:56:35.872967 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m04:56:35.885289 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m04:56:35.887603 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m04:56:35.890076 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:56:35.912120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3683d66de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36845698b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3683939160>]}


============================== 04:56:35.918397 | 370f256d-d249-4573-ba88-b47ff3c689db ==============================
[0m04:56:35.918397 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:56:35.920944 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/stock_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/stock_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/stock_dbt --project-dir /opt/airflow/stock_dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:56:36.447411 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.557 seconds
[0m04:56:36.450024 [debug] [ThreadPool]: On list_dev: Close
[0m04:56:36.565806 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_snapshot)
[0m04:56:36.570630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '370f256d-d249-4573-ba88-b47ff3c689db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36291cf5c0>]}
[0m04:56:36.573729 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m04:56:36.574717 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m04:56:36.575454 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:56:36.607920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '370f256d-d249-4573-ba88-b47ff3c689db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36292ef020>]}
[0m04:56:36.609830 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:56:36.620465 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:56:36.991250 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.416 seconds
[0m04:56:36.993897 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m04:56:37.000073 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:56:37.001553 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:56:37.006181 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.stock_prediction.raw_data
- models.stock_prediction.tranformations
- models.stock_prediction
[0m04:56:37.038214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '370f256d-d249-4573-ba88-b47ff3c689db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3629121640>]}
[0m04:56:37.104268 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m04:56:37.106976 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m04:56:37.108000 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m04:56:37.109507 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:56:37.155479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '370f256d-d249-4573-ba88-b47ff3c689db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3629015370>]}
[0m04:56:37.156439 [info ] [MainThread]: Found 5 models, 4 snapshots, 27 data tests, 1 source, 459 macros
[0m04:56:37.157977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '370f256d-d249-4573-ba88-b47ff3c689db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3628d68170>]}
[0m04:56:37.160762 [info ] [MainThread]: 
[0m04:56:37.162216 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:56:37.165856 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m04:56:37.176806 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m04:56:37.178713 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m04:56:37.180261 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:56:37.544398 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.435 seconds
[0m04:56:37.547852 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m04:56:37.596662 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.416 seconds
[0m04:56:37.601223 [debug] [ThreadPool]: On list_dev: Close
[0m04:56:37.660668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0abf3ca-abbe-400e-b83d-c4313d1d4e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f0010cd70>]}
[0m04:56:37.662925 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:56:37.664977 [info ] [MainThread]: 
[0m04:56:37.673067 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.snapshot_atr
[0m04:56:37.675414 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshot.snapshot_atr .................................... [RUN]
[0m04:56:37.677463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now snapshot.stock_dbt.snapshot_atr)
[0m04:56:37.679373 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.snapshot_atr
[0m04:56:37.686241 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.snapshot_atr
[0m04:56:37.724075 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:56:37.727828 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
[0m04:56:37.730642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:37.736521 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_snapshot)
[0m04:56:37.744911 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m04:56:37.746465 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m04:56:37.747710 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:56:38.070832 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.340 seconds
[0m04:56:38.104492 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:56:38.106947 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.avg_true_range


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m04:56:38.122218 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.374 seconds
[0m04:56:38.124981 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m04:56:38.242152 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m04:56:38.247056 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m04:56:38.249301 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m04:56:38.251668 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:56:38.706517 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.455 seconds
[0m04:56:38.711442 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m04:56:38.841076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '370f256d-d249-4573-ba88-b47ff3c689db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3683fb4c80>]}
[0m04:56:38.843980 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:56:38.846337 [info ] [MainThread]: 
[0m04:56:38.854672 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.snapshot_atr
[0m04:56:38.856702 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshot.snapshot_atr .................................... [RUN]
[0m04:56:38.858542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now snapshot.stock_dbt.snapshot_atr)
[0m04:56:38.860550 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.snapshot_atr
[0m04:56:38.867355 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.snapshot_atr
[0m04:56:38.904818 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:56:38.908336 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
[0m04:56:38.912215 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:38.937060 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.828 seconds
[0m04:56:38.940407 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:56:38.942074 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
[0m04:56:39.097739 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.154 seconds
[0m04:56:39.104209 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:56:39.106332 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
[0m04:56:39.183053 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.074 seconds
[0m04:56:39.188041 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:56:39.189839 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
[0m04:56:39.264819 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.352 seconds
[0m04:56:39.304099 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.113 seconds
[0m04:56:39.308329 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:56:39.308597 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:56:39.310116 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
[0m04:56:39.310768 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.avg_true_range


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m04:56:39.408588 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.096 seconds
[0m04:56:39.416064 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:56:39.417934 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
[0m04:56:39.511768 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.092 seconds
[0m04:56:39.529789 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:56:39.533331 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.avg_true_range


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m04:56:39.702546 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.167 seconds
[0m04:56:39.706988 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:56:39.708567 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m04:56:39.791287 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.081 seconds
[0m04:56:39.795899 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.snapshot_atr"
[0m04:56:39.809859 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:56:39.811883 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
BEGIN
[0m04:56:39.920193 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.106 seconds
[0m04:56:39.923359 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:56:39.926195 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_ATR" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATE", "SYMBOL", "ATR_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATE", "SYMBOL", "ATR_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m04:56:39.933803 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.621 seconds
[0m04:56:39.937845 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:56:39.939357 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
[0m04:56:40.059382 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.118 seconds
[0m04:56:40.066423 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:56:40.068117 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
[0m04:56:40.137497 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.068 seconds
[0m04:56:40.143424 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:56:40.145153 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
[0m04:56:40.237775 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.091 seconds
[0m04:56:40.241662 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:56:40.242877 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
[0m04:56:40.318093 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.074 seconds
[0m04:56:40.325493 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:56:40.328552 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
[0m04:56:40.367916 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.439 seconds
[0m04:56:40.370047 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:56:40.372037 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
COMMIT
[0m04:56:40.410150 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.079 seconds
[0m04:56:40.427189 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:56:40.428124 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.avg_true_range


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m04:56:40.591412 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.162 seconds
[0m04:56:40.595462 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:56:40.596999 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m04:56:40.661217 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.287 seconds
[0m04:56:40.669933 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.071 seconds
[0m04:56:40.671568 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.snapshot_atr"
[0m04:56:40.677774 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: Close
[0m04:56:40.680547 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:56:40.681493 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
BEGIN
[0m04:56:40.783916 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0abf3ca-abbe-400e-b83d-c4313d1d4e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9eff381d30>]}
[0m04:56:40.785289 [info ] [Thread-1 (]: 1 of 4 OK snapshotted snapshot.snapshot_atr .................................... [[32mSUCCESS 0[0m in 3.11s]
[0m04:56:40.787296 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.snapshot_atr
[0m04:56:40.788512 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.snapshot_bollinger
[0m04:56:40.789574 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshot.snapshot_bollinger .............................. [RUN]
[0m04:56:40.790693 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_dbt.snapshot_atr, now snapshot.stock_dbt.snapshot_bollinger)
[0m04:56:40.792222 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.snapshot_bollinger
[0m04:56:40.792535 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.110 seconds
[0m04:56:40.794537 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:56:40.795942 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.snapshot_bollinger
[0m04:56:40.796300 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_ATR" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATE", "SYMBOL", "ATR_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATE", "SYMBOL", "ATR_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m04:56:40.800208 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:56:40.801422 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
[0m04:56:40.802259 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:41.256864 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.454 seconds
[0m04:56:41.264868 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:56:41.266603 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.bollinger


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m04:56:41.268551 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.471 seconds
[0m04:56:41.270688 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:56:41.272390 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
COMMIT
[0m04:56:41.582995 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.308 seconds
[0m04:56:41.605542 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: Close
[0m04:56:41.743054 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '370f256d-d249-4573-ba88-b47ff3c689db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f362922c050>]}
[0m04:56:41.745278 [info ] [Thread-1 (]: 1 of 4 OK snapshotted snapshot.snapshot_atr .................................... [[32mSUCCESS 0[0m in 2.88s]
[0m04:56:41.746943 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.snapshot_atr
[0m04:56:41.748789 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.snapshot_bollinger
[0m04:56:41.750111 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshot.snapshot_bollinger .............................. [RUN]
[0m04:56:41.751321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_dbt.snapshot_atr, now snapshot.stock_dbt.snapshot_bollinger)
[0m04:56:41.752427 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.snapshot_bollinger
[0m04:56:41.755380 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.snapshot_bollinger
[0m04:56:41.759567 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:56:41.760703 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
[0m04:56:41.761748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:42.063872 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.795 seconds
[0m04:56:42.067908 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:56:42.070032 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
[0m04:56:42.158868 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.087 seconds
[0m04:56:42.166553 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:56:42.169513 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
[0m04:56:42.266833 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.094 seconds
[0m04:56:42.273568 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:56:42.275321 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
[0m04:56:42.275719 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.514 seconds
[0m04:56:42.281919 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:56:42.283440 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.bollinger


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m04:56:42.383176 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.106 seconds
[0m04:56:42.390480 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:56:42.394093 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
[0m04:56:42.481041 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.084 seconds
[0m04:56:42.488765 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:56:42.492626 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
[0m04:56:42.581195 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.086 seconds
[0m04:56:42.587187 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:56:42.589208 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.bollinger


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m04:56:42.775886 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.185 seconds
[0m04:56:42.779861 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:56:42.782508 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m04:56:42.867473 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.082 seconds
[0m04:56:42.871623 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.snapshot_bollinger"
[0m04:56:42.885125 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:56:42.886035 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
BEGIN
[0m04:56:42.918459 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.634 seconds
[0m04:56:42.923518 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:56:42.925313 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
[0m04:56:42.974522 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.088 seconds
[0m04:56:42.976559 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:56:42.978345 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "SMA_20D", "UPPER_BAND", "LOWER_BAND", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "SMA_20D", "UPPER_BAND", "LOWER_BAND", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m04:56:43.013628 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.087 seconds
[0m04:56:43.017857 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:56:43.019749 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
[0m04:56:43.095232 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.073 seconds
[0m04:56:43.100675 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:56:43.102335 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
[0m04:56:43.192472 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.089 seconds
[0m04:56:43.197825 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:56:43.199034 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
[0m04:56:43.273392 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.073 seconds
[0m04:56:43.282199 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:56:43.285403 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
[0m04:56:43.373206 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.085 seconds
[0m04:56:43.378278 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:56:43.379748 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.bollinger


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m04:56:43.418406 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.438 seconds
[0m04:56:43.421586 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:56:43.424296 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
COMMIT
[0m04:56:43.557987 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.177 seconds
[0m04:56:43.561601 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:56:43.563560 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m04:56:43.635918 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.070 seconds
[0m04:56:43.639721 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.snapshot_bollinger"
[0m04:56:43.660249 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:56:43.662897 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
BEGIN
[0m04:56:43.685859 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.260 seconds
[0m04:56:43.688900 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: Close
[0m04:56:43.805080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0abf3ca-abbe-400e-b83d-c4313d1d4e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ea4427c50>]}
[0m04:56:43.808043 [info ] [Thread-1 (]: 2 of 4 OK snapshotted snapshot.snapshot_bollinger .............................. [[32mSUCCESS 0[0m in 3.01s]
[0m04:56:43.809819 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.snapshot_bollinger
[0m04:56:43.811035 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.146 seconds
[0m04:56:43.811121 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.snapshot_moving_avg
[0m04:56:43.812103 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:56:43.812237 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshot.snapshot_moving_avg ............................. [RUN]
[0m04:56:43.813993 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "SMA_20D", "UPPER_BAND", "LOWER_BAND", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "SMA_20D", "UPPER_BAND", "LOWER_BAND", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m04:56:43.814066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_dbt.snapshot_bollinger, now snapshot.stock_dbt.snapshot_moving_avg)
[0m04:56:43.815941 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.snapshot_moving_avg
[0m04:56:43.819328 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.snapshot_moving_avg
[0m04:56:43.823234 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:56:43.824606 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
[0m04:56:43.826055 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:44.215116 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.391 seconds
[0m04:56:44.223888 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:56:44.225023 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.moving_average


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m04:56:44.228057 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.414 seconds
[0m04:56:44.229131 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:56:44.230085 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
COMMIT
[0m04:56:44.539038 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.308 seconds
[0m04:56:44.544758 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: Close
[0m04:56:44.685982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '370f256d-d249-4573-ba88-b47ff3c689db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36282ceff0>]}
[0m04:56:44.688585 [info ] [Thread-1 (]: 2 of 4 OK snapshotted snapshot.snapshot_bollinger .............................. [[32mSUCCESS 0[0m in 2.93s]
[0m04:56:44.690591 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.snapshot_bollinger
[0m04:56:44.692071 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.snapshot_moving_avg
[0m04:56:44.693817 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshot.snapshot_moving_avg ............................. [RUN]
[0m04:56:44.695332 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_dbt.snapshot_bollinger, now snapshot.stock_dbt.snapshot_moving_avg)
[0m04:56:44.696859 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.snapshot_moving_avg
[0m04:56:44.699814 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.snapshot_moving_avg
[0m04:56:44.703989 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:56:44.705652 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
[0m04:56:44.706503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:44.920112 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.694 seconds
[0m04:56:44.926271 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:56:44.929232 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
[0m04:56:45.044096 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.112 seconds
[0m04:56:45.049537 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:56:45.051041 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
[0m04:56:45.052926 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.346 seconds
[0m04:56:45.059167 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:56:45.060455 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.moving_average


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m04:56:45.143618 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.091 seconds
[0m04:56:45.147861 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:56:45.149885 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
[0m04:56:45.228619 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.077 seconds
[0m04:56:45.236517 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:56:45.239746 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
[0m04:56:45.341337 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.098 seconds
[0m04:56:45.349097 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:56:45.352329 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
[0m04:56:45.437855 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.082 seconds
[0m04:56:45.446462 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:56:45.448021 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.moving_average


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m04:56:45.621194 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.171 seconds
[0m04:56:45.624202 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:56:45.625863 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m04:56:45.700287 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.638 seconds
[0m04:56:45.705309 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:56:45.707620 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
[0m04:56:45.771858 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.145 seconds
[0m04:56:45.773522 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:56:45.784553 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:56:45.785629 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
BEGIN
[0m04:56:45.800978 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.091 seconds
[0m04:56:45.805361 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:56:45.807364 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
[0m04:56:45.882322 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.073 seconds
[0m04:56:45.889224 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:56:45.892414 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.105 seconds
[0m04:56:45.892230 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
[0m04:56:45.895160 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:56:45.897040 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "MOVING_AVG_5D", "MOVING_AVG_20D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "MOVING_AVG_5D", "MOVING_AVG_20D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m04:56:45.982578 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.087 seconds
[0m04:56:45.989965 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:56:45.993522 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
[0m04:56:46.061754 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.065 seconds
[0m04:56:46.067550 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:56:46.069807 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
[0m04:56:46.143028 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.071 seconds
[0m04:56:46.150058 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:56:46.152074 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.moving_average


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m04:56:46.257433 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.358 seconds
[0m04:56:46.261367 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:56:46.264767 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
COMMIT
[0m04:56:46.401202 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.248 seconds
[0m04:56:46.404904 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:56:46.406881 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m04:56:46.499141 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.090 seconds
[0m04:56:46.503422 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:56:46.547586 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.279 seconds
[0m04:56:46.549718 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:56:46.551436 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: Close
[0m04:56:46.552607 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
BEGIN
[0m04:56:46.658902 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0abf3ca-abbe-400e-b83d-c4313d1d4e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f02033500>]}
[0m04:56:46.661392 [info ] [Thread-1 (]: 3 of 4 OK snapshotted snapshot.snapshot_moving_avg ............................. [[32mSUCCESS 0[0m in 2.84s]
[0m04:56:46.662976 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.snapshot_moving_avg
[0m04:56:46.665024 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.snapshot_rsi
[0m04:56:46.667315 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshot.snapshot_rsi .................................... [RUN]
[0m04:56:46.669107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_dbt.snapshot_moving_avg, now snapshot.stock_dbt.snapshot_rsi)
[0m04:56:46.670825 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.snapshot_rsi
[0m04:56:46.673153 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.118 seconds
[0m04:56:46.675038 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:56:46.675654 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.snapshot_rsi
[0m04:56:46.676512 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "MOVING_AVG_5D", "MOVING_AVG_20D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "MOVING_AVG_5D", "MOVING_AVG_20D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m04:56:46.679292 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:56:46.680735 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m04:56:46.682338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:47.099728 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.417 seconds
[0m04:56:47.109787 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:56:47.110426 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.432 seconds
[0m04:56:47.112116 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.rsi_calculation


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m04:56:47.112600 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:56:47.114738 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
COMMIT
[0m04:56:47.432907 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.316 seconds
[0m04:56:47.436408 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: Close
[0m04:56:47.539162 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '370f256d-d249-4573-ba88-b47ff3c689db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3628303f20>]}
[0m04:56:47.542116 [info ] [Thread-1 (]: 3 of 4 OK snapshotted snapshot.snapshot_moving_avg ............................. [[32mSUCCESS 0[0m in 2.84s]
[0m04:56:47.544064 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.snapshot_moving_avg
[0m04:56:47.546096 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.snapshot_rsi
[0m04:56:47.548832 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshot.snapshot_rsi .................................... [RUN]
[0m04:56:47.555488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_dbt.snapshot_moving_avg, now snapshot.stock_dbt.snapshot_rsi)
[0m04:56:47.560779 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.snapshot_rsi
[0m04:56:47.565448 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.snapshot_rsi
[0m04:56:47.573613 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:56:47.576562 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m04:56:47.577810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:47.824777 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.711 seconds
[0m04:56:47.828320 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:56:47.829627 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m04:56:47.930715 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.099 seconds
[0m04:56:47.934794 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:56:47.936705 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m04:56:48.013446 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.435 seconds
[0m04:56:48.022841 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:56:48.034803 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.rsi_calculation


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m04:56:48.044184 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.105 seconds
[0m04:56:48.048682 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:56:48.050153 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m04:56:48.127836 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.076 seconds
[0m04:56:48.133576 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:56:48.135107 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m04:56:48.208258 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.072 seconds
[0m04:56:48.212668 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:56:48.214643 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m04:56:48.297138 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.080 seconds
[0m04:56:48.304596 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:56:48.307852 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.rsi_calculation


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m04:56:48.575392 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.259 seconds
[0m04:56:48.578726 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:56:48.580903 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m04:56:48.655467 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.072 seconds
[0m04:56:48.658074 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.619 seconds
[0m04:56:48.658439 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.snapshot_rsi"
[0m04:56:48.661980 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:56:48.663389 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m04:56:48.670688 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:56:48.671824 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
BEGIN
[0m04:56:48.759386 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.095 seconds
[0m04:56:48.763147 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:56:48.764273 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m04:56:48.771268 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.098 seconds
[0m04:56:48.772573 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:56:48.773691 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_RSI" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "AVG_GAIN", "AVG_LOSS", "RSI_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "AVG_GAIN", "AVG_LOSS", "RSI_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m04:56:48.841158 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.076 seconds
[0m04:56:48.844504 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:56:48.845767 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m04:56:48.943182 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.096 seconds
[0m04:56:48.947569 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:56:48.948581 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m04:56:49.023617 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.073 seconds
[0m04:56:49.029668 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:56:49.031533 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m04:56:49.104606 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.072 seconds
[0m04:56:49.111903 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:56:49.115291 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.rsi_calculation


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m04:56:49.242632 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.468 seconds
[0m04:56:49.245799 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:56:49.248026 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
COMMIT
[0m04:56:49.375904 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.257 seconds
[0m04:56:49.380475 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:56:49.383501 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m04:56:49.456043 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.071 seconds
[0m04:56:49.457657 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.snapshot_rsi"
[0m04:56:49.467962 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:56:49.469491 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
BEGIN
[0m04:56:49.571783 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.100 seconds
[0m04:56:49.575417 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:56:49.577921 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_RSI" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "AVG_GAIN", "AVG_LOSS", "RSI_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "AVG_GAIN", "AVG_LOSS", "RSI_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m04:56:49.597273 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.347 seconds
[0m04:56:49.600724 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: Close
[0m04:56:49.702775 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0abf3ca-abbe-400e-b83d-c4313d1d4e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ea447bf80>]}
[0m04:56:49.705933 [info ] [Thread-1 (]: 4 of 4 OK snapshotted snapshot.snapshot_rsi .................................... [[32mSUCCESS 0[0m in 3.03s]
[0m04:56:49.708705 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.snapshot_rsi
[0m04:56:49.711590 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:56:49.712959 [debug] [MainThread]: Connection 'snapshot.stock_dbt.snapshot_rsi' was properly closed.
[0m04:56:49.714359 [info ] [MainThread]: 
[0m04:56:49.715602 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 13.85 seconds (13.85s).
[0m04:56:49.717318 [debug] [MainThread]: Command end result
[0m04:56:49.831608 [info ] [MainThread]: 
[0m04:56:49.833006 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:56:49.834331 [info ] [MainThread]: 
[0m04:56:49.835997 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m04:56:49.838489 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 15.325504, "process_user_time": 3.337924, "process_kernel_time": 2.817858, "process_mem_max_rss": "246956", "process_in_blocks": "8", "process_out_blocks": "8"}
[0m04:56:49.841182 [debug] [MainThread]: Command `dbt snapshot` succeeded at 04:56:49.841092 after 15.33 seconds
[0m04:56:49.842322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f029b2a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ea531cd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f01e34950>]}
[0m04:56:49.843260 [debug] [MainThread]: Flushing usage events
[0m04:56:50.163226 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.583 seconds
[0m04:56:50.165395 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:56:50.167296 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
COMMIT
[0m04:56:50.405783 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.236 seconds
[0m04:56:50.409648 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: Close
[0m04:56:50.527455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '370f256d-d249-4573-ba88-b47ff3c689db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3628dc5c10>]}
[0m04:56:50.529757 [info ] [Thread-1 (]: 4 of 4 OK snapshotted snapshot.snapshot_rsi .................................... [[32mSUCCESS 0[0m in 2.97s]
[0m04:56:50.531391 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.snapshot_rsi
[0m04:56:50.533397 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:56:50.534741 [debug] [MainThread]: Connection 'snapshot.stock_dbt.snapshot_rsi' was properly closed.
[0m04:56:50.536213 [info ] [MainThread]: 
[0m04:56:50.537543 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 13.37 seconds (13.37s).
[0m04:56:50.539314 [debug] [MainThread]: Command end result
[0m04:56:50.638432 [info ] [MainThread]: 
[0m04:56:50.640152 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:56:50.641694 [info ] [MainThread]: 
[0m04:56:50.643192 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m04:56:50.644834 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 14.824211, "process_user_time": 3.388484, "process_kernel_time": 2.932161, "process_mem_max_rss": "250860", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m04:56:50.645900 [debug] [MainThread]: Command `dbt snapshot` succeeded at 04:56:50.645803 after 14.83 seconds
[0m04:56:50.646571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3682a77e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f362b7b7b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3628d407a0>]}
[0m04:56:50.647398 [debug] [MainThread]: Flushing usage events
[0m04:57:16.300836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff02d1ff8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff02d18c5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff02c4bfa40>]}


============================== 04:57:16.305574 | a3798c2d-7fb8-4fa6-8b62-b9597a443764 ==============================
[0m04:57:16.305574 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:57:16.307323 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/stock_dbt/logs', 'profiles_dir': '/opt/airflow/stock_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/stock_dbt --project-dir /opt/airflow/stock_dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:57:16.960125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3798c2d-7fb8-4fa6-8b62-b9597a443764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd536e570>]}
[0m04:57:16.995687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3798c2d-7fb8-4fa6-8b62-b9597a443764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd4802c30>]}
[0m04:57:16.998591 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:57:17.008376 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:57:17.090775 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m04:57:17.092976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a3798c2d-7fb8-4fa6-8b62-b9597a443764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff02cdbce30>]}
[0m04:57:17.447076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39db00f710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39dcad53d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39dab21970>]}


============================== 04:57:17.452034 | e869f8a6-b369-4111-93d7-93057fff977b ==============================
[0m04:57:17.452034 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:57:17.453257 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/stock_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/stock_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/stock_dbt --project-dir /opt/airflow/stock_dbt', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:57:18.068726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e869f8a6-b369-4111-93d7-93057fff977b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3983f46960>]}
[0m04:57:18.105375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e869f8a6-b369-4111-93d7-93057fff977b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39ddf56a80>]}
[0m04:57:18.107288 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:57:18.116198 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:57:18.137888 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m04:57:18.139683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a3798c2d-7fb8-4fa6-8b62-b9597a443764', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefceb5bef0>]}
[0m04:57:18.199176 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m04:57:18.201872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e869f8a6-b369-4111-93d7-93057fff977b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f398057aed0>]}
[0m04:57:18.398935 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.stock_prediction.raw_data
- models.stock_prediction
- models.stock_prediction.tranformations
[0m04:57:18.408733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3798c2d-7fb8-4fa6-8b62-b9597a443764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefce984da0>]}
[0m04:57:18.544461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3798c2d-7fb8-4fa6-8b62-b9597a443764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefce925700>]}
[0m04:57:18.546302 [info ] [MainThread]: Found 5 models, 4 snapshots, 27 data tests, 1 source, 459 macros
[0m04:57:18.547744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3798c2d-7fb8-4fa6-8b62-b9597a443764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefcea7f890>]}
[0m04:57:18.550728 [info ] [MainThread]: 
[0m04:57:18.552948 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:57:18.557740 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m04:57:18.568809 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m04:57:18.570355 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m04:57:18.571739 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:57:19.151874 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.580 seconds
[0m04:57:19.155467 [debug] [ThreadPool]: On list_dev: Close
[0m04:57:19.195566 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m04:57:19.197249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e869f8a6-b369-4111-93d7-93057fff977b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f398077c3b0>]}
[0m04:57:19.279933 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_snapshot)
[0m04:57:19.288601 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m04:57:19.290385 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m04:57:19.291599 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:57:19.465778 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.stock_prediction.raw_data
- models.stock_prediction.tranformations
- models.stock_prediction
[0m04:57:19.474632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e869f8a6-b369-4111-93d7-93057fff977b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3978541b80>]}
[0m04:57:19.591404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e869f8a6-b369-4111-93d7-93057fff977b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39805c0350>]}
[0m04:57:19.592248 [info ] [MainThread]: Found 5 models, 4 snapshots, 27 data tests, 1 source, 459 macros
[0m04:57:19.594038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e869f8a6-b369-4111-93d7-93057fff977b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39805d0bc0>]}
[0m04:57:19.602192 [info ] [MainThread]: 
[0m04:57:19.603333 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:57:19.607387 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m04:57:19.618317 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m04:57:19.619366 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m04:57:19.620429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:57:19.661339 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.370 seconds
[0m04:57:19.663778 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m04:57:19.795754 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m04:57:19.799356 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m04:57:19.801781 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m04:57:19.803384 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:57:19.997925 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.377 seconds
[0m04:57:20.001418 [debug] [ThreadPool]: On list_dev: Close
[0m04:57:20.119975 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m04:57:20.128438 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m04:57:20.129825 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m04:57:20.131668 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:57:20.211977 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.409 seconds
[0m04:57:20.214913 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m04:57:20.338571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3798c2d-7fb8-4fa6-8b62-b9597a443764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff02db5cf50>]}
[0m04:57:20.340923 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:57:20.343252 [info ] [MainThread]: 
[0m04:57:20.350022 [debug] [Thread-1 (]: Began running node model.stock_dbt.stock_prices
[0m04:57:20.351874 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stock_prices ............................. [RUN]
[0m04:57:20.353105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.stock_dbt.stock_prices)
[0m04:57:20.354436 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.stock_prices
[0m04:57:20.360594 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.stock_prices"
[0m04:57:20.371328 [debug] [Thread-1 (]: Began executing node model.stock_dbt.stock_prices
[0m04:57:20.391987 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.stock_prices"
[0m04:57:20.402060 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.stock_prices"
[0m04:57:20.402888 [debug] [Thread-1 (]: On model.stock_dbt.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.stock_prices"} */
create or replace   view dev.analytics.stock_prices
  
   as (
    SELECT
    symbol,
    date,
    open,
    high,
    low,
    close,
    volume
FROM dev.raw_data.stock_prices
  );
[0m04:57:20.403702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:20.556560 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.425 seconds
[0m04:57:20.559175 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m04:57:20.702913 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m04:57:20.706462 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m04:57:20.707706 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m04:57:20.708689 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:57:21.094307 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.386 seconds
[0m04:57:21.096819 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.693 seconds
[0m04:57:21.097906 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m04:57:21.113943 [debug] [Thread-1 (]: On model.stock_dbt.stock_prices: Close
[0m04:57:21.266905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e869f8a6-b369-4111-93d7-93057fff977b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39805d1cd0>]}
[0m04:57:21.267043 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3798c2d-7fb8-4fa6-8b62-b9597a443764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefcede0bf0>]}
[0m04:57:21.268984 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stock_prices ........................ [[32mSUCCESS 1[0m in 0.91s]
[0m04:57:21.268802 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:57:21.270749 [info ] [MainThread]: 
[0m04:57:21.270865 [debug] [Thread-1 (]: Finished running node model.stock_dbt.stock_prices
[0m04:57:21.273035 [debug] [Thread-1 (]: Began running node model.stock_dbt.avg_true_range
[0m04:57:21.274445 [info ] [Thread-1 (]: 2 of 5 START sql view model analytics.avg_true_range ........................... [RUN]
[0m04:57:21.276067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.stock_prices, now model.stock_dbt.avg_true_range)
[0m04:57:21.277136 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.avg_true_range
[0m04:57:21.277582 [debug] [Thread-1 (]: Began running node model.stock_dbt.stock_prices
[0m04:57:21.279078 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stock_prices ............................. [RUN]
[0m04:57:21.280238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now model.stock_dbt.stock_prices)
[0m04:57:21.280179 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.avg_true_range"
[0m04:57:21.281317 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.stock_prices
[0m04:57:21.287157 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.stock_prices"
[0m04:57:21.289125 [debug] [Thread-1 (]: Began executing node model.stock_dbt.avg_true_range
[0m04:57:21.291771 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.avg_true_range"
[0m04:57:21.294386 [debug] [Thread-1 (]: Began executing node model.stock_dbt.stock_prices
[0m04:57:21.300375 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.avg_true_range"
[0m04:57:21.301792 [debug] [Thread-1 (]: On model.stock_dbt.avg_true_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.avg_true_range"} */
create or replace   view dev.analytics.avg_true_range
  
   as (
    WITH averageTrueRanges AS (
    SELECT
        date,
        symbol,
        close,
        ABS(close - LAG(close) OVER (PARTITION BY symbol ORDER BY date)) AS true_range
    FROM dev.analytics.stock_prices
),
atr AS (
    SELECT
        date,
        symbol,
        AVG(true_range) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS atr_14d
    FROM averageTrueRanges
)
SELECT 
    date, 
    symbol, 
    COALESCE(atr_14d, 0) AS atr_14d
FROM atr
ORDER BY date, symbol
  );
[0m04:57:21.302778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:21.316357 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.stock_prices"
[0m04:57:21.325807 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.stock_prices"
[0m04:57:21.327342 [debug] [Thread-1 (]: On model.stock_dbt.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.stock_prices"} */
create or replace   view dev.analytics.stock_prices
  
   as (
    SELECT
    symbol,
    date,
    open,
    high,
    low,
    close,
    volume
FROM dev.raw_data.stock_prices
  );
[0m04:57:21.328207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:21.822231 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.519 seconds
[0m04:57:21.827589 [debug] [Thread-1 (]: On model.stock_dbt.avg_true_range: Close
[0m04:57:21.855253 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.527 seconds
[0m04:57:21.872990 [debug] [Thread-1 (]: On model.stock_dbt.stock_prices: Close
[0m04:57:21.947661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3798c2d-7fb8-4fa6-8b62-b9597a443764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef85b41760>]}
[0m04:57:21.949693 [info ] [Thread-1 (]: 2 of 5 OK created sql view model analytics.avg_true_range ...................... [[32mSUCCESS 1[0m in 0.67s]
[0m04:57:21.952087 [debug] [Thread-1 (]: Finished running node model.stock_dbt.avg_true_range
[0m04:57:21.953182 [debug] [Thread-1 (]: Began running node model.stock_dbt.bollinger
[0m04:57:21.955327 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.bollinger ................................ [RUN]
[0m04:57:21.956696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.avg_true_range, now model.stock_dbt.bollinger)
[0m04:57:21.957712 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.bollinger
[0m04:57:21.960746 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.bollinger"
[0m04:57:21.966494 [debug] [Thread-1 (]: Began executing node model.stock_dbt.bollinger
[0m04:57:21.969044 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.bollinger"
[0m04:57:21.980978 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.bollinger"
[0m04:57:21.982178 [debug] [Thread-1 (]: On model.stock_dbt.bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.bollinger"} */
create or replace   view dev.analytics.bollinger
  
   as (
    WITH bollinger AS (
    SELECT
        symbol,
        date,
        close,
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) AS sma_20d,
        STDDEV(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) AS stddev_20d
    FROM dev.analytics.stock_prices
)

SELECT
    symbol,
    date,
    close,
    COALESCE(sma_20d, 0) AS sma_20d,
    COALESCE(sma_20d + (2 * stddev_20d), 0) AS upper_band,
    COALESCE(sma_20d - (2 * stddev_20d), 0) AS lower_band
FROM bollinger
ORDER BY symbol, date
  );
[0m04:57:21.983674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:22.004655 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e869f8a6-b369-4111-93d7-93057fff977b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3980924560>]}
[0m04:57:22.006064 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stock_prices ........................ [[32mSUCCESS 1[0m in 0.72s]
[0m04:57:22.007303 [debug] [Thread-1 (]: Finished running node model.stock_dbt.stock_prices
[0m04:57:22.008711 [debug] [Thread-1 (]: Began running node model.stock_dbt.avg_true_range
[0m04:57:22.009621 [info ] [Thread-1 (]: 2 of 5 START sql view model analytics.avg_true_range ........................... [RUN]
[0m04:57:22.010556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.stock_prices, now model.stock_dbt.avg_true_range)
[0m04:57:22.011544 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.avg_true_range
[0m04:57:22.014066 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.avg_true_range"
[0m04:57:22.024362 [debug] [Thread-1 (]: Began executing node model.stock_dbt.avg_true_range
[0m04:57:22.026804 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.avg_true_range"
[0m04:57:22.033721 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.avg_true_range"
[0m04:57:22.034601 [debug] [Thread-1 (]: On model.stock_dbt.avg_true_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.avg_true_range"} */
create or replace   view dev.analytics.avg_true_range
  
   as (
    WITH averageTrueRanges AS (
    SELECT
        date,
        symbol,
        close,
        ABS(close - LAG(close) OVER (PARTITION BY symbol ORDER BY date)) AS true_range
    FROM dev.analytics.stock_prices
),
atr AS (
    SELECT
        date,
        symbol,
        AVG(true_range) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS atr_14d
    FROM averageTrueRanges
)
SELECT 
    date, 
    symbol, 
    COALESCE(atr_14d, 0) AS atr_14d
FROM atr
ORDER BY date, symbol
  );
[0m04:57:22.035456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:22.543373 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.559 seconds
[0m04:57:22.550172 [debug] [Thread-1 (]: On model.stock_dbt.bollinger: Close
[0m04:57:22.551164 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.516 seconds
[0m04:57:22.554538 [debug] [Thread-1 (]: On model.stock_dbt.avg_true_range: Close
[0m04:57:22.657192 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3798c2d-7fb8-4fa6-8b62-b9597a443764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef85b43770>]}
[0m04:57:22.660323 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.bollinger ........................... [[32mSUCCESS 1[0m in 0.70s]
[0m04:57:22.662564 [debug] [Thread-1 (]: Finished running node model.stock_dbt.bollinger
[0m04:57:22.664235 [debug] [Thread-1 (]: Began running node model.stock_dbt.moving_average
[0m04:57:22.665767 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.moving_average ........................... [RUN]
[0m04:57:22.666938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.bollinger, now model.stock_dbt.moving_average)
[0m04:57:22.667720 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.moving_average
[0m04:57:22.668425 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e869f8a6-b369-4111-93d7-93057fff977b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39780f1010>]}
[0m04:57:22.669980 [info ] [Thread-1 (]: 2 of 5 OK created sql view model analytics.avg_true_range ...................... [[32mSUCCESS 1[0m in 0.66s]
[0m04:57:22.670157 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.moving_average"
[0m04:57:22.671664 [debug] [Thread-1 (]: Finished running node model.stock_dbt.avg_true_range
[0m04:57:22.672560 [debug] [Thread-1 (]: Began running node model.stock_dbt.bollinger
[0m04:57:22.673931 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.bollinger ................................ [RUN]
[0m04:57:22.674854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.avg_true_range, now model.stock_dbt.bollinger)
[0m04:57:22.675771 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.bollinger
[0m04:57:22.678478 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.bollinger"
[0m04:57:22.678906 [debug] [Thread-1 (]: Began executing node model.stock_dbt.moving_average
[0m04:57:22.681674 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.moving_average"
[0m04:57:22.686328 [debug] [Thread-1 (]: Began executing node model.stock_dbt.bollinger
[0m04:57:22.689458 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.bollinger"
[0m04:57:22.690993 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.moving_average"
[0m04:57:22.692038 [debug] [Thread-1 (]: On model.stock_dbt.moving_average: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.moving_average"} */
create or replace   view dev.analytics.moving_average
  
   as (
    WITH stock_data AS (
    SELECT
        symbol,
        date,
        close
    FROM dev.analytics.stock_prices -- assuming 'stock_prices' is the name of the raw table model in dbt
)

SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
    ) AS moving_avg_5d,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
    ) AS moving_avg_20d
FROM stock_data
ORDER BY symbol, date
  );
[0m04:57:22.692984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:22.699754 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.bollinger"
[0m04:57:22.701195 [debug] [Thread-1 (]: On model.stock_dbt.bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.bollinger"} */
create or replace   view dev.analytics.bollinger
  
   as (
    WITH bollinger AS (
    SELECT
        symbol,
        date,
        close,
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) AS sma_20d,
        STDDEV(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) AS stddev_20d
    FROM dev.analytics.stock_prices
)

SELECT
    symbol,
    date,
    close,
    COALESCE(sma_20d, 0) AS sma_20d,
    COALESCE(sma_20d + (2 * stddev_20d), 0) AS upper_band,
    COALESCE(sma_20d - (2 * stddev_20d), 0) AS lower_band
FROM bollinger
ORDER BY symbol, date
  );
[0m04:57:22.702492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:23.284787 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.592 seconds
[0m04:57:23.289288 [debug] [Thread-1 (]: On model.stock_dbt.moving_average: Close
[0m04:57:23.305755 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.603 seconds
[0m04:57:23.308603 [debug] [Thread-1 (]: On model.stock_dbt.bollinger: Close
[0m04:57:23.411774 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3798c2d-7fb8-4fa6-8b62-b9597a443764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefcec523c0>]}
[0m04:57:23.414371 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.moving_average ...................... [[32mSUCCESS 1[0m in 0.74s]
[0m04:57:23.416713 [debug] [Thread-1 (]: Finished running node model.stock_dbt.moving_average
[0m04:57:23.418478 [debug] [Thread-1 (]: Began running node model.stock_dbt.rsi_calculation
[0m04:57:23.419806 [info ] [Thread-1 (]: 5 of 5 START sql view model analytics.rsi_calculation .......................... [RUN]
[0m04:57:23.420822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.moving_average, now model.stock_dbt.rsi_calculation)
[0m04:57:23.421952 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.rsi_calculation
[0m04:57:23.424674 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.rsi_calculation"
[0m04:57:23.433675 [debug] [Thread-1 (]: Began executing node model.stock_dbt.rsi_calculation
[0m04:57:23.436154 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.rsi_calculation"
[0m04:57:23.444330 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.rsi_calculation"
[0m04:57:23.445447 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e869f8a6-b369-4111-93d7-93057fff977b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f397824b650>]}
[0m04:57:23.446258 [debug] [Thread-1 (]: On model.stock_dbt.rsi_calculation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.rsi_calculation"} */
create or replace   view dev.analytics.rsi_calculation
  
   as (
    WITH stock_data AS (
    SELECT
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM dev.analytics.stock_prices
),

price_changes AS (
    SELECT
        symbol,
        date,
        close,
        CASE 
            WHEN close > prev_close THEN close - prev_close
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close < prev_close THEN prev_close - close
            ELSE 0 
        END AS loss
    FROM stock_data
),

average_gains_losses AS (
    SELECT
        symbol,
        date,
        close,
        -- Calculate the average gain over the last 14 days, including the current row
        AVG(gain) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain,
        -- Calculate the average loss over the last 14 days, including the current row
        AVG(loss) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss
    FROM price_changes
)

SELECT
    symbol,
    date,
    close,
    avg_gain,
    avg_loss,
    -- Calculate RSI, using COALESCE to set to 0 if result is NULL
    COALESCE(100 - (100 / (1 + (NULLIF(avg_gain, 0) / NULLIF(avg_loss, 0)))), 0) AS rsi_14d
FROM average_gains_losses
ORDER BY symbol, date
  );
[0m04:57:23.447781 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.bollinger ........................... [[32mSUCCESS 1[0m in 0.77s]
[0m04:57:23.447909 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:23.450265 [debug] [Thread-1 (]: Finished running node model.stock_dbt.bollinger
[0m04:57:23.451889 [debug] [Thread-1 (]: Began running node model.stock_dbt.moving_average
[0m04:57:23.453343 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.moving_average ........................... [RUN]
[0m04:57:23.454770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.bollinger, now model.stock_dbt.moving_average)
[0m04:57:23.455890 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.moving_average
[0m04:57:23.458560 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.moving_average"
[0m04:57:23.467394 [debug] [Thread-1 (]: Began executing node model.stock_dbt.moving_average
[0m04:57:23.469860 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.moving_average"
[0m04:57:23.478962 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.moving_average"
[0m04:57:23.479922 [debug] [Thread-1 (]: On model.stock_dbt.moving_average: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.moving_average"} */
create or replace   view dev.analytics.moving_average
  
   as (
    WITH stock_data AS (
    SELECT
        symbol,
        date,
        close
    FROM dev.analytics.stock_prices -- assuming 'stock_prices' is the name of the raw table model in dbt
)

SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
    ) AS moving_avg_5d,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
    ) AS moving_avg_20d
FROM stock_data
ORDER BY symbol, date
  );
[0m04:57:23.480813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:24.091449 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.610 seconds
[0m04:57:24.096188 [debug] [Thread-1 (]: On model.stock_dbt.moving_average: Close
[0m04:57:24.127972 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.680 seconds
[0m04:57:24.132173 [debug] [Thread-1 (]: On model.stock_dbt.rsi_calculation: Close
[0m04:57:24.248463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3798c2d-7fb8-4fa6-8b62-b9597a443764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd53d9d60>]}
[0m04:57:24.249801 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e869f8a6-b369-4111-93d7-93057fff977b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39805c3080>]}
[0m04:57:24.251350 [info ] [Thread-1 (]: 5 of 5 OK created sql view model analytics.rsi_calculation ..................... [[32mSUCCESS 1[0m in 0.83s]
[0m04:57:24.252127 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.moving_average ...................... [[32mSUCCESS 1[0m in 0.79s]
[0m04:57:24.253215 [debug] [Thread-1 (]: Finished running node model.stock_dbt.rsi_calculation
[0m04:57:24.254051 [debug] [Thread-1 (]: Finished running node model.stock_dbt.moving_average
[0m04:57:24.255836 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:57:24.256215 [debug] [Thread-1 (]: Began running node model.stock_dbt.rsi_calculation
[0m04:57:24.257524 [debug] [MainThread]: Connection 'model.stock_dbt.rsi_calculation' was properly closed.
[0m04:57:24.258085 [info ] [Thread-1 (]: 5 of 5 START sql view model analytics.rsi_calculation .......................... [RUN]
[0m04:57:24.259437 [info ] [MainThread]: 
[0m04:57:24.259915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.moving_average, now model.stock_dbt.rsi_calculation)
[0m04:57:24.261242 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 5.71 seconds (5.71s).
[0m04:57:24.261369 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.rsi_calculation
[0m04:57:24.263136 [debug] [MainThread]: Command end result
[0m04:57:24.264871 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.rsi_calculation"
[0m04:57:24.273925 [debug] [Thread-1 (]: Began executing node model.stock_dbt.rsi_calculation
[0m04:57:24.276737 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.rsi_calculation"
[0m04:57:24.286633 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.rsi_calculation"
[0m04:57:24.287969 [debug] [Thread-1 (]: On model.stock_dbt.rsi_calculation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.rsi_calculation"} */
create or replace   view dev.analytics.rsi_calculation
  
   as (
    WITH stock_data AS (
    SELECT
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM dev.analytics.stock_prices
),

price_changes AS (
    SELECT
        symbol,
        date,
        close,
        CASE 
            WHEN close > prev_close THEN close - prev_close
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close < prev_close THEN prev_close - close
            ELSE 0 
        END AS loss
    FROM stock_data
),

average_gains_losses AS (
    SELECT
        symbol,
        date,
        close,
        -- Calculate the average gain over the last 14 days, including the current row
        AVG(gain) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain,
        -- Calculate the average loss over the last 14 days, including the current row
        AVG(loss) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss
    FROM price_changes
)

SELECT
    symbol,
    date,
    close,
    avg_gain,
    avg_loss,
    -- Calculate RSI, using COALESCE to set to 0 if result is NULL
    COALESCE(100 - (100 / (1 + (NULLIF(avg_gain, 0) / NULLIF(avg_loss, 0)))), 0) AS rsi_14d
FROM average_gains_losses
ORDER BY symbol, date
  );
[0m04:57:24.288986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:24.317077 [info ] [MainThread]: 
[0m04:57:24.318749 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:57:24.320826 [info ] [MainThread]: 
[0m04:57:24.322193 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m04:57:24.323728 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.094293, "process_user_time": 3.949411, "process_kernel_time": 3.007165, "process_mem_max_rss": "261340", "process_in_blocks": "480", "process_out_blocks": "8"}
[0m04:57:24.325020 [debug] [MainThread]: Command `dbt run` succeeded at 04:57:24.324917 after 8.10 seconds
[0m04:57:24.326029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff02c473d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff02c4bf3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff02c4bfce0>]}
[0m04:57:24.327007 [debug] [MainThread]: Flushing usage events
[0m04:57:24.854748 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.566 seconds
[0m04:57:24.858195 [debug] [Thread-1 (]: On model.stock_dbt.rsi_calculation: Close
[0m04:57:24.982710 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e869f8a6-b369-4111-93d7-93057fff977b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f398046b170>]}
[0m04:57:24.984625 [info ] [Thread-1 (]: 5 of 5 OK created sql view model analytics.rsi_calculation ..................... [[32mSUCCESS 1[0m in 0.72s]
[0m04:57:24.986671 [debug] [Thread-1 (]: Finished running node model.stock_dbt.rsi_calculation
[0m04:57:24.988459 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:57:24.990973 [debug] [MainThread]: Connection 'model.stock_dbt.rsi_calculation' was properly closed.
[0m04:57:24.992211 [info ] [MainThread]: 
[0m04:57:24.993178 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 5.39 seconds (5.39s).
[0m04:57:24.994589 [debug] [MainThread]: Command end result
[0m04:57:25.063666 [info ] [MainThread]: 
[0m04:57:25.064701 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:57:25.065552 [info ] [MainThread]: 
[0m04:57:25.066833 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m04:57:25.069621 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.713447, "process_user_time": 4.035287, "process_kernel_time": 2.890952, "process_mem_max_rss": "267620", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m04:57:25.076660 [debug] [MainThread]: Command `dbt run` succeeded at 04:57:25.076566 after 7.72 seconds
[0m04:57:25.078323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39dd5db2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39785b03e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39d9beba40>]}
[0m04:57:25.079980 [debug] [MainThread]: Flushing usage events
[0m04:57:26.323257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3588657110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3589d4bd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35899e46b0>]}


============================== 04:57:26.327677 | e024e217-3d90-46b3-b3ed-1422ad720742 ==============================
[0m04:57:26.327677 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:57:26.329166 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/stock_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/stock_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/stock_dbt --project-dir /opt/airflow/stock_dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:57:26.953675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e024e217-3d90-46b3-b3ed-1422ad720742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3588631940>]}
[0m04:57:26.989608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e024e217-3d90-46b3-b3ed-1422ad720742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f352bdd68d0>]}
[0m04:57:26.991716 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:57:27.001195 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:57:27.279238 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:57:27.280599 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:57:27.285574 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.stock_prediction.tranformations
- models.stock_prediction.raw_data
- models.stock_prediction
[0m04:57:27.320776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e024e217-3d90-46b3-b3ed-1422ad720742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3531d2dca0>]}
[0m04:57:27.365250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa92ca9cbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa92e92bbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa92ca33f80>]}


============================== 04:57:27.370291 | c1e5819d-95c8-44fe-b8c7-dff40e248ebe ==============================
[0m04:57:27.370291 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:57:27.371617 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/stock_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/stock_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/stock_dbt --project-dir /opt/airflow/stock_dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:57:27.443707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e024e217-3d90-46b3-b3ed-1422ad720742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3588e15640>]}
[0m04:57:27.445674 [info ] [MainThread]: Found 5 models, 4 snapshots, 27 data tests, 1 source, 459 macros
[0m04:57:27.446517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e024e217-3d90-46b3-b3ed-1422ad720742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f352a6419d0>]}
[0m04:57:27.450723 [info ] [MainThread]: 
[0m04:57:27.451897 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:57:27.461818 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_snapshot'
[0m04:57:27.501907 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m04:57:27.511237 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m04:57:27.512222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:57:27.904135 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.392 seconds
[0m04:57:27.906179 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m04:57:27.959335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1e5819d-95c8-44fe-b8c7-dff40e248ebe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa92d9b7380>]}
[0m04:57:27.994556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1e5819d-95c8-44fe-b8c7-dff40e248ebe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8cf817fe0>]}
[0m04:57:27.996697 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:57:28.006021 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:57:28.018229 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m04:57:28.021375 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m04:57:28.022583 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m04:57:28.024575 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:57:28.507910 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:57:28.509345 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:57:28.514418 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.stock_prediction.raw_data
- models.stock_prediction
- models.stock_prediction.tranformations
[0m04:57:28.547878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1e5819d-95c8-44fe-b8c7-dff40e248ebe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8cf695010>]}
[0m04:57:28.591863 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.567 seconds
[0m04:57:28.595207 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m04:57:28.679587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1e5819d-95c8-44fe-b8c7-dff40e248ebe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ce3c3140>]}
[0m04:57:28.681709 [info ] [MainThread]: Found 5 models, 4 snapshots, 27 data tests, 1 source, 459 macros
[0m04:57:28.683340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1e5819d-95c8-44fe-b8c7-dff40e248ebe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8cf716e40>]}
[0m04:57:28.687069 [info ] [MainThread]: 
[0m04:57:28.689411 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:57:28.694176 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_analytics'
[0m04:57:28.707153 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m04:57:28.709047 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m04:57:28.709895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e024e217-3d90-46b3-b3ed-1422ad720742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f352a78cad0>]}
[0m04:57:28.710399 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:57:28.711385 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:57:28.713150 [info ] [MainThread]: 
[0m04:57:28.720888 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m04:57:28.722087 [info ] [Thread-1 (]: 1 of 27 START test not_null_avg_true_range_atr_14d ............................. [RUN]
[0m04:57:28.723440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad)
[0m04:57:28.724368 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m04:57:28.735476 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad"
[0m04:57:28.746665 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m04:57:28.761719 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad"
[0m04:57:28.775776 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad"
[0m04:57:28.777479 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select atr_14d
from dev.analytics.avg_true_range
where atr_14d is null



      
    ) dbt_internal_test
[0m04:57:28.779348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:29.142314 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.432 seconds
[0m04:57:29.146409 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m04:57:29.289024 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m04:57:29.292591 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m04:57:29.294279 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m04:57:29.295898 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:57:29.305088 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.526 seconds
[0m04:57:29.312392 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad: Close
[0m04:57:29.435009 [info ] [Thread-1 (]: 1 of 27 PASS not_null_avg_true_range_atr_14d ................................... [[32mPASS[0m in 0.71s]
[0m04:57:29.436789 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m04:57:29.438308 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_avg_true_range_date.4e418b835d
[0m04:57:29.439286 [info ] [Thread-1 (]: 2 of 27 START test not_null_avg_true_range_date ................................ [RUN]
[0m04:57:29.440825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad, now test.stock_dbt.not_null_avg_true_range_date.4e418b835d)
[0m04:57:29.441967 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_avg_true_range_date.4e418b835d
[0m04:57:29.446137 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_avg_true_range_date.4e418b835d"
[0m04:57:29.456393 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_avg_true_range_date.4e418b835d
[0m04:57:29.458661 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_avg_true_range_date.4e418b835d"
[0m04:57:29.467523 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_avg_true_range_date.4e418b835d"
[0m04:57:29.468717 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_date.4e418b835d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_avg_true_range_date.4e418b835d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.avg_true_range
where date is null



      
    ) dbt_internal_test
[0m04:57:29.470200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:29.718150 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.422 seconds
[0m04:57:29.720881 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m04:57:29.833746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1e5819d-95c8-44fe-b8c7-dff40e248ebe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ce919fd0>]}
[0m04:57:29.835687 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:57:29.836726 [info ] [MainThread]: 
[0m04:57:29.843605 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m04:57:29.844785 [info ] [Thread-1 (]: 1 of 27 START test not_null_avg_true_range_atr_14d ............................. [RUN]
[0m04:57:29.845827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad)
[0m04:57:29.847452 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m04:57:29.858946 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad"
[0m04:57:29.875126 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m04:57:29.890098 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad"
[0m04:57:29.904411 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad"
[0m04:57:29.905596 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select atr_14d
from dev.analytics.avg_true_range
where atr_14d is null



      
    ) dbt_internal_test
[0m04:57:29.906523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:29.924738 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.455 seconds
[0m04:57:29.927832 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_date.4e418b835d: Close
[0m04:57:30.078225 [info ] [Thread-1 (]: 2 of 27 PASS not_null_avg_true_range_date ...................................... [[32mPASS[0m in 0.64s]
[0m04:57:30.080093 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_avg_true_range_date.4e418b835d
[0m04:57:30.081841 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1
[0m04:57:30.083387 [info ] [Thread-1 (]: 3 of 27 START test not_null_avg_true_range_symbol .............................. [RUN]
[0m04:57:30.084652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_avg_true_range_date.4e418b835d, now test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1)
[0m04:57:30.085593 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1
[0m04:57:30.089124 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1"
[0m04:57:30.097966 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1
[0m04:57:30.100330 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1"
[0m04:57:30.107657 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1"
[0m04:57:30.108772 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.avg_true_range
where symbol is null



      
    ) dbt_internal_test
[0m04:57:30.110301 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:30.468594 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.562 seconds
[0m04:57:30.478120 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad: Close
[0m04:57:30.499087 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.389 seconds
[0m04:57:30.501853 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1: Close
[0m04:57:30.642326 [info ] [Thread-1 (]: 1 of 27 PASS not_null_avg_true_range_atr_14d ................................... [[32mPASS[0m in 0.80s]
[0m04:57:30.642320 [info ] [Thread-1 (]: 3 of 27 PASS not_null_avg_true_range_symbol .................................... [[32mPASS[0m in 0.56s]
[0m04:57:30.645694 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m04:57:30.646124 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1
[0m04:57:30.648542 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_avg_true_range_date.4e418b835d
[0m04:57:30.649011 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_close.4ccb16a429
[0m04:57:30.650880 [info ] [Thread-1 (]: 2 of 27 START test not_null_avg_true_range_date ................................ [RUN]
[0m04:57:30.651338 [info ] [Thread-1 (]: 4 of 27 START test not_null_bollinger_close .................................... [RUN]
[0m04:57:30.653339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad, now test.stock_dbt.not_null_avg_true_range_date.4e418b835d)
[0m04:57:30.653453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1, now test.stock_dbt.not_null_bollinger_close.4ccb16a429)
[0m04:57:30.655242 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_avg_true_range_date.4e418b835d
[0m04:57:30.655222 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_close.4ccb16a429
[0m04:57:30.659481 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_avg_true_range_date.4e418b835d"
[0m04:57:30.659742 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_close.4ccb16a429"
[0m04:57:30.667163 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_avg_true_range_date.4e418b835d
[0m04:57:30.670282 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_close.4ccb16a429
[0m04:57:30.670545 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_avg_true_range_date.4e418b835d"
[0m04:57:30.673063 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_close.4ccb16a429"
[0m04:57:30.679206 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_avg_true_range_date.4e418b835d"
[0m04:57:30.680049 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_close.4ccb16a429"
[0m04:57:30.680205 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_date.4e418b835d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_avg_true_range_date.4e418b835d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.avg_true_range
where date is null



      
    ) dbt_internal_test
[0m04:57:30.681019 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_close.4ccb16a429: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_close.4ccb16a429"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.bollinger
where close is null



      
    ) dbt_internal_test
[0m04:57:30.681094 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:30.681968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:31.153681 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.472 seconds
[0m04:57:31.158106 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_date.4e418b835d: Close
[0m04:57:31.212356 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.530 seconds
[0m04:57:31.215879 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_close.4ccb16a429: Close
[0m04:57:31.273053 [info ] [Thread-1 (]: 2 of 27 PASS not_null_avg_true_range_date ...................................... [[32mPASS[0m in 0.62s]
[0m04:57:31.274387 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_avg_true_range_date.4e418b835d
[0m04:57:31.275472 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1
[0m04:57:31.276435 [info ] [Thread-1 (]: 3 of 27 START test not_null_avg_true_range_symbol .............................. [RUN]
[0m04:57:31.277734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_avg_true_range_date.4e418b835d, now test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1)
[0m04:57:31.279046 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1
[0m04:57:31.282787 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1"
[0m04:57:31.291496 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1
[0m04:57:31.293370 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1"
[0m04:57:31.300797 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1"
[0m04:57:31.302062 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.avg_true_range
where symbol is null



      
    ) dbt_internal_test
[0m04:57:31.303545 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:31.326400 [info ] [Thread-1 (]: 4 of 27 PASS not_null_bollinger_close .......................................... [[32mPASS[0m in 0.67s]
[0m04:57:31.328536 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_close.4ccb16a429
[0m04:57:31.330183 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_date.9d77bdd20c
[0m04:57:31.331972 [info ] [Thread-1 (]: 5 of 27 START test not_null_bollinger_date ..................................... [RUN]
[0m04:57:31.333621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_close.4ccb16a429, now test.stock_dbt.not_null_bollinger_date.9d77bdd20c)
[0m04:57:31.334719 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_date.9d77bdd20c
[0m04:57:31.338331 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_date.9d77bdd20c"
[0m04:57:31.345742 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_date.9d77bdd20c
[0m04:57:31.348182 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_date.9d77bdd20c"
[0m04:57:31.355680 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_date.9d77bdd20c"
[0m04:57:31.356775 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_date.9d77bdd20c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_date.9d77bdd20c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.bollinger
where date is null



      
    ) dbt_internal_test
[0m04:57:31.357704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:31.711832 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.408 seconds
[0m04:57:31.716297 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1: Close
[0m04:57:31.768020 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.410 seconds
[0m04:57:31.770288 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_date.9d77bdd20c: Close
[0m04:57:31.836492 [info ] [Thread-1 (]: 3 of 27 PASS not_null_avg_true_range_symbol .................................... [[32mPASS[0m in 0.56s]
[0m04:57:31.838840 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1
[0m04:57:31.840673 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_close.4ccb16a429
[0m04:57:31.842446 [info ] [Thread-1 (]: 4 of 27 START test not_null_bollinger_close .................................... [RUN]
[0m04:57:31.843996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1, now test.stock_dbt.not_null_bollinger_close.4ccb16a429)
[0m04:57:31.845756 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_close.4ccb16a429
[0m04:57:31.852338 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_close.4ccb16a429"
[0m04:57:31.869388 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_close.4ccb16a429
[0m04:57:31.872161 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_close.4ccb16a429"
[0m04:57:31.880447 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_close.4ccb16a429"
[0m04:57:31.881696 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_close.4ccb16a429: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_close.4ccb16a429"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.bollinger
where close is null



      
    ) dbt_internal_test
[0m04:57:31.882619 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:31.904192 [info ] [Thread-1 (]: 5 of 27 PASS not_null_bollinger_date ........................................... [[32mPASS[0m in 0.57s]
[0m04:57:31.905709 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_date.9d77bdd20c
[0m04:57:31.906652 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e
[0m04:57:31.907424 [info ] [Thread-1 (]: 6 of 27 START test not_null_bollinger_lower_band ............................... [RUN]
[0m04:57:31.908756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_date.9d77bdd20c, now test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e)
[0m04:57:31.909826 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e
[0m04:57:31.913117 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e"
[0m04:57:31.923156 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e
[0m04:57:31.925370 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e"
[0m04:57:31.932364 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e"
[0m04:57:31.933277 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select lower_band
from dev.analytics.bollinger
where lower_band is null



      
    ) dbt_internal_test
[0m04:57:31.934157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:32.340140 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.457 seconds
[0m04:57:32.346545 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_close.4ccb16a429: Close
[0m04:57:32.396496 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.462 seconds
[0m04:57:32.400746 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e: Close
[0m04:57:32.486345 [info ] [Thread-1 (]: 4 of 27 PASS not_null_bollinger_close .......................................... [[32mPASS[0m in 0.64s]
[0m04:57:32.489162 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_close.4ccb16a429
[0m04:57:32.491472 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_date.9d77bdd20c
[0m04:57:32.493355 [info ] [Thread-1 (]: 5 of 27 START test not_null_bollinger_date ..................................... [RUN]
[0m04:57:32.495646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_close.4ccb16a429, now test.stock_dbt.not_null_bollinger_date.9d77bdd20c)
[0m04:57:32.497387 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_date.9d77bdd20c
[0m04:57:32.501537 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_date.9d77bdd20c"
[0m04:57:32.508432 [info ] [Thread-1 (]: 6 of 27 PASS not_null_bollinger_lower_band ..................................... [[32mPASS[0m in 0.60s]
[0m04:57:32.510524 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e
[0m04:57:32.512296 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3
[0m04:57:32.513150 [info ] [Thread-1 (]: 7 of 27 START test not_null_bollinger_sma_20d .................................. [RUN]
[0m04:57:32.514686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e, now test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3)
[0m04:57:32.516184 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3
[0m04:57:32.516623 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_date.9d77bdd20c
[0m04:57:32.518718 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_date.9d77bdd20c"
[0m04:57:32.519702 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3"
[0m04:57:32.526742 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_date.9d77bdd20c"
[0m04:57:32.527072 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3
[0m04:57:32.528059 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_date.9d77bdd20c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_date.9d77bdd20c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.bollinger
where date is null



      
    ) dbt_internal_test
[0m04:57:32.528769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:32.529743 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3"
[0m04:57:32.540223 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3"
[0m04:57:32.541199 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sma_20d
from dev.analytics.bollinger
where sma_20d is null



      
    ) dbt_internal_test
[0m04:57:32.542119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:32.952801 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.424 seconds
[0m04:57:32.956993 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_date.9d77bdd20c: Close
[0m04:57:32.963793 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.422 seconds
[0m04:57:32.966629 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3: Close
[0m04:57:33.089526 [info ] [Thread-1 (]: 7 of 27 PASS not_null_bollinger_sma_20d ........................................ [[32mPASS[0m in 0.57s]
[0m04:57:33.091777 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3
[0m04:57:33.093339 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_symbol.a932e30f82
[0m04:57:33.094441 [info ] [Thread-1 (]: 8 of 27 START test not_null_bollinger_symbol ................................... [RUN]
[0m04:57:33.096121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3, now test.stock_dbt.not_null_bollinger_symbol.a932e30f82)
[0m04:57:33.096812 [info ] [Thread-1 (]: 5 of 27 PASS not_null_bollinger_date ........................................... [[32mPASS[0m in 0.60s]
[0m04:57:33.098952 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_date.9d77bdd20c
[0m04:57:33.098211 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_symbol.a932e30f82
[0m04:57:33.101076 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e
[0m04:57:33.102481 [info ] [Thread-1 (]: 6 of 27 START test not_null_bollinger_lower_band ............................... [RUN]
[0m04:57:33.103888 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_symbol.a932e30f82"
[0m04:57:33.103668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_date.9d77bdd20c, now test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e)
[0m04:57:33.105359 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e
[0m04:57:33.109147 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e"
[0m04:57:33.111250 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_symbol.a932e30f82
[0m04:57:33.114144 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_symbol.a932e30f82"
[0m04:57:33.114902 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e
[0m04:57:33.117385 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e"
[0m04:57:33.122052 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_symbol.a932e30f82"
[0m04:57:33.123413 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_symbol.a932e30f82: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_symbol.a932e30f82"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.bollinger
where symbol is null



      
    ) dbt_internal_test
[0m04:57:33.123548 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e"
[0m04:57:33.124412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:33.124586 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select lower_band
from dev.analytics.bollinger
where lower_band is null



      
    ) dbt_internal_test
[0m04:57:33.125973 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:33.548776 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.423 seconds
[0m04:57:33.551558 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e: Close
[0m04:57:33.610799 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.486 seconds
[0m04:57:33.613719 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_symbol.a932e30f82: Close
[0m04:57:33.685080 [info ] [Thread-1 (]: 6 of 27 PASS not_null_bollinger_lower_band ..................................... [[32mPASS[0m in 0.58s]
[0m04:57:33.687313 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e
[0m04:57:33.689095 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3
[0m04:57:33.690531 [info ] [Thread-1 (]: 7 of 27 START test not_null_bollinger_sma_20d .................................. [RUN]
[0m04:57:33.692486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e, now test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3)
[0m04:57:33.694521 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3
[0m04:57:33.699418 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3"
[0m04:57:33.716157 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3
[0m04:57:33.719524 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3"
[0m04:57:33.729313 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3"
[0m04:57:33.730301 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sma_20d
from dev.analytics.bollinger
where sma_20d is null



      
    ) dbt_internal_test
[0m04:57:33.731187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:33.734386 [info ] [Thread-1 (]: 8 of 27 PASS not_null_bollinger_symbol ......................................... [[32mPASS[0m in 0.64s]
[0m04:57:33.736637 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_symbol.a932e30f82
[0m04:57:33.737603 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_upper_band.e4db87564c
[0m04:57:33.738660 [info ] [Thread-1 (]: 9 of 27 START test not_null_bollinger_upper_band ............................... [RUN]
[0m04:57:33.740374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_symbol.a932e30f82, now test.stock_dbt.not_null_bollinger_upper_band.e4db87564c)
[0m04:57:33.741488 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_upper_band.e4db87564c
[0m04:57:33.745188 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_upper_band.e4db87564c"
[0m04:57:33.752267 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_upper_band.e4db87564c
[0m04:57:33.754665 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_upper_band.e4db87564c"
[0m04:57:33.763481 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_upper_band.e4db87564c"
[0m04:57:33.764795 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_upper_band.e4db87564c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_upper_band.e4db87564c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select upper_band
from dev.analytics.bollinger
where upper_band is null



      
    ) dbt_internal_test
[0m04:57:33.765751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:34.213757 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.483 seconds
[0m04:57:34.216542 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3: Close
[0m04:57:34.254057 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.488 seconds
[0m04:57:34.257288 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_upper_band.e4db87564c: Close
[0m04:57:34.357457 [info ] [Thread-1 (]: 7 of 27 PASS not_null_bollinger_sma_20d ........................................ [[32mPASS[0m in 0.66s]
[0m04:57:34.359101 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3
[0m04:57:34.360294 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_symbol.a932e30f82
[0m04:57:34.361344 [info ] [Thread-1 (]: 8 of 27 START test not_null_bollinger_symbol ................................... [RUN]
[0m04:57:34.362412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3, now test.stock_dbt.not_null_bollinger_symbol.a932e30f82)
[0m04:57:34.363359 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_symbol.a932e30f82
[0m04:57:34.366735 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_symbol.a932e30f82"
[0m04:57:34.377227 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_symbol.a932e30f82
[0m04:57:34.379703 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_symbol.a932e30f82"
[0m04:57:34.390598 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_symbol.a932e30f82"
[0m04:57:34.390820 [info ] [Thread-1 (]: 9 of 27 PASS not_null_bollinger_upper_band ..................................... [[32mPASS[0m in 0.65s]
[0m04:57:34.392069 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_symbol.a932e30f82: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_symbol.a932e30f82"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.bollinger
where symbol is null



      
    ) dbt_internal_test
[0m04:57:34.392288 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_upper_band.e4db87564c
[0m04:57:34.393414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:34.393918 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_close.6d037dd588
[0m04:57:34.394935 [info ] [Thread-1 (]: 10 of 27 START test not_null_moving_average_close .............................. [RUN]
[0m04:57:34.396299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_upper_band.e4db87564c, now test.stock_dbt.not_null_moving_average_close.6d037dd588)
[0m04:57:34.397458 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_close.6d037dd588
[0m04:57:34.401768 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_close.6d037dd588"
[0m04:57:34.409907 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_close.6d037dd588
[0m04:57:34.412154 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_close.6d037dd588"
[0m04:57:34.422527 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_close.6d037dd588"
[0m04:57:34.423466 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_close.6d037dd588: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_close.6d037dd588"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.moving_average
where close is null



      
    ) dbt_internal_test
[0m04:57:34.424535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:34.791806 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.398 seconds
[0m04:57:34.795545 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_symbol.a932e30f82: Close
[0m04:57:34.822445 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.398 seconds
[0m04:57:34.825542 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_close.6d037dd588: Close
[0m04:57:34.917935 [info ] [Thread-1 (]: 8 of 27 PASS not_null_bollinger_symbol ......................................... [[32mPASS[0m in 0.56s]
[0m04:57:34.919471 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_symbol.a932e30f82
[0m04:57:34.920499 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_upper_band.e4db87564c
[0m04:57:34.921363 [info ] [Thread-1 (]: 9 of 27 START test not_null_bollinger_upper_band ............................... [RUN]
[0m04:57:34.922261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_symbol.a932e30f82, now test.stock_dbt.not_null_bollinger_upper_band.e4db87564c)
[0m04:57:34.923139 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_upper_band.e4db87564c
[0m04:57:34.927040 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_upper_band.e4db87564c"
[0m04:57:34.933544 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_upper_band.e4db87564c
[0m04:57:34.935718 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_upper_band.e4db87564c"
[0m04:57:34.943868 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_upper_band.e4db87564c"
[0m04:57:34.944796 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_upper_band.e4db87564c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_upper_band.e4db87564c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select upper_band
from dev.analytics.bollinger
where upper_band is null



      
    ) dbt_internal_test
[0m04:57:34.946027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:34.947095 [info ] [Thread-1 (]: 10 of 27 PASS not_null_moving_average_close .................................... [[32mPASS[0m in 0.55s]
[0m04:57:34.949113 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_close.6d037dd588
[0m04:57:34.950802 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_date.3ad00158b5
[0m04:57:34.952387 [info ] [Thread-1 (]: 11 of 27 START test not_null_moving_average_date ............................... [RUN]
[0m04:57:34.953495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_close.6d037dd588, now test.stock_dbt.not_null_moving_average_date.3ad00158b5)
[0m04:57:34.954976 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_date.3ad00158b5
[0m04:57:34.959100 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_date.3ad00158b5"
[0m04:57:34.968872 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_date.3ad00158b5
[0m04:57:34.971474 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_date.3ad00158b5"
[0m04:57:34.979332 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_date.3ad00158b5"
[0m04:57:34.980276 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_date.3ad00158b5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_date.3ad00158b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.moving_average
where date is null



      
    ) dbt_internal_test
[0m04:57:34.981178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:35.365058 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.419 seconds
[0m04:57:35.367711 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_upper_band.e4db87564c: Close
[0m04:57:35.412792 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.431 seconds
[0m04:57:35.416223 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_date.3ad00158b5: Close
[0m04:57:35.485193 [info ] [Thread-1 (]: 9 of 27 PASS not_null_bollinger_upper_band ..................................... [[32mPASS[0m in 0.56s]
[0m04:57:35.487205 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_upper_band.e4db87564c
[0m04:57:35.488460 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_close.6d037dd588
[0m04:57:35.489320 [info ] [Thread-1 (]: 10 of 27 START test not_null_moving_average_close .............................. [RUN]
[0m04:57:35.490313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_upper_band.e4db87564c, now test.stock_dbt.not_null_moving_average_close.6d037dd588)
[0m04:57:35.491156 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_close.6d037dd588
[0m04:57:35.494912 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_close.6d037dd588"
[0m04:57:35.504392 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_close.6d037dd588
[0m04:57:35.506548 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_close.6d037dd588"
[0m04:57:35.514977 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_close.6d037dd588"
[0m04:57:35.515908 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_close.6d037dd588: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_close.6d037dd588"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.moving_average
where close is null



      
    ) dbt_internal_test
[0m04:57:35.516779 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:35.549009 [info ] [Thread-1 (]: 11 of 27 PASS not_null_moving_average_date ..................................... [[32mPASS[0m in 0.60s]
[0m04:57:35.551630 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_date.3ad00158b5
[0m04:57:35.553097 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m04:57:35.553968 [info ] [Thread-1 (]: 12 of 27 START test not_null_moving_average_moving_avg_20d ..................... [RUN]
[0m04:57:35.555399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_date.3ad00158b5, now test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22)
[0m04:57:35.556207 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m04:57:35.560360 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m04:57:35.567502 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m04:57:35.569608 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m04:57:35.578831 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m04:57:35.580126 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg_20d
from dev.analytics.moving_average
where moving_avg_20d is null



      
    ) dbt_internal_test
[0m04:57:35.581163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:35.939247 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.422 seconds
[0m04:57:35.941458 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_close.6d037dd588: Close
[0m04:57:36.019599 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.438 seconds
[0m04:57:36.022600 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22: Close
[0m04:57:36.083275 [info ] [Thread-1 (]: 10 of 27 PASS not_null_moving_average_close .................................... [[32mPASS[0m in 0.59s]
[0m04:57:36.084702 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_close.6d037dd588
[0m04:57:36.085741 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_date.3ad00158b5
[0m04:57:36.087116 [info ] [Thread-1 (]: 11 of 27 START test not_null_moving_average_date ............................... [RUN]
[0m04:57:36.088242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_close.6d037dd588, now test.stock_dbt.not_null_moving_average_date.3ad00158b5)
[0m04:57:36.089214 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_date.3ad00158b5
[0m04:57:36.092894 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_date.3ad00158b5"
[0m04:57:36.099394 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_date.3ad00158b5
[0m04:57:36.101813 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_date.3ad00158b5"
[0m04:57:36.108018 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_date.3ad00158b5"
[0m04:57:36.109209 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_date.3ad00158b5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_date.3ad00158b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.moving_average
where date is null



      
    ) dbt_internal_test
[0m04:57:36.110048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:36.129551 [info ] [Thread-1 (]: 12 of 27 PASS not_null_moving_average_moving_avg_20d ........................... [[32mPASS[0m in 0.57s]
[0m04:57:36.130968 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m04:57:36.132600 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m04:57:36.134151 [info ] [Thread-1 (]: 13 of 27 START test not_null_moving_average_moving_avg_5d ...................... [RUN]
[0m04:57:36.135440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22, now test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca)
[0m04:57:36.136407 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m04:57:36.139910 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m04:57:36.146760 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m04:57:36.149709 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m04:57:36.158441 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m04:57:36.159999 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg_5d
from dev.analytics.moving_average
where moving_avg_5d is null



      
    ) dbt_internal_test
[0m04:57:36.161052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:36.492473 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.382 seconds
[0m04:57:36.496054 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_date.3ad00158b5: Close
[0m04:57:36.599135 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.438 seconds
[0m04:57:36.601791 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca: Close
[0m04:57:36.612183 [info ] [Thread-1 (]: 11 of 27 PASS not_null_moving_average_date ..................................... [[32mPASS[0m in 0.52s]
[0m04:57:36.613735 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_date.3ad00158b5
[0m04:57:36.614911 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m04:57:36.615914 [info ] [Thread-1 (]: 12 of 27 START test not_null_moving_average_moving_avg_20d ..................... [RUN]
[0m04:57:36.616893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_date.3ad00158b5, now test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22)
[0m04:57:36.617663 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m04:57:36.621654 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m04:57:36.630964 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m04:57:36.633692 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m04:57:36.640908 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m04:57:36.641929 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg_20d
from dev.analytics.moving_average
where moving_avg_20d is null



      
    ) dbt_internal_test
[0m04:57:36.642717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:36.730230 [info ] [Thread-1 (]: 13 of 27 PASS not_null_moving_average_moving_avg_5d ............................ [[32mPASS[0m in 0.59s]
[0m04:57:36.732414 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m04:57:36.733700 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_symbol.75a6f7473c
[0m04:57:36.734760 [info ] [Thread-1 (]: 14 of 27 START test not_null_moving_average_symbol ............................. [RUN]
[0m04:57:36.736437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca, now test.stock_dbt.not_null_moving_average_symbol.75a6f7473c)
[0m04:57:36.737694 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_symbol.75a6f7473c
[0m04:57:36.742031 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_symbol.75a6f7473c"
[0m04:57:36.753254 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_symbol.75a6f7473c
[0m04:57:36.755761 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_symbol.75a6f7473c"
[0m04:57:36.766127 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_symbol.75a6f7473c"
[0m04:57:36.767369 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_symbol.75a6f7473c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_symbol.75a6f7473c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.moving_average
where symbol is null



      
    ) dbt_internal_test
[0m04:57:36.768308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:37.002883 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.360 seconds
[0m04:57:37.005242 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22: Close
[0m04:57:37.118287 [info ] [Thread-1 (]: 12 of 27 PASS not_null_moving_average_moving_avg_20d ........................... [[32mPASS[0m in 0.50s]
[0m04:57:37.119811 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m04:57:37.120535 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m04:57:37.121440 [info ] [Thread-1 (]: 13 of 27 START test not_null_moving_average_moving_avg_5d ...................... [RUN]
[0m04:57:37.122223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22, now test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca)
[0m04:57:37.123621 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m04:57:37.127696 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m04:57:37.136364 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m04:57:37.140553 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m04:57:37.149158 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m04:57:37.152321 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg_5d
from dev.analytics.moving_average
where moving_avg_5d is null



      
    ) dbt_internal_test
[0m04:57:37.154131 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:37.262895 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.494 seconds
[0m04:57:37.266883 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_symbol.75a6f7473c: Close
[0m04:57:37.389433 [info ] [Thread-1 (]: 14 of 27 PASS not_null_moving_average_symbol ................................... [[32mPASS[0m in 0.65s]
[0m04:57:37.391965 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_symbol.75a6f7473c
[0m04:57:37.393060 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42
[0m04:57:37.393990 [info ] [Thread-1 (]: 15 of 27 START test not_null_rsi_calculation_avg_gain .......................... [RUN]
[0m04:57:37.394853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_symbol.75a6f7473c, now test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42)
[0m04:57:37.395983 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42
[0m04:57:37.400055 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m04:57:37.407609 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42
[0m04:57:37.410213 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m04:57:37.420427 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m04:57:37.422008 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_gain
from dev.analytics.rsi_calculation
where avg_gain is null



      
    ) dbt_internal_test
[0m04:57:37.423540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:37.546124 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.392 seconds
[0m04:57:37.549438 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca: Close
[0m04:57:37.679989 [info ] [Thread-1 (]: 13 of 27 PASS not_null_moving_average_moving_avg_5d ............................ [[32mPASS[0m in 0.56s]
[0m04:57:37.681655 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m04:57:37.683286 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_symbol.75a6f7473c
[0m04:57:37.684844 [info ] [Thread-1 (]: 14 of 27 START test not_null_moving_average_symbol ............................. [RUN]
[0m04:57:37.686056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca, now test.stock_dbt.not_null_moving_average_symbol.75a6f7473c)
[0m04:57:37.687231 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_symbol.75a6f7473c
[0m04:57:37.691461 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_symbol.75a6f7473c"
[0m04:57:37.702620 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_symbol.75a6f7473c
[0m04:57:37.705070 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_symbol.75a6f7473c"
[0m04:57:37.715304 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_symbol.75a6f7473c"
[0m04:57:37.716169 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_symbol.75a6f7473c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_symbol.75a6f7473c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.moving_average
where symbol is null



      
    ) dbt_internal_test
[0m04:57:37.717080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:37.871500 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.448 seconds
[0m04:57:37.873620 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42: Close
[0m04:57:37.984634 [info ] [Thread-1 (]: 15 of 27 PASS not_null_rsi_calculation_avg_gain ................................ [[32mPASS[0m in 0.59s]
[0m04:57:37.987308 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42
[0m04:57:37.988485 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m04:57:37.990183 [info ] [Thread-1 (]: 16 of 27 START test not_null_rsi_calculation_avg_loss .......................... [RUN]
[0m04:57:37.991886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42, now test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19)
[0m04:57:37.992981 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m04:57:37.996861 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m04:57:38.004025 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m04:57:38.006263 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m04:57:38.015295 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m04:57:38.016223 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_loss
from dev.analytics.rsi_calculation
where avg_loss is null



      
    ) dbt_internal_test
[0m04:57:38.017097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:38.091434 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.374 seconds
[0m04:57:38.094832 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_symbol.75a6f7473c: Close
[0m04:57:38.230000 [info ] [Thread-1 (]: 14 of 27 PASS not_null_moving_average_symbol ................................... [[32mPASS[0m in 0.54s]
[0m04:57:38.233609 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_symbol.75a6f7473c
[0m04:57:38.235701 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42
[0m04:57:38.237258 [info ] [Thread-1 (]: 15 of 27 START test not_null_rsi_calculation_avg_gain .......................... [RUN]
[0m04:57:38.238815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_symbol.75a6f7473c, now test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42)
[0m04:57:38.239990 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42
[0m04:57:38.243970 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m04:57:38.263925 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42
[0m04:57:38.266845 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m04:57:38.276208 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m04:57:38.277024 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_gain
from dev.analytics.rsi_calculation
where avg_gain is null



      
    ) dbt_internal_test
[0m04:57:38.279320 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:38.616687 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.600 seconds
[0m04:57:38.619265 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19: Close
[0m04:57:38.729559 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.450 seconds
[0m04:57:38.732192 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42: Close
[0m04:57:38.754241 [info ] [Thread-1 (]: 16 of 27 PASS not_null_rsi_calculation_avg_loss ................................ [[32mPASS[0m in 0.76s]
[0m04:57:38.756000 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m04:57:38.756977 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d
[0m04:57:38.758105 [info ] [Thread-1 (]: 17 of 27 START test not_null_rsi_calculation_close ............................. [RUN]
[0m04:57:38.759383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19, now test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d)
[0m04:57:38.760740 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d
[0m04:57:38.764551 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d"
[0m04:57:38.773112 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d
[0m04:57:38.775380 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d"
[0m04:57:38.784114 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d"
[0m04:57:38.785006 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.rsi_calculation
where close is null



      
    ) dbt_internal_test
[0m04:57:38.785981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:38.855004 [info ] [Thread-1 (]: 15 of 27 PASS not_null_rsi_calculation_avg_gain ................................ [[32mPASS[0m in 0.62s]
[0m04:57:38.856898 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42
[0m04:57:38.857731 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m04:57:38.859131 [info ] [Thread-1 (]: 16 of 27 START test not_null_rsi_calculation_avg_loss .......................... [RUN]
[0m04:57:38.860150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42, now test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19)
[0m04:57:38.860862 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m04:57:38.865142 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m04:57:38.875020 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m04:57:38.877371 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m04:57:38.891876 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m04:57:38.892647 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_loss
from dev.analytics.rsi_calculation
where avg_loss is null



      
    ) dbt_internal_test
[0m04:57:38.893634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:39.283548 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.497 seconds
[0m04:57:39.286350 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d: Close
[0m04:57:39.325852 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.432 seconds
[0m04:57:39.329445 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19: Close
[0m04:57:39.424053 [info ] [Thread-1 (]: 17 of 27 PASS not_null_rsi_calculation_close ................................... [[32mPASS[0m in 0.66s]
[0m04:57:39.426393 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d
[0m04:57:39.427949 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76
[0m04:57:39.429269 [info ] [Thread-1 (]: 18 of 27 START test not_null_rsi_calculation_date .............................. [RUN]
[0m04:57:39.430577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d, now test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76)
[0m04:57:39.431384 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76
[0m04:57:39.456311 [info ] [Thread-1 (]: 16 of 27 PASS not_null_rsi_calculation_avg_loss ................................ [[32mPASS[0m in 0.60s]
[0m04:57:39.457736 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m04:57:39.459122 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d
[0m04:57:39.460407 [info ] [Thread-1 (]: 17 of 27 START test not_null_rsi_calculation_close ............................. [RUN]
[0m04:57:39.461437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19, now test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d)
[0m04:57:39.462413 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d
[0m04:57:39.466255 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d"
[0m04:57:39.474397 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d
[0m04:57:39.477375 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d"
[0m04:57:39.485084 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76"
[0m04:57:39.486655 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d"
[0m04:57:39.487407 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.rsi_calculation
where close is null



      
    ) dbt_internal_test
[0m04:57:39.488614 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:39.497201 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76
[0m04:57:39.499916 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76"
[0m04:57:39.508425 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76"
[0m04:57:39.509126 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.rsi_calculation
where date is null



      
    ) dbt_internal_test
[0m04:57:39.509900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:39.889154 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.379 seconds
[0m04:57:39.892594 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76: Close
[0m04:57:39.897347 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.409 seconds
[0m04:57:39.899781 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d: Close
[0m04:57:40.019777 [info ] [Thread-1 (]: 18 of 27 PASS not_null_rsi_calculation_date .................................... [[32mPASS[0m in 0.59s]
[0m04:57:40.021838 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76
[0m04:57:40.023428 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m04:57:40.023564 [info ] [Thread-1 (]: 17 of 27 PASS not_null_rsi_calculation_close ................................... [[32mPASS[0m in 0.56s]
[0m04:57:40.025526 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d
[0m04:57:40.025052 [info ] [Thread-1 (]: 19 of 27 START test not_null_rsi_calculation_rsi_14d ........................... [RUN]
[0m04:57:40.027146 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76
[0m04:57:40.027328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76, now test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8)
[0m04:57:40.028131 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m04:57:40.027983 [info ] [Thread-1 (]: 18 of 27 START test not_null_rsi_calculation_date .............................. [RUN]
[0m04:57:40.028975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d, now test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76)
[0m04:57:40.030626 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76
[0m04:57:40.031685 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m04:57:40.039566 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m04:57:40.041966 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m04:57:40.051223 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m04:57:40.052345 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from dev.analytics.rsi_calculation
where rsi_14d is null



      
    ) dbt_internal_test
[0m04:57:40.053531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:40.078163 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76"
[0m04:57:40.086483 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76
[0m04:57:40.088850 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76"
[0m04:57:40.101595 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76"
[0m04:57:40.102493 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.rsi_calculation
where date is null



      
    ) dbt_internal_test
[0m04:57:40.103500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:40.543404 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.490 seconds
[0m04:57:40.546977 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8: Close
[0m04:57:40.600563 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.497 seconds
[0m04:57:40.603994 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76: Close
[0m04:57:40.676480 [info ] [Thread-1 (]: 19 of 27 PASS not_null_rsi_calculation_rsi_14d ................................. [[32mPASS[0m in 0.65s]
[0m04:57:40.678578 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m04:57:40.679632 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84
[0m04:57:40.680598 [info ] [Thread-1 (]: 20 of 27 START test not_null_rsi_calculation_symbol ............................ [RUN]
[0m04:57:40.682151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8, now test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84)
[0m04:57:40.683016 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84
[0m04:57:40.686722 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m04:57:40.694738 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84
[0m04:57:40.697124 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m04:57:40.704598 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m04:57:40.705764 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.rsi_calculation
where symbol is null



      
    ) dbt_internal_test
[0m04:57:40.706607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:40.731472 [info ] [Thread-1 (]: 18 of 27 PASS not_null_rsi_calculation_date .................................... [[32mPASS[0m in 0.70s]
[0m04:57:40.733291 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76
[0m04:57:40.734489 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m04:57:40.735511 [info ] [Thread-1 (]: 19 of 27 START test not_null_rsi_calculation_rsi_14d ........................... [RUN]
[0m04:57:40.736599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76, now test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8)
[0m04:57:40.737628 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m04:57:40.741372 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m04:57:40.751754 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m04:57:40.754465 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m04:57:40.763648 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m04:57:40.764731 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from dev.analytics.rsi_calculation
where rsi_14d is null



      
    ) dbt_internal_test
[0m04:57:40.765746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:41.104999 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.398 seconds
[0m04:57:41.107815 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84: Close
[0m04:57:41.184358 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.419 seconds
[0m04:57:41.186902 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8: Close
[0m04:57:41.224592 [info ] [Thread-1 (]: 20 of 27 PASS not_null_rsi_calculation_symbol .................................. [[32mPASS[0m in 0.54s]
[0m04:57:41.226510 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84
[0m04:57:41.227540 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_close.d7e232e1ba
[0m04:57:41.228481 [info ] [Thread-1 (]: 21 of 27 START test not_null_stock_prices_close ................................ [RUN]
[0m04:57:41.229810 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84, now test.stock_dbt.not_null_stock_prices_close.d7e232e1ba)
[0m04:57:41.231297 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_close.d7e232e1ba
[0m04:57:41.234902 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_close.d7e232e1ba"
[0m04:57:41.243356 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_close.d7e232e1ba
[0m04:57:41.245741 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_close.d7e232e1ba"
[0m04:57:41.260808 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_close.d7e232e1ba"
[0m04:57:41.261425 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_close.d7e232e1ba: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_close.d7e232e1ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.stock_prices
where close is null



      
    ) dbt_internal_test
[0m04:57:41.262207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:41.319990 [info ] [Thread-1 (]: 19 of 27 PASS not_null_rsi_calculation_rsi_14d ................................. [[32mPASS[0m in 0.58s]
[0m04:57:41.321909 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m04:57:41.323414 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84
[0m04:57:41.324787 [info ] [Thread-1 (]: 20 of 27 START test not_null_rsi_calculation_symbol ............................ [RUN]
[0m04:57:41.325757 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8, now test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84)
[0m04:57:41.326511 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84
[0m04:57:41.330352 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m04:57:41.339346 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84
[0m04:57:41.342417 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m04:57:41.350766 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m04:57:41.352241 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.rsi_calculation
where symbol is null



      
    ) dbt_internal_test
[0m04:57:41.353889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:41.612911 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.351 seconds
[0m04:57:41.615950 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_close.d7e232e1ba: Close
[0m04:57:41.702254 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.348 seconds
[0m04:57:41.705171 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84: Close
[0m04:57:41.776043 [info ] [Thread-1 (]: 21 of 27 PASS not_null_stock_prices_close ...................................... [[32mPASS[0m in 0.55s]
[0m04:57:41.777719 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_close.d7e232e1ba
[0m04:57:41.779108 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_date.98a7527501
[0m04:57:41.780612 [info ] [Thread-1 (]: 22 of 27 START test not_null_stock_prices_date ................................. [RUN]
[0m04:57:41.782069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_close.d7e232e1ba, now test.stock_dbt.not_null_stock_prices_date.98a7527501)
[0m04:57:41.783151 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_date.98a7527501
[0m04:57:41.787911 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_date.98a7527501"
[0m04:57:41.794204 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_date.98a7527501
[0m04:57:41.796868 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_date.98a7527501"
[0m04:57:41.807474 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_date.98a7527501"
[0m04:57:41.808442 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_date.98a7527501: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_date.98a7527501"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.stock_prices
where date is null



      
    ) dbt_internal_test
[0m04:57:41.809819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:41.833416 [info ] [Thread-1 (]: 20 of 27 PASS not_null_rsi_calculation_symbol .................................. [[32mPASS[0m in 0.51s]
[0m04:57:41.834831 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84
[0m04:57:41.835867 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_close.d7e232e1ba
[0m04:57:41.836777 [info ] [Thread-1 (]: 21 of 27 START test not_null_stock_prices_close ................................ [RUN]
[0m04:57:41.837915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84, now test.stock_dbt.not_null_stock_prices_close.d7e232e1ba)
[0m04:57:41.838907 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_close.d7e232e1ba
[0m04:57:41.843459 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_close.d7e232e1ba"
[0m04:57:41.850876 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_close.d7e232e1ba
[0m04:57:41.853257 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_close.d7e232e1ba"
[0m04:57:41.862714 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_close.d7e232e1ba"
[0m04:57:41.863607 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_close.d7e232e1ba: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_close.d7e232e1ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.stock_prices
where close is null



      
    ) dbt_internal_test
[0m04:57:41.864563 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:42.233970 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.424 seconds
[0m04:57:42.236606 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_date.98a7527501: Close
[0m04:57:42.252314 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.388 seconds
[0m04:57:42.254693 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_close.d7e232e1ba: Close
[0m04:57:42.337986 [info ] [Thread-1 (]: 22 of 27 PASS not_null_stock_prices_date ....................................... [[32mPASS[0m in 0.56s]
[0m04:57:42.339897 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_date.98a7527501
[0m04:57:42.341168 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc
[0m04:57:42.342399 [info ] [Thread-1 (]: 23 of 27 START test not_null_stock_prices_high ................................. [RUN]
[0m04:57:42.344162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_date.98a7527501, now test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc)
[0m04:57:42.345336 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc
[0m04:57:42.349274 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc"
[0m04:57:42.358483 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc
[0m04:57:42.360773 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc"
[0m04:57:42.370438 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc"
[0m04:57:42.371593 [info ] [Thread-1 (]: 21 of 27 PASS not_null_stock_prices_close ...................................... [[32mPASS[0m in 0.53s]
[0m04:57:42.371949 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select high
from dev.analytics.stock_prices
where high is null



      
    ) dbt_internal_test
[0m04:57:42.373090 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_close.d7e232e1ba
[0m04:57:42.372999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:42.375002 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_date.98a7527501
[0m04:57:42.376357 [info ] [Thread-1 (]: 22 of 27 START test not_null_stock_prices_date ................................. [RUN]
[0m04:57:42.377946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_close.d7e232e1ba, now test.stock_dbt.not_null_stock_prices_date.98a7527501)
[0m04:57:42.379320 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_date.98a7527501
[0m04:57:42.385310 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_date.98a7527501"
[0m04:57:42.400201 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_date.98a7527501
[0m04:57:42.402983 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_date.98a7527501"
[0m04:57:42.412669 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_date.98a7527501"
[0m04:57:42.413727 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_date.98a7527501: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_date.98a7527501"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.stock_prices
where date is null



      
    ) dbt_internal_test
[0m04:57:42.415025 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:42.758694 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.386 seconds
[0m04:57:42.761247 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc: Close
[0m04:57:42.815940 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.401 seconds
[0m04:57:42.818934 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_date.98a7527501: Close
[0m04:57:42.876008 [info ] [Thread-1 (]: 23 of 27 PASS not_null_stock_prices_high ....................................... [[32mPASS[0m in 0.53s]
[0m04:57:42.878424 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc
[0m04:57:42.880015 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_low.e65294ca15
[0m04:57:42.881530 [info ] [Thread-1 (]: 24 of 27 START test not_null_stock_prices_low .................................. [RUN]
[0m04:57:42.882831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc, now test.stock_dbt.not_null_stock_prices_low.e65294ca15)
[0m04:57:42.883545 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_low.e65294ca15
[0m04:57:42.887442 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_low.e65294ca15"
[0m04:57:42.896741 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_low.e65294ca15
[0m04:57:42.899273 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_low.e65294ca15"
[0m04:57:42.906804 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_low.e65294ca15"
[0m04:57:42.907832 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_low.e65294ca15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_low.e65294ca15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select low
from dev.analytics.stock_prices
where low is null



      
    ) dbt_internal_test
[0m04:57:42.908646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:42.933145 [info ] [Thread-1 (]: 22 of 27 PASS not_null_stock_prices_date ....................................... [[32mPASS[0m in 0.55s]
[0m04:57:42.934869 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_date.98a7527501
[0m04:57:42.936074 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc
[0m04:57:42.937115 [info ] [Thread-1 (]: 23 of 27 START test not_null_stock_prices_high ................................. [RUN]
[0m04:57:42.938349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_date.98a7527501, now test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc)
[0m04:57:42.939886 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc
[0m04:57:42.944101 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc"
[0m04:57:42.951921 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc
[0m04:57:42.954639 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc"
[0m04:57:42.962917 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc"
[0m04:57:42.963838 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select high
from dev.analytics.stock_prices
where high is null



      
    ) dbt_internal_test
[0m04:57:42.964683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:43.445597 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.481 seconds
[0m04:57:43.448496 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc: Close
[0m04:57:43.481972 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.573 seconds
[0m04:57:43.485055 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_low.e65294ca15: Close
[0m04:57:43.565551 [info ] [Thread-1 (]: 23 of 27 PASS not_null_stock_prices_high ....................................... [[32mPASS[0m in 0.63s]
[0m04:57:43.566750 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc
[0m04:57:43.568153 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_low.e65294ca15
[0m04:57:43.569110 [info ] [Thread-1 (]: 24 of 27 START test not_null_stock_prices_low .................................. [RUN]
[0m04:57:43.570678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc, now test.stock_dbt.not_null_stock_prices_low.e65294ca15)
[0m04:57:43.572347 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_low.e65294ca15
[0m04:57:43.576299 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_low.e65294ca15"
[0m04:57:43.585538 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_low.e65294ca15
[0m04:57:43.588141 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_low.e65294ca15"
[0m04:57:43.595407 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_low.e65294ca15"
[0m04:57:43.596498 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_low.e65294ca15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_low.e65294ca15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select low
from dev.analytics.stock_prices
where low is null



      
    ) dbt_internal_test
[0m04:57:43.597520 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:43.601194 [info ] [Thread-1 (]: 24 of 27 PASS not_null_stock_prices_low ........................................ [[32mPASS[0m in 0.72s]
[0m04:57:43.603152 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_low.e65294ca15
[0m04:57:43.604326 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_open.e09b13f215
[0m04:57:43.605212 [info ] [Thread-1 (]: 25 of 27 START test not_null_stock_prices_open ................................. [RUN]
[0m04:57:43.606516 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_low.e65294ca15, now test.stock_dbt.not_null_stock_prices_open.e09b13f215)
[0m04:57:43.607219 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_open.e09b13f215
[0m04:57:43.611102 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_open.e09b13f215"
[0m04:57:43.619547 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_open.e09b13f215
[0m04:57:43.621673 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_open.e09b13f215"
[0m04:57:43.628662 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_open.e09b13f215"
[0m04:57:43.629619 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_open.e09b13f215: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_open.e09b13f215"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from dev.analytics.stock_prices
where open is null



      
    ) dbt_internal_test
[0m04:57:43.630333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:43.958045 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.360 seconds
[0m04:57:43.961261 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_low.e65294ca15: Close
[0m04:57:44.043163 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.414 seconds
[0m04:57:44.046085 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_open.e09b13f215: Close
[0m04:57:44.110099 [info ] [Thread-1 (]: 24 of 27 PASS not_null_stock_prices_low ........................................ [[32mPASS[0m in 0.54s]
[0m04:57:44.112827 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_low.e65294ca15
[0m04:57:44.114968 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_open.e09b13f215
[0m04:57:44.116918 [info ] [Thread-1 (]: 25 of 27 START test not_null_stock_prices_open ................................. [RUN]
[0m04:57:44.118982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_low.e65294ca15, now test.stock_dbt.not_null_stock_prices_open.e09b13f215)
[0m04:57:44.121064 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_open.e09b13f215
[0m04:57:44.126169 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_open.e09b13f215"
[0m04:57:44.147955 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_open.e09b13f215
[0m04:57:44.151539 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_open.e09b13f215"
[0m04:57:44.172211 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_open.e09b13f215"
[0m04:57:44.173715 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_open.e09b13f215: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_open.e09b13f215"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from dev.analytics.stock_prices
where open is null



      
    ) dbt_internal_test
[0m04:57:44.175178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:44.181659 [info ] [Thread-1 (]: 25 of 27 PASS not_null_stock_prices_open ....................................... [[32mPASS[0m in 0.57s]
[0m04:57:44.183350 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_open.e09b13f215
[0m04:57:44.184761 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8
[0m04:57:44.186512 [info ] [Thread-1 (]: 26 of 27 START test not_null_stock_prices_symbol ............................... [RUN]
[0m04:57:44.190178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_open.e09b13f215, now test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8)
[0m04:57:44.191297 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8
[0m04:57:44.196270 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8"
[0m04:57:44.206828 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8
[0m04:57:44.209662 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8"
[0m04:57:44.221430 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8"
[0m04:57:44.223097 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.stock_prices
where symbol is null



      
    ) dbt_internal_test
[0m04:57:44.224338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:44.518542 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.343 seconds
[0m04:57:44.521533 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_open.e09b13f215: Close
[0m04:57:44.630397 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.406 seconds
[0m04:57:44.634651 [info ] [Thread-1 (]: 25 of 27 PASS not_null_stock_prices_open ....................................... [[32mPASS[0m in 0.52s]
[0m04:57:44.634721 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8: Close
[0m04:57:44.636183 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_open.e09b13f215
[0m04:57:44.637263 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8
[0m04:57:44.638526 [info ] [Thread-1 (]: 26 of 27 START test not_null_stock_prices_symbol ............................... [RUN]
[0m04:57:44.639461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_open.e09b13f215, now test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8)
[0m04:57:44.640681 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8
[0m04:57:44.645177 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8"
[0m04:57:44.660265 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8
[0m04:57:44.663045 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8"
[0m04:57:44.671573 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8"
[0m04:57:44.672743 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.stock_prices
where symbol is null



      
    ) dbt_internal_test
[0m04:57:44.673698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:44.764469 [info ] [Thread-1 (]: 26 of 27 PASS not_null_stock_prices_symbol ..................................... [[32mPASS[0m in 0.57s]
[0m04:57:44.767961 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8
[0m04:57:44.769673 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_volume.71420bc956
[0m04:57:44.771245 [info ] [Thread-1 (]: 27 of 27 START test not_null_stock_prices_volume ............................... [RUN]
[0m04:57:44.772337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8, now test.stock_dbt.not_null_stock_prices_volume.71420bc956)
[0m04:57:44.773677 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_volume.71420bc956
[0m04:57:44.777681 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_volume.71420bc956"
[0m04:57:44.784666 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_volume.71420bc956
[0m04:57:44.787129 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_volume.71420bc956"
[0m04:57:44.798388 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_volume.71420bc956"
[0m04:57:44.799947 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_volume.71420bc956: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_volume.71420bc956"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume
from dev.analytics.stock_prices
where volume is null



      
    ) dbt_internal_test
[0m04:57:44.801400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:45.030104 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.356 seconds
[0m04:57:45.033506 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8: Close
[0m04:57:45.191669 [info ] [Thread-1 (]: 26 of 27 PASS not_null_stock_prices_symbol ..................................... [[32mPASS[0m in 0.55s]
[0m04:57:45.192081 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.391 seconds
[0m04:57:45.193376 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8
[0m04:57:45.194462 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_volume.71420bc956
[0m04:57:45.194841 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_volume.71420bc956: Close
[0m04:57:45.196293 [info ] [Thread-1 (]: 27 of 27 START test not_null_stock_prices_volume ............................... [RUN]
[0m04:57:45.197812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8, now test.stock_dbt.not_null_stock_prices_volume.71420bc956)
[0m04:57:45.199276 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_volume.71420bc956
[0m04:57:45.203553 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_volume.71420bc956"
[0m04:57:45.210561 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_volume.71420bc956
[0m04:57:45.213082 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_volume.71420bc956"
[0m04:57:45.222363 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_volume.71420bc956"
[0m04:57:45.223356 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_volume.71420bc956: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_volume.71420bc956"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume
from dev.analytics.stock_prices
where volume is null



      
    ) dbt_internal_test
[0m04:57:45.224920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:45.318360 [info ] [Thread-1 (]: 27 of 27 PASS not_null_stock_prices_volume ..................................... [[32mPASS[0m in 0.55s]
[0m04:57:45.320331 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_volume.71420bc956
[0m04:57:45.322493 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:57:45.323419 [debug] [MainThread]: Connection 'test.stock_dbt.not_null_stock_prices_volume.71420bc956' was properly closed.
[0m04:57:45.324468 [info ] [MainThread]: 
[0m04:57:45.325267 [info ] [MainThread]: Finished running 27 data tests in 0 hours 0 minutes and 17.87 seconds (17.87s).
[0m04:57:45.328664 [debug] [MainThread]: Command end result
[0m04:57:45.383377 [info ] [MainThread]: 
[0m04:57:45.385119 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:57:45.386523 [info ] [MainThread]: 
[0m04:57:45.388457 [info ] [MainThread]: Done. PASS=27 WARN=0 ERROR=0 SKIP=0 TOTAL=27
[0m04:57:45.390703 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 19.157612, "process_user_time": 3.78634, "process_kernel_time": 2.873465, "process_mem_max_rss": "243320", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m04:57:45.392708 [debug] [MainThread]: Command `dbt test` succeeded at 04:57:45.392625 after 19.16 seconds
[0m04:57:45.394207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3589330ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f352973fbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3588d63ad0>]}
[0m04:57:45.395769 [debug] [MainThread]: Flushing usage events
[0m04:57:45.575588 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.351 seconds
[0m04:57:45.579024 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_volume.71420bc956: Close
[0m04:57:45.701424 [info ] [Thread-1 (]: 27 of 27 PASS not_null_stock_prices_volume ..................................... [[32mPASS[0m in 0.50s]
[0m04:57:45.703441 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_volume.71420bc956
[0m04:57:45.705747 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:57:45.706960 [debug] [MainThread]: Connection 'test.stock_dbt.not_null_stock_prices_volume.71420bc956' was properly closed.
[0m04:57:45.708034 [info ] [MainThread]: 
[0m04:57:45.709001 [info ] [MainThread]: Finished running 27 data tests in 0 hours 0 minutes and 17.02 seconds (17.02s).
[0m04:57:45.711922 [debug] [MainThread]: Command end result
[0m04:57:45.776286 [info ] [MainThread]: 
[0m04:57:45.777435 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:57:45.778812 [info ] [MainThread]: 
[0m04:57:45.780343 [info ] [MainThread]: Done. PASS=27 WARN=0 ERROR=0 SKIP=0 TOTAL=27
[0m04:57:45.781839 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 18.48553, "process_user_time": 3.764924, "process_kernel_time": 2.996193, "process_mem_max_rss": "236712", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m04:57:45.782695 [debug] [MainThread]: Command `dbt test` succeeded at 04:57:45.782617 after 18.49 seconds
[0m04:57:45.783627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ce61a4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ceb7d010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa92ca31a30>]}
[0m04:57:45.784542 [debug] [MainThread]: Flushing usage events
[0m04:57:47.320671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08759f11c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f087528e4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0875110890>]}


============================== 04:57:47.325723 | 9fd9b018-3fba-419e-9083-906f6d840a76 ==============================
[0m04:57:47.325723 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:57:47.327493 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/stock_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/stock_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/stock_dbt --project-dir /opt/airflow/stock_dbt', 'send_anonymous_usage_stats': 'True'}
[0m04:57:47.997825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9fd9b018-3fba-419e-9083-906f6d840a76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08790a69c0>]}
[0m04:57:48.036721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9fd9b018-3fba-419e-9083-906f6d840a76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f081c8a61b0>]}
[0m04:57:48.038256 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:57:48.047714 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:57:48.330614 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:57:48.332362 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:57:48.337414 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.stock_prediction.tranformations
- models.stock_prediction.raw_data
- models.stock_prediction
[0m04:57:48.372015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9fd9b018-3fba-419e-9083-906f6d840a76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08178b69f0>]}
[0m04:57:48.504709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9fd9b018-3fba-419e-9083-906f6d840a76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0817549c40>]}
[0m04:57:48.505666 [info ] [MainThread]: Found 5 models, 4 snapshots, 27 data tests, 1 source, 459 macros
[0m04:57:48.507234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fd9b018-3fba-419e-9083-906f6d840a76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0817af1d00>]}
[0m04:57:48.510588 [info ] [MainThread]: 
[0m04:57:48.512681 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:57:48.517400 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m04:57:48.529762 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m04:57:48.531839 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m04:57:48.534516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:57:48.586573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0417a5c4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0419c123f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0417a5d7f0>]}


============================== 04:57:48.591799 | 40eec819-6bb5-4d6a-96ec-4d02ec51b744 ==============================
[0m04:57:48.591799 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:57:48.593631 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/stock_dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/stock_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/stock_dbt --project-dir /opt/airflow/stock_dbt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:57:49.042576 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.508 seconds
[0m04:57:49.045459 [debug] [ThreadPool]: On list_dev: Close
[0m04:57:49.159245 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m04:57:49.167888 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m04:57:49.170009 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m04:57:49.172268 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:57:49.212563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40eec819-6bb5-4d6a-96ec-4d02ec51b744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0417a873b0>]}
[0m04:57:49.251635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40eec819-6bb5-4d6a-96ec-4d02ec51b744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03bda73110>]}
[0m04:57:49.258107 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:57:49.267124 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:57:49.560003 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:57:49.561064 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:57:49.565114 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.stock_prediction
- models.stock_prediction.tranformations
- models.stock_prediction.raw_data
[0m04:57:49.567540 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.395 seconds
[0m04:57:49.569801 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m04:57:49.598823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40eec819-6bb5-4d6a-96ec-4d02ec51b744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03bd969400>]}
[0m04:57:49.685503 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m04:57:49.688585 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m04:57:49.690104 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m04:57:49.691506 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:57:49.729956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40eec819-6bb5-4d6a-96ec-4d02ec51b744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03bd59fec0>]}
[0m04:57:49.731512 [info ] [MainThread]: Found 5 models, 4 snapshots, 27 data tests, 1 source, 459 macros
[0m04:57:49.738138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40eec819-6bb5-4d6a-96ec-4d02ec51b744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03bdc5c6b0>]}
[0m04:57:49.740479 [info ] [MainThread]: 
[0m04:57:49.741558 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:57:49.745640 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m04:57:49.757259 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m04:57:49.758511 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m04:57:49.759461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:57:50.108867 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.417 seconds
[0m04:57:50.113339 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m04:57:50.149866 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.390 seconds
[0m04:57:50.155333 [debug] [ThreadPool]: On list_dev: Close
[0m04:57:50.240058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fd9b018-3fba-419e-9083-906f6d840a76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0817523770>]}
[0m04:57:50.241892 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:57:50.243593 [info ] [MainThread]: 
[0m04:57:50.250345 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.snapshot_atr
[0m04:57:50.251720 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshot.snapshot_atr .................................... [RUN]
[0m04:57:50.253270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now snapshot.stock_dbt.snapshot_atr)
[0m04:57:50.254512 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.snapshot_atr
[0m04:57:50.260460 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.snapshot_atr
[0m04:57:50.274746 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m04:57:50.282722 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m04:57:50.283928 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m04:57:50.284846 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:57:50.304669 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:57:50.306017 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
[0m04:57:50.307105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:50.646740 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.340 seconds
[0m04:57:50.658418 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.374 seconds
[0m04:57:50.660815 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m04:57:50.683062 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:57:50.685563 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.avg_true_range


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m04:57:50.791131 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m04:57:50.795106 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m04:57:50.797115 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m04:57:50.801693 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:57:51.199682 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.398 seconds
[0m04:57:51.202562 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m04:57:51.277424 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.589 seconds
[0m04:57:51.281122 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:57:51.283170 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
[0m04:57:51.323107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40eec819-6bb5-4d6a-96ec-4d02ec51b744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03bd969370>]}
[0m04:57:51.325233 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:57:51.326772 [info ] [MainThread]: 
[0m04:57:51.334253 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.snapshot_atr
[0m04:57:51.336117 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshot.snapshot_atr .................................... [RUN]
[0m04:57:51.337934 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now snapshot.stock_dbt.snapshot_atr)
[0m04:57:51.339721 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.snapshot_atr
[0m04:57:51.346442 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.snapshot_atr
[0m04:57:51.385367 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:57:51.388315 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
[0m04:57:51.390699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:51.392379 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.107 seconds
[0m04:57:51.396760 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:57:51.398792 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
[0m04:57:51.471564 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.071 seconds
[0m04:57:51.476228 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:57:51.478321 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
[0m04:57:51.576781 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.097 seconds
[0m04:57:51.581469 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:57:51.582968 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
[0m04:57:51.650813 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.066 seconds
[0m04:57:51.659112 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:57:51.661314 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
[0m04:57:51.731519 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.068 seconds
[0m04:57:51.749054 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:57:51.751512 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.avg_true_range


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m04:57:51.790773 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.400 seconds
[0m04:57:51.824903 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:57:51.826968 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.avg_true_range


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m04:57:51.940489 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.187 seconds
[0m04:57:51.945079 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:57:51.946662 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m04:57:52.013063 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.064 seconds
[0m04:57:52.017128 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.snapshot_atr"
[0m04:57:52.036385 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:57:52.037512 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
BEGIN
[0m04:57:52.136864 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.098 seconds
[0m04:57:52.140119 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:57:52.142648 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_ATR" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATE", "SYMBOL", "ATR_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATE", "SYMBOL", "ATR_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m04:57:52.390143 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.561 seconds
[0m04:57:52.394755 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:57:52.396558 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
[0m04:57:52.480223 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.082 seconds
[0m04:57:52.484614 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:57:52.486448 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
[0m04:57:52.567117 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.079 seconds
[0m04:57:52.573183 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:57:52.575426 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
[0m04:57:52.628809 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.484 seconds
[0m04:57:52.631135 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:57:52.633191 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
COMMIT
[0m04:57:52.663144 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.085 seconds
[0m04:57:52.668542 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:57:52.670639 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
[0m04:57:52.736657 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.064 seconds
[0m04:57:52.744838 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:57:52.747194 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
[0m04:57:52.837815 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.088 seconds
[0m04:57:52.855402 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:57:52.859114 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.avg_true_range


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m04:57:52.876615 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.242 seconds
[0m04:57:52.894191 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: Close
[0m04:57:53.043208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fd9b018-3fba-419e-9083-906f6d840a76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08179547d0>]}
[0m04:57:53.044998 [info ] [Thread-1 (]: 1 of 4 OK snapshotted snapshot.snapshot_atr .................................... [[32mSUCCESS 0[0m in 2.79s]
[0m04:57:53.046724 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.snapshot_atr
[0m04:57:53.047780 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.snapshot_bollinger
[0m04:57:53.048911 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshot.snapshot_bollinger .............................. [RUN]
[0m04:57:53.050174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_dbt.snapshot_atr, now snapshot.stock_dbt.snapshot_bollinger)
[0m04:57:53.050845 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.snapshot_bollinger
[0m04:57:53.053867 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.snapshot_bollinger
[0m04:57:53.057765 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:57:53.058861 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
[0m04:57:53.059565 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:53.090471 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.228 seconds
[0m04:57:53.093996 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:57:53.095558 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m04:57:53.226330 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.130 seconds
[0m04:57:53.227837 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.snapshot_atr"
[0m04:57:53.235327 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:57:53.236267 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
BEGIN
[0m04:57:53.390640 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.153 seconds
[0m04:57:53.394170 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:57:53.396443 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_ATR" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATE", "SYMBOL", "ATR_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATE", "SYMBOL", "ATR_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m04:57:53.561755 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.502 seconds
[0m04:57:53.568606 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:57:53.570448 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.bollinger


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m04:57:53.896510 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.498 seconds
[0m04:57:53.899267 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m04:57:53.901426 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
COMMIT
[0m04:57:54.128270 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.225 seconds
[0m04:57:54.148044 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: Close
[0m04:57:54.261176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40eec819-6bb5-4d6a-96ec-4d02ec51b744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03bda70650>]}
[0m04:57:54.263795 [info ] [Thread-1 (]: 1 of 4 OK snapshotted snapshot.snapshot_atr .................................... [[32mSUCCESS 0[0m in 2.92s]
[0m04:57:54.265956 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.snapshot_atr
[0m04:57:54.268508 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.snapshot_bollinger
[0m04:57:54.270488 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshot.snapshot_bollinger .............................. [RUN]
[0m04:57:54.271995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_dbt.snapshot_atr, now snapshot.stock_dbt.snapshot_bollinger)
[0m04:57:54.273663 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.snapshot_bollinger
[0m04:57:54.277445 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.snapshot_bollinger
[0m04:57:54.281726 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:57:54.283360 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
[0m04:57:54.285697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:54.285791 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.714 seconds
[0m04:57:54.289296 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:57:54.290829 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
[0m04:57:54.378792 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.086 seconds
[0m04:57:54.382915 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:57:54.384020 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
[0m04:57:54.451903 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.066 seconds
[0m04:57:54.457776 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:57:54.461491 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
[0m04:57:54.546946 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.082 seconds
[0m04:57:54.550968 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:57:54.552291 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
[0m04:57:54.623444 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.338 seconds
[0m04:57:54.623924 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.070 seconds
[0m04:57:54.630654 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:57:54.632112 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:57:54.632717 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
[0m04:57:54.635450 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.bollinger


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m04:57:54.703865 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.068 seconds
[0m04:57:54.710927 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:57:54.713258 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.bollinger


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m04:57:54.966632 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.250 seconds
[0m04:57:54.971554 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:57:54.974643 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m04:57:55.058222 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.081 seconds
[0m04:57:55.060426 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.snapshot_bollinger"
[0m04:57:55.069262 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:57:55.070546 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
BEGIN
[0m04:57:55.161907 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.090 seconds
[0m04:57:55.163272 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:57:55.164262 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "SMA_20D", "UPPER_BAND", "LOWER_BAND", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "SMA_20D", "UPPER_BAND", "LOWER_BAND", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m04:57:55.297681 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.661 seconds
[0m04:57:55.301726 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:57:55.303557 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
[0m04:57:55.392851 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.087 seconds
[0m04:57:55.395850 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:57:55.396903 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
[0m04:57:55.472700 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.075 seconds
[0m04:57:55.476251 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:57:55.477231 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
[0m04:57:55.558465 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.080 seconds
[0m04:57:55.561968 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:57:55.562748 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
[0m04:57:55.672895 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.508 seconds
[0m04:57:55.674266 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:57:55.674990 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
COMMIT
[0m04:57:55.686185 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.122 seconds
[0m04:57:55.690154 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:57:55.691592 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
[0m04:57:55.775710 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.083 seconds
[0m04:57:55.781722 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:57:55.784192 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.bollinger


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m04:57:55.960343 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.284 seconds
[0m04:57:55.963672 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: Close
[0m04:57:55.971412 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.186 seconds
[0m04:57:55.973493 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:57:55.974969 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m04:57:56.045110 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.069 seconds
[0m04:57:56.047345 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.snapshot_bollinger"
[0m04:57:56.058276 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:57:56.059460 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
BEGIN
[0m04:57:56.077149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fd9b018-3fba-419e-9083-906f6d840a76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0815270080>]}
[0m04:57:56.078631 [info ] [Thread-1 (]: 2 of 4 OK snapshotted snapshot.snapshot_bollinger .............................. [[32mSUCCESS 0[0m in 3.03s]
[0m04:57:56.080733 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.snapshot_bollinger
[0m04:57:56.082073 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.snapshot_moving_avg
[0m04:57:56.083214 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshot.snapshot_moving_avg ............................. [RUN]
[0m04:57:56.084571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_dbt.snapshot_bollinger, now snapshot.stock_dbt.snapshot_moving_avg)
[0m04:57:56.085844 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.snapshot_moving_avg
[0m04:57:56.088517 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.snapshot_moving_avg
[0m04:57:56.092242 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:57:56.093298 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
[0m04:57:56.094144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:56.155205 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.095 seconds
[0m04:57:56.156890 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:57:56.158896 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "SMA_20D", "UPPER_BAND", "LOWER_BAND", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "SMA_20D", "UPPER_BAND", "LOWER_BAND", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m04:57:56.501790 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.408 seconds
[0m04:57:56.508793 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:57:56.510100 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.moving_average


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m04:57:56.598414 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.438 seconds
[0m04:57:56.601725 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m04:57:56.604280 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
COMMIT
[0m04:57:56.825801 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.219 seconds
[0m04:57:56.829345 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: Close
[0m04:57:56.941976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40eec819-6bb5-4d6a-96ec-4d02ec51b744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03bcb17680>]}
[0m04:57:56.944023 [info ] [Thread-1 (]: 2 of 4 OK snapshotted snapshot.snapshot_bollinger .............................. [[32mSUCCESS 0[0m in 2.67s]
[0m04:57:56.945602 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.snapshot_bollinger
[0m04:57:56.946757 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.snapshot_moving_avg
[0m04:57:56.947990 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshot.snapshot_moving_avg ............................. [RUN]
[0m04:57:56.949473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_dbt.snapshot_bollinger, now snapshot.stock_dbt.snapshot_moving_avg)
[0m04:57:56.950697 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.snapshot_moving_avg
[0m04:57:56.953788 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.snapshot_moving_avg
[0m04:57:56.957764 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:57:56.958852 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
[0m04:57:56.959906 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:57.083792 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.573 seconds
[0m04:57:57.087327 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:57:57.088640 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
[0m04:57:57.234422 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.145 seconds
[0m04:57:57.238224 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:57:57.239142 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
[0m04:57:57.335455 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.095 seconds
[0m04:57:57.341797 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:57:57.345345 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
[0m04:57:57.361208 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.401 seconds
[0m04:57:57.369378 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:57:57.371433 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.moving_average


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m04:57:57.450260 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.102 seconds
[0m04:57:57.455059 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:57:57.456441 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
[0m04:57:57.561917 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.105 seconds
[0m04:57:57.566176 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:57:57.567689 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
[0m04:57:57.668088 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.099 seconds
[0m04:57:57.673556 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:57:57.675052 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.moving_average


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m04:57:57.886534 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.210 seconds
[0m04:57:57.890123 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:57:57.891330 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m04:57:57.973770 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.081 seconds
[0m04:57:57.975147 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:57:57.983110 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:57:57.984075 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
BEGIN
[0m04:57:58.080288 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.707 seconds
[0m04:57:58.083157 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:57:58.084318 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
[0m04:57:58.092595 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.108 seconds
[0m04:57:58.093657 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:57:58.094737 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "MOVING_AVG_5D", "MOVING_AVG_20D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "MOVING_AVG_5D", "MOVING_AVG_20D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m04:57:58.177163 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.092 seconds
[0m04:57:58.183275 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:57:58.185318 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
[0m04:57:58.258765 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.071 seconds
[0m04:57:58.264354 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:57:58.266159 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
[0m04:57:58.430437 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.163 seconds
[0m04:57:58.433997 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:57:58.435090 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
[0m04:57:58.502190 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.065 seconds
[0m04:57:58.505955 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:57:58.506957 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
[0m04:57:58.575402 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.479 seconds
[0m04:57:58.576651 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:57:58.577472 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
COMMIT
[0m04:57:58.580976 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.073 seconds
[0m04:57:58.585588 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:57:58.586288 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.moving_average


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m04:57:58.759637 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.173 seconds
[0m04:57:58.762194 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:57:58.763578 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m04:57:58.830202 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.065 seconds
[0m04:57:58.831788 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:57:58.837621 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:57:58.838646 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
BEGIN
[0m04:57:58.899500 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.321 seconds
[0m04:57:58.902000 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: Close
[0m04:57:58.970064 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.130 seconds
[0m04:57:58.971543 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:57:58.972456 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "MOVING_AVG_5D", "MOVING_AVG_20D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "MOVING_AVG_5D", "MOVING_AVG_20D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m04:57:59.015430 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fd9b018-3fba-419e-9083-906f6d840a76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0815277860>]}
[0m04:57:59.018402 [info ] [Thread-1 (]: 3 of 4 OK snapshotted snapshot.snapshot_moving_avg ............................. [[32mSUCCESS 0[0m in 2.93s]
[0m04:57:59.020590 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.snapshot_moving_avg
[0m04:57:59.021741 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.snapshot_rsi
[0m04:57:59.022889 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshot.snapshot_rsi .................................... [RUN]
[0m04:57:59.024248 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_dbt.snapshot_moving_avg, now snapshot.stock_dbt.snapshot_rsi)
[0m04:57:59.025129 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.snapshot_rsi
[0m04:57:59.028093 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.snapshot_rsi
[0m04:57:59.031935 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:57:59.033514 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m04:57:59.035495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:57:59.418366 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.445 seconds
[0m04:57:59.419852 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m04:57:59.421041 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
COMMIT
[0m04:57:59.499244 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.464 seconds
[0m04:57:59.505157 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:57:59.506120 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.rsi_calculation


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m04:57:59.813344 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.391 seconds
[0m04:57:59.815550 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: Close
[0m04:57:59.919933 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40eec819-6bb5-4d6a-96ec-4d02ec51b744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03bcb17b00>]}
[0m04:57:59.921346 [info ] [Thread-1 (]: 3 of 4 OK snapshotted snapshot.snapshot_moving_avg ............................. [[32mSUCCESS 0[0m in 2.97s]
[0m04:57:59.922623 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.snapshot_moving_avg
[0m04:57:59.923682 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.snapshot_rsi
[0m04:57:59.924740 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshot.snapshot_rsi .................................... [RUN]
[0m04:57:59.925699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_dbt.snapshot_moving_avg, now snapshot.stock_dbt.snapshot_rsi)
[0m04:57:59.926500 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.snapshot_rsi
[0m04:57:59.929890 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.snapshot_rsi
[0m04:57:59.933931 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:57:59.934970 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m04:57:59.935953 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:58:00.284767 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.778 seconds
[0m04:58:00.292181 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:58:00.294723 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m04:58:00.386394 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.089 seconds
[0m04:58:00.390489 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:58:00.391802 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m04:58:00.467568 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.075 seconds
[0m04:58:00.472105 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:58:00.473094 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m04:58:00.488062 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.552 seconds
[0m04:58:00.493504 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:58:00.494415 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.rsi_calculation


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m04:58:00.550131 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.076 seconds
[0m04:58:00.554932 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:58:00.556149 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m04:58:00.640673 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.083 seconds
[0m04:58:00.647911 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:58:00.650424 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m04:58:00.756841 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.104 seconds
[0m04:58:00.762137 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:58:00.763407 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.rsi_calculation


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m04:58:01.042089 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.277 seconds
[0m04:58:01.043904 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:58:01.044982 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m04:58:01.155468 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.109 seconds
[0m04:58:01.158033 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.snapshot_rsi"
[0m04:58:01.169100 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:58:01.170242 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
BEGIN
[0m04:58:01.263716 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.768 seconds
[0m04:58:01.267814 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:58:01.269060 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m04:58:01.278960 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.108 seconds
[0m04:58:01.280573 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:58:01.281647 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_RSI" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "AVG_GAIN", "AVG_LOSS", "RSI_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "AVG_GAIN", "AVG_LOSS", "RSI_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m04:58:01.384222 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.114 seconds
[0m04:58:01.387471 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:58:01.388549 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m04:58:01.458894 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.069 seconds
[0m04:58:01.463912 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:58:01.465429 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m04:58:01.552246 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.085 seconds
[0m04:58:01.557074 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:58:01.558926 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m04:58:01.647065 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.087 seconds
[0m04:58:01.651323 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:58:01.653001 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m04:58:01.717765 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.435 seconds
[0m04:58:01.720874 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:58:01.723497 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
COMMIT
[0m04:58:01.770059 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.116 seconds
[0m04:58:01.776284 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:58:01.778038 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.rsi_calculation


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m04:58:01.967998 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.189 seconds
[0m04:58:01.970336 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:58:01.971422 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m04:58:01.997651 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.272 seconds
[0m04:58:02.000818 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: Close
[0m04:58:02.057527 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.085 seconds
[0m04:58:02.059312 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.snapshot_rsi"
[0m04:58:02.067729 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:58:02.068909 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
BEGIN
[0m04:58:02.124536 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fd9b018-3fba-419e-9083-906f6d840a76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f081dfbdf10>]}
[0m04:58:02.127316 [info ] [Thread-1 (]: 4 of 4 OK snapshotted snapshot.snapshot_rsi .................................... [[32mSUCCESS 0[0m in 3.10s]
[0m04:58:02.129015 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.snapshot_rsi
[0m04:58:02.131031 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:58:02.132206 [debug] [MainThread]: Connection 'snapshot.stock_dbt.snapshot_rsi' was properly closed.
[0m04:58:02.133418 [info ] [MainThread]: 
[0m04:58:02.135008 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 13.62 seconds (13.62s).
[0m04:58:02.136911 [debug] [MainThread]: Command end result
[0m04:58:02.187621 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.117 seconds
[0m04:58:02.188582 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:58:02.189699 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_RSI" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "AVG_GAIN", "AVG_LOSS", "RSI_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "AVG_GAIN", "AVG_LOSS", "RSI_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m04:58:02.239026 [info ] [MainThread]: 
[0m04:58:02.240260 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:58:02.241721 [info ] [MainThread]: 
[0m04:58:02.243612 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m04:58:02.246026 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 15.011423, "process_user_time": 3.281616, "process_kernel_time": 2.973343, "process_mem_max_rss": "265964", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m04:58:02.248253 [debug] [MainThread]: Command `dbt snapshot` succeeded at 04:58:02.248162 after 15.01 seconds
[0m04:58:02.249966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f081dfbdf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08756464e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08176cfda0>]}
[0m04:58:02.250852 [debug] [MainThread]: Flushing usage events
[0m04:58:02.682641 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.492 seconds
[0m04:58:02.684607 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m04:58:02.686127 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
COMMIT
[0m04:58:03.012753 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.325 seconds
[0m04:58:03.015399 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: Close
[0m04:58:03.136774 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40eec819-6bb5-4d6a-96ec-4d02ec51b744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03bca717c0>]}
[0m04:58:03.138953 [info ] [Thread-1 (]: 4 of 4 OK snapshotted snapshot.snapshot_rsi .................................... [[32mSUCCESS 0[0m in 3.21s]
[0m04:58:03.140872 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.snapshot_rsi
[0m04:58:03.143183 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:58:03.144530 [debug] [MainThread]: Connection 'snapshot.stock_dbt.snapshot_rsi' was properly closed.
[0m04:58:03.146424 [info ] [MainThread]: 
[0m04:58:03.147819 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 13.40 seconds (13.40s).
[0m04:58:03.149474 [debug] [MainThread]: Command end result
[0m04:58:03.257585 [info ] [MainThread]: 
[0m04:58:03.259129 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:58:03.260423 [info ] [MainThread]: 
[0m04:58:03.261690 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m04:58:03.263190 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 14.755399, "process_user_time": 3.459823, "process_kernel_time": 2.864485, "process_mem_max_rss": "255000", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m04:58:03.264096 [debug] [MainThread]: Command `dbt snapshot` succeeded at 04:58:03.264001 after 14.76 seconds
[0m04:58:03.264870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0417ca70b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03bf2b7770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03bd578e00>]}
[0m04:58:03.265588 [debug] [MainThread]: Flushing usage events
[0m05:02:21.766614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163e6f03b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163e100c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163e6f1e80>]}


============================== 05:02:21.773109 | a77382b9-921c-4fae-80d3-3191fe2998f7 ==============================
[0m05:02:21.773109 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:02:21.774286 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/stock_dbt/logs', 'profiles_dir': '/opt/airflow/stock_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/stock_dbt --project-dir /opt/airflow/stock_dbt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:02:22.315590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2abcd1b7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aba6cd6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aba6cf950>]}


============================== 05:02:22.321464 | 3125eda0-ad41-4943-a19b-80ece7e91e89 ==============================
[0m05:02:22.321464 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:02:22.323403 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/stock_dbt/logs', 'profiles_dir': '/opt/airflow/stock_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/stock_dbt --project-dir /opt/airflow/stock_dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:02:22.484226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a77382b9-921c-4fae-80d3-3191fe2998f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15e530d910>]}
[0m05:02:22.537974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a77382b9-921c-4fae-80d3-3191fe2998f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15e7d13380>]}
[0m05:02:22.541013 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:02:22.553092 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:02:22.651120 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m05:02:22.653455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a77382b9-921c-4fae-80d3-3191fe2998f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163e6f0bf0>]}
[0m05:02:22.954863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3125eda0-ad41-4943-a19b-80ece7e91e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a610a9a90>]}
[0m05:02:22.993736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3125eda0-ad41-4943-a19b-80ece7e91e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a689ce840>]}
[0m05:02:22.996550 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:02:23.006962 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:02:23.103345 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m05:02:23.104971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3125eda0-ad41-4943-a19b-80ece7e91e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a60c92d50>]}
[0m05:02:23.643302 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m05:02:23.646729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a77382b9-921c-4fae-80d3-3191fe2998f7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15e43adee0>]}
[0m05:02:23.900896 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.stock_prediction.raw_data
- models.stock_prediction
- models.stock_prediction.tranformations
[0m05:02:23.911005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a77382b9-921c-4fae-80d3-3191fe2998f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15e47a0590>]}
[0m05:02:24.056386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a77382b9-921c-4fae-80d3-3191fe2998f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15e4396600>]}
[0m05:02:24.058289 [info ] [MainThread]: Found 5 models, 4 snapshots, 27 data tests, 1 source, 459 macros
[0m05:02:24.060271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a77382b9-921c-4fae-80d3-3191fe2998f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15e4238170>]}
[0m05:02:24.065208 [info ] [MainThread]: 
[0m05:02:24.066858 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:02:24.071702 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m05:02:24.082760 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m05:02:24.084563 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m05:02:24.086041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:02:24.114927 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m05:02:24.116555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3125eda0-ad41-4943-a19b-80ece7e91e89', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a61d65430>]}
[0m05:02:24.379958 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.stock_prediction.raw_data
- models.stock_prediction
- models.stock_prediction.tranformations
[0m05:02:24.389545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3125eda0-ad41-4943-a19b-80ece7e91e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a60bec980>]}
[0m05:02:24.497731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3125eda0-ad41-4943-a19b-80ece7e91e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a60d06060>]}
[0m05:02:24.499669 [info ] [MainThread]: Found 5 models, 4 snapshots, 27 data tests, 1 source, 459 macros
[0m05:02:24.501677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3125eda0-ad41-4943-a19b-80ece7e91e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a60d6f770>]}
[0m05:02:24.504175 [info ] [MainThread]: 
[0m05:02:24.505425 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:02:24.509063 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m05:02:24.519856 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m05:02:24.521979 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m05:02:24.523506 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:02:24.725242 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.639 seconds
[0m05:02:24.728756 [debug] [ThreadPool]: On list_dev: Close
[0m05:02:24.857129 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m05:02:24.865672 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m05:02:24.867359 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m05:02:24.868903 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:02:24.990204 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.467 seconds
[0m05:02:24.993832 [debug] [ThreadPool]: On list_dev: Close
[0m05:02:25.123102 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m05:02:25.132504 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m05:02:25.133523 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m05:02:25.134597 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:02:25.309875 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.441 seconds
[0m05:02:25.313032 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m05:02:25.449521 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m05:02:25.453668 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m05:02:25.455595 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m05:02:25.457522 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:02:25.567552 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.433 seconds
[0m05:02:25.571272 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m05:02:25.690229 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m05:02:25.694555 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m05:02:25.696352 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m05:02:25.697434 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:02:25.850749 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.393 seconds
[0m05:02:25.854704 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m05:02:25.977985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a77382b9-921c-4fae-80d3-3191fe2998f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15e45c0bc0>]}
[0m05:02:25.979900 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:02:25.981286 [info ] [MainThread]: 
[0m05:02:25.988419 [debug] [Thread-1 (]: Began running node model.stock_dbt.stock_prices
[0m05:02:25.989845 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stock_prices ............................. [RUN]
[0m05:02:25.991326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now model.stock_dbt.stock_prices)
[0m05:02:25.992645 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.stock_prices
[0m05:02:25.998847 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.stock_prices"
[0m05:02:26.016329 [debug] [Thread-1 (]: Began executing node model.stock_dbt.stock_prices
[0m05:02:26.037549 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.stock_prices"
[0m05:02:26.056537 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.stock_prices"
[0m05:02:26.057735 [debug] [Thread-1 (]: On model.stock_dbt.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.stock_prices"} */
create or replace   view dev.analytics.stock_prices
  
   as (
    SELECT
    symbol,
    date,
    open,
    high,
    low,
    close,
    volume
FROM dev.raw_data.stock_prices
  );
[0m05:02:26.059215 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:02:26.093774 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.396 seconds
[0m05:02:26.096980 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m05:02:26.222910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3125eda0-ad41-4943-a19b-80ece7e91e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2abbc4f500>]}
[0m05:02:26.224855 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:02:26.226059 [info ] [MainThread]: 
[0m05:02:26.232875 [debug] [Thread-1 (]: Began running node model.stock_dbt.stock_prices
[0m05:02:26.234457 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stock_prices ............................. [RUN]
[0m05:02:26.236102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now model.stock_dbt.stock_prices)
[0m05:02:26.237406 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.stock_prices
[0m05:02:26.243422 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.stock_prices"
[0m05:02:26.252279 [debug] [Thread-1 (]: Began executing node model.stock_dbt.stock_prices
[0m05:02:26.272644 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.stock_prices"
[0m05:02:26.295090 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.stock_prices"
[0m05:02:26.296299 [debug] [Thread-1 (]: On model.stock_dbt.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.stock_prices"} */
create or replace   view dev.analytics.stock_prices
  
   as (
    SELECT
    symbol,
    date,
    open,
    high,
    low,
    close,
    volume
FROM dev.raw_data.stock_prices
  );
[0m05:02:26.297330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:02:26.657101 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.598 seconds
[0m05:02:26.675293 [debug] [Thread-1 (]: On model.stock_dbt.stock_prices: Close
[0m05:02:26.797608 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a77382b9-921c-4fae-80d3-3191fe2998f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15e47006b0>]}
[0m05:02:26.799946 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stock_prices ........................ [[32mSUCCESS 1[0m in 0.81s]
[0m05:02:26.801569 [debug] [Thread-1 (]: Finished running node model.stock_dbt.stock_prices
[0m05:02:26.803686 [debug] [Thread-1 (]: Began running node model.stock_dbt.avg_true_range
[0m05:02:26.805236 [info ] [Thread-1 (]: 2 of 5 START sql view model analytics.avg_true_range ........................... [RUN]
[0m05:02:26.806831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.stock_prices, now model.stock_dbt.avg_true_range)
[0m05:02:26.808460 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.avg_true_range
[0m05:02:26.811608 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.avg_true_range"
[0m05:02:26.826155 [debug] [Thread-1 (]: Began executing node model.stock_dbt.avg_true_range
[0m05:02:26.829275 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.avg_true_range"
[0m05:02:26.841768 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.avg_true_range"
[0m05:02:26.842941 [debug] [Thread-1 (]: On model.stock_dbt.avg_true_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.avg_true_range"} */
create or replace   view dev.analytics.avg_true_range
  
   as (
    WITH averageTrueRanges AS (
    SELECT
        date,
        symbol,
        close,
        ABS(close - LAG(close) OVER (PARTITION BY symbol ORDER BY date)) AS true_range
    FROM dev.analytics.stock_prices
),
atr AS (
    SELECT
        date,
        symbol,
        AVG(true_range) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS atr_14d
    FROM averageTrueRanges
)
SELECT 
    date, 
    symbol, 
    COALESCE(atr_14d, 0) AS atr_14d
FROM atr
ORDER BY date, symbol
  );
[0m05:02:26.844062 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:02:26.953606 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.656 seconds
[0m05:02:26.971872 [debug] [Thread-1 (]: On model.stock_dbt.stock_prices: Close
[0m05:02:27.118666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3125eda0-ad41-4943-a19b-80ece7e91e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a6103c530>]}
[0m05:02:27.121059 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stock_prices ........................ [[32mSUCCESS 1[0m in 0.88s]
[0m05:02:27.122702 [debug] [Thread-1 (]: Finished running node model.stock_dbt.stock_prices
[0m05:02:27.124582 [debug] [Thread-1 (]: Began running node model.stock_dbt.avg_true_range
[0m05:02:27.126111 [info ] [Thread-1 (]: 2 of 5 START sql view model analytics.avg_true_range ........................... [RUN]
[0m05:02:27.127366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.stock_prices, now model.stock_dbt.avg_true_range)
[0m05:02:27.128940 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.avg_true_range
[0m05:02:27.131782 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.avg_true_range"
[0m05:02:27.144750 [debug] [Thread-1 (]: Began executing node model.stock_dbt.avg_true_range
[0m05:02:27.147806 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.avg_true_range"
[0m05:02:27.161492 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.avg_true_range"
[0m05:02:27.163025 [debug] [Thread-1 (]: On model.stock_dbt.avg_true_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.avg_true_range"} */
create or replace   view dev.analytics.avg_true_range
  
   as (
    WITH averageTrueRanges AS (
    SELECT
        date,
        symbol,
        close,
        ABS(close - LAG(close) OVER (PARTITION BY symbol ORDER BY date)) AS true_range
    FROM dev.analytics.stock_prices
),
atr AS (
    SELECT
        date,
        symbol,
        AVG(true_range) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS atr_14d
    FROM averageTrueRanges
)
SELECT 
    date, 
    symbol, 
    COALESCE(atr_14d, 0) AS atr_14d
FROM atr
ORDER BY date, symbol
  );
[0m05:02:27.164082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:02:27.459116 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.615 seconds
[0m05:02:27.462414 [debug] [Thread-1 (]: On model.stock_dbt.avg_true_range: Close
[0m05:02:27.580621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a77382b9-921c-4fae-80d3-3191fe2998f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1573408560>]}
[0m05:02:27.583535 [info ] [Thread-1 (]: 2 of 5 OK created sql view model analytics.avg_true_range ...................... [[32mSUCCESS 1[0m in 0.77s]
[0m05:02:27.585748 [debug] [Thread-1 (]: Finished running node model.stock_dbt.avg_true_range
[0m05:02:27.587295 [debug] [Thread-1 (]: Began running node model.stock_dbt.bollinger
[0m05:02:27.589334 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.bollinger ................................ [RUN]
[0m05:02:27.591110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.avg_true_range, now model.stock_dbt.bollinger)
[0m05:02:27.592717 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.bollinger
[0m05:02:27.596086 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.bollinger"
[0m05:02:27.610019 [debug] [Thread-1 (]: Began executing node model.stock_dbt.bollinger
[0m05:02:27.612734 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.bollinger"
[0m05:02:27.625420 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.bollinger"
[0m05:02:27.626338 [debug] [Thread-1 (]: On model.stock_dbt.bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.bollinger"} */
create or replace   view dev.analytics.bollinger
  
   as (
    WITH bollinger AS (
    SELECT
        symbol,
        date,
        close,
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) AS sma_20d,
        STDDEV(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) AS stddev_20d
    FROM dev.analytics.stock_prices
)

SELECT
    symbol,
    date,
    close,
    COALESCE(sma_20d, 0) AS sma_20d,
    COALESCE(sma_20d + (2 * stddev_20d), 0) AS upper_band,
    COALESCE(sma_20d - (2 * stddev_20d), 0) AS lower_band
FROM bollinger
ORDER BY symbol, date
  );
[0m05:02:27.627760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:02:27.651585 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.487 seconds
[0m05:02:27.655307 [debug] [Thread-1 (]: On model.stock_dbt.avg_true_range: Close
[0m05:02:27.763683 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3125eda0-ad41-4943-a19b-80ece7e91e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a53f697c0>]}
[0m05:02:27.765201 [info ] [Thread-1 (]: 2 of 5 OK created sql view model analytics.avg_true_range ...................... [[32mSUCCESS 1[0m in 0.64s]
[0m05:02:27.766755 [debug] [Thread-1 (]: Finished running node model.stock_dbt.avg_true_range
[0m05:02:27.768091 [debug] [Thread-1 (]: Began running node model.stock_dbt.bollinger
[0m05:02:27.769041 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.bollinger ................................ [RUN]
[0m05:02:27.769994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.avg_true_range, now model.stock_dbt.bollinger)
[0m05:02:27.770773 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.bollinger
[0m05:02:27.773648 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.bollinger"
[0m05:02:27.783823 [debug] [Thread-1 (]: Began executing node model.stock_dbt.bollinger
[0m05:02:27.786478 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.bollinger"
[0m05:02:27.795833 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.bollinger"
[0m05:02:27.797178 [debug] [Thread-1 (]: On model.stock_dbt.bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.bollinger"} */
create or replace   view dev.analytics.bollinger
  
   as (
    WITH bollinger AS (
    SELECT
        symbol,
        date,
        close,
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) AS sma_20d,
        STDDEV(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) AS stddev_20d
    FROM dev.analytics.stock_prices
)

SELECT
    symbol,
    date,
    close,
    COALESCE(sma_20d, 0) AS sma_20d,
    COALESCE(sma_20d + (2 * stddev_20d), 0) AS upper_band,
    COALESCE(sma_20d - (2 * stddev_20d), 0) AS lower_band
FROM bollinger
ORDER BY symbol, date
  );
[0m05:02:27.798681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:02:28.250137 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.622 seconds
[0m05:02:28.253628 [debug] [Thread-1 (]: On model.stock_dbt.bollinger: Close
[0m05:02:28.360710 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.562 seconds
[0m05:02:28.364128 [debug] [Thread-1 (]: On model.stock_dbt.bollinger: Close
[0m05:02:28.371747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a77382b9-921c-4fae-80d3-3191fe2998f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15e42a4a10>]}
[0m05:02:28.373636 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.bollinger ........................... [[32mSUCCESS 1[0m in 0.78s]
[0m05:02:28.374956 [debug] [Thread-1 (]: Finished running node model.stock_dbt.bollinger
[0m05:02:28.376493 [debug] [Thread-1 (]: Began running node model.stock_dbt.moving_average
[0m05:02:28.377753 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.moving_average ........................... [RUN]
[0m05:02:28.379048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.bollinger, now model.stock_dbt.moving_average)
[0m05:02:28.380416 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.moving_average
[0m05:02:28.383706 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.moving_average"
[0m05:02:28.394440 [debug] [Thread-1 (]: Began executing node model.stock_dbt.moving_average
[0m05:02:28.397528 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.moving_average"
[0m05:02:28.412472 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.moving_average"
[0m05:02:28.413732 [debug] [Thread-1 (]: On model.stock_dbt.moving_average: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.moving_average"} */
create or replace   view dev.analytics.moving_average
  
   as (
    WITH stock_data AS (
    SELECT
        symbol,
        date,
        close
    FROM dev.analytics.stock_prices -- assuming 'stock_prices' is the name of the raw table model in dbt
)

SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
    ) AS moving_avg_5d,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
    ) AS moving_avg_20d
FROM stock_data
ORDER BY symbol, date
  );
[0m05:02:28.414727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:02:28.477129 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3125eda0-ad41-4943-a19b-80ece7e91e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a600c0e60>]}
[0m05:02:28.478909 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.bollinger ........................... [[32mSUCCESS 1[0m in 0.71s]
[0m05:02:28.480620 [debug] [Thread-1 (]: Finished running node model.stock_dbt.bollinger
[0m05:02:28.481992 [debug] [Thread-1 (]: Began running node model.stock_dbt.moving_average
[0m05:02:28.483061 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.moving_average ........................... [RUN]
[0m05:02:28.484011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.bollinger, now model.stock_dbt.moving_average)
[0m05:02:28.484995 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.moving_average
[0m05:02:28.487774 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.moving_average"
[0m05:02:28.497695 [debug] [Thread-1 (]: Began executing node model.stock_dbt.moving_average
[0m05:02:28.500617 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.moving_average"
[0m05:02:28.509834 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.moving_average"
[0m05:02:28.511368 [debug] [Thread-1 (]: On model.stock_dbt.moving_average: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.moving_average"} */
create or replace   view dev.analytics.moving_average
  
   as (
    WITH stock_data AS (
    SELECT
        symbol,
        date,
        close
    FROM dev.analytics.stock_prices -- assuming 'stock_prices' is the name of the raw table model in dbt
)

SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
    ) AS moving_avg_5d,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
    ) AS moving_avg_20d
FROM stock_data
ORDER BY symbol, date
  );
[0m05:02:28.512237 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:02:28.923575 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.509 seconds
[0m05:02:28.927746 [debug] [Thread-1 (]: On model.stock_dbt.moving_average: Close
[0m05:02:29.021700 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.509 seconds
[0m05:02:29.025071 [debug] [Thread-1 (]: On model.stock_dbt.moving_average: Close
[0m05:02:29.050646 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a77382b9-921c-4fae-80d3-3191fe2998f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163e6f0110>]}
[0m05:02:29.052476 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.moving_average ...................... [[32mSUCCESS 1[0m in 0.67s]
[0m05:02:29.053762 [debug] [Thread-1 (]: Finished running node model.stock_dbt.moving_average
[0m05:02:29.054945 [debug] [Thread-1 (]: Began running node model.stock_dbt.rsi_calculation
[0m05:02:29.055878 [info ] [Thread-1 (]: 5 of 5 START sql view model analytics.rsi_calculation .......................... [RUN]
[0m05:02:29.056837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.moving_average, now model.stock_dbt.rsi_calculation)
[0m05:02:29.057938 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.rsi_calculation
[0m05:02:29.060696 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.rsi_calculation"
[0m05:02:29.069734 [debug] [Thread-1 (]: Began executing node model.stock_dbt.rsi_calculation
[0m05:02:29.072448 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.rsi_calculation"
[0m05:02:29.087370 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.rsi_calculation"
[0m05:02:29.088828 [debug] [Thread-1 (]: On model.stock_dbt.rsi_calculation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.rsi_calculation"} */
create or replace   view dev.analytics.rsi_calculation
  
   as (
    WITH stock_data AS (
    SELECT
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM dev.analytics.stock_prices
),

price_changes AS (
    SELECT
        symbol,
        date,
        close,
        CASE 
            WHEN close > prev_close THEN close - prev_close
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close < prev_close THEN prev_close - close
            ELSE 0 
        END AS loss
    FROM stock_data
),

average_gains_losses AS (
    SELECT
        symbol,
        date,
        close,
        -- Calculate the average gain over the last 14 days, including the current row
        AVG(gain) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain,
        -- Calculate the average loss over the last 14 days, including the current row
        AVG(loss) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss
    FROM price_changes
)

SELECT
    symbol,
    date,
    close,
    avg_gain,
    avg_loss,
    -- Calculate RSI, using COALESCE to set to 0 if result is NULL
    COALESCE(100 - (100 / (1 + (NULLIF(avg_gain, 0) / NULLIF(avg_loss, 0)))), 0) AS rsi_14d
FROM average_gains_losses
ORDER BY symbol, date
  );
[0m05:02:29.090112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:02:29.161320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3125eda0-ad41-4943-a19b-80ece7e91e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a60e26930>]}
[0m05:02:29.163490 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.moving_average ...................... [[32mSUCCESS 1[0m in 0.68s]
[0m05:02:29.165169 [debug] [Thread-1 (]: Finished running node model.stock_dbt.moving_average
[0m05:02:29.166478 [debug] [Thread-1 (]: Began running node model.stock_dbt.rsi_calculation
[0m05:02:29.168373 [info ] [Thread-1 (]: 5 of 5 START sql view model analytics.rsi_calculation .......................... [RUN]
[0m05:02:29.170158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.moving_average, now model.stock_dbt.rsi_calculation)
[0m05:02:29.171509 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.rsi_calculation
[0m05:02:29.174273 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.rsi_calculation"
[0m05:02:29.181573 [debug] [Thread-1 (]: Began executing node model.stock_dbt.rsi_calculation
[0m05:02:29.184153 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.rsi_calculation"
[0m05:02:29.195330 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.rsi_calculation"
[0m05:02:29.196405 [debug] [Thread-1 (]: On model.stock_dbt.rsi_calculation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.rsi_calculation"} */
create or replace   view dev.analytics.rsi_calculation
  
   as (
    WITH stock_data AS (
    SELECT
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM dev.analytics.stock_prices
),

price_changes AS (
    SELECT
        symbol,
        date,
        close,
        CASE 
            WHEN close > prev_close THEN close - prev_close
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close < prev_close THEN prev_close - close
            ELSE 0 
        END AS loss
    FROM stock_data
),

average_gains_losses AS (
    SELECT
        symbol,
        date,
        close,
        -- Calculate the average gain over the last 14 days, including the current row
        AVG(gain) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain,
        -- Calculate the average loss over the last 14 days, including the current row
        AVG(loss) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss
    FROM price_changes
)

SELECT
    symbol,
    date,
    close,
    avg_gain,
    avg_loss,
    -- Calculate RSI, using COALESCE to set to 0 if result is NULL
    COALESCE(100 - (100 / (1 + (NULLIF(avg_gain, 0) / NULLIF(avg_loss, 0)))), 0) AS rsi_14d
FROM average_gains_losses
ORDER BY symbol, date
  );
[0m05:02:29.197795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:02:29.781992 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.692 seconds
[0m05:02:29.787806 [debug] [Thread-1 (]: On model.stock_dbt.rsi_calculation: Close
[0m05:02:29.809486 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.612 seconds
[0m05:02:29.813370 [debug] [Thread-1 (]: On model.stock_dbt.rsi_calculation: Close
[0m05:02:29.919542 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a77382b9-921c-4fae-80d3-3191fe2998f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1573555d90>]}
[0m05:02:29.922156 [info ] [Thread-1 (]: 5 of 5 OK created sql view model analytics.rsi_calculation ..................... [[32mSUCCESS 1[0m in 0.86s]
[0m05:02:29.924279 [debug] [Thread-1 (]: Finished running node model.stock_dbt.rsi_calculation
[0m05:02:29.926849 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:02:29.927772 [debug] [MainThread]: Connection 'model.stock_dbt.rsi_calculation' was properly closed.
[0m05:02:29.928901 [info ] [MainThread]: 
[0m05:02:29.930526 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 5.86 seconds (5.86s).
[0m05:02:29.932345 [debug] [MainThread]: Command end result
[0m05:02:29.955184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3125eda0-ad41-4943-a19b-80ece7e91e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a53f7ad20>]}
[0m05:02:29.957644 [info ] [Thread-1 (]: 5 of 5 OK created sql view model analytics.rsi_calculation ..................... [[32mSUCCESS 1[0m in 0.78s]
[0m05:02:29.959570 [debug] [Thread-1 (]: Finished running node model.stock_dbt.rsi_calculation
[0m05:02:29.961848 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:02:29.963233 [debug] [MainThread]: Connection 'model.stock_dbt.rsi_calculation' was properly closed.
[0m05:02:29.964207 [info ] [MainThread]: 
[0m05:02:29.965182 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 5.46 seconds (5.46s).
[0m05:02:29.966616 [debug] [MainThread]: Command end result
[0m05:02:29.996518 [info ] [MainThread]: 
[0m05:02:29.997889 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:02:29.999753 [info ] [MainThread]: 
[0m05:02:30.001553 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m05:02:30.004161 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.306681, "process_user_time": 3.963624, "process_kernel_time": 2.922206, "process_mem_max_rss": "246972", "process_in_blocks": "43616", "process_out_blocks": "8"}
[0m05:02:30.005821 [debug] [MainThread]: Command `dbt run` succeeded at 05:02:30.005694 after 8.31 seconds
[0m05:02:30.006721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163d9c38f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163d9c3980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15dc170440>]}
[0m05:02:30.007648 [debug] [MainThread]: Flushing usage events
[0m05:02:30.028819 [info ] [MainThread]: 
[0m05:02:30.030409 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:02:30.032174 [info ] [MainThread]: 
[0m05:02:30.033944 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m05:02:30.035416 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.806761, "process_user_time": 3.729532, "process_kernel_time": 3.109637, "process_mem_max_rss": "248948", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m05:02:30.036919 [debug] [MainThread]: Command `dbt run` succeeded at 05:02:30.036832 after 7.81 seconds
[0m05:02:30.037848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2abcd1b7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aba7f92b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aba6cf9e0>]}
[0m05:02:30.038900 [debug] [MainThread]: Flushing usage events
[0m05:02:32.075349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdba5d2d1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdba5dd8860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdba5d2fc20>]}


============================== 05:02:32.080499 | 209eb7da-c935-41b2-974b-f153bbd5018c ==============================
[0m05:02:32.080499 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:02:32.081932 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/stock_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/stock_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/stock_dbt --project-dir /opt/airflow/stock_dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:02:32.631091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '209eb7da-c935-41b2-974b-f153bbd5018c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdba7087ce0>]}
[0m05:02:32.668135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '209eb7da-c935-41b2-974b-f153bbd5018c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb53f2d070>]}
[0m05:02:32.670747 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:02:32.683918 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:02:33.025991 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:02:33.027333 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:02:33.031944 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.stock_prediction
- models.stock_prediction.raw_data
- models.stock_prediction.tranformations
[0m05:02:33.065393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '209eb7da-c935-41b2-974b-f153bbd5018c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb4c2b6120>]}
[0m05:02:33.239784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '209eb7da-c935-41b2-974b-f153bbd5018c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb47c233e0>]}
[0m05:02:33.241729 [info ] [MainThread]: Found 5 models, 4 snapshots, 27 data tests, 1 source, 459 macros
[0m05:02:33.243469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '209eb7da-c935-41b2-974b-f153bbd5018c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb47df7140>]}
[0m05:02:33.247945 [info ] [MainThread]: 
[0m05:02:33.249291 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:02:33.254507 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_snapshot'
[0m05:02:33.266879 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m05:02:33.268674 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m05:02:33.270677 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:02:33.740753 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.470 seconds
[0m05:02:33.743288 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m05:02:33.871425 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m05:02:33.875457 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m05:02:33.877742 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m05:02:33.879312 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:02:34.358622 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.479 seconds
[0m05:02:34.361862 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m05:02:34.473075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '209eb7da-c935-41b2-974b-f153bbd5018c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb47df5940>]}
[0m05:02:34.475408 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:02:34.477177 [info ] [MainThread]: 
[0m05:02:34.485329 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m05:02:34.487127 [info ] [Thread-1 (]: 1 of 27 START test not_null_avg_true_range_atr_14d ............................. [RUN]
[0m05:02:34.489041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad)
[0m05:02:34.490681 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m05:02:34.503083 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad"
[0m05:02:34.517874 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m05:02:34.532103 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad"
[0m05:02:34.540885 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad"
[0m05:02:34.542562 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select atr_14d
from dev.analytics.avg_true_range
where atr_14d is null



      
    ) dbt_internal_test
[0m05:02:34.544340 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:02:35.246872 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.702 seconds
[0m05:02:35.265284 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad: Close
[0m05:02:35.381565 [info ] [Thread-1 (]: 1 of 27 PASS not_null_avg_true_range_atr_14d ................................... [[32mPASS[0m in 0.89s]
[0m05:02:35.384084 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m05:02:35.385652 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_avg_true_range_date.4e418b835d
[0m05:02:35.386803 [info ] [Thread-1 (]: 2 of 27 START test not_null_avg_true_range_date ................................ [RUN]
[0m05:02:35.389062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad, now test.stock_dbt.not_null_avg_true_range_date.4e418b835d)
[0m05:02:35.390613 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_avg_true_range_date.4e418b835d
[0m05:02:35.394526 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_avg_true_range_date.4e418b835d"
[0m05:02:35.407951 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_avg_true_range_date.4e418b835d
[0m05:02:35.410748 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_avg_true_range_date.4e418b835d"
[0m05:02:35.423923 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_avg_true_range_date.4e418b835d"
[0m05:02:35.425110 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_date.4e418b835d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_avg_true_range_date.4e418b835d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.avg_true_range
where date is null



      
    ) dbt_internal_test
[0m05:02:35.426197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:02:35.838975 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.413 seconds
[0m05:02:35.841408 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_date.4e418b835d: Close
[0m05:02:35.955004 [info ] [Thread-1 (]: 2 of 27 PASS not_null_avg_true_range_date ...................................... [[32mPASS[0m in 0.57s]
[0m05:02:35.957494 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_avg_true_range_date.4e418b835d
[0m05:02:35.958893 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1
[0m05:02:35.960284 [info ] [Thread-1 (]: 3 of 27 START test not_null_avg_true_range_symbol .............................. [RUN]
[0m05:02:35.961663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_avg_true_range_date.4e418b835d, now test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1)
[0m05:02:35.962736 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1
[0m05:02:35.966518 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1"
[0m05:02:35.977761 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1
[0m05:02:35.980481 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1"
[0m05:02:35.989399 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1"
[0m05:02:35.990477 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.avg_true_range
where symbol is null



      
    ) dbt_internal_test
[0m05:02:35.991472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:02:36.401859 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.410 seconds
[0m05:02:36.404843 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1: Close
[0m05:02:36.528566 [info ] [Thread-1 (]: 3 of 27 PASS not_null_avg_true_range_symbol .................................... [[32mPASS[0m in 0.57s]
[0m05:02:36.531278 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1
[0m05:02:36.532704 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_close.4ccb16a429
[0m05:02:36.533611 [info ] [Thread-1 (]: 4 of 27 START test not_null_bollinger_close .................................... [RUN]
[0m05:02:36.534726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1, now test.stock_dbt.not_null_bollinger_close.4ccb16a429)
[0m05:02:36.535573 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_close.4ccb16a429
[0m05:02:36.539233 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_close.4ccb16a429"
[0m05:02:36.548055 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_close.4ccb16a429
[0m05:02:36.550225 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_close.4ccb16a429"
[0m05:02:36.557332 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_close.4ccb16a429"
[0m05:02:36.558114 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_close.4ccb16a429: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_close.4ccb16a429"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.bollinger
where close is null



      
    ) dbt_internal_test
[0m05:02:36.558886 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:02:37.013859 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.455 seconds
[0m05:02:37.017342 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_close.4ccb16a429: Close
[0m05:02:37.178196 [info ] [Thread-1 (]: 4 of 27 PASS not_null_bollinger_close .......................................... [[32mPASS[0m in 0.64s]
[0m05:02:37.181450 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_close.4ccb16a429
[0m05:02:37.183030 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_date.9d77bdd20c
[0m05:02:37.184330 [info ] [Thread-1 (]: 5 of 27 START test not_null_bollinger_date ..................................... [RUN]
[0m05:02:37.185729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_close.4ccb16a429, now test.stock_dbt.not_null_bollinger_date.9d77bdd20c)
[0m05:02:37.186781 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_date.9d77bdd20c
[0m05:02:37.190421 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_date.9d77bdd20c"
[0m05:02:37.201909 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_date.9d77bdd20c
[0m05:02:37.204593 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_date.9d77bdd20c"
[0m05:02:37.222784 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_date.9d77bdd20c"
[0m05:02:37.224638 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_date.9d77bdd20c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_date.9d77bdd20c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.bollinger
where date is null



      
    ) dbt_internal_test
[0m05:02:37.227213 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:02:37.632768 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.405 seconds
[0m05:02:37.638569 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_date.9d77bdd20c: Close
[0m05:02:37.764120 [info ] [Thread-1 (]: 5 of 27 PASS not_null_bollinger_date ........................................... [[32mPASS[0m in 0.58s]
[0m05:02:37.766190 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_date.9d77bdd20c
[0m05:02:37.767399 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e
[0m05:02:37.769019 [info ] [Thread-1 (]: 6 of 27 START test not_null_bollinger_lower_band ............................... [RUN]
[0m05:02:37.770913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_date.9d77bdd20c, now test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e)
[0m05:02:37.772404 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e
[0m05:02:37.776255 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e"
[0m05:02:37.790706 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e
[0m05:02:37.793363 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e"
[0m05:02:37.805036 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e"
[0m05:02:37.806003 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select lower_band
from dev.analytics.bollinger
where lower_band is null



      
    ) dbt_internal_test
[0m05:02:37.806800 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:02:38.322176 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.515 seconds
[0m05:02:38.327382 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e: Close
[0m05:02:38.456979 [info ] [Thread-1 (]: 6 of 27 PASS not_null_bollinger_lower_band ..................................... [[32mPASS[0m in 0.69s]
[0m05:02:38.459768 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e
[0m05:02:38.461186 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3
[0m05:02:38.462489 [info ] [Thread-1 (]: 7 of 27 START test not_null_bollinger_sma_20d .................................. [RUN]
[0m05:02:38.463964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e, now test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3)
[0m05:02:38.465177 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3
[0m05:02:38.468725 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3"
[0m05:02:38.477744 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3
[0m05:02:38.480496 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3"
[0m05:02:38.489117 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3"
[0m05:02:38.490666 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sma_20d
from dev.analytics.bollinger
where sma_20d is null



      
    ) dbt_internal_test
[0m05:02:38.492015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:02:38.926620 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.434 seconds
[0m05:02:38.932233 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3: Close
[0m05:02:39.058367 [info ] [Thread-1 (]: 7 of 27 PASS not_null_bollinger_sma_20d ........................................ [[32mPASS[0m in 0.59s]
[0m05:02:39.060927 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3
[0m05:02:39.062843 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_symbol.a932e30f82
[0m05:02:39.064357 [info ] [Thread-1 (]: 8 of 27 START test not_null_bollinger_symbol ................................... [RUN]
[0m05:02:39.066182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3, now test.stock_dbt.not_null_bollinger_symbol.a932e30f82)
[0m05:02:39.067676 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_symbol.a932e30f82
[0m05:02:39.071481 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_symbol.a932e30f82"
[0m05:02:39.080361 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_symbol.a932e30f82
[0m05:02:39.082698 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_symbol.a932e30f82"
[0m05:02:39.091893 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_symbol.a932e30f82"
[0m05:02:39.093525 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_symbol.a932e30f82: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_symbol.a932e30f82"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.bollinger
where symbol is null



      
    ) dbt_internal_test
[0m05:02:39.095124 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:02:39.587147 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.492 seconds
[0m05:02:39.591599 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_symbol.a932e30f82: Close
[0m05:02:39.739917 [info ] [Thread-1 (]: 8 of 27 PASS not_null_bollinger_symbol ......................................... [[32mPASS[0m in 0.67s]
[0m05:02:39.742159 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_symbol.a932e30f82
[0m05:02:39.743652 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_upper_band.e4db87564c
[0m05:02:39.745008 [info ] [Thread-1 (]: 9 of 27 START test not_null_bollinger_upper_band ............................... [RUN]
[0m05:02:39.746971 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_symbol.a932e30f82, now test.stock_dbt.not_null_bollinger_upper_band.e4db87564c)
[0m05:02:39.748481 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_upper_band.e4db87564c
[0m05:02:39.752777 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_upper_band.e4db87564c"
[0m05:02:39.762324 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_upper_band.e4db87564c
[0m05:02:39.765043 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_upper_band.e4db87564c"
[0m05:02:39.771989 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_upper_band.e4db87564c"
[0m05:02:39.773908 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_upper_band.e4db87564c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_upper_band.e4db87564c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select upper_band
from dev.analytics.bollinger
where upper_band is null



      
    ) dbt_internal_test
[0m05:02:39.775594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:02:40.234802 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.459 seconds
[0m05:02:40.240452 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_upper_band.e4db87564c: Close
[0m05:02:40.383257 [info ] [Thread-1 (]: 9 of 27 PASS not_null_bollinger_upper_band ..................................... [[32mPASS[0m in 0.64s]
[0m05:02:40.385857 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_upper_band.e4db87564c
[0m05:02:40.387808 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_close.6d037dd588
[0m05:02:40.389466 [info ] [Thread-1 (]: 10 of 27 START test not_null_moving_average_close .............................. [RUN]
[0m05:02:40.390714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_upper_band.e4db87564c, now test.stock_dbt.not_null_moving_average_close.6d037dd588)
[0m05:02:40.391982 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_close.6d037dd588
[0m05:02:40.396362 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_close.6d037dd588"
[0m05:02:40.406942 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_close.6d037dd588
[0m05:02:40.409454 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_close.6d037dd588"
[0m05:02:40.417485 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_close.6d037dd588"
[0m05:02:40.419459 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_close.6d037dd588: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_close.6d037dd588"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.moving_average
where close is null



      
    ) dbt_internal_test
[0m05:02:40.420828 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:02:40.830907 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.410 seconds
[0m05:02:40.834098 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_close.6d037dd588: Close
[0m05:02:40.961892 [info ] [Thread-1 (]: 10 of 27 PASS not_null_moving_average_close .................................... [[32mPASS[0m in 0.57s]
[0m05:02:40.964446 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_close.6d037dd588
[0m05:02:40.966162 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_date.3ad00158b5
[0m05:02:40.967151 [info ] [Thread-1 (]: 11 of 27 START test not_null_moving_average_date ............................... [RUN]
[0m05:02:40.968368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_close.6d037dd588, now test.stock_dbt.not_null_moving_average_date.3ad00158b5)
[0m05:02:40.969308 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_date.3ad00158b5
[0m05:02:40.972968 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_date.3ad00158b5"
[0m05:02:40.982061 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_date.3ad00158b5
[0m05:02:40.984346 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_date.3ad00158b5"
[0m05:02:40.993299 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_date.3ad00158b5"
[0m05:02:40.994913 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_date.3ad00158b5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_date.3ad00158b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.moving_average
where date is null



      
    ) dbt_internal_test
[0m05:02:40.996200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:02:41.898768 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.902 seconds
[0m05:02:41.901525 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_date.3ad00158b5: Close
[0m05:02:42.037317 [info ] [Thread-1 (]: 11 of 27 PASS not_null_moving_average_date ..................................... [[32mPASS[0m in 1.07s]
[0m05:02:42.039691 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_date.3ad00158b5
[0m05:02:42.040893 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m05:02:42.042172 [info ] [Thread-1 (]: 12 of 27 START test not_null_moving_average_moving_avg_20d ..................... [RUN]
[0m05:02:42.043851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_date.3ad00158b5, now test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22)
[0m05:02:42.044707 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m05:02:42.048366 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m05:02:42.054439 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m05:02:42.056607 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m05:02:42.064726 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m05:02:42.065567 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg_20d
from dev.analytics.moving_average
where moving_avg_20d is null



      
    ) dbt_internal_test
[0m05:02:42.066360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:02:42.468995 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.403 seconds
[0m05:02:42.471694 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22: Close
[0m05:02:42.596254 [info ] [Thread-1 (]: 12 of 27 PASS not_null_moving_average_moving_avg_20d ........................... [[32mPASS[0m in 0.55s]
[0m05:02:42.599862 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m05:02:42.601228 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m05:02:42.602470 [info ] [Thread-1 (]: 13 of 27 START test not_null_moving_average_moving_avg_5d ...................... [RUN]
[0m05:02:42.603713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22, now test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca)
[0m05:02:42.605546 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m05:02:42.609342 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m05:02:42.615831 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m05:02:42.617956 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m05:02:42.628308 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m05:02:42.629214 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg_5d
from dev.analytics.moving_average
where moving_avg_5d is null



      
    ) dbt_internal_test
[0m05:02:42.630217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:02:43.052781 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.422 seconds
[0m05:02:43.057200 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca: Close
[0m05:02:43.181157 [info ] [Thread-1 (]: 13 of 27 PASS not_null_moving_average_moving_avg_5d ............................ [[32mPASS[0m in 0.58s]
[0m05:02:43.183154 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m05:02:43.184562 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_symbol.75a6f7473c
[0m05:02:43.185778 [info ] [Thread-1 (]: 14 of 27 START test not_null_moving_average_symbol ............................. [RUN]
[0m05:02:43.187410 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca, now test.stock_dbt.not_null_moving_average_symbol.75a6f7473c)
[0m05:02:43.188764 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_symbol.75a6f7473c
[0m05:02:43.192367 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_symbol.75a6f7473c"
[0m05:02:43.200000 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_symbol.75a6f7473c
[0m05:02:43.202073 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_symbol.75a6f7473c"
[0m05:02:43.208989 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_symbol.75a6f7473c"
[0m05:02:43.209774 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_symbol.75a6f7473c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_symbol.75a6f7473c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.moving_average
where symbol is null



      
    ) dbt_internal_test
[0m05:02:43.211136 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:02:43.732943 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.522 seconds
[0m05:02:43.736233 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_symbol.75a6f7473c: Close
[0m05:02:43.846751 [info ] [Thread-1 (]: 14 of 27 PASS not_null_moving_average_symbol ................................... [[32mPASS[0m in 0.66s]
[0m05:02:43.850308 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_symbol.75a6f7473c
[0m05:02:43.851791 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42
[0m05:02:43.853014 [info ] [Thread-1 (]: 15 of 27 START test not_null_rsi_calculation_avg_gain .......................... [RUN]
[0m05:02:43.854609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_symbol.75a6f7473c, now test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42)
[0m05:02:43.855575 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42
[0m05:02:43.859316 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m05:02:43.869318 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42
[0m05:02:43.871811 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m05:02:43.880237 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m05:02:43.881923 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_gain
from dev.analytics.rsi_calculation
where avg_gain is null



      
    ) dbt_internal_test
[0m05:02:43.883675 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:02:44.519035 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.636 seconds
[0m05:02:44.523098 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42: Close
[0m05:02:44.659874 [info ] [Thread-1 (]: 15 of 27 PASS not_null_rsi_calculation_avg_gain ................................ [[32mPASS[0m in 0.80s]
[0m05:02:44.661749 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42
[0m05:02:44.663081 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m05:02:44.664079 [info ] [Thread-1 (]: 16 of 27 START test not_null_rsi_calculation_avg_loss .......................... [RUN]
[0m05:02:44.665476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42, now test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19)
[0m05:02:44.666381 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m05:02:44.670007 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m05:02:44.678626 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m05:02:44.680752 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m05:02:44.687812 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m05:02:44.689479 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_loss
from dev.analytics.rsi_calculation
where avg_loss is null



      
    ) dbt_internal_test
[0m05:02:44.690811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:02:45.177793 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.487 seconds
[0m05:02:45.181242 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19: Close
[0m05:02:45.307061 [info ] [Thread-1 (]: 16 of 27 PASS not_null_rsi_calculation_avg_loss ................................ [[32mPASS[0m in 0.64s]
[0m05:02:45.309937 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m05:02:45.311625 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d
[0m05:02:45.313190 [info ] [Thread-1 (]: 17 of 27 START test not_null_rsi_calculation_close ............................. [RUN]
[0m05:02:45.314671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19, now test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d)
[0m05:02:45.315919 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d
[0m05:02:45.319648 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d"
[0m05:02:45.330799 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d
[0m05:02:45.333471 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d"
[0m05:02:45.343930 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d"
[0m05:02:45.345418 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.rsi_calculation
where close is null



      
    ) dbt_internal_test
[0m05:02:45.346704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:02:45.828527 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.482 seconds
[0m05:02:45.831548 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d: Close
[0m05:02:45.944518 [info ] [Thread-1 (]: 17 of 27 PASS not_null_rsi_calculation_close ................................... [[32mPASS[0m in 0.63s]
[0m05:02:45.946995 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d
[0m05:02:45.948349 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76
[0m05:02:45.949594 [info ] [Thread-1 (]: 18 of 27 START test not_null_rsi_calculation_date .............................. [RUN]
[0m05:02:45.950926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d, now test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76)
[0m05:02:45.952063 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76
[0m05:02:45.998640 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76"
[0m05:02:46.027366 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76
[0m05:02:46.030540 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76"
[0m05:02:46.042466 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76"
[0m05:02:46.043332 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.rsi_calculation
where date is null



      
    ) dbt_internal_test
[0m05:02:46.044110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:02:46.486586 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.442 seconds
[0m05:02:46.489802 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76: Close
[0m05:02:46.607307 [info ] [Thread-1 (]: 18 of 27 PASS not_null_rsi_calculation_date .................................... [[32mPASS[0m in 0.66s]
[0m05:02:46.609405 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76
[0m05:02:46.610698 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m05:02:46.611556 [info ] [Thread-1 (]: 19 of 27 START test not_null_rsi_calculation_rsi_14d ........................... [RUN]
[0m05:02:46.613355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76, now test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8)
[0m05:02:46.614545 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m05:02:46.618395 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m05:02:46.624535 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m05:02:46.626770 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m05:02:46.635207 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m05:02:46.636104 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from dev.analytics.rsi_calculation
where rsi_14d is null



      
    ) dbt_internal_test
[0m05:02:46.636927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:02:47.108693 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.472 seconds
[0m05:02:47.111581 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8: Close
[0m05:02:47.243553 [info ] [Thread-1 (]: 19 of 27 PASS not_null_rsi_calculation_rsi_14d ................................. [[32mPASS[0m in 0.63s]
[0m05:02:47.246053 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m05:02:47.247739 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84
[0m05:02:47.248771 [info ] [Thread-1 (]: 20 of 27 START test not_null_rsi_calculation_symbol ............................ [RUN]
[0m05:02:47.250339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8, now test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84)
[0m05:02:47.251628 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84
[0m05:02:47.255421 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m05:02:47.264597 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84
[0m05:02:47.266812 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m05:02:47.273626 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m05:02:47.274445 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.rsi_calculation
where symbol is null



      
    ) dbt_internal_test
[0m05:02:47.275874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:02:47.722994 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.447 seconds
[0m05:02:47.726308 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84: Close
[0m05:02:47.882894 [info ] [Thread-1 (]: 20 of 27 PASS not_null_rsi_calculation_symbol .................................. [[32mPASS[0m in 0.63s]
[0m05:02:47.884560 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84
[0m05:02:47.885419 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_close.d7e232e1ba
[0m05:02:47.886459 [info ] [Thread-1 (]: 21 of 27 START test not_null_stock_prices_close ................................ [RUN]
[0m05:02:47.887896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84, now test.stock_dbt.not_null_stock_prices_close.d7e232e1ba)
[0m05:02:47.888638 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_close.d7e232e1ba
[0m05:02:47.892140 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_close.d7e232e1ba"
[0m05:02:47.899779 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_close.d7e232e1ba
[0m05:02:47.902276 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_close.d7e232e1ba"
[0m05:02:47.909367 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_close.d7e232e1ba"
[0m05:02:47.915750 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_close.d7e232e1ba: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_close.d7e232e1ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.stock_prices
where close is null



      
    ) dbt_internal_test
[0m05:02:47.916814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:02:48.334781 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.418 seconds
[0m05:02:48.337494 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_close.d7e232e1ba: Close
[0m05:02:48.448189 [info ] [Thread-1 (]: 21 of 27 PASS not_null_stock_prices_close ...................................... [[32mPASS[0m in 0.56s]
[0m05:02:48.449935 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_close.d7e232e1ba
[0m05:02:48.451654 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_date.98a7527501
[0m05:02:48.453291 [info ] [Thread-1 (]: 22 of 27 START test not_null_stock_prices_date ................................. [RUN]
[0m05:02:48.454573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_close.d7e232e1ba, now test.stock_dbt.not_null_stock_prices_date.98a7527501)
[0m05:02:48.455750 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_date.98a7527501
[0m05:02:48.460440 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_date.98a7527501"
[0m05:02:48.469382 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_date.98a7527501
[0m05:02:48.471911 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_date.98a7527501"
[0m05:02:48.478930 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_date.98a7527501"
[0m05:02:48.480788 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_date.98a7527501: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_date.98a7527501"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.stock_prices
where date is null



      
    ) dbt_internal_test
[0m05:02:48.481522 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:02:48.953367 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.472 seconds
[0m05:02:48.956146 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_date.98a7527501: Close
[0m05:02:49.098270 [info ] [Thread-1 (]: 22 of 27 PASS not_null_stock_prices_date ....................................... [[32mPASS[0m in 0.64s]
[0m05:02:49.100316 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_date.98a7527501
[0m05:02:49.102195 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc
[0m05:02:49.103829 [info ] [Thread-1 (]: 23 of 27 START test not_null_stock_prices_high ................................. [RUN]
[0m05:02:49.105276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_date.98a7527501, now test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc)
[0m05:02:49.106086 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc
[0m05:02:49.109825 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc"
[0m05:02:49.115888 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc
[0m05:02:49.118159 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc"
[0m05:02:49.127141 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc"
[0m05:02:49.128344 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select high
from dev.analytics.stock_prices
where high is null



      
    ) dbt_internal_test
[0m05:02:49.129214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:02:49.705123 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.576 seconds
[0m05:02:49.707995 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc: Close
[0m05:02:49.827669 [info ] [Thread-1 (]: 23 of 27 PASS not_null_stock_prices_high ....................................... [[32mPASS[0m in 0.72s]
[0m05:02:49.829771 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc
[0m05:02:49.831078 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_low.e65294ca15
[0m05:02:49.832153 [info ] [Thread-1 (]: 24 of 27 START test not_null_stock_prices_low .................................. [RUN]
[0m05:02:49.834108 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc, now test.stock_dbt.not_null_stock_prices_low.e65294ca15)
[0m05:02:49.835785 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_low.e65294ca15
[0m05:02:49.839531 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_low.e65294ca15"
[0m05:02:49.847028 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_low.e65294ca15
[0m05:02:49.849084 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_low.e65294ca15"
[0m05:02:49.855833 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_low.e65294ca15"
[0m05:02:49.856797 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_low.e65294ca15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_low.e65294ca15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select low
from dev.analytics.stock_prices
where low is null



      
    ) dbt_internal_test
[0m05:02:49.858017 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:02:50.246065 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.388 seconds
[0m05:02:50.248869 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_low.e65294ca15: Close
[0m05:02:50.374324 [info ] [Thread-1 (]: 24 of 27 PASS not_null_stock_prices_low ........................................ [[32mPASS[0m in 0.54s]
[0m05:02:50.377069 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_low.e65294ca15
[0m05:02:50.378524 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_open.e09b13f215
[0m05:02:50.379663 [info ] [Thread-1 (]: 25 of 27 START test not_null_stock_prices_open ................................. [RUN]
[0m05:02:50.381524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_low.e65294ca15, now test.stock_dbt.not_null_stock_prices_open.e09b13f215)
[0m05:02:50.382726 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_open.e09b13f215
[0m05:02:50.386456 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_open.e09b13f215"
[0m05:02:50.396052 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_open.e09b13f215
[0m05:02:50.398314 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_open.e09b13f215"
[0m05:02:50.405961 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_open.e09b13f215"
[0m05:02:50.407201 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_open.e09b13f215: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_open.e09b13f215"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from dev.analytics.stock_prices
where open is null



      
    ) dbt_internal_test
[0m05:02:50.408474 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:02:50.907042 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.498 seconds
[0m05:02:50.910283 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_open.e09b13f215: Close
[0m05:02:51.030471 [info ] [Thread-1 (]: 25 of 27 PASS not_null_stock_prices_open ....................................... [[32mPASS[0m in 0.65s]
[0m05:02:51.033891 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_open.e09b13f215
[0m05:02:51.035577 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8
[0m05:02:51.036506 [info ] [Thread-1 (]: 26 of 27 START test not_null_stock_prices_symbol ............................... [RUN]
[0m05:02:51.037884 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_open.e09b13f215, now test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8)
[0m05:02:51.038771 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8
[0m05:02:51.043388 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8"
[0m05:02:51.052353 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8
[0m05:02:51.054668 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8"
[0m05:02:51.062722 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8"
[0m05:02:51.064111 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.stock_prices
where symbol is null



      
    ) dbt_internal_test
[0m05:02:51.064968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:02:51.475559 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.410 seconds
[0m05:02:51.479445 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8: Close
[0m05:02:51.598586 [info ] [Thread-1 (]: 26 of 27 PASS not_null_stock_prices_symbol ..................................... [[32mPASS[0m in 0.56s]
[0m05:02:51.601376 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8
[0m05:02:51.603676 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_volume.71420bc956
[0m05:02:51.604751 [info ] [Thread-1 (]: 27 of 27 START test not_null_stock_prices_volume ............................... [RUN]
[0m05:02:51.606555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8, now test.stock_dbt.not_null_stock_prices_volume.71420bc956)
[0m05:02:51.608001 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_volume.71420bc956
[0m05:02:51.611652 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_volume.71420bc956"
[0m05:02:51.619750 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_volume.71420bc956
[0m05:02:51.621939 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_volume.71420bc956"
[0m05:02:51.631775 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_volume.71420bc956"
[0m05:02:51.632856 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_volume.71420bc956: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_volume.71420bc956"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume
from dev.analytics.stock_prices
where volume is null



      
    ) dbt_internal_test
[0m05:02:51.633859 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:02:52.027712 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.394 seconds
[0m05:02:52.033692 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_volume.71420bc956: Close
[0m05:02:52.163509 [info ] [Thread-1 (]: 27 of 27 PASS not_null_stock_prices_volume ..................................... [[32mPASS[0m in 0.56s]
[0m05:02:52.167528 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_volume.71420bc956
[0m05:02:52.170699 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:02:52.172044 [debug] [MainThread]: Connection 'test.stock_dbt.not_null_stock_prices_volume.71420bc956' was properly closed.
[0m05:02:52.173416 [info ] [MainThread]: 
[0m05:02:52.174902 [info ] [MainThread]: Finished running 27 data tests in 0 hours 0 minutes and 18.92 seconds (18.92s).
[0m05:02:52.178149 [debug] [MainThread]: Command end result
[0m05:02:52.261049 [info ] [MainThread]: 
[0m05:02:52.262551 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:02:52.264032 [info ] [MainThread]: 
[0m05:02:52.265905 [info ] [MainThread]: Done. PASS=27 WARN=0 ERROR=0 SKIP=0 TOTAL=27
[0m05:02:52.268101 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 20.282734, "process_user_time": 3.819405, "process_kernel_time": 2.961571, "process_mem_max_rss": "250272", "process_in_blocks": "1976", "process_out_blocks": "8"}
[0m05:02:52.270058 [debug] [MainThread]: Command `dbt test` succeeded at 05:02:52.269977 after 20.28 seconds
[0m05:02:52.271723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdba5dd8860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdba838a840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdba6fb3ad0>]}
[0m05:02:52.272806 [debug] [MainThread]: Flushing usage events
[0m05:02:54.149558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa63d9ddc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa63db82690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa63d9ddcd0>]}


============================== 05:02:54.154439 | 863b941d-9113-4987-b5dd-0abcde65796a ==============================
[0m05:02:54.154439 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:02:54.155478 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/stock_dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/stock_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/stock_dbt --project-dir /opt/airflow/stock_dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:02:54.790281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '863b941d-9113-4987-b5dd-0abcde65796a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa63d9ddcd0>]}
[0m05:02:54.827587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '863b941d-9113-4987-b5dd-0abcde65796a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5e4593fb0>]}
[0m05:02:54.830230 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:02:54.841196 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:02:55.140539 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:02:55.142118 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:02:55.147124 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.stock_prediction.tranformations
- models.stock_prediction.raw_data
- models.stock_prediction
[0m05:02:55.182331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '863b941d-9113-4987-b5dd-0abcde65796a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5e42289e0>]}
[0m05:02:55.297379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '863b941d-9113-4987-b5dd-0abcde65796a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5dfe7d340>]}
[0m05:02:55.298461 [info ] [MainThread]: Found 5 models, 4 snapshots, 27 data tests, 1 source, 459 macros
[0m05:02:55.299392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '863b941d-9113-4987-b5dd-0abcde65796a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5e4873b30>]}
[0m05:02:55.302034 [info ] [MainThread]: 
[0m05:02:55.304173 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:02:55.308214 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m05:02:55.319211 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m05:02:55.320419 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m05:02:55.321994 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:02:55.557946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95bfffba70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95c2a723c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95c03551c0>]}


============================== 05:02:55.563471 | 6ff8c27f-a061-4aac-a0ee-0a6ebbc65d3b ==============================
[0m05:02:55.563471 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:02:55.565240 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/stock_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/stock_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/stock_dbt --project-dir /opt/airflow/stock_dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:02:55.905117 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.583 seconds
[0m05:02:55.907825 [debug] [ThreadPool]: On list_dev: Close
[0m05:02:56.023967 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m05:02:56.031933 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m05:02:56.033408 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m05:02:56.034685 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:02:56.171002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ff8c27f-a061-4aac-a0ee-0a6ebbc65d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9562a1d610>]}
[0m05:02:56.208610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ff8c27f-a061-4aac-a0ee-0a6ebbc65d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9562c34440>]}
[0m05:02:56.211108 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:02:56.226127 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:02:56.412221 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.378 seconds
[0m05:02:56.414813 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m05:02:56.542904 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m05:02:56.545647 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m05:02:56.546439 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m05:02:56.547321 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:02:56.599650 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:02:56.600796 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:02:56.605045 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.stock_prediction
- models.stock_prediction.raw_data
- models.stock_prediction.tranformations
[0m05:02:56.638495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff8c27f-a061-4aac-a0ee-0a6ebbc65d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95627f1d00>]}
[0m05:02:56.759712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ff8c27f-a061-4aac-a0ee-0a6ebbc65d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f956246afc0>]}
[0m05:02:56.761444 [info ] [MainThread]: Found 5 models, 4 snapshots, 27 data tests, 1 source, 459 macros
[0m05:02:56.762808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ff8c27f-a061-4aac-a0ee-0a6ebbc65d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9569f67b60>]}
[0m05:02:56.765544 [info ] [MainThread]: 
[0m05:02:56.767013 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:02:56.771171 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m05:02:56.782972 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m05:02:56.785800 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m05:02:56.787950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:02:56.939073 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.392 seconds
[0m05:02:56.942158 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m05:02:57.068992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '863b941d-9113-4987-b5dd-0abcde65796a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5e4378230>]}
[0m05:02:57.071603 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:02:57.073498 [info ] [MainThread]: 
[0m05:02:57.083901 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.snapshot_atr
[0m05:02:57.085672 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshot.snapshot_atr .................................... [RUN]
[0m05:02:57.087354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now snapshot.stock_dbt.snapshot_atr)
[0m05:02:57.088787 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.snapshot_atr
[0m05:02:57.095574 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.snapshot_atr
[0m05:02:57.135158 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:02:57.137364 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
[0m05:02:57.139270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:02:57.267462 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.479 seconds
[0m05:02:57.270402 [debug] [ThreadPool]: On list_dev: Close
[0m05:02:57.397987 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m05:02:57.407061 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m05:02:57.408443 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m05:02:57.409699 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:02:57.498938 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.360 seconds
[0m05:02:57.534398 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:02:57.536138 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.avg_true_range


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m05:02:57.819804 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.410 seconds
[0m05:02:57.822695 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m05:02:57.946604 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m05:02:57.952299 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m05:02:57.954169 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m05:02:57.955799 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:02:58.189548 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.652 seconds
[0m05:02:58.192906 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:02:58.194168 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
[0m05:02:58.303089 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.108 seconds
[0m05:02:58.307552 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:02:58.309266 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
[0m05:02:58.342142 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.386 seconds
[0m05:02:58.345291 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m05:02:58.398346 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.087 seconds
[0m05:02:58.402501 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:02:58.404718 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
[0m05:02:58.461907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ff8c27f-a061-4aac-a0ee-0a6ebbc65d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9562df48c0>]}
[0m05:02:58.463863 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:02:58.465494 [info ] [MainThread]: 
[0m05:02:58.472319 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.snapshot_atr
[0m05:02:58.473926 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshot.snapshot_atr .................................... [RUN]
[0m05:02:58.475121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now snapshot.stock_dbt.snapshot_atr)
[0m05:02:58.476350 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.snapshot_atr
[0m05:02:58.480178 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.074 seconds
[0m05:02:58.483226 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.snapshot_atr
[0m05:02:58.484112 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:02:58.485431 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
[0m05:02:58.520863 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:02:58.522358 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
[0m05:02:58.523894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:02:58.565332 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.079 seconds
[0m05:02:58.572226 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:02:58.574630 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
[0m05:02:58.664909 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.088 seconds
[0m05:02:58.681754 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:02:58.683597 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.avg_true_range


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m05:02:58.918277 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.232 seconds
[0m05:02:58.918933 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.395 seconds
[0m05:02:58.923881 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:02:58.925574 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m05:02:58.954206 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:02:58.957686 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.avg_true_range


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m05:02:59.009496 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.082 seconds
[0m05:02:59.012205 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.snapshot_atr"
[0m05:02:59.026996 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:02:59.028529 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
BEGIN
[0m05:02:59.155813 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.126 seconds
[0m05:02:59.158151 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:02:59.159992 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_ATR" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATE", "SYMBOL", "ATR_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATE", "SYMBOL", "ATR_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m05:02:59.578200 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.617 seconds
[0m05:02:59.583235 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:02:59.585532 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
[0m05:02:59.722374 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.561 seconds
[0m05:02:59.724075 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.136 seconds
[0m05:02:59.725335 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:02:59.726986 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
COMMIT
[0m05:02:59.728601 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:02:59.730160 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
[0m05:02:59.805498 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.074 seconds
[0m05:02:59.813438 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:02:59.815730 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
[0m05:02:59.925749 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.108 seconds
[0m05:02:59.930979 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:02:59.933144 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
[0m05:03:00.009088 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.281 seconds
[0m05:03:00.017122 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.082 seconds
[0m05:03:00.026177 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:03:00.028390 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
[0m05:03:00.030132 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: Close
[0m05:03:00.133775 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.103 seconds
[0m05:03:00.152780 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:03:00.155326 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.avg_true_range


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m05:03:00.156380 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '863b941d-9113-4987-b5dd-0abcde65796a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5e430be00>]}
[0m05:03:00.158623 [info ] [Thread-1 (]: 1 of 4 OK snapshotted snapshot.snapshot_atr .................................... [[32mSUCCESS 0[0m in 3.07s]
[0m05:03:00.160298 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.snapshot_atr
[0m05:03:00.161562 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.snapshot_bollinger
[0m05:03:00.162613 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshot.snapshot_bollinger .............................. [RUN]
[0m05:03:00.163948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_dbt.snapshot_atr, now snapshot.stock_dbt.snapshot_bollinger)
[0m05:03:00.165100 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.snapshot_bollinger
[0m05:03:00.168413 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.snapshot_bollinger
[0m05:03:00.172562 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:03:00.175132 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
[0m05:03:00.176264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:03:00.379755 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.223 seconds
[0m05:03:00.383976 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:03:00.386007 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m05:03:00.457090 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.069 seconds
[0m05:03:00.458743 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.snapshot_atr"
[0m05:03:00.469302 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:03:00.470436 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
BEGIN
[0m05:03:00.628430 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.452 seconds
[0m05:03:00.627854 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.156 seconds
[0m05:03:00.630870 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:03:00.632416 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_ATR" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATE", "SYMBOL", "ATR_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATE", "SYMBOL", "ATR_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m05:03:00.636666 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:03:00.637914 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.bollinger


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m05:03:01.241044 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.607 seconds
[0m05:03:01.244931 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:03:01.248184 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
COMMIT
[0m05:03:01.592653 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.954 seconds
[0m05:03:01.596309 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:03:01.596996 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.346 seconds
[0m05:03:01.597826 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
[0m05:03:01.613435 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: Close
[0m05:03:01.725515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ff8c27f-a061-4aac-a0ee-0a6ebbc65d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9562940710>]}
[0m05:03:01.728286 [info ] [Thread-1 (]: 1 of 4 OK snapshotted snapshot.snapshot_atr .................................... [[32mSUCCESS 0[0m in 3.25s]
[0m05:03:01.730322 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.snapshot_atr
[0m05:03:01.732177 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.snapshot_bollinger
[0m05:03:01.734185 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshot.snapshot_bollinger .............................. [RUN]
[0m05:03:01.736193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_dbt.snapshot_atr, now snapshot.stock_dbt.snapshot_bollinger)
[0m05:03:01.738125 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.snapshot_bollinger
[0m05:03:01.741935 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.snapshot_bollinger
[0m05:03:01.746358 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:03:01.747953 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
[0m05:03:01.749426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:03:01.785280 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.186 seconds
[0m05:03:01.789543 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:03:01.791324 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
[0m05:03:01.868598 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.076 seconds
[0m05:03:01.873150 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:03:01.875324 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
[0m05:03:01.969664 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.093 seconds
[0m05:03:01.976607 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:03:01.978522 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
[0m05:03:02.043728 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.063 seconds
[0m05:03:02.048676 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:03:02.050131 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
[0m05:03:02.111804 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.362 seconds
[0m05:03:02.118730 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:03:02.120279 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.bollinger


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m05:03:02.265294 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.214 seconds
[0m05:03:02.272306 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:03:02.275361 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.bollinger


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m05:03:02.462824 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.185 seconds
[0m05:03:02.465374 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:03:02.467173 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m05:03:02.542457 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.074 seconds
[0m05:03:02.545042 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.snapshot_bollinger"
[0m05:03:02.558232 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:03:02.559333 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
BEGIN
[0m05:03:02.658452 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.098 seconds
[0m05:03:02.661260 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:03:02.662987 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "SMA_20D", "UPPER_BAND", "LOWER_BAND", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "SMA_20D", "UPPER_BAND", "LOWER_BAND", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m05:03:02.880544 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.758 seconds
[0m05:03:02.887771 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:03:02.890308 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
[0m05:03:02.981497 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.089 seconds
[0m05:03:02.987011 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:03:02.988974 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
[0m05:03:03.090319 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.099 seconds
[0m05:03:03.094575 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:03:03.096033 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
[0m05:03:03.191726 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.094 seconds
[0m05:03:03.199217 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:03:03.201332 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
[0m05:03:03.205671 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.541 seconds
[0m05:03:03.206882 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:03:03.208432 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
COMMIT
[0m05:03:03.320782 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.117 seconds
[0m05:03:03.327792 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:03:03.330045 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
[0m05:03:03.462263 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.131 seconds
[0m05:03:03.466938 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:03:03.468725 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.bollinger


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m05:03:03.587537 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.377 seconds
[0m05:03:03.591566 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: Close
[0m05:03:03.670946 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.200 seconds
[0m05:03:03.672857 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:03:03.674287 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m05:03:03.717164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '863b941d-9113-4987-b5dd-0abcde65796a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5df386930>]}
[0m05:03:03.719746 [info ] [Thread-1 (]: 2 of 4 OK snapshotted snapshot.snapshot_bollinger .............................. [[32mSUCCESS 0[0m in 3.55s]
[0m05:03:03.721960 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.snapshot_bollinger
[0m05:03:03.723660 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.snapshot_moving_avg
[0m05:03:03.725151 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshot.snapshot_moving_avg ............................. [RUN]
[0m05:03:03.726413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_dbt.snapshot_bollinger, now snapshot.stock_dbt.snapshot_moving_avg)
[0m05:03:03.727350 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.snapshot_moving_avg
[0m05:03:03.730607 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.snapshot_moving_avg
[0m05:03:03.734982 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:03:03.736255 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
[0m05:03:03.737293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:03:03.826727 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.151 seconds
[0m05:03:03.828958 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.snapshot_bollinger"
[0m05:03:03.839146 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:03:03.840217 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
BEGIN
[0m05:03:03.957241 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.116 seconds
[0m05:03:03.959440 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:03:03.960941 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "SMA_20D", "UPPER_BAND", "LOWER_BAND", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "SMA_20D", "UPPER_BAND", "LOWER_BAND", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m05:03:04.083964 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.347 seconds
[0m05:03:04.091157 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:03:04.094189 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.moving_average


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m05:03:04.502219 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.540 seconds
[0m05:03:04.504207 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:03:04.506258 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
COMMIT
[0m05:03:04.712073 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.616 seconds
[0m05:03:04.716391 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:03:04.718167 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
[0m05:03:04.749961 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.242 seconds
[0m05:03:04.753510 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: Close
[0m05:03:04.830223 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.110 seconds
[0m05:03:04.835886 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:03:04.838907 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
[0m05:03:04.877004 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ff8c27f-a061-4aac-a0ee-0a6ebbc65d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95624d9df0>]}
[0m05:03:04.879417 [info ] [Thread-1 (]: 2 of 4 OK snapshotted snapshot.snapshot_bollinger .............................. [[32mSUCCESS 0[0m in 3.14s]
[0m05:03:04.881381 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.snapshot_bollinger
[0m05:03:04.883121 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.snapshot_moving_avg
[0m05:03:04.884657 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshot.snapshot_moving_avg ............................. [RUN]
[0m05:03:04.886303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_dbt.snapshot_bollinger, now snapshot.stock_dbt.snapshot_moving_avg)
[0m05:03:04.887252 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.snapshot_moving_avg
[0m05:03:04.890245 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.snapshot_moving_avg
[0m05:03:04.894024 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:03:04.894980 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
[0m05:03:04.896028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:03:04.939859 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.098 seconds
[0m05:03:04.943419 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:03:04.945159 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
[0m05:03:05.029121 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.082 seconds
[0m05:03:05.035493 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:03:05.037679 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
[0m05:03:05.107926 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.068 seconds
[0m05:03:05.111845 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:03:05.113839 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
[0m05:03:05.207974 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.093 seconds
[0m05:03:05.215467 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:03:05.218667 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.moving_average


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m05:03:05.390124 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.169 seconds
[0m05:03:05.393523 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:03:05.395392 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m05:03:05.418067 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.522 seconds
[0m05:03:05.426007 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:03:05.427367 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.moving_average


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m05:03:05.496334 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.100 seconds
[0m05:03:05.497773 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:03:05.507514 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:03:05.508512 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
BEGIN
[0m05:03:05.607420 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.098 seconds
[0m05:03:05.610261 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:03:05.612380 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "MOVING_AVG_5D", "MOVING_AVG_20D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "MOVING_AVG_5D", "MOVING_AVG_20D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m05:03:06.125463 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.511 seconds
[0m05:03:06.127905 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:03:06.129890 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
COMMIT
[0m05:03:06.208720 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.780 seconds
[0m05:03:06.212597 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:03:06.214375 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
[0m05:03:06.324210 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.109 seconds
[0m05:03:06.327864 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:03:06.329436 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
[0m05:03:06.400203 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.070 seconds
[0m05:03:06.406224 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:03:06.408249 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
[0m05:03:06.430630 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.300 seconds
[0m05:03:06.433976 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: Close
[0m05:03:06.506635 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.096 seconds
[0m05:03:06.511461 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:03:06.512724 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
[0m05:03:06.548185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '863b941d-9113-4987-b5dd-0abcde65796a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa640fdbb60>]}
[0m05:03:06.550826 [info ] [Thread-1 (]: 3 of 4 OK snapshotted snapshot.snapshot_moving_avg ............................. [[32mSUCCESS 0[0m in 2.82s]
[0m05:03:06.552559 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.snapshot_moving_avg
[0m05:03:06.553825 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.snapshot_rsi
[0m05:03:06.555598 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshot.snapshot_rsi .................................... [RUN]
[0m05:03:06.557292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_dbt.snapshot_moving_avg, now snapshot.stock_dbt.snapshot_rsi)
[0m05:03:06.558843 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.snapshot_rsi
[0m05:03:06.562561 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.snapshot_rsi
[0m05:03:06.567013 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:03:06.568395 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m05:03:06.569890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:03:06.594007 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.080 seconds
[0m05:03:06.598399 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:03:06.600063 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
[0m05:03:06.692646 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.091 seconds
[0m05:03:06.697565 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:03:06.699259 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.moving_average


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m05:03:06.944460 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.244 seconds
[0m05:03:06.946492 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:03:06.947380 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m05:03:07.078979 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.130 seconds
[0m05:03:07.078900 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.509 seconds
[0m05:03:07.081985 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:03:07.086490 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:03:07.088037 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.rsi_calculation


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m05:03:07.098077 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:03:07.099765 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
BEGIN
[0m05:03:07.300050 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.198 seconds
[0m05:03:07.302880 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:03:07.305098 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "MOVING_AVG_5D", "MOVING_AVG_20D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "MOVING_AVG_5D", "MOVING_AVG_20D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m05:03:07.764191 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.457 seconds
[0m05:03:07.766160 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:03:07.767614 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
COMMIT
[0m05:03:07.829454 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.740 seconds
[0m05:03:07.833849 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:03:07.835273 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m05:03:07.976024 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.139 seconds
[0m05:03:07.980406 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:03:07.982336 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m05:03:08.065036 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.080 seconds
[0m05:03:08.070872 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:03:08.072942 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m05:03:08.111346 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.342 seconds
[0m05:03:08.114757 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: Close
[0m05:03:08.160786 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.085 seconds
[0m05:03:08.166022 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:03:08.168104 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m05:03:08.242992 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ff8c27f-a061-4aac-a0ee-0a6ebbc65d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9561c21340>]}
[0m05:03:08.245223 [info ] [Thread-1 (]: 3 of 4 OK snapshotted snapshot.snapshot_moving_avg ............................. [[32mSUCCESS 0[0m in 3.36s]
[0m05:03:08.246626 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.snapshot_moving_avg
[0m05:03:08.248644 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.snapshot_rsi
[0m05:03:08.250509 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshot.snapshot_rsi .................................... [RUN]
[0m05:03:08.251644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_dbt.snapshot_moving_avg, now snapshot.stock_dbt.snapshot_rsi)
[0m05:03:08.252669 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.snapshot_rsi
[0m05:03:08.256126 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.snapshot_rsi
[0m05:03:08.260409 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:03:08.261622 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m05:03:08.262209 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.092 seconds
[0m05:03:08.263179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:03:08.266074 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:03:08.267261 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m05:03:08.340819 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.072 seconds
[0m05:03:08.345709 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:03:08.347327 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.rsi_calculation


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m05:03:08.601993 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.253 seconds
[0m05:03:08.604247 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:03:08.605347 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m05:03:08.610952 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.348 seconds
[0m05:03:08.617718 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:03:08.619649 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.rsi_calculation


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m05:03:08.678877 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.072 seconds
[0m05:03:08.681392 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.snapshot_rsi"
[0m05:03:08.699566 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:03:08.701432 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
BEGIN
[0m05:03:08.806154 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.103 seconds
[0m05:03:08.808399 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:03:08.810351 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_RSI" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "AVG_GAIN", "AVG_LOSS", "RSI_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "AVG_GAIN", "AVG_LOSS", "RSI_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m05:03:09.281637 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.469 seconds
[0m05:03:09.283892 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:03:09.285823 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
COMMIT
[0m05:03:09.449910 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.829 seconds
[0m05:03:09.454183 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:03:09.455547 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m05:03:09.540074 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.083 seconds
[0m05:03:09.543684 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:03:09.545151 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m05:03:09.643836 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.097 seconds
[0m05:03:09.648455 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:03:09.650189 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m05:03:09.667993 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.381 seconds
[0m05:03:09.670976 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: Close
[0m05:03:09.739596 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.088 seconds
[0m05:03:09.743830 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:03:09.745857 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m05:03:09.782254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '863b941d-9113-4987-b5dd-0abcde65796a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5df5f8ad0>]}
[0m05:03:09.784530 [info ] [Thread-1 (]: 4 of 4 OK snapshotted snapshot.snapshot_rsi .................................... [[32mSUCCESS 0[0m in 3.22s]
[0m05:03:09.785743 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.snapshot_rsi
[0m05:03:09.787566 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:03:09.788814 [debug] [MainThread]: Connection 'snapshot.stock_dbt.snapshot_rsi' was properly closed.
[0m05:03:09.790390 [info ] [MainThread]: 
[0m05:03:09.792168 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 14.49 seconds (14.49s).
[0m05:03:09.793934 [debug] [MainThread]: Command end result
[0m05:03:09.861481 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.114 seconds
[0m05:03:09.865108 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:03:09.866568 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m05:03:09.899672 [info ] [MainThread]: 
[0m05:03:09.900899 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:03:09.902142 [info ] [MainThread]: 
[0m05:03:09.904266 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m05:03:09.906224 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 15.83352, "process_user_time": 3.298014, "process_kernel_time": 2.821149, "process_mem_max_rss": "241284", "process_in_blocks": "8", "process_out_blocks": "8"}
[0m05:03:09.908304 [debug] [MainThread]: Command `dbt snapshot` succeeded at 05:03:09.908216 after 15.84 seconds
[0m05:03:09.910318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5dfe3e990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6402ac500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5dff56e40>]}
[0m05:03:09.911698 [debug] [MainThread]: Flushing usage events
[0m05:03:09.971367 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.103 seconds
[0m05:03:09.976447 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:03:09.978187 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.rsi_calculation


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m05:03:10.252002 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.272 seconds
[0m05:03:10.255455 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:03:10.256887 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m05:03:10.358297 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.100 seconds
[0m05:03:10.363483 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.snapshot_rsi"
[0m05:03:10.426465 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:03:10.428877 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
BEGIN
[0m05:03:10.536428 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.105 seconds
[0m05:03:10.539288 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:03:10.541315 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_RSI" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "AVG_GAIN", "AVG_LOSS", "RSI_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "AVG_GAIN", "AVG_LOSS", "RSI_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m05:03:11.008167 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.465 seconds
[0m05:03:11.009951 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:03:11.011495 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
COMMIT
[0m05:03:11.291064 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.278 seconds
[0m05:03:11.293429 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: Close
[0m05:03:11.407309 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ff8c27f-a061-4aac-a0ee-0a6ebbc65d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9560050cb0>]}
[0m05:03:11.409559 [info ] [Thread-1 (]: 4 of 4 OK snapshotted snapshot.snapshot_rsi .................................... [[32mSUCCESS 0[0m in 3.16s]
[0m05:03:11.411019 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.snapshot_rsi
[0m05:03:11.413137 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:03:11.414219 [debug] [MainThread]: Connection 'snapshot.stock_dbt.snapshot_rsi' was properly closed.
[0m05:03:11.415548 [info ] [MainThread]: 
[0m05:03:11.416916 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 14.65 seconds (14.65s).
[0m05:03:11.418306 [debug] [MainThread]: Command end result
[0m05:03:11.518964 [info ] [MainThread]: 
[0m05:03:11.520043 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:03:11.520946 [info ] [MainThread]: 
[0m05:03:11.521667 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m05:03:11.522781 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 16.039165, "process_user_time": 3.287133, "process_kernel_time": 3.024162, "process_mem_max_rss": "239876", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m05:03:11.523783 [debug] [MainThread]: Command `dbt snapshot` succeeded at 05:03:11.523709 after 16.04 seconds
[0m05:03:11.525204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95c2a723c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95c13b4890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9562597500>]}
[0m05:03:11.526041 [debug] [MainThread]: Flushing usage events
[0m21:03:26.300768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178128BBBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178106B83E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017812822270>]}


============================== 21:03:26.303778 | 76103442-4b27-451a-a0b4-84a31c176f3c ==============================
[0m21:03:26.303778 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:03:26.304775 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\tekal\\Downloads\\Sem 1\\DATA226\\sjsu-data226\\week8\\airflow\\stock_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\tekal\\Downloads\\Sem 1\\DATA226\\sjsu-data226\\week8\\airflow\\stock_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m21:03:26.406898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76103442-4b27-451a-a0b4-84a31c176f3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017812CC15B0>]}
[0m21:03:26.434690 [debug] [MainThread]: Command `dbt clean` succeeded at 21:03:26.434690 after 0.35 seconds
[0m21:03:26.434690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017811FC89E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017812822270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178131A2F00>]}
[0m21:03:26.434690 [debug] [MainThread]: Flushing usage events
[0m21:03:31.278425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7443334D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E744333740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E744333710>]}


============================== 21:03:31.282232 | d0eb37b6-e6b6-4e2a-8495-b30a0dacf2be ==============================
[0m21:03:31.282232 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:03:31.282232 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\tekal\\Downloads\\Sem 1\\DATA226\\sjsu-data226\\week8\\airflow\\stock_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\tekal\\Downloads\\Sem 1\\DATA226\\sjsu-data226\\week8\\airflow\\stock_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:03:31.285423 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_ACCOUNT'
[0m21:03:31.286423 [debug] [MainThread]: Command `dbt run` failed at 21:03:31.286423 after 0.14 seconds
[0m21:03:31.286423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7443511C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E744333950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E744333FE0>]}
[0m21:03:31.286423 [debug] [MainThread]: Flushing usage events
[0m21:03:55.491741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224ACF336B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224AAD442C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224ACF31D00>]}


============================== 21:03:55.494575 | 15bb515b-9443-4027-9e27-0d81ad0241df ==============================
[0m21:03:55.494575 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:03:55.495107 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\tekal\\Downloads\\Sem 1\\DATA226\\sjsu-data226\\week8\\airflow\\stock_dbt\\logs', 'profiles_dir': 'C:\\Users\\tekal\\Downloads\\Sem 1\\DATA226\\sjsu-data226\\week8\\airflow\\stock_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:03:55.498374 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_DATABASE'
[0m21:03:55.498903 [debug] [MainThread]: Command `dbt run` failed at 21:03:55.498903 after 0.16 seconds
[0m21:03:55.498903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224AD0AFB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224ACFEB7A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224ACFEB890>]}
[0m21:03:55.499459 [debug] [MainThread]: Flushing usage events
[0m21:04:06.260823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C164E8710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C18E32B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C16B7A270>]}


============================== 21:04:06.263826 | e040959e-1a1c-4d96-bfea-7461178e613c ==============================
[0m21:04:06.263826 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:04:06.264826 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\tekal\\Downloads\\Sem 1\\DATA226\\sjsu-data226\\week8\\airflow\\stock_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\tekal\\Downloads\\Sem 1\\DATA226\\sjsu-data226\\week8\\airflow\\stock_dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:04:06.267834 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_TYPE'
[0m21:04:06.269059 [debug] [MainThread]: Command `dbt run` failed at 21:04:06.269059 after 0.15 seconds
[0m21:04:06.269059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C18DB1B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C18BAFC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C18E83170>]}
[0m21:04:06.269059 [debug] [MainThread]: Flushing usage events
[0m21:04:17.132507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BCC72F57C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BCCADD7200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BCCADD7410>]}


============================== 21:04:17.135503 | d8811072-95cd-4308-a2d2-bb7be140214d ==============================
[0m21:04:17.135503 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:04:17.135503 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\tekal\\Downloads\\Sem 1\\DATA226\\sjsu-data226\\week8\\airflow\\stock_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\tekal\\Downloads\\Sem 1\\DATA226\\sjsu-data226\\week8\\airflow\\stock_dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:04:17.138096 [error] [MainThread]: Encountered an error:
Runtime Error
  required field "type" not found in profile stock_dbt and target dev
[0m21:04:17.139007 [debug] [MainThread]: Command `dbt run` failed at 21:04:17.139007 after 0.17 seconds
[0m21:04:17.139489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BCCA0009E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BCCAC527E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BCCADD7740>]}
[0m21:04:17.139489 [debug] [MainThread]: Flushing usage events
[0m21:04:40.921178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7D32B0DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7D3111A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7D32B0B90>]}


============================== 21:04:40.924521 | 06ba3534-6570-4982-baf3-4c3e6127699b ==============================
[0m21:04:40.924521 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:04:40.924521 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\tekal\\Downloads\\Sem 1\\DATA226\\sjsu-data226\\week8\\airflow\\stock_dbt', 'log_path': 'C:\\Users\\tekal\\Downloads\\Sem 1\\DATA226\\sjsu-data226\\week8\\airflow\\stock_dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:04:40.926520 [error] [MainThread]: Encountered an error:
Runtime Error
  outputs not specified in profile 'stock_dbt'
[0m21:04:40.927520 [debug] [MainThread]: Command `dbt run` failed at 21:04:40.927520 after 0.15 seconds
[0m21:04:40.928521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7D32B3710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7D3093680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7D3297920>]}
[0m21:04:40.928521 [debug] [MainThread]: Flushing usage events
[0m21:04:57.161065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C68E3DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C68E35F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C68E3D70>]}


============================== 21:04:57.163077 | 465892c1-03d2-4626-9a57-bffbd18c3bf0 ==============================
[0m21:04:57.163077 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:04:57.164077 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\tekal\\Downloads\\Sem 1\\DATA226\\sjsu-data226\\week8\\airflow\\stock_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\tekal\\Downloads\\Sem 1\\DATA226\\sjsu-data226\\week8\\airflow\\stock_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:04:57.167076 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_ACCOUNT'
[0m21:04:57.168081 [debug] [MainThread]: Command `dbt run` failed at 21:04:57.168081 after 0.16 seconds
[0m21:04:57.168081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C6420920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C68E3A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C68E37A0>]}
[0m21:04:57.168081 [debug] [MainThread]: Flushing usage events
[0m21:07:02.714443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F7AF460C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F7B0A52B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F7B3DB4D0>]}


============================== 21:07:02.717491 | 63246b59-5416-4415-8e35-105ec05b7592 ==============================
[0m21:07:02.717491 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:07:02.717491 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\tekal\\Downloads\\Sem 1\\DATA226\\sjsu-data226\\week8\\airflow\\stock_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\tekal\\Downloads\\Sem 1\\DATA226\\sjsu-data226\\week8\\airflow\\stock_dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:07:02.720657 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'oqkqedn-jzb09886'
[0m21:07:02.721658 [debug] [MainThread]: Command `dbt run` failed at 21:07:02.721658 after 0.15 seconds
[0m21:07:02.721658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F7AF460C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F7B1319A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F7B3DB410>]}
[0m21:07:02.721658 [debug] [MainThread]: Flushing usage events
[0m21:07:33.689809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A229F08560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A22BDF7CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A22BDF6D80>]}


============================== 21:07:33.692805 | 354e35f5-6443-48f4-8c17-fe368b0dcc0a ==============================
[0m21:07:33.692805 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:07:33.693801 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\tekal\\Downloads\\Sem 1\\DATA226\\sjsu-data226\\week8\\airflow\\stock_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\tekal\\Downloads\\Sem 1\\DATA226\\sjsu-data226\\week8\\airflow\\stock_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:07:33.696813 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_ACCOUNT'
[0m21:07:33.697809 [debug] [MainThread]: Command `dbt run` failed at 21:07:33.697809 after 0.16 seconds
[0m21:07:33.697809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A229F08560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A22C8A39B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A22C5CB7D0>]}
[0m21:07:33.697809 [debug] [MainThread]: Flushing usage events
[0m21:07:38.847939 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m21:11:16.945295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001672F0F4170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001672B615250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001672EF29F40>]}


============================== 21:11:16.948403 | 09684fa5-ade2-4e93-a4bb-1d64b377d49b ==============================
[0m21:11:16.948403 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:11:16.948403 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\tekal\\Downloads\\Sem 1\\DATA226\\sjsu-data226\\week8\\airflow\\stock_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\tekal\\Downloads\\Sem 1\\DATA226\\sjsu-data226\\week8\\airflow\\stock_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:11:24.994864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09684fa5-ade2-4e93-a4bb-1d64b377d49b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001672EC2E0F0>]}
[0m21:11:25.037515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09684fa5-ade2-4e93-a4bb-1d64b377d49b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001675FC11160>]}
[0m21:11:25.038507 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:11:25.056752 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:11:25.057831 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:11:25.057831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '09684fa5-ade2-4e93-a4bb-1d64b377d49b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001672FAC2690>]}
[0m21:11:26.641791 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:11:26.642868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '09684fa5-ade2-4e93-a4bb-1d64b377d49b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001672D757560>]}
[0m21:11:26.843785 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.stock_prediction.raw_data
- models.stock_prediction
- models.stock_prediction.tranformations
[0m21:11:26.851262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09684fa5-ade2-4e93-a4bb-1d64b377d49b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001675FEC2B70>]}
[0m21:11:26.936111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09684fa5-ade2-4e93-a4bb-1d64b377d49b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001676207E030>]}
[0m21:11:26.936111 [info ] [MainThread]: Found 5 models, 4 snapshots, 27 data tests, 1 source, 459 macros
[0m21:11:26.936111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09684fa5-ade2-4e93-a4bb-1d64b377d49b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016762178920>]}
[0m21:11:26.938110 [info ] [MainThread]: 
[0m21:11:26.938110 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:11:26.941162 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m21:11:26.948166 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m21:11:26.948166 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m21:11:26.948166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:11:27.701019 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.752 seconds
[0m21:11:27.702029 [debug] [ThreadPool]: On list_dev: Close
[0m21:11:27.825617 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_snapshot'
[0m21:11:27.830894 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m21:11:27.830894 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m21:11:27.831908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:11:28.585876 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.754 seconds
[0m21:11:28.589353 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m21:11:28.711543 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m21:11:28.714539 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m21:11:28.715547 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m21:11:28.715547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:11:29.333439 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.618 seconds
[0m21:11:29.334441 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m21:11:29.451124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09684fa5-ade2-4e93-a4bb-1d64b377d49b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016761F1C620>]}
[0m21:11:29.452119 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:11:29.452692 [info ] [MainThread]: 
[0m21:11:29.458913 [debug] [Thread-1 (]: Began running node model.stock_dbt.stock_prices
[0m21:11:29.458913 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stock_prices ............................. [RUN]
[0m21:11:29.459660 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.stock_dbt.stock_prices'
[0m21:11:29.459660 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.stock_prices
[0m21:11:29.464601 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.stock_prices"
[0m21:11:29.465585 [debug] [Thread-1 (]: Began executing node model.stock_dbt.stock_prices
[0m21:11:29.481049 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.stock_prices"
[0m21:11:29.482489 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.stock_prices"
[0m21:11:29.482489 [debug] [Thread-1 (]: On model.stock_dbt.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.stock_prices"} */
create or replace   view dev.analytics.stock_prices
  
   as (
    SELECT
    symbol,
    date,
    open,
    high,
    low,
    close,
    volume
FROM dev.raw_data.stock_prices
  );
[0m21:11:29.482489 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:11:30.442207 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.960 seconds
[0m21:11:30.457493 [debug] [Thread-1 (]: On model.stock_dbt.stock_prices: Close
[0m21:11:30.578598 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09684fa5-ade2-4e93-a4bb-1d64b377d49b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001672F3296A0>]}
[0m21:11:30.579649 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stock_prices ........................ [[32mSUCCESS 1[0m in 1.12s]
[0m21:11:30.579649 [debug] [Thread-1 (]: Finished running node model.stock_dbt.stock_prices
[0m21:11:30.580649 [debug] [Thread-1 (]: Began running node model.stock_dbt.avg_true_range
[0m21:11:30.580649 [info ] [Thread-1 (]: 2 of 5 START sql view model analytics.avg_true_range ........................... [RUN]
[0m21:11:30.581652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.stock_prices, now model.stock_dbt.avg_true_range)
[0m21:11:30.581652 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.avg_true_range
[0m21:11:30.583649 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.avg_true_range"
[0m21:11:30.583649 [debug] [Thread-1 (]: Began executing node model.stock_dbt.avg_true_range
[0m21:11:30.585649 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.avg_true_range"
[0m21:11:30.586650 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.avg_true_range"
[0m21:11:30.586650 [debug] [Thread-1 (]: On model.stock_dbt.avg_true_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.avg_true_range"} */
create or replace   view dev.analytics.avg_true_range
  
   as (
    WITH averageTrueRanges AS (
    SELECT
        date,
        symbol,
        close,
        ABS(close - LAG(close) OVER (PARTITION BY symbol ORDER BY date)) AS true_range
    FROM dev.analytics.stock_prices
),
atr AS (
    SELECT
        date,
        symbol,
        AVG(true_range) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS atr_14d
    FROM averageTrueRanges
)
SELECT 
    date, 
    symbol, 
    COALESCE(atr_14d, 0) AS atr_14d
FROM atr
ORDER BY date, symbol
  );
[0m21:11:30.586650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:11:31.431613 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.845 seconds
[0m21:11:31.434607 [debug] [Thread-1 (]: On model.stock_dbt.avg_true_range: Close
[0m21:11:31.558672 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09684fa5-ade2-4e93-a4bb-1d64b377d49b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016762753F20>]}
[0m21:11:31.559929 [info ] [Thread-1 (]: 2 of 5 OK created sql view model analytics.avg_true_range ...................... [[32mSUCCESS 1[0m in 0.98s]
[0m21:11:31.560823 [debug] [Thread-1 (]: Finished running node model.stock_dbt.avg_true_range
[0m21:11:31.561916 [debug] [Thread-1 (]: Began running node model.stock_dbt.bollinger
[0m21:11:31.561916 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.bollinger ................................ [RUN]
[0m21:11:31.562892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.avg_true_range, now model.stock_dbt.bollinger)
[0m21:11:31.562892 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.bollinger
[0m21:11:31.565906 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.bollinger"
[0m21:11:31.567816 [debug] [Thread-1 (]: Began executing node model.stock_dbt.bollinger
[0m21:11:31.570254 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.bollinger"
[0m21:11:31.571188 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.bollinger"
[0m21:11:31.571188 [debug] [Thread-1 (]: On model.stock_dbt.bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.bollinger"} */
create or replace   view dev.analytics.bollinger
  
   as (
    WITH bollinger AS (
    SELECT
        symbol,
        date,
        close,
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) AS sma_20d,
        STDDEV(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) AS stddev_20d
    FROM dev.analytics.stock_prices
)

SELECT
    symbol,
    date,
    close,
    COALESCE(sma_20d, 0) AS sma_20d,
    COALESCE(sma_20d + (2 * stddev_20d), 0) AS upper_band,
    COALESCE(sma_20d - (2 * stddev_20d), 0) AS lower_band
FROM bollinger
ORDER BY symbol, date
  );
[0m21:11:31.572275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:11:32.390489 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.818 seconds
[0m21:11:32.394439 [debug] [Thread-1 (]: On model.stock_dbt.bollinger: Close
[0m21:11:32.508347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09684fa5-ade2-4e93-a4bb-1d64b377d49b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167620B61B0>]}
[0m21:11:32.509436 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.bollinger ........................... [[32mSUCCESS 1[0m in 0.95s]
[0m21:11:32.511346 [debug] [Thread-1 (]: Finished running node model.stock_dbt.bollinger
[0m21:11:32.511346 [debug] [Thread-1 (]: Began running node model.stock_dbt.moving_average
[0m21:11:32.512342 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.moving_average ........................... [RUN]
[0m21:11:32.513341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.bollinger, now model.stock_dbt.moving_average)
[0m21:11:32.513341 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.moving_average
[0m21:11:32.515383 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.moving_average"
[0m21:11:32.525624 [debug] [Thread-1 (]: Began executing node model.stock_dbt.moving_average
[0m21:11:32.527629 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.moving_average"
[0m21:11:32.528631 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.moving_average"
[0m21:11:32.528631 [debug] [Thread-1 (]: On model.stock_dbt.moving_average: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.moving_average"} */
create or replace   view dev.analytics.moving_average
  
   as (
    WITH stock_data AS (
    SELECT
        symbol,
        date,
        close
    FROM dev.analytics.stock_prices -- assuming 'stock_prices' is the name of the raw table model in dbt
)

SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
    ) AS moving_avg_5d,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
    ) AS moving_avg_20d
FROM stock_data
ORDER BY symbol, date
  );
[0m21:11:32.528631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:11:33.419177 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.890 seconds
[0m21:11:33.422254 [debug] [Thread-1 (]: On model.stock_dbt.moving_average: Close
[0m21:11:33.535741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09684fa5-ade2-4e93-a4bb-1d64b377d49b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167628474A0>]}
[0m21:11:33.536741 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.moving_average ...................... [[32mSUCCESS 1[0m in 1.02s]
[0m21:11:33.537202 [debug] [Thread-1 (]: Finished running node model.stock_dbt.moving_average
[0m21:11:33.537202 [debug] [Thread-1 (]: Began running node model.stock_dbt.rsi_calculation
[0m21:11:33.538253 [info ] [Thread-1 (]: 5 of 5 START sql view model analytics.rsi_calculation .......................... [RUN]
[0m21:11:33.538700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.moving_average, now model.stock_dbt.rsi_calculation)
[0m21:11:33.538700 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.rsi_calculation
[0m21:11:33.540767 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.rsi_calculation"
[0m21:11:33.541779 [debug] [Thread-1 (]: Began executing node model.stock_dbt.rsi_calculation
[0m21:11:33.543782 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.rsi_calculation"
[0m21:11:33.544771 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.rsi_calculation"
[0m21:11:33.544771 [debug] [Thread-1 (]: On model.stock_dbt.rsi_calculation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.rsi_calculation"} */
create or replace   view dev.analytics.rsi_calculation
  
   as (
    WITH stock_data AS (
    SELECT
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM dev.analytics.stock_prices
),

price_changes AS (
    SELECT
        symbol,
        date,
        close,
        CASE 
            WHEN close > prev_close THEN close - prev_close
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close < prev_close THEN prev_close - close
            ELSE 0 
        END AS loss
    FROM stock_data
),

average_gains_losses AS (
    SELECT
        symbol,
        date,
        close,
        -- Calculate the average gain over the last 14 days, including the current row
        AVG(gain) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain,
        -- Calculate the average loss over the last 14 days, including the current row
        AVG(loss) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss
    FROM price_changes
)

SELECT
    symbol,
    date,
    close,
    avg_gain,
    avg_loss,
    -- Calculate RSI, using COALESCE to set to 0 if result is NULL
    COALESCE(100 - (100 / (1 + (NULLIF(avg_gain, 0) / NULLIF(avg_loss, 0)))), 0) AS rsi_14d
FROM average_gains_losses
ORDER BY symbol, date
  );
[0m21:11:33.544771 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:11:34.362140 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.817 seconds
[0m21:11:34.364141 [debug] [Thread-1 (]: On model.stock_dbt.rsi_calculation: Close
[0m21:11:34.484904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09684fa5-ade2-4e93-a4bb-1d64b377d49b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001676286C4D0>]}
[0m21:11:34.485900 [info ] [Thread-1 (]: 5 of 5 OK created sql view model analytics.rsi_calculation ..................... [[32mSUCCESS 1[0m in 0.95s]
[0m21:11:34.487923 [debug] [Thread-1 (]: Finished running node model.stock_dbt.rsi_calculation
[0m21:11:34.489216 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:11:34.489216 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m21:11:34.489216 [debug] [MainThread]: Connection 'list_dev_analytics' was properly closed.
[0m21:11:34.489216 [debug] [MainThread]: Connection 'model.stock_dbt.rsi_calculation' was properly closed.
[0m21:11:34.489216 [info ] [MainThread]: 
[0m21:11:34.490423 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 7.55 seconds (7.55s).
[0m21:11:34.490840 [debug] [MainThread]: Command end result
[0m21:11:34.508412 [info ] [MainThread]: 
[0m21:11:34.508412 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:11:34.508412 [info ] [MainThread]: 
[0m21:11:34.508412 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m21:11:34.509596 [debug] [MainThread]: Command `dbt run` succeeded at 21:11:34.509596 after 17.74 seconds
[0m21:11:34.509596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001672F360B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016729A3EEA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001672FA71D00>]}
[0m21:11:34.510605 [debug] [MainThread]: Flushing usage events
[0m21:13:51.031097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F668434A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F66ADAFD70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F66AE3B7D0>]}


============================== 21:13:51.033096 | fa189391-9cef-4997-9678-9a5829bebd92 ==============================
[0m21:13:51.033096 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:13:51.034100 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\tekal\\Downloads\\Sem 1\\DATA226\\sjsu-data226\\week8\\airflow\\stock_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\tekal\\Downloads\\Sem 1\\DATA226\\sjsu-data226\\week8\\airflow\\stock_dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:13:51.672069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa189391-9cef-4997-9678-9a5829bebd92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F66AF23470>]}
[0m21:13:51.709792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa189391-9cef-4997-9678-9a5829bebd92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F61C098770>]}
[0m21:13:51.711764 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:13:51.715715 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:13:51.784811 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:13:51.786103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fa189391-9cef-4997-9678-9a5829bebd92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F61D4824B0>]}
[0m21:13:52.486233 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:13:52.487237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fa189391-9cef-4997-9678-9a5829bebd92', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F61D5514F0>]}
[0m21:13:52.679910 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.stock_prediction.tranformations
- models.stock_prediction
- models.stock_prediction.raw_data
[0m21:13:52.685908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa189391-9cef-4997-9678-9a5829bebd92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F61D557FB0>]}
[0m21:13:52.747883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa189391-9cef-4997-9678-9a5829bebd92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F61D87B9B0>]}
[0m21:13:52.747883 [info ] [MainThread]: Found 5 models, 4 snapshots, 27 data tests, 1 source, 459 macros
[0m21:13:52.749183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa189391-9cef-4997-9678-9a5829bebd92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F61D2FAFC0>]}
[0m21:13:52.750596 [info ] [MainThread]: 
[0m21:13:52.750596 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:13:52.753592 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m21:13:52.759879 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m21:13:52.759879 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m21:13:52.760793 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:13:53.573723 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.813 seconds
[0m21:13:53.575721 [debug] [ThreadPool]: On list_dev: Close
[0m21:13:53.694802 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_analytics'
[0m21:13:53.700196 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m21:13:53.700196 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m21:13:53.700196 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:13:54.329530 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.629 seconds
[0m21:13:54.331931 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m21:13:54.444026 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m21:13:54.448026 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m21:13:54.448026 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m21:13:54.448026 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:13:54.973239 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.525 seconds
[0m21:13:54.974774 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m21:13:55.088753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa189391-9cef-4997-9678-9a5829bebd92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F61D6B80E0>]}
[0m21:13:55.088753 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:13:55.089753 [info ] [MainThread]: 
[0m21:13:55.091753 [debug] [Thread-1 (]: Began running node model.stock_dbt.stock_prices
[0m21:13:55.091753 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stock_prices ............................. [RUN]
[0m21:13:55.092429 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.stock_dbt.stock_prices'
[0m21:13:55.092429 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.stock_prices
[0m21:13:55.096442 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.stock_prices"
[0m21:13:55.096442 [debug] [Thread-1 (]: Began executing node model.stock_dbt.stock_prices
[0m21:13:55.112717 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.stock_prices"
[0m21:13:55.113286 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.stock_prices"
[0m21:13:55.113286 [debug] [Thread-1 (]: On model.stock_dbt.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.stock_prices"} */
create or replace   view dev.analytics.stock_prices
  
   as (
    SELECT
    symbol,
    date,
    open,
    high,
    low,
    close,
    volume
FROM dev.raw_data.stock_prices
  );
[0m21:13:55.113850 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:13:55.944144 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.830 seconds
[0m21:13:55.958516 [debug] [Thread-1 (]: On model.stock_dbt.stock_prices: Close
[0m21:13:56.104176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa189391-9cef-4997-9678-9a5829bebd92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F61C199850>]}
[0m21:13:56.105177 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stock_prices ........................ [[32mSUCCESS 1[0m in 1.01s]
[0m21:13:56.105177 [debug] [Thread-1 (]: Finished running node model.stock_dbt.stock_prices
[0m21:13:56.106169 [debug] [Thread-1 (]: Began running node model.stock_dbt.avg_true_range
[0m21:13:56.106169 [info ] [Thread-1 (]: 2 of 5 START sql view model analytics.avg_true_range ........................... [RUN]
[0m21:13:56.107169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.stock_prices, now model.stock_dbt.avg_true_range)
[0m21:13:56.107169 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.avg_true_range
[0m21:13:56.109176 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.avg_true_range"
[0m21:13:56.110417 [debug] [Thread-1 (]: Began executing node model.stock_dbt.avg_true_range
[0m21:13:56.111417 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.avg_true_range"
[0m21:13:56.112424 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.avg_true_range"
[0m21:13:56.112424 [debug] [Thread-1 (]: On model.stock_dbt.avg_true_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.avg_true_range"} */
create or replace   view dev.analytics.avg_true_range
  
   as (
    WITH averageTrueRanges AS (
    SELECT
        date,
        symbol,
        close,
        ABS(close - LAG(close) OVER (PARTITION BY symbol ORDER BY date)) AS true_range
    FROM dev.analytics.stock_prices
),
atr AS (
    SELECT
        date,
        symbol,
        AVG(true_range) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS atr_14d
    FROM averageTrueRanges
)
SELECT 
    date, 
    symbol, 
    COALESCE(atr_14d, 0) AS atr_14d
FROM atr
ORDER BY date, symbol
  );
[0m21:13:56.112424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:56.841855 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.728 seconds
[0m21:13:56.844943 [debug] [Thread-1 (]: On model.stock_dbt.avg_true_range: Close
[0m21:13:56.956042 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa189391-9cef-4997-9678-9a5829bebd92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F61DB0C0B0>]}
[0m21:13:56.957956 [info ] [Thread-1 (]: 2 of 5 OK created sql view model analytics.avg_true_range ...................... [[32mSUCCESS 1[0m in 0.85s]
[0m21:13:56.959331 [debug] [Thread-1 (]: Finished running node model.stock_dbt.avg_true_range
[0m21:13:56.959331 [debug] [Thread-1 (]: Began running node model.stock_dbt.bollinger
[0m21:13:56.960326 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.bollinger ................................ [RUN]
[0m21:13:56.961327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.avg_true_range, now model.stock_dbt.bollinger)
[0m21:13:56.961327 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.bollinger
[0m21:13:56.964409 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.bollinger"
[0m21:13:56.965417 [debug] [Thread-1 (]: Began executing node model.stock_dbt.bollinger
[0m21:13:56.966330 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.bollinger"
[0m21:13:56.967327 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.bollinger"
[0m21:13:56.967327 [debug] [Thread-1 (]: On model.stock_dbt.bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.bollinger"} */
create or replace   view dev.analytics.bollinger
  
   as (
    WITH bollinger AS (
    SELECT
        symbol,
        date,
        close,
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) AS sma_20d,
        STDDEV(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) AS stddev_20d
    FROM dev.analytics.stock_prices
)

SELECT
    symbol,
    date,
    close,
    COALESCE(sma_20d, 0) AS sma_20d,
    COALESCE(sma_20d + (2 * stddev_20d), 0) AS upper_band,
    COALESCE(sma_20d - (2 * stddev_20d), 0) AS lower_band
FROM bollinger
ORDER BY symbol, date
  );
[0m21:13:56.968405 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:57.825712 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.858 seconds
[0m21:13:57.828108 [debug] [Thread-1 (]: On model.stock_dbt.bollinger: Close
[0m21:13:57.938952 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa189391-9cef-4997-9678-9a5829bebd92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F61DAF2570>]}
[0m21:13:57.938952 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.bollinger ........................... [[32mSUCCESS 1[0m in 0.98s]
[0m21:13:57.940215 [debug] [Thread-1 (]: Finished running node model.stock_dbt.bollinger
[0m21:13:57.940215 [debug] [Thread-1 (]: Began running node model.stock_dbt.moving_average
[0m21:13:57.941259 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.moving_average ........................... [RUN]
[0m21:13:57.941259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.bollinger, now model.stock_dbt.moving_average)
[0m21:13:57.941259 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.moving_average
[0m21:13:57.943244 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.moving_average"
[0m21:13:57.944246 [debug] [Thread-1 (]: Began executing node model.stock_dbt.moving_average
[0m21:13:57.945245 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.moving_average"
[0m21:13:57.946245 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.moving_average"
[0m21:13:57.946245 [debug] [Thread-1 (]: On model.stock_dbt.moving_average: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.moving_average"} */
create or replace   view dev.analytics.moving_average
  
   as (
    WITH stock_data AS (
    SELECT
        symbol,
        date,
        close
    FROM dev.analytics.stock_prices -- assuming 'stock_prices' is the name of the raw table model in dbt
)

SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
    ) AS moving_avg_5d,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
    ) AS moving_avg_20d
FROM stock_data
ORDER BY symbol, date
  );
[0m21:13:57.946245 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:58.732448 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.786 seconds
[0m21:13:58.736526 [debug] [Thread-1 (]: On model.stock_dbt.moving_average: Close
[0m21:13:58.878828 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa189391-9cef-4997-9678-9a5829bebd92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F61DC384A0>]}
[0m21:13:58.879271 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.moving_average ...................... [[32mSUCCESS 1[0m in 0.94s]
[0m21:13:58.880292 [debug] [Thread-1 (]: Finished running node model.stock_dbt.moving_average
[0m21:13:58.881266 [debug] [Thread-1 (]: Began running node model.stock_dbt.rsi_calculation
[0m21:13:58.881266 [info ] [Thread-1 (]: 5 of 5 START sql view model analytics.rsi_calculation .......................... [RUN]
[0m21:13:58.882366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.moving_average, now model.stock_dbt.rsi_calculation)
[0m21:13:58.882366 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.rsi_calculation
[0m21:13:58.885372 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.rsi_calculation"
[0m21:13:58.885372 [debug] [Thread-1 (]: Began executing node model.stock_dbt.rsi_calculation
[0m21:13:58.888454 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.rsi_calculation"
[0m21:13:58.889989 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.rsi_calculation"
[0m21:13:58.889989 [debug] [Thread-1 (]: On model.stock_dbt.rsi_calculation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.rsi_calculation"} */
create or replace   view dev.analytics.rsi_calculation
  
   as (
    WITH stock_data AS (
    SELECT
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM dev.analytics.stock_prices
),

price_changes AS (
    SELECT
        symbol,
        date,
        close,
        CASE 
            WHEN close > prev_close THEN close - prev_close
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close < prev_close THEN prev_close - close
            ELSE 0 
        END AS loss
    FROM stock_data
),

average_gains_losses AS (
    SELECT
        symbol,
        date,
        close,
        -- Calculate the average gain over the last 14 days, including the current row
        AVG(gain) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain,
        -- Calculate the average loss over the last 14 days, including the current row
        AVG(loss) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss
    FROM price_changes
)

SELECT
    symbol,
    date,
    close,
    avg_gain,
    avg_loss,
    -- Calculate RSI, using COALESCE to set to 0 if result is NULL
    COALESCE(100 - (100 / (1 + (NULLIF(avg_gain, 0) / NULLIF(avg_loss, 0)))), 0) AS rsi_14d
FROM average_gains_losses
ORDER BY symbol, date
  );
[0m21:13:58.890993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:59.739873 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.849 seconds
[0m21:13:59.742873 [debug] [Thread-1 (]: On model.stock_dbt.rsi_calculation: Close
[0m21:13:59.865894 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa189391-9cef-4997-9678-9a5829bebd92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F61DC2D850>]}
[0m21:13:59.866933 [info ] [Thread-1 (]: 5 of 5 OK created sql view model analytics.rsi_calculation ..................... [[32mSUCCESS 1[0m in 0.98s]
[0m21:13:59.867854 [debug] [Thread-1 (]: Finished running node model.stock_dbt.rsi_calculation
[0m21:13:59.869251 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:13:59.870262 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m21:13:59.870262 [debug] [MainThread]: Connection 'list_dev_snapshot' was properly closed.
[0m21:13:59.870262 [debug] [MainThread]: Connection 'model.stock_dbt.rsi_calculation' was properly closed.
[0m21:13:59.871256 [info ] [MainThread]: 
[0m21:13:59.871256 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 7.12 seconds (7.12s).
[0m21:13:59.872256 [debug] [MainThread]: Command end result
[0m21:13:59.888451 [info ] [MainThread]: 
[0m21:13:59.888451 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:13:59.889660 [info ] [MainThread]: 
[0m21:13:59.889660 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m21:13:59.890658 [debug] [MainThread]: Command `dbt run` succeeded at 21:13:59.890658 after 9.09 seconds
[0m21:13:59.890658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F66AC50BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F66AE08710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F61D773680>]}
[0m21:13:59.890658 [debug] [MainThread]: Flushing usage events
[0m21:16:23.541969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001712A4A17F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001712A4A3380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017127B00920>]}


============================== 21:16:23.544033 | 1d61d5ee-c74b-4301-b529-9a243d3cd725 ==============================
[0m21:16:23.544033 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:16:23.544977 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\tekal\\Downloads\\Sem 1\\DATA226\\sjsu-data226\\week8\\airflow\\stock_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\tekal\\Downloads\\Sem 1\\DATA226\\sjsu-data226\\week8\\airflow\\stock_dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:16:23.633479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d61d5ee-c74b-4301-b529-9a243d3cd725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001712A5F0800>]}
[0m21:16:23.651029 [debug] [MainThread]: Command `dbt clean` succeeded at 21:16:23.651029 after 0.34 seconds
[0m21:16:23.652034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171243FEA80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001712A1C9910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171295BBE00>]}
[0m21:16:23.652034 [debug] [MainThread]: Flushing usage events
[0m21:16:28.533399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A0B6427B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A0B640FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A0B641D00>]}


============================== 21:16:28.536398 | 56958e81-faae-4da4-9f3c-0233e2da18a0 ==============================
[0m21:16:28.536398 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:16:28.536398 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\tekal\\Downloads\\Sem 1\\DATA226\\sjsu-data226\\week8\\airflow\\stock_dbt\\logs', 'profiles_dir': 'C:\\Users\\tekal\\Downloads\\Sem 1\\DATA226\\sjsu-data226\\week8\\airflow\\stock_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:16:29.166441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56958e81-faae-4da4-9f3c-0233e2da18a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A0A65E0F0>]}
[0m21:16:29.206498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56958e81-faae-4da4-9f3c-0233e2da18a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A3B4C3770>]}
[0m21:16:29.207494 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:16:29.212719 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:16:29.212719 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:16:29.213641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '56958e81-faae-4da4-9f3c-0233e2da18a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A3D908440>]}
[0m21:16:29.936805 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:16:29.937806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '56958e81-faae-4da4-9f3c-0233e2da18a0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A3DDB4950>]}
[0m21:16:30.146680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56958e81-faae-4da4-9f3c-0233e2da18a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A3DD1C290>]}
[0m21:16:30.211971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56958e81-faae-4da4-9f3c-0233e2da18a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A3DAF0230>]}
[0m21:16:30.211971 [info ] [MainThread]: Found 5 models, 4 snapshots, 27 data tests, 1 source, 459 macros
[0m21:16:30.212963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56958e81-faae-4da4-9f3c-0233e2da18a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A0BECF050>]}
[0m21:16:30.213971 [info ] [MainThread]: 
[0m21:16:30.214962 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:16:30.216963 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m21:16:30.224069 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m21:16:30.224069 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m21:16:30.225072 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:16:30.963008 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.738 seconds
[0m21:16:30.964087 [debug] [ThreadPool]: On list_dev: Close
[0m21:16:31.090420 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_snapshot'
[0m21:16:31.096415 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m21:16:31.096763 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m21:16:31.096763 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:16:31.898341 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.802 seconds
[0m21:16:31.900727 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m21:16:32.043730 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m21:16:32.046773 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m21:16:32.046773 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m21:16:32.046773 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:16:32.659331 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.612 seconds
[0m21:16:32.662419 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m21:16:32.802443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56958e81-faae-4da4-9f3c-0233e2da18a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A3DCD7080>]}
[0m21:16:32.803428 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:16:32.804429 [info ] [MainThread]: 
[0m21:16:32.807427 [debug] [Thread-1 (]: Began running node model.stock_dbt.stock_prices
[0m21:16:32.807427 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stock_prices ............................. [RUN]
[0m21:16:32.808427 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.stock_dbt.stock_prices'
[0m21:16:32.808427 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.stock_prices
[0m21:16:32.812548 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.stock_prices"
[0m21:16:32.814548 [debug] [Thread-1 (]: Began executing node model.stock_dbt.stock_prices
[0m21:16:32.829292 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.stock_prices"
[0m21:16:32.829292 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.stock_prices"
[0m21:16:32.830631 [debug] [Thread-1 (]: On model.stock_dbt.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.stock_prices"} */
create or replace   view dev.analytics.stock_prices
  
   as (
    SELECT
    symbol,
    date,
    open,
    high,
    low,
    close,
    volume
FROM dev.raw_data.stock_prices
  );
[0m21:16:32.830631 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:16:33.593095 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.762 seconds
[0m21:16:33.607587 [debug] [Thread-1 (]: On model.stock_dbt.stock_prices: Close
[0m21:16:33.735201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56958e81-faae-4da4-9f3c-0233e2da18a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A0AD595E0>]}
[0m21:16:33.736208 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stock_prices ........................ [[32mSUCCESS 1[0m in 0.93s]
[0m21:16:33.736208 [debug] [Thread-1 (]: Finished running node model.stock_dbt.stock_prices
[0m21:16:33.737390 [debug] [Thread-1 (]: Began running node model.stock_dbt.avg_true_range
[0m21:16:33.737390 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.avg_true_range .......................... [RUN]
[0m21:16:33.738437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.stock_prices, now model.stock_dbt.avg_true_range)
[0m21:16:33.738437 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.avg_true_range
[0m21:16:33.739642 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.avg_true_range"
[0m21:16:33.740635 [debug] [Thread-1 (]: Began executing node model.stock_dbt.avg_true_range
[0m21:16:33.745706 [debug] [Thread-1 (]: Dropping relation "DEV"."ANALYTICS"."AVG_TRUE_RANGE" because it is of type view
[0m21:16:33.749854 [debug] [Thread-1 (]: Applying DROP to: "DEV"."ANALYTICS"."AVG_TRUE_RANGE"
[0m21:16:33.753846 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.avg_true_range"
[0m21:16:33.753846 [debug] [Thread-1 (]: On model.stock_dbt.avg_true_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.avg_true_range"} */
drop view if exists "DEV"."ANALYTICS"."AVG_TRUE_RANGE" cascade
[0m21:16:33.753846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:34.395633 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.641 seconds
[0m21:16:34.405955 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.avg_true_range"
[0m21:16:34.406958 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.avg_true_range"
[0m21:16:34.407876 [debug] [Thread-1 (]: On model.stock_dbt.avg_true_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.avg_true_range"} */
create or replace transient table dev.analytics.avg_true_range
         as
        (WITH averageTrueRanges AS (
    SELECT
        date,
        symbol,
        close,
        ABS(close - LAG(close) OVER (PARTITION BY symbol ORDER BY date)) AS true_range
    FROM dev.analytics.stock_prices
),
atr AS (
    SELECT
        date,
        symbol,
        AVG(true_range) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS atr_14d
    FROM averageTrueRanges
)
SELECT 
    date, 
    symbol, 
    COALESCE(atr_14d, 0) AS atr_14d
FROM atr
ORDER BY date, symbol
        );
[0m21:16:35.707937 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.300 seconds
[0m21:16:35.710183 [debug] [Thread-1 (]: On model.stock_dbt.avg_true_range: Close
[0m21:16:35.867378 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56958e81-faae-4da4-9f3c-0233e2da18a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A3E13D640>]}
[0m21:16:35.867378 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.avg_true_range ..................... [[32mSUCCESS 1[0m in 2.13s]
[0m21:16:35.868378 [debug] [Thread-1 (]: Finished running node model.stock_dbt.avg_true_range
[0m21:16:35.869402 [debug] [Thread-1 (]: Began running node model.stock_dbt.bollinger
[0m21:16:35.869720 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.bollinger ............................... [RUN]
[0m21:16:35.870206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.avg_true_range, now model.stock_dbt.bollinger)
[0m21:16:35.870206 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.bollinger
[0m21:16:35.872301 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.bollinger"
[0m21:16:35.872301 [debug] [Thread-1 (]: Began executing node model.stock_dbt.bollinger
[0m21:16:35.873659 [debug] [Thread-1 (]: Dropping relation "DEV"."ANALYTICS"."BOLLINGER" because it is of type view
[0m21:16:35.874764 [debug] [Thread-1 (]: Applying DROP to: "DEV"."ANALYTICS"."BOLLINGER"
[0m21:16:35.874764 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.bollinger"
[0m21:16:35.875765 [debug] [Thread-1 (]: On model.stock_dbt.bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.bollinger"} */
drop view if exists "DEV"."ANALYTICS"."BOLLINGER" cascade
[0m21:16:35.875765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:36.484137 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.609 seconds
[0m21:16:36.485136 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.bollinger"
[0m21:16:36.486136 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.bollinger"
[0m21:16:36.487139 [debug] [Thread-1 (]: On model.stock_dbt.bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.bollinger"} */
create or replace transient table dev.analytics.bollinger
         as
        (WITH bollinger AS (
    SELECT
        symbol,
        date,
        close,
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) AS sma_20d,
        STDDEV(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) AS stddev_20d
    FROM dev.analytics.stock_prices
)

SELECT
    symbol,
    date,
    close,
    COALESCE(sma_20d, 0) AS sma_20d,
    COALESCE(sma_20d + (2 * stddev_20d), 0) AS upper_band,
    COALESCE(sma_20d - (2 * stddev_20d), 0) AS lower_band
FROM bollinger
ORDER BY symbol, date
        );
[0m21:16:37.229707 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.743 seconds
[0m21:16:37.233712 [debug] [Thread-1 (]: On model.stock_dbt.bollinger: Close
[0m21:16:37.344008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56958e81-faae-4da4-9f3c-0233e2da18a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A3E2608C0>]}
[0m21:16:37.344910 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.bollinger .......................... [[32mSUCCESS 1[0m in 1.47s]
[0m21:16:37.346837 [debug] [Thread-1 (]: Finished running node model.stock_dbt.bollinger
[0m21:16:37.346837 [debug] [Thread-1 (]: Began running node model.stock_dbt.moving_average
[0m21:16:37.347829 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.moving_average .......................... [RUN]
[0m21:16:37.348833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.bollinger, now model.stock_dbt.moving_average)
[0m21:16:37.348833 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.moving_average
[0m21:16:37.351050 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.moving_average"
[0m21:16:37.362352 [debug] [Thread-1 (]: Began executing node model.stock_dbt.moving_average
[0m21:16:37.365443 [debug] [Thread-1 (]: Dropping relation "DEV"."ANALYTICS"."MOVING_AVERAGE" because it is of type view
[0m21:16:37.366446 [debug] [Thread-1 (]: Applying DROP to: "DEV"."ANALYTICS"."MOVING_AVERAGE"
[0m21:16:37.367443 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.moving_average"
[0m21:16:37.367443 [debug] [Thread-1 (]: On model.stock_dbt.moving_average: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.moving_average"} */
drop view if exists "DEV"."ANALYTICS"."MOVING_AVERAGE" cascade
[0m21:16:37.367443 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:38.056390 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.688 seconds
[0m21:16:38.059037 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.moving_average"
[0m21:16:38.072405 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.moving_average"
[0m21:16:38.072405 [debug] [Thread-1 (]: On model.stock_dbt.moving_average: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.moving_average"} */
create or replace transient table dev.analytics.moving_average
         as
        (WITH stock_data AS (
    SELECT
        symbol,
        date,
        close
    FROM dev.analytics.stock_prices -- assuming 'stock_prices' is the name of the raw table model in dbt
)

SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
    ) AS moving_avg_5d,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
    ) AS moving_avg_20d
FROM stock_data
ORDER BY symbol, date
        );
[0m21:16:38.967671 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.894 seconds
[0m21:16:38.970034 [debug] [Thread-1 (]: On model.stock_dbt.moving_average: Close
[0m21:16:39.109906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56958e81-faae-4da4-9f3c-0233e2da18a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A3E282600>]}
[0m21:16:39.110902 [info ] [Thread-1 (]: 4 of 5 OK created sql table model analytics.moving_average ..................... [[32mSUCCESS 1[0m in 1.76s]
[0m21:16:39.112903 [debug] [Thread-1 (]: Finished running node model.stock_dbt.moving_average
[0m21:16:39.112903 [debug] [Thread-1 (]: Began running node model.stock_dbt.rsi_calculation
[0m21:16:39.113896 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.rsi_calculation ......................... [RUN]
[0m21:16:39.113896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.moving_average, now model.stock_dbt.rsi_calculation)
[0m21:16:39.114897 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.rsi_calculation
[0m21:16:39.115901 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.rsi_calculation"
[0m21:16:39.116903 [debug] [Thread-1 (]: Began executing node model.stock_dbt.rsi_calculation
[0m21:16:39.117903 [debug] [Thread-1 (]: Dropping relation "DEV"."ANALYTICS"."RSI_CALCULATION" because it is of type view
[0m21:16:39.119124 [debug] [Thread-1 (]: Applying DROP to: "DEV"."ANALYTICS"."RSI_CALCULATION"
[0m21:16:39.120123 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.rsi_calculation"
[0m21:16:39.120123 [debug] [Thread-1 (]: On model.stock_dbt.rsi_calculation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.rsi_calculation"} */
drop view if exists "DEV"."ANALYTICS"."RSI_CALCULATION" cascade
[0m21:16:39.120123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:39.709434 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.589 seconds
[0m21:16:39.712500 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.rsi_calculation"
[0m21:16:39.714494 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.rsi_calculation"
[0m21:16:39.714494 [debug] [Thread-1 (]: On model.stock_dbt.rsi_calculation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.rsi_calculation"} */
create or replace transient table dev.analytics.rsi_calculation
         as
        (WITH stock_data AS (
    SELECT
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM dev.analytics.stock_prices
),

price_changes AS (
    SELECT
        symbol,
        date,
        close,
        CASE 
            WHEN close > prev_close THEN close - prev_close
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close < prev_close THEN prev_close - close
            ELSE 0 
        END AS loss
    FROM stock_data
),

average_gains_losses AS (
    SELECT
        symbol,
        date,
        close,
        -- Calculate the average gain over the last 14 days, including the current row
        AVG(gain) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain,
        -- Calculate the average loss over the last 14 days, including the current row
        AVG(loss) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss
    FROM price_changes
)

SELECT
    symbol,
    date,
    close,
    avg_gain,
    avg_loss,
    -- Calculate RSI, using COALESCE to set to 0 if result is NULL
    COALESCE(100 - (100 / (1 + (NULLIF(avg_gain, 0) / NULLIF(avg_loss, 0)))), 0) AS rsi_14d
FROM average_gains_losses
ORDER BY symbol, date
        );
[0m21:16:40.515085 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.800 seconds
[0m21:16:40.517305 [debug] [Thread-1 (]: On model.stock_dbt.rsi_calculation: Close
[0m21:16:40.625064 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56958e81-faae-4da4-9f3c-0233e2da18a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A3DA80BF0>]}
[0m21:16:40.625064 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.rsi_calculation .................... [[32mSUCCESS 1[0m in 1.51s]
[0m21:16:40.626075 [debug] [Thread-1 (]: Finished running node model.stock_dbt.rsi_calculation
[0m21:16:40.627066 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:16:40.627066 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m21:16:40.628075 [debug] [MainThread]: Connection 'list_dev_analytics' was properly closed.
[0m21:16:40.628075 [debug] [MainThread]: Connection 'model.stock_dbt.rsi_calculation' was properly closed.
[0m21:16:40.628075 [info ] [MainThread]: 
[0m21:16:40.628677 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 10.41 seconds (10.41s).
[0m21:16:40.628677 [debug] [MainThread]: Command end result
[0m21:16:40.646237 [info ] [MainThread]: 
[0m21:16:40.646237 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:16:40.646237 [info ] [MainThread]: 
[0m21:16:40.646237 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m21:16:40.647235 [debug] [MainThread]: Command `dbt run` succeeded at 21:16:40.647235 after 12.24 seconds
[0m21:16:40.647235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A0AAF8A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A0A7B02C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A0B371D00>]}
[0m21:16:40.647235 [debug] [MainThread]: Flushing usage events
[0m05:17:32.218566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01a1447b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01a3ef2300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01a188b350>]}


============================== 05:17:32.225388 | 98254d08-0f09-446e-8419-88b309e6f622 ==============================
[0m05:17:32.225388 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:17:32.227327 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/stock_dbt/logs', 'profiles_dir': '/opt/airflow/stock_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/stock_dbt --project-dir /opt/airflow/stock_dbt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:17:32.587692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6946f5f740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6946f5dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6947ca3b30>]}


============================== 05:17:32.593097 | 4892b23e-bada-4c91-b66c-e9332526334f ==============================
[0m05:17:32.593097 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:17:32.594865 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/stock_dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/stock_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/stock_dbt --project-dir /opt/airflow/stock_dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:17:32.917210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98254d08-0f09-446e-8419-88b309e6f622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f014b3499a0>]}
[0m05:17:32.953168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98254d08-0f09-446e-8419-88b309e6f622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0143c77290>]}
[0m05:17:32.956072 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:17:32.966265 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:17:33.061878 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m05:17:33.064259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '98254d08-0f09-446e-8419-88b309e6f622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f014393ee40>]}
[0m05:17:33.250065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4892b23e-bada-4c91-b66c-e9332526334f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6947c36de0>]}
[0m05:17:33.285170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4892b23e-bada-4c91-b66c-e9332526334f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68ed94bc20>]}
[0m05:17:33.287126 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:17:33.296704 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:17:33.386887 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m05:17:33.390092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4892b23e-bada-4c91-b66c-e9332526334f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6947864860>]}
[0m05:17:34.033082 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m05:17:34.035648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '98254d08-0f09-446e-8419-88b309e6f622', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01401a8080>]}
[0m05:17:34.305028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98254d08-0f09-446e-8419-88b309e6f622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01438fa9c0>]}
[0m05:17:34.363952 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m05:17:34.365312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4892b23e-bada-4c91-b66c-e9332526334f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68ed5e3830>]}
[0m05:17:34.435446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98254d08-0f09-446e-8419-88b309e6f622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01a297cdd0>]}
[0m05:17:34.437857 [info ] [MainThread]: Found 5 models, 4 snapshots, 27 data tests, 1 source, 459 macros
[0m05:17:34.439483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98254d08-0f09-446e-8419-88b309e6f622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f014396b650>]}
[0m05:17:34.442542 [info ] [MainThread]: 
[0m05:17:34.444411 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:17:34.449734 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m05:17:34.461298 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m05:17:34.463639 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m05:17:34.465590 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:17:34.632701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4892b23e-bada-4c91-b66c-e9332526334f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68dd3677a0>]}
[0m05:17:34.742948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4892b23e-bada-4c91-b66c-e9332526334f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68ed3acbf0>]}
[0m05:17:34.744347 [info ] [MainThread]: Found 5 models, 4 snapshots, 27 data tests, 1 source, 459 macros
[0m05:17:34.745648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4892b23e-bada-4c91-b66c-e9332526334f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68eef36d20>]}
[0m05:17:34.747808 [info ] [MainThread]: 
[0m05:17:34.748914 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:17:34.752445 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m05:17:34.762417 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m05:17:34.763603 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m05:17:34.764650 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:17:35.075447 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.610 seconds
[0m05:17:35.080523 [debug] [ThreadPool]: On list_dev: Close
[0m05:17:35.210736 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m05:17:35.218661 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m05:17:35.220493 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m05:17:35.221730 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:17:35.232712 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.468 seconds
[0m05:17:35.235159 [debug] [ThreadPool]: On list_dev: Close
[0m05:17:35.364779 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_snapshot)
[0m05:17:35.372853 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m05:17:35.374463 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m05:17:35.375657 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:17:35.632320 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.410 seconds
[0m05:17:35.637315 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m05:17:35.759890 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m05:17:35.762678 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m05:17:35.763492 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m05:17:35.764236 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:17:35.813024 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.437 seconds
[0m05:17:35.816058 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m05:17:35.936646 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m05:17:35.940421 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m05:17:35.942316 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m05:17:35.944031 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:17:36.139381 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.375 seconds
[0m05:17:36.143580 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m05:17:36.257117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98254d08-0f09-446e-8419-88b309e6f622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0143ba4110>]}
[0m05:17:36.258449 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:17:36.259752 [info ] [MainThread]: 
[0m05:17:36.266044 [debug] [Thread-1 (]: Began running node model.stock_dbt.stock_prices
[0m05:17:36.267370 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stock_prices ............................. [RUN]
[0m05:17:36.268373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now model.stock_dbt.stock_prices)
[0m05:17:36.269081 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.stock_prices
[0m05:17:36.274932 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.stock_prices"
[0m05:17:36.282463 [debug] [Thread-1 (]: Began executing node model.stock_dbt.stock_prices
[0m05:17:36.303561 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.stock_prices"
[0m05:17:36.313351 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.stock_prices"
[0m05:17:36.314186 [debug] [Thread-1 (]: On model.stock_dbt.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.stock_prices"} */
create or replace   view dev.analytics.stock_prices
  
   as (
    SELECT
    symbol,
    date,
    open,
    high,
    low,
    close,
    volume
FROM dev.raw_data.stock_prices
  );
[0m05:17:36.314964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:36.369922 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.426 seconds
[0m05:17:36.372058 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m05:17:36.511470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4892b23e-bada-4c91-b66c-e9332526334f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6948600dd0>]}
[0m05:17:36.513000 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:17:36.514148 [info ] [MainThread]: 
[0m05:17:36.521548 [debug] [Thread-1 (]: Began running node model.stock_dbt.stock_prices
[0m05:17:36.523327 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stock_prices ............................. [RUN]
[0m05:17:36.524821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.stock_dbt.stock_prices)
[0m05:17:36.525966 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.stock_prices
[0m05:17:36.531570 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.stock_prices"
[0m05:17:36.547972 [debug] [Thread-1 (]: Began executing node model.stock_dbt.stock_prices
[0m05:17:36.569514 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.stock_prices"
[0m05:17:36.578529 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.stock_prices"
[0m05:17:36.579491 [debug] [Thread-1 (]: On model.stock_dbt.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.stock_prices"} */
create or replace   view dev.analytics.stock_prices
  
   as (
    SELECT
    symbol,
    date,
    open,
    high,
    low,
    close,
    volume
FROM dev.raw_data.stock_prices
  );
[0m05:17:36.580454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:36.911596 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.596 seconds
[0m05:17:36.935968 [debug] [Thread-1 (]: On model.stock_dbt.stock_prices: Close
[0m05:17:37.046240 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98254d08-0f09-446e-8419-88b309e6f622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0143c47fb0>]}
[0m05:17:37.048974 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stock_prices ........................ [[32mSUCCESS 1[0m in 0.78s]
[0m05:17:37.050779 [debug] [Thread-1 (]: Finished running node model.stock_dbt.stock_prices
[0m05:17:37.052630 [debug] [Thread-1 (]: Began running node model.stock_dbt.avg_true_range
[0m05:17:37.053746 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.avg_true_range .......................... [RUN]
[0m05:17:37.055156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.stock_prices, now model.stock_dbt.avg_true_range)
[0m05:17:37.056375 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.avg_true_range
[0m05:17:37.058870 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.avg_true_range"
[0m05:17:37.068369 [debug] [Thread-1 (]: Began executing node model.stock_dbt.avg_true_range
[0m05:17:37.085726 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.avg_true_range"
[0m05:17:37.100185 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.avg_true_range"
[0m05:17:37.101185 [debug] [Thread-1 (]: On model.stock_dbt.avg_true_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.avg_true_range"} */
create or replace transient table dev.analytics.avg_true_range
         as
        (WITH averageTrueRanges AS (
    SELECT
        date,
        symbol,
        close,
        ABS(close - LAG(close) OVER (PARTITION BY symbol ORDER BY date)) AS true_range
    FROM dev.analytics.stock_prices
),
atr AS (
    SELECT
        date,
        symbol,
        AVG(true_range) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS atr_14d
    FROM averageTrueRanges
)
SELECT 
    date, 
    symbol, 
    COALESCE(atr_14d, 0) AS atr_14d
FROM atr
ORDER BY date, symbol
        );
[0m05:17:37.101996 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:37.116144 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.536 seconds
[0m05:17:37.133665 [debug] [Thread-1 (]: On model.stock_dbt.stock_prices: Close
[0m05:17:37.232957 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4892b23e-bada-4c91-b66c-e9332526334f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68ed86ccb0>]}
[0m05:17:37.235461 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stock_prices ........................ [[32mSUCCESS 1[0m in 0.71s]
[0m05:17:37.237560 [debug] [Thread-1 (]: Finished running node model.stock_dbt.stock_prices
[0m05:17:37.239813 [debug] [Thread-1 (]: Began running node model.stock_dbt.avg_true_range
[0m05:17:37.241866 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.avg_true_range .......................... [RUN]
[0m05:17:37.244173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.stock_prices, now model.stock_dbt.avg_true_range)
[0m05:17:37.245573 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.avg_true_range
[0m05:17:37.248574 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.avg_true_range"
[0m05:17:37.264927 [debug] [Thread-1 (]: Began executing node model.stock_dbt.avg_true_range
[0m05:17:37.282183 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.avg_true_range"
[0m05:17:37.294384 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.avg_true_range"
[0m05:17:37.295388 [debug] [Thread-1 (]: On model.stock_dbt.avg_true_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.avg_true_range"} */
create or replace transient table dev.analytics.avg_true_range
         as
        (WITH averageTrueRanges AS (
    SELECT
        date,
        symbol,
        close,
        ABS(close - LAG(close) OVER (PARTITION BY symbol ORDER BY date)) AS true_range
    FROM dev.analytics.stock_prices
),
atr AS (
    SELECT
        date,
        symbol,
        AVG(true_range) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS atr_14d
    FROM averageTrueRanges
)
SELECT 
    date, 
    symbol, 
    COALESCE(atr_14d, 0) AS atr_14d
FROM atr
ORDER BY date, symbol
        );
[0m05:17:37.296541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:38.098388 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.996 seconds
[0m05:17:38.103256 [debug] [Thread-1 (]: On model.stock_dbt.avg_true_range: Close
[0m05:17:38.215770 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.919 seconds
[0m05:17:38.221794 [debug] [Thread-1 (]: On model.stock_dbt.avg_true_range: Close
[0m05:17:38.231281 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98254d08-0f09-446e-8419-88b309e6f622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00dae108f0>]}
[0m05:17:38.232928 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.avg_true_range ..................... [[32mSUCCESS 1[0m in 1.18s]
[0m05:17:38.234385 [debug] [Thread-1 (]: Finished running node model.stock_dbt.avg_true_range
[0m05:17:38.235350 [debug] [Thread-1 (]: Began running node model.stock_dbt.bollinger
[0m05:17:38.236520 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.bollinger ............................... [RUN]
[0m05:17:38.237796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.avg_true_range, now model.stock_dbt.bollinger)
[0m05:17:38.238734 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.bollinger
[0m05:17:38.241390 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.bollinger"
[0m05:17:38.247905 [debug] [Thread-1 (]: Began executing node model.stock_dbt.bollinger
[0m05:17:38.250207 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.bollinger"
[0m05:17:38.258224 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.bollinger"
[0m05:17:38.259422 [debug] [Thread-1 (]: On model.stock_dbt.bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.bollinger"} */
create or replace transient table dev.analytics.bollinger
         as
        (WITH bollinger AS (
    SELECT
        symbol,
        date,
        close,
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) AS sma_20d,
        STDDEV(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) AS stddev_20d
    FROM dev.analytics.stock_prices
)

SELECT
    symbol,
    date,
    close,
    COALESCE(sma_20d, 0) AS sma_20d,
    COALESCE(sma_20d + (2 * stddev_20d), 0) AS upper_band,
    COALESCE(sma_20d - (2 * stddev_20d), 0) AS lower_band
FROM bollinger
ORDER BY symbol, date
        );
[0m05:17:38.261887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:38.339648 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4892b23e-bada-4c91-b66c-e9332526334f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68dc92da90>]}
[0m05:17:38.342081 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.avg_true_range ..................... [[32mSUCCESS 1[0m in 1.10s]
[0m05:17:38.344569 [debug] [Thread-1 (]: Finished running node model.stock_dbt.avg_true_range
[0m05:17:38.346878 [debug] [Thread-1 (]: Began running node model.stock_dbt.bollinger
[0m05:17:38.348189 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.bollinger ............................... [RUN]
[0m05:17:38.349804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.avg_true_range, now model.stock_dbt.bollinger)
[0m05:17:38.351298 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.bollinger
[0m05:17:38.354429 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.bollinger"
[0m05:17:38.365268 [debug] [Thread-1 (]: Began executing node model.stock_dbt.bollinger
[0m05:17:38.367700 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.bollinger"
[0m05:17:38.377013 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.bollinger"
[0m05:17:38.378170 [debug] [Thread-1 (]: On model.stock_dbt.bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.bollinger"} */
create or replace transient table dev.analytics.bollinger
         as
        (WITH bollinger AS (
    SELECT
        symbol,
        date,
        close,
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) AS sma_20d,
        STDDEV(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) AS stddev_20d
    FROM dev.analytics.stock_prices
)

SELECT
    symbol,
    date,
    close,
    COALESCE(sma_20d, 0) AS sma_20d,
    COALESCE(sma_20d + (2 * stddev_20d), 0) AS upper_band,
    COALESCE(sma_20d - (2 * stddev_20d), 0) AS lower_band
FROM bollinger
ORDER BY symbol, date
        );
[0m05:17:38.378970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:39.171788 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.910 seconds
[0m05:17:39.175204 [debug] [Thread-1 (]: On model.stock_dbt.bollinger: Close
[0m05:17:39.297330 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98254d08-0f09-446e-8419-88b309e6f622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00daf0ee10>]}
[0m05:17:39.299747 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.bollinger .......................... [[32mSUCCESS 1[0m in 1.06s]
[0m05:17:39.301868 [debug] [Thread-1 (]: Finished running node model.stock_dbt.bollinger
[0m05:17:39.303904 [debug] [Thread-1 (]: Began running node model.stock_dbt.moving_average
[0m05:17:39.305309 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.moving_average .......................... [RUN]
[0m05:17:39.306718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.bollinger, now model.stock_dbt.moving_average)
[0m05:17:39.307870 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.moving_average
[0m05:17:39.310583 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.moving_average"
[0m05:17:39.318782 [debug] [Thread-1 (]: Began executing node model.stock_dbt.moving_average
[0m05:17:39.321304 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.moving_average"
[0m05:17:39.329317 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.moving_average"
[0m05:17:39.330778 [debug] [Thread-1 (]: On model.stock_dbt.moving_average: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.moving_average"} */
create or replace transient table dev.analytics.moving_average
         as
        (WITH stock_data AS (
    SELECT
        symbol,
        date,
        close
    FROM dev.analytics.stock_prices -- assuming 'stock_prices' is the name of the raw table model in dbt
)

SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
    ) AS moving_avg_5d,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
    ) AS moving_avg_20d
FROM stock_data
ORDER BY symbol, date
        );
[0m05:17:39.332080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:39.427604 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.048 seconds
[0m05:17:39.431744 [debug] [Thread-1 (]: On model.stock_dbt.bollinger: Close
[0m05:17:39.541335 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4892b23e-bada-4c91-b66c-e9332526334f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68dc9014f0>]}
[0m05:17:39.542954 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.bollinger .......................... [[32mSUCCESS 1[0m in 1.19s]
[0m05:17:39.544205 [debug] [Thread-1 (]: Finished running node model.stock_dbt.bollinger
[0m05:17:39.545137 [debug] [Thread-1 (]: Began running node model.stock_dbt.moving_average
[0m05:17:39.546171 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.moving_average .......................... [RUN]
[0m05:17:39.547111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.bollinger, now model.stock_dbt.moving_average)
[0m05:17:39.548324 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.moving_average
[0m05:17:39.551353 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.moving_average"
[0m05:17:39.558689 [debug] [Thread-1 (]: Began executing node model.stock_dbt.moving_average
[0m05:17:39.561187 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.moving_average"
[0m05:17:39.571923 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.moving_average"
[0m05:17:39.572963 [debug] [Thread-1 (]: On model.stock_dbt.moving_average: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.moving_average"} */
create or replace transient table dev.analytics.moving_average
         as
        (WITH stock_data AS (
    SELECT
        symbol,
        date,
        close
    FROM dev.analytics.stock_prices -- assuming 'stock_prices' is the name of the raw table model in dbt
)

SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
    ) AS moving_avg_5d,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
    ) AS moving_avg_20d
FROM stock_data
ORDER BY symbol, date
        );
[0m05:17:39.574023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:40.562726 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.988 seconds
[0m05:17:40.568436 [debug] [Thread-1 (]: On model.stock_dbt.moving_average: Close
[0m05:17:40.569865 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.238 seconds
[0m05:17:40.572174 [debug] [Thread-1 (]: On model.stock_dbt.moving_average: Close
[0m05:17:40.702306 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98254d08-0f09-446e-8419-88b309e6f622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01401bc260>]}
[0m05:17:40.703071 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4892b23e-bada-4c91-b66c-e9332526334f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68dc9002f0>]}
[0m05:17:40.705190 [info ] [Thread-1 (]: 4 of 5 OK created sql table model analytics.moving_average ..................... [[32mSUCCESS 1[0m in 1.39s]
[0m05:17:40.705684 [info ] [Thread-1 (]: 4 of 5 OK created sql table model analytics.moving_average ..................... [[32mSUCCESS 1[0m in 1.16s]
[0m05:17:40.707231 [debug] [Thread-1 (]: Finished running node model.stock_dbt.moving_average
[0m05:17:40.707748 [debug] [Thread-1 (]: Finished running node model.stock_dbt.moving_average
[0m05:17:40.708438 [debug] [Thread-1 (]: Began running node model.stock_dbt.rsi_calculation
[0m05:17:40.709270 [debug] [Thread-1 (]: Began running node model.stock_dbt.rsi_calculation
[0m05:17:40.709828 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.rsi_calculation ......................... [RUN]
[0m05:17:40.710688 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.rsi_calculation ......................... [RUN]
[0m05:17:40.710993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.moving_average, now model.stock_dbt.rsi_calculation)
[0m05:17:40.712137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.moving_average, now model.stock_dbt.rsi_calculation)
[0m05:17:40.713310 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.rsi_calculation
[0m05:17:40.712763 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.rsi_calculation
[0m05:17:40.716169 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.rsi_calculation"
[0m05:17:40.716499 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.rsi_calculation"
[0m05:17:40.723367 [debug] [Thread-1 (]: Began executing node model.stock_dbt.rsi_calculation
[0m05:17:40.724552 [debug] [Thread-1 (]: Began executing node model.stock_dbt.rsi_calculation
[0m05:17:40.726063 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.rsi_calculation"
[0m05:17:40.726997 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.rsi_calculation"
[0m05:17:40.731737 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.rsi_calculation"
[0m05:17:40.732567 [debug] [Thread-1 (]: On model.stock_dbt.rsi_calculation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.rsi_calculation"} */
create or replace transient table dev.analytics.rsi_calculation
         as
        (WITH stock_data AS (
    SELECT
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM dev.analytics.stock_prices
),

price_changes AS (
    SELECT
        symbol,
        date,
        close,
        CASE 
            WHEN close > prev_close THEN close - prev_close
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close < prev_close THEN prev_close - close
            ELSE 0 
        END AS loss
    FROM stock_data
),

average_gains_losses AS (
    SELECT
        symbol,
        date,
        close,
        -- Calculate the average gain over the last 14 days, including the current row
        AVG(gain) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain,
        -- Calculate the average loss over the last 14 days, including the current row
        AVG(loss) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss
    FROM price_changes
)

SELECT
    symbol,
    date,
    close,
    avg_gain,
    avg_loss,
    -- Calculate RSI, using COALESCE to set to 0 if result is NULL
    COALESCE(100 - (100 / (1 + (NULLIF(avg_gain, 0) / NULLIF(avg_loss, 0)))), 0) AS rsi_14d
FROM average_gains_losses
ORDER BY symbol, date
        );
[0m05:17:40.732413 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.rsi_calculation"
[0m05:17:40.733719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:40.733752 [debug] [Thread-1 (]: On model.stock_dbt.rsi_calculation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.rsi_calculation"} */
create or replace transient table dev.analytics.rsi_calculation
         as
        (WITH stock_data AS (
    SELECT
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM dev.analytics.stock_prices
),

price_changes AS (
    SELECT
        symbol,
        date,
        close,
        CASE 
            WHEN close > prev_close THEN close - prev_close
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close < prev_close THEN prev_close - close
            ELSE 0 
        END AS loss
    FROM stock_data
),

average_gains_losses AS (
    SELECT
        symbol,
        date,
        close,
        -- Calculate the average gain over the last 14 days, including the current row
        AVG(gain) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain,
        -- Calculate the average loss over the last 14 days, including the current row
        AVG(loss) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss
    FROM price_changes
)

SELECT
    symbol,
    date,
    close,
    avg_gain,
    avg_loss,
    -- Calculate RSI, using COALESCE to set to 0 if result is NULL
    COALESCE(100 - (100 / (1 + (NULLIF(avg_gain, 0) / NULLIF(avg_loss, 0)))), 0) AS rsi_14d
FROM average_gains_losses
ORDER BY symbol, date
        );
[0m05:17:40.735034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:41.791089 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.056 seconds
[0m05:17:41.793975 [debug] [Thread-1 (]: On model.stock_dbt.rsi_calculation: Close
[0m05:17:41.803075 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.069 seconds
[0m05:17:41.805416 [debug] [Thread-1 (]: On model.stock_dbt.rsi_calculation: Close
[0m05:17:41.915584 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98254d08-0f09-446e-8419-88b309e6f622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00dae41fa0>]}
[0m05:17:41.918275 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.rsi_calculation .................... [[32mSUCCESS 1[0m in 1.20s]
[0m05:17:41.920569 [debug] [Thread-1 (]: Finished running node model.stock_dbt.rsi_calculation
[0m05:17:41.922327 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:17:41.923200 [debug] [MainThread]: Connection 'model.stock_dbt.rsi_calculation' was properly closed.
[0m05:17:41.924549 [info ] [MainThread]: 
[0m05:17:41.925649 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 7.48 seconds (7.48s).
[0m05:17:41.927616 [debug] [MainThread]: Command end result
[0m05:17:41.930360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4892b23e-bada-4c91-b66c-e9332526334f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68dc800530>]}
[0m05:17:41.931691 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.rsi_calculation .................... [[32mSUCCESS 1[0m in 1.22s]
[0m05:17:41.934020 [debug] [Thread-1 (]: Finished running node model.stock_dbt.rsi_calculation
[0m05:17:41.936252 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:17:41.937148 [debug] [MainThread]: Connection 'model.stock_dbt.rsi_calculation' was properly closed.
[0m05:17:41.937845 [info ] [MainThread]: 
[0m05:17:41.940257 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 7.19 seconds (7.19s).
[0m05:17:41.942387 [debug] [MainThread]: Command end result
[0m05:17:41.976951 [info ] [MainThread]: 
[0m05:17:41.978368 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:17:41.980024 [info ] [MainThread]: 
[0m05:17:41.981591 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m05:17:41.983659 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.84679, "process_user_time": 3.811738, "process_kernel_time": 3.077184, "process_mem_max_rss": "263952", "process_in_blocks": "43616", "process_out_blocks": "8"}
[0m05:17:41.985676 [debug] [MainThread]: Command `dbt run` succeeded at 05:17:41.985587 after 9.85 seconds
[0m05:17:41.988203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01a1e8f440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01439b78c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01a175baa0>]}
[0m05:17:41.990164 [debug] [MainThread]: Flushing usage events
[0m05:17:41.997277 [info ] [MainThread]: 
[0m05:17:41.998575 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:17:42.000100 [info ] [MainThread]: 
[0m05:17:42.001806 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m05:17:42.003743 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.502373, "process_user_time": 3.902392, "process_kernel_time": 2.973423, "process_mem_max_rss": "257988", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m05:17:42.005331 [debug] [MainThread]: Command `dbt run` succeeded at 05:17:42.005259 after 9.50 seconds
[0m05:17:42.006708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f694744ecc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69468f5c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68ed8ffc20>]}
[0m05:17:42.007950 [debug] [MainThread]: Flushing usage events
[0m05:17:44.107565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78ad918260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78acfc3c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78afac97c0>]}


============================== 05:17:44.112433 | 9bee2524-d6d6-4340-a423-b9b48f864a75 ==============================
[0m05:17:44.112433 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:17:44.114786 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/stock_dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/stock_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/stock_dbt --project-dir /opt/airflow/stock_dbt', 'send_anonymous_usage_stats': 'True'}
[0m05:17:44.710672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9bee2524-d6d6-4340-a423-b9b48f864a75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78ad32acc0>]}
[0m05:17:44.746421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9bee2524-d6d6-4340-a423-b9b48f864a75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f784fb14770>]}
[0m05:17:44.748667 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:17:44.758232 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:17:45.058725 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:17:45.060195 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:17:45.096226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9bee2524-d6d6-4340-a423-b9b48f864a75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f784f7b58b0>]}
[0m05:17:45.227378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9bee2524-d6d6-4340-a423-b9b48f864a75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f784f226900>]}
[0m05:17:45.228698 [info ] [MainThread]: Found 5 models, 4 snapshots, 27 data tests, 1 source, 459 macros
[0m05:17:45.230280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bee2524-d6d6-4340-a423-b9b48f864a75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f784f76a330>]}
[0m05:17:45.233387 [info ] [MainThread]: 
[0m05:17:45.235143 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:17:45.239782 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_analytics'
[0m05:17:45.254422 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m05:17:45.255707 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m05:17:45.257389 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:17:45.277462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e439090a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e450d5eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e43078890>]}


============================== 05:17:45.282813 | f53e9aca-7898-4961-857c-901b17d06abf ==============================
[0m05:17:45.282813 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:17:45.284109 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/stock_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/stock_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/stock_dbt --project-dir /opt/airflow/stock_dbt', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:17:45.800203 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.543 seconds
[0m05:17:45.803010 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m05:17:45.927637 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m05:17:45.929824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f53e9aca-7898-4961-857c-901b17d06abf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3de92eb710>]}
[0m05:17:45.930621 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m05:17:45.931794 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m05:17:45.932631 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:17:45.968721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f53e9aca-7898-4961-857c-901b17d06abf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e425cf1d0>]}
[0m05:17:45.970615 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:17:45.980525 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:17:46.266969 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:17:46.268433 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:17:46.305380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f53e9aca-7898-4961-857c-901b17d06abf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3de90eede0>]}
[0m05:17:46.338795 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.406 seconds
[0m05:17:46.341575 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m05:17:46.416742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f53e9aca-7898-4961-857c-901b17d06abf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3de8b9f1a0>]}
[0m05:17:46.418050 [info ] [MainThread]: Found 5 models, 4 snapshots, 27 data tests, 1 source, 459 macros
[0m05:17:46.418949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f53e9aca-7898-4961-857c-901b17d06abf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3de8e17230>]}
[0m05:17:46.422127 [info ] [MainThread]: 
[0m05:17:46.423044 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:17:46.426853 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_analytics'
[0m05:17:46.439327 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m05:17:46.441078 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m05:17:46.442363 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:17:46.469998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bee2524-d6d6-4340-a423-b9b48f864a75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f784f938590>]}
[0m05:17:46.471691 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:17:46.472625 [info ] [MainThread]: 
[0m05:17:46.479514 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m05:17:46.480574 [info ] [Thread-1 (]: 1 of 27 START test not_null_avg_true_range_atr_14d ............................. [RUN]
[0m05:17:46.482206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad)
[0m05:17:46.483496 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m05:17:46.495698 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad"
[0m05:17:46.510762 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m05:17:46.525617 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad"
[0m05:17:46.549862 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad"
[0m05:17:46.550981 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select atr_14d
from dev.analytics.avg_true_range
where atr_14d is null



      
    ) dbt_internal_test
[0m05:17:46.552491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:46.900558 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.458 seconds
[0m05:17:46.904841 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m05:17:46.995074 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.443 seconds
[0m05:17:47.002413 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad: Close
[0m05:17:47.032687 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m05:17:47.037373 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m05:17:47.039182 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m05:17:47.040636 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:17:47.122224 [info ] [Thread-1 (]: 1 of 27 PASS not_null_avg_true_range_atr_14d ................................... [[32mPASS[0m in 0.64s]
[0m05:17:47.125864 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m05:17:47.128094 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_avg_true_range_date.4e418b835d
[0m05:17:47.129764 [info ] [Thread-1 (]: 2 of 27 START test not_null_avg_true_range_date ................................ [RUN]
[0m05:17:47.130912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad, now test.stock_dbt.not_null_avg_true_range_date.4e418b835d)
[0m05:17:47.131814 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_avg_true_range_date.4e418b835d
[0m05:17:47.135500 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_avg_true_range_date.4e418b835d"
[0m05:17:47.145639 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_avg_true_range_date.4e418b835d
[0m05:17:47.148071 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_avg_true_range_date.4e418b835d"
[0m05:17:47.157142 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_avg_true_range_date.4e418b835d"
[0m05:17:47.158215 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_date.4e418b835d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_avg_true_range_date.4e418b835d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.avg_true_range
where date is null



      
    ) dbt_internal_test
[0m05:17:47.159064 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:47.518323 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.478 seconds
[0m05:17:47.520771 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m05:17:47.642942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f53e9aca-7898-4961-857c-901b17d06abf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e43f84cb0>]}
[0m05:17:47.648363 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:17:47.650800 [info ] [MainThread]: 
[0m05:17:47.660511 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m05:17:47.662372 [info ] [Thread-1 (]: 1 of 27 START test not_null_avg_true_range_atr_14d ............................. [RUN]
[0m05:17:47.663986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad)
[0m05:17:47.665844 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m05:17:47.677695 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad"
[0m05:17:47.687508 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m05:17:47.703949 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad"
[0m05:17:47.710390 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad"
[0m05:17:47.712442 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select atr_14d
from dev.analytics.avg_true_range
where atr_14d is null



      
    ) dbt_internal_test
[0m05:17:47.713806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:47.743344 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.584 seconds
[0m05:17:47.747023 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_date.4e418b835d: Close
[0m05:17:47.871172 [info ] [Thread-1 (]: 2 of 27 PASS not_null_avg_true_range_date ...................................... [[32mPASS[0m in 0.74s]
[0m05:17:47.873673 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_avg_true_range_date.4e418b835d
[0m05:17:47.875592 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1
[0m05:17:47.877360 [info ] [Thread-1 (]: 3 of 27 START test not_null_avg_true_range_symbol .............................. [RUN]
[0m05:17:47.879145 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_avg_true_range_date.4e418b835d, now test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1)
[0m05:17:47.880567 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1
[0m05:17:47.885161 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1"
[0m05:17:47.901827 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1
[0m05:17:47.905030 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1"
[0m05:17:47.919189 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1"
[0m05:17:47.920379 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.avg_true_range
where symbol is null



      
    ) dbt_internal_test
[0m05:17:47.921710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:48.156837 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.443 seconds
[0m05:17:48.166034 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad: Close
[0m05:17:48.275774 [info ] [Thread-1 (]: 1 of 27 PASS not_null_avg_true_range_atr_14d ................................... [[32mPASS[0m in 0.61s]
[0m05:17:48.278427 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m05:17:48.280218 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_avg_true_range_date.4e418b835d
[0m05:17:48.281362 [info ] [Thread-1 (]: 2 of 27 START test not_null_avg_true_range_date ................................ [RUN]
[0m05:17:48.282464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_avg_true_range_atr_14d.dccf1cc6ad, now test.stock_dbt.not_null_avg_true_range_date.4e418b835d)
[0m05:17:48.283716 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_avg_true_range_date.4e418b835d
[0m05:17:48.287374 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_avg_true_range_date.4e418b835d"
[0m05:17:48.289854 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.368 seconds
[0m05:17:48.292171 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1: Close
[0m05:17:48.296845 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_avg_true_range_date.4e418b835d
[0m05:17:48.299711 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_avg_true_range_date.4e418b835d"
[0m05:17:48.311127 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_avg_true_range_date.4e418b835d"
[0m05:17:48.312323 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_date.4e418b835d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_avg_true_range_date.4e418b835d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.avg_true_range
where date is null



      
    ) dbt_internal_test
[0m05:17:48.313561 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:48.411945 [info ] [Thread-1 (]: 3 of 27 PASS not_null_avg_true_range_symbol .................................... [[32mPASS[0m in 0.53s]
[0m05:17:48.414549 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1
[0m05:17:48.416491 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_close.4ccb16a429
[0m05:17:48.418514 [info ] [Thread-1 (]: 4 of 27 START test not_null_bollinger_close .................................... [RUN]
[0m05:17:48.419849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1, now test.stock_dbt.not_null_bollinger_close.4ccb16a429)
[0m05:17:48.420760 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_close.4ccb16a429
[0m05:17:48.424791 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_close.4ccb16a429"
[0m05:17:48.433389 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_close.4ccb16a429
[0m05:17:48.435858 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_close.4ccb16a429"
[0m05:17:48.452424 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_close.4ccb16a429"
[0m05:17:48.454335 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_close.4ccb16a429: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_close.4ccb16a429"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.bollinger
where close is null



      
    ) dbt_internal_test
[0m05:17:48.456283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:48.720697 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.407 seconds
[0m05:17:48.725251 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_date.4e418b835d: Close
[0m05:17:48.832388 [info ] [Thread-1 (]: 2 of 27 PASS not_null_avg_true_range_date ...................................... [[32mPASS[0m in 0.55s]
[0m05:17:48.834933 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_avg_true_range_date.4e418b835d
[0m05:17:48.836194 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1
[0m05:17:48.837369 [info ] [Thread-1 (]: 3 of 27 START test not_null_avg_true_range_symbol .............................. [RUN]
[0m05:17:48.838238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_avg_true_range_date.4e418b835d, now test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1)
[0m05:17:48.839033 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1
[0m05:17:48.843088 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1"
[0m05:17:48.850902 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1
[0m05:17:48.853216 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1"
[0m05:17:48.862653 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1"
[0m05:17:48.863950 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.avg_true_range
where symbol is null



      
    ) dbt_internal_test
[0m05:17:48.864562 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:48.916450 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.460 seconds
[0m05:17:48.919932 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_close.4ccb16a429: Close
[0m05:17:49.062683 [info ] [Thread-1 (]: 4 of 27 PASS not_null_bollinger_close .......................................... [[32mPASS[0m in 0.64s]
[0m05:17:49.065132 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_close.4ccb16a429
[0m05:17:49.066138 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_date.9d77bdd20c
[0m05:17:49.066942 [info ] [Thread-1 (]: 5 of 27 START test not_null_bollinger_date ..................................... [RUN]
[0m05:17:49.068078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_close.4ccb16a429, now test.stock_dbt.not_null_bollinger_date.9d77bdd20c)
[0m05:17:49.069058 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_date.9d77bdd20c
[0m05:17:49.072899 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_date.9d77bdd20c"
[0m05:17:49.080405 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_date.9d77bdd20c
[0m05:17:49.083108 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_date.9d77bdd20c"
[0m05:17:49.097525 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_date.9d77bdd20c"
[0m05:17:49.098670 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_date.9d77bdd20c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_date.9d77bdd20c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.bollinger
where date is null



      
    ) dbt_internal_test
[0m05:17:49.099595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:49.266162 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.401 seconds
[0m05:17:49.269110 [debug] [Thread-1 (]: On test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1: Close
[0m05:17:49.386071 [info ] [Thread-1 (]: 3 of 27 PASS not_null_avg_true_range_symbol .................................... [[32mPASS[0m in 0.55s]
[0m05:17:49.388340 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1
[0m05:17:49.389215 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_close.4ccb16a429
[0m05:17:49.390123 [info ] [Thread-1 (]: 4 of 27 START test not_null_bollinger_close .................................... [RUN]
[0m05:17:49.391024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_avg_true_range_symbol.e4c229c0c1, now test.stock_dbt.not_null_bollinger_close.4ccb16a429)
[0m05:17:49.391748 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_close.4ccb16a429
[0m05:17:49.395186 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_close.4ccb16a429"
[0m05:17:49.405337 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_close.4ccb16a429
[0m05:17:49.407494 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_close.4ccb16a429"
[0m05:17:49.422297 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_close.4ccb16a429"
[0m05:17:49.423502 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_close.4ccb16a429: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_close.4ccb16a429"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.bollinger
where close is null



      
    ) dbt_internal_test
[0m05:17:49.424956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:49.549978 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.450 seconds
[0m05:17:49.554179 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_date.9d77bdd20c: Close
[0m05:17:49.671161 [info ] [Thread-1 (]: 5 of 27 PASS not_null_bollinger_date ........................................... [[32mPASS[0m in 0.60s]
[0m05:17:49.673827 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_date.9d77bdd20c
[0m05:17:49.675224 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e
[0m05:17:49.676138 [info ] [Thread-1 (]: 6 of 27 START test not_null_bollinger_lower_band ............................... [RUN]
[0m05:17:49.677483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_date.9d77bdd20c, now test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e)
[0m05:17:49.678503 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e
[0m05:17:49.682643 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e"
[0m05:17:49.692375 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e
[0m05:17:49.694939 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e"
[0m05:17:49.703195 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e"
[0m05:17:49.704971 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select lower_band
from dev.analytics.bollinger
where lower_band is null



      
    ) dbt_internal_test
[0m05:17:49.706597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:49.800892 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.376 seconds
[0m05:17:49.804450 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_close.4ccb16a429: Close
[0m05:17:49.920216 [info ] [Thread-1 (]: 4 of 27 PASS not_null_bollinger_close .......................................... [[32mPASS[0m in 0.53s]
[0m05:17:49.922819 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_close.4ccb16a429
[0m05:17:49.924322 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_date.9d77bdd20c
[0m05:17:49.925803 [info ] [Thread-1 (]: 5 of 27 START test not_null_bollinger_date ..................................... [RUN]
[0m05:17:49.927088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_close.4ccb16a429, now test.stock_dbt.not_null_bollinger_date.9d77bdd20c)
[0m05:17:49.928633 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_date.9d77bdd20c
[0m05:17:49.932711 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_date.9d77bdd20c"
[0m05:17:49.943451 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_date.9d77bdd20c
[0m05:17:49.945377 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_date.9d77bdd20c"
[0m05:17:49.953950 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_date.9d77bdd20c"
[0m05:17:49.955194 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_date.9d77bdd20c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_date.9d77bdd20c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.bollinger
where date is null



      
    ) dbt_internal_test
[0m05:17:49.957077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:50.109526 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.403 seconds
[0m05:17:50.112743 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e: Close
[0m05:17:50.248298 [info ] [Thread-1 (]: 6 of 27 PASS not_null_bollinger_lower_band ..................................... [[32mPASS[0m in 0.57s]
[0m05:17:50.250510 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e
[0m05:17:50.252743 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3
[0m05:17:50.254154 [info ] [Thread-1 (]: 7 of 27 START test not_null_bollinger_sma_20d .................................. [RUN]
[0m05:17:50.256112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e, now test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3)
[0m05:17:50.257687 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3
[0m05:17:50.262310 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3"
[0m05:17:50.277603 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3
[0m05:17:50.280490 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3"
[0m05:17:50.289746 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3"
[0m05:17:50.290797 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sma_20d
from dev.analytics.bollinger
where sma_20d is null



      
    ) dbt_internal_test
[0m05:17:50.291600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:50.388439 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.431 seconds
[0m05:17:50.391095 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_date.9d77bdd20c: Close
[0m05:17:50.563304 [info ] [Thread-1 (]: 5 of 27 PASS not_null_bollinger_date ........................................... [[32mPASS[0m in 0.64s]
[0m05:17:50.565414 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_date.9d77bdd20c
[0m05:17:50.567435 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e
[0m05:17:50.569350 [info ] [Thread-1 (]: 6 of 27 START test not_null_bollinger_lower_band ............................... [RUN]
[0m05:17:50.571383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_date.9d77bdd20c, now test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e)
[0m05:17:50.573497 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e
[0m05:17:50.577316 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e"
[0m05:17:50.590881 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e
[0m05:17:50.593897 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e"
[0m05:17:50.606607 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e"
[0m05:17:50.608052 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select lower_band
from dev.analytics.bollinger
where lower_band is null



      
    ) dbt_internal_test
[0m05:17:50.609108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:50.710627 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.419 seconds
[0m05:17:50.714124 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3: Close
[0m05:17:50.846535 [info ] [Thread-1 (]: 7 of 27 PASS not_null_bollinger_sma_20d ........................................ [[32mPASS[0m in 0.59s]
[0m05:17:50.849116 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3
[0m05:17:50.849964 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_symbol.a932e30f82
[0m05:17:50.850799 [info ] [Thread-1 (]: 8 of 27 START test not_null_bollinger_symbol ................................... [RUN]
[0m05:17:50.852004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3, now test.stock_dbt.not_null_bollinger_symbol.a932e30f82)
[0m05:17:50.852655 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_symbol.a932e30f82
[0m05:17:50.856807 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_symbol.a932e30f82"
[0m05:17:50.864160 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_symbol.a932e30f82
[0m05:17:50.866487 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_symbol.a932e30f82"
[0m05:17:50.879834 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_symbol.a932e30f82"
[0m05:17:50.880857 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_symbol.a932e30f82: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_symbol.a932e30f82"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.bollinger
where symbol is null



      
    ) dbt_internal_test
[0m05:17:50.881906 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:51.054217 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.445 seconds
[0m05:17:51.059458 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e: Close
[0m05:17:51.176589 [info ] [Thread-1 (]: 6 of 27 PASS not_null_bollinger_lower_band ..................................... [[32mPASS[0m in 0.60s]
[0m05:17:51.178380 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e
[0m05:17:51.179423 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3
[0m05:17:51.180200 [info ] [Thread-1 (]: 7 of 27 START test not_null_bollinger_sma_20d .................................. [RUN]
[0m05:17:51.181269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_lower_band.10fb75ad4e, now test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3)
[0m05:17:51.182116 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3
[0m05:17:51.185534 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3"
[0m05:17:51.194344 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3
[0m05:17:51.196529 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3"
[0m05:17:51.204642 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3"
[0m05:17:51.206061 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sma_20d
from dev.analytics.bollinger
where sma_20d is null



      
    ) dbt_internal_test
[0m05:17:51.207273 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:51.274006 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.392 seconds
[0m05:17:51.276986 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_symbol.a932e30f82: Close
[0m05:17:51.391781 [info ] [Thread-1 (]: 8 of 27 PASS not_null_bollinger_symbol ......................................... [[32mPASS[0m in 0.54s]
[0m05:17:51.394585 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_symbol.a932e30f82
[0m05:17:51.396198 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_upper_band.e4db87564c
[0m05:17:51.397378 [info ] [Thread-1 (]: 9 of 27 START test not_null_bollinger_upper_band ............................... [RUN]
[0m05:17:51.398546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_symbol.a932e30f82, now test.stock_dbt.not_null_bollinger_upper_band.e4db87564c)
[0m05:17:51.399221 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_upper_band.e4db87564c
[0m05:17:51.402960 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_upper_band.e4db87564c"
[0m05:17:51.413786 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_upper_band.e4db87564c
[0m05:17:51.415961 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_upper_band.e4db87564c"
[0m05:17:51.431060 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_upper_band.e4db87564c"
[0m05:17:51.432644 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_upper_band.e4db87564c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_upper_band.e4db87564c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select upper_band
from dev.analytics.bollinger
where upper_band is null



      
    ) dbt_internal_test
[0m05:17:51.433721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:51.616525 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.409 seconds
[0m05:17:51.619507 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3: Close
[0m05:17:51.762470 [info ] [Thread-1 (]: 7 of 27 PASS not_null_bollinger_sma_20d ........................................ [[32mPASS[0m in 0.58s]
[0m05:17:51.765516 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3
[0m05:17:51.767330 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_symbol.a932e30f82
[0m05:17:51.768097 [info ] [Thread-1 (]: 8 of 27 START test not_null_bollinger_symbol ................................... [RUN]
[0m05:17:51.769085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_sma_20d.26c74c44b3, now test.stock_dbt.not_null_bollinger_symbol.a932e30f82)
[0m05:17:51.769939 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_symbol.a932e30f82
[0m05:17:51.773273 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_symbol.a932e30f82"
[0m05:17:51.781704 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_symbol.a932e30f82
[0m05:17:51.783913 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_symbol.a932e30f82"
[0m05:17:51.792415 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_symbol.a932e30f82"
[0m05:17:51.793231 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_symbol.a932e30f82: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_symbol.a932e30f82"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.bollinger
where symbol is null



      
    ) dbt_internal_test
[0m05:17:51.794005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:51.916679 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.483 seconds
[0m05:17:51.920189 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_upper_band.e4db87564c: Close
[0m05:17:52.040605 [info ] [Thread-1 (]: 9 of 27 PASS not_null_bollinger_upper_band ..................................... [[32mPASS[0m in 0.64s]
[0m05:17:52.042545 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_upper_band.e4db87564c
[0m05:17:52.043976 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_close.6d037dd588
[0m05:17:52.044915 [info ] [Thread-1 (]: 10 of 27 START test not_null_moving_average_close .............................. [RUN]
[0m05:17:52.046423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_upper_band.e4db87564c, now test.stock_dbt.not_null_moving_average_close.6d037dd588)
[0m05:17:52.047251 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_close.6d037dd588
[0m05:17:52.051233 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_close.6d037dd588"
[0m05:17:52.059035 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_close.6d037dd588
[0m05:17:52.069659 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_close.6d037dd588"
[0m05:17:52.084947 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_close.6d037dd588"
[0m05:17:52.086270 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_close.6d037dd588: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_close.6d037dd588"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.moving_average
where close is null



      
    ) dbt_internal_test
[0m05:17:52.087106 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:52.138021 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.344 seconds
[0m05:17:52.140772 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_symbol.a932e30f82: Close
[0m05:17:52.247216 [info ] [Thread-1 (]: 8 of 27 PASS not_null_bollinger_symbol ......................................... [[32mPASS[0m in 0.48s]
[0m05:17:52.248755 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_symbol.a932e30f82
[0m05:17:52.250460 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_bollinger_upper_band.e4db87564c
[0m05:17:52.251871 [info ] [Thread-1 (]: 9 of 27 START test not_null_bollinger_upper_band ............................... [RUN]
[0m05:17:52.253058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_symbol.a932e30f82, now test.stock_dbt.not_null_bollinger_upper_band.e4db87564c)
[0m05:17:52.253863 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_bollinger_upper_band.e4db87564c
[0m05:17:52.257616 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_bollinger_upper_band.e4db87564c"
[0m05:17:52.267940 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_bollinger_upper_band.e4db87564c
[0m05:17:52.270509 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_bollinger_upper_band.e4db87564c"
[0m05:17:52.282912 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_bollinger_upper_band.e4db87564c"
[0m05:17:52.283819 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_upper_band.e4db87564c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_bollinger_upper_band.e4db87564c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select upper_band
from dev.analytics.bollinger
where upper_band is null



      
    ) dbt_internal_test
[0m05:17:52.284616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:52.547514 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.460 seconds
[0m05:17:52.551622 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_close.6d037dd588: Close
[0m05:17:52.643520 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.359 seconds
[0m05:17:52.648206 [debug] [Thread-1 (]: On test.stock_dbt.not_null_bollinger_upper_band.e4db87564c: Close
[0m05:17:52.674491 [info ] [Thread-1 (]: 10 of 27 PASS not_null_moving_average_close .................................... [[32mPASS[0m in 0.63s]
[0m05:17:52.676294 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_close.6d037dd588
[0m05:17:52.677007 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_date.3ad00158b5
[0m05:17:52.677989 [info ] [Thread-1 (]: 11 of 27 START test not_null_moving_average_date ............................... [RUN]
[0m05:17:52.679584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_close.6d037dd588, now test.stock_dbt.not_null_moving_average_date.3ad00158b5)
[0m05:17:52.680499 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_date.3ad00158b5
[0m05:17:52.684316 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_date.3ad00158b5"
[0m05:17:52.693874 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_date.3ad00158b5
[0m05:17:52.696122 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_date.3ad00158b5"
[0m05:17:52.712342 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_date.3ad00158b5"
[0m05:17:52.713825 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_date.3ad00158b5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_date.3ad00158b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.moving_average
where date is null



      
    ) dbt_internal_test
[0m05:17:52.715004 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:52.775071 [info ] [Thread-1 (]: 9 of 27 PASS not_null_bollinger_upper_band ..................................... [[32mPASS[0m in 0.52s]
[0m05:17:52.777077 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_bollinger_upper_band.e4db87564c
[0m05:17:52.778638 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_close.6d037dd588
[0m05:17:52.779601 [info ] [Thread-1 (]: 10 of 27 START test not_null_moving_average_close .............................. [RUN]
[0m05:17:52.780824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_bollinger_upper_band.e4db87564c, now test.stock_dbt.not_null_moving_average_close.6d037dd588)
[0m05:17:52.781702 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_close.6d037dd588
[0m05:17:52.785141 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_close.6d037dd588"
[0m05:17:52.793737 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_close.6d037dd588
[0m05:17:52.797419 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_close.6d037dd588"
[0m05:17:52.806755 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_close.6d037dd588"
[0m05:17:52.808088 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_close.6d037dd588: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_close.6d037dd588"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.moving_average
where close is null



      
    ) dbt_internal_test
[0m05:17:52.809593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:53.142391 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.427 seconds
[0m05:17:53.147231 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_date.3ad00158b5: Close
[0m05:17:53.184360 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.375 seconds
[0m05:17:53.189501 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_close.6d037dd588: Close
[0m05:17:53.307414 [info ] [Thread-1 (]: 10 of 27 PASS not_null_moving_average_close .................................... [[32mPASS[0m in 0.53s]
[0m05:17:53.308269 [info ] [Thread-1 (]: 11 of 27 PASS not_null_moving_average_date ..................................... [[32mPASS[0m in 0.63s]
[0m05:17:53.310485 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_close.6d037dd588
[0m05:17:53.311707 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_date.3ad00158b5
[0m05:17:53.312409 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_date.3ad00158b5
[0m05:17:53.313698 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m05:17:53.314512 [info ] [Thread-1 (]: 11 of 27 START test not_null_moving_average_date ............................... [RUN]
[0m05:17:53.315486 [info ] [Thread-1 (]: 12 of 27 START test not_null_moving_average_moving_avg_20d ..................... [RUN]
[0m05:17:53.316403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_close.6d037dd588, now test.stock_dbt.not_null_moving_average_date.3ad00158b5)
[0m05:17:53.317688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_date.3ad00158b5, now test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22)
[0m05:17:53.318167 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_date.3ad00158b5
[0m05:17:53.319817 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m05:17:53.322826 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_date.3ad00158b5"
[0m05:17:53.324517 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m05:17:53.333406 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_date.3ad00158b5
[0m05:17:53.336058 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m05:17:53.336760 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_date.3ad00158b5"
[0m05:17:53.339606 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m05:17:53.348046 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m05:17:53.349966 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg_20d
from dev.analytics.moving_average
where moving_avg_20d is null



      
    ) dbt_internal_test
[0m05:17:53.351417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:53.351798 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_date.3ad00158b5"
[0m05:17:53.353089 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_date.3ad00158b5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_date.3ad00158b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.moving_average
where date is null



      
    ) dbt_internal_test
[0m05:17:53.354529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:53.740129 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.389 seconds
[0m05:17:53.742047 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.387 seconds
[0m05:17:53.743284 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22: Close
[0m05:17:53.745375 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_date.3ad00158b5: Close
[0m05:17:53.859369 [info ] [Thread-1 (]: 12 of 27 PASS not_null_moving_average_moving_avg_20d ........................... [[32mPASS[0m in 0.54s]
[0m05:17:53.861627 [info ] [Thread-1 (]: 11 of 27 PASS not_null_moving_average_date ..................................... [[32mPASS[0m in 0.54s]
[0m05:17:53.861853 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m05:17:53.863597 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_date.3ad00158b5
[0m05:17:53.863642 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m05:17:53.864437 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m05:17:53.864461 [info ] [Thread-1 (]: 13 of 27 START test not_null_moving_average_moving_avg_5d ...................... [RUN]
[0m05:17:53.866011 [info ] [Thread-1 (]: 12 of 27 START test not_null_moving_average_moving_avg_20d ..................... [RUN]
[0m05:17:53.866260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22, now test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca)
[0m05:17:53.867215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_date.3ad00158b5, now test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22)
[0m05:17:53.867846 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m05:17:53.867897 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m05:17:53.871291 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m05:17:53.871936 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m05:17:53.875901 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m05:17:53.878858 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m05:17:53.879571 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m05:17:53.881699 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m05:17:53.898036 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m05:17:53.899748 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg_20d
from dev.analytics.moving_average
where moving_avg_20d is null



      
    ) dbt_internal_test
[0m05:17:53.900331 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m05:17:53.900724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:53.901472 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg_5d
from dev.analytics.moving_average
where moving_avg_5d is null



      
    ) dbt_internal_test
[0m05:17:53.902356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:54.274588 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.374 seconds
[0m05:17:54.277532 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22: Close
[0m05:17:54.286492 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.384 seconds
[0m05:17:54.288400 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca: Close
[0m05:17:54.416137 [info ] [Thread-1 (]: 12 of 27 PASS not_null_moving_average_moving_avg_20d ........................... [[32mPASS[0m in 0.55s]
[0m05:17:54.418915 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m05:17:54.419206 [info ] [Thread-1 (]: 13 of 27 PASS not_null_moving_average_moving_avg_5d ............................ [[32mPASS[0m in 0.55s]
[0m05:17:54.420593 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m05:17:54.420837 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m05:17:54.422001 [info ] [Thread-1 (]: 13 of 27 START test not_null_moving_average_moving_avg_5d ...................... [RUN]
[0m05:17:54.422377 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_symbol.75a6f7473c
[0m05:17:54.423377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_moving_avg_20d.57e57c7d22, now test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca)
[0m05:17:54.423844 [info ] [Thread-1 (]: 14 of 27 START test not_null_moving_average_symbol ............................. [RUN]
[0m05:17:54.425044 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m05:17:54.425172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca, now test.stock_dbt.not_null_moving_average_symbol.75a6f7473c)
[0m05:17:54.426204 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_symbol.75a6f7473c
[0m05:17:54.428931 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m05:17:54.430291 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_symbol.75a6f7473c"
[0m05:17:54.433315 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m05:17:54.434336 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_symbol.75a6f7473c
[0m05:17:54.435681 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m05:17:54.436445 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_symbol.75a6f7473c"
[0m05:17:54.442158 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m05:17:54.443045 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_symbol.75a6f7473c"
[0m05:17:54.443426 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg_5d
from dev.analytics.moving_average
where moving_avg_5d is null



      
    ) dbt_internal_test
[0m05:17:54.444935 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_symbol.75a6f7473c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_symbol.75a6f7473c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.moving_average
where symbol is null



      
    ) dbt_internal_test
[0m05:17:54.445474 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:54.446206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:54.834375 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.389 seconds
[0m05:17:54.839222 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca: Close
[0m05:17:54.873907 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.428 seconds
[0m05:17:54.877080 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_symbol.75a6f7473c: Close
[0m05:17:54.985876 [info ] [Thread-1 (]: 13 of 27 PASS not_null_moving_average_moving_avg_5d ............................ [[32mPASS[0m in 0.56s]
[0m05:17:54.988978 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m05:17:54.990453 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_moving_average_symbol.75a6f7473c
[0m05:17:54.992171 [info ] [Thread-1 (]: 14 of 27 START test not_null_moving_average_symbol ............................. [RUN]
[0m05:17:54.993674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_moving_avg_5d.9a12e3e8ca, now test.stock_dbt.not_null_moving_average_symbol.75a6f7473c)
[0m05:17:54.995478 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_moving_average_symbol.75a6f7473c
[0m05:17:54.998533 [info ] [Thread-1 (]: 14 of 27 PASS not_null_moving_average_symbol ................................... [[32mPASS[0m in 0.57s]
[0m05:17:54.999846 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_moving_average_symbol.75a6f7473c"
[0m05:17:55.000223 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_symbol.75a6f7473c
[0m05:17:55.001629 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42
[0m05:17:55.003188 [info ] [Thread-1 (]: 15 of 27 START test not_null_rsi_calculation_avg_gain .......................... [RUN]
[0m05:17:55.004318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_symbol.75a6f7473c, now test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42)
[0m05:17:55.005573 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42
[0m05:17:55.009200 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m05:17:55.010186 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_moving_average_symbol.75a6f7473c
[0m05:17:55.012773 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_moving_average_symbol.75a6f7473c"
[0m05:17:55.015676 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42
[0m05:17:55.017921 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m05:17:55.022007 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_moving_average_symbol.75a6f7473c"
[0m05:17:55.023143 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_symbol.75a6f7473c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_moving_average_symbol.75a6f7473c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.moving_average
where symbol is null



      
    ) dbt_internal_test
[0m05:17:55.022946 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m05:17:55.023911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:55.024097 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_gain
from dev.analytics.rsi_calculation
where avg_gain is null



      
    ) dbt_internal_test
[0m05:17:55.025027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:55.496748 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.473 seconds
[0m05:17:55.499405 [debug] [Thread-1 (]: On test.stock_dbt.not_null_moving_average_symbol.75a6f7473c: Close
[0m05:17:55.627059 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.602 seconds
[0m05:17:55.627140 [info ] [Thread-1 (]: 14 of 27 PASS not_null_moving_average_symbol ................................... [[32mPASS[0m in 0.63s]
[0m05:17:55.630366 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_moving_average_symbol.75a6f7473c
[0m05:17:55.631008 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42: Close
[0m05:17:55.631530 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42
[0m05:17:55.633061 [info ] [Thread-1 (]: 15 of 27 START test not_null_rsi_calculation_avg_gain .......................... [RUN]
[0m05:17:55.635029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_moving_average_symbol.75a6f7473c, now test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42)
[0m05:17:55.636210 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42
[0m05:17:55.640119 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m05:17:55.652162 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42
[0m05:17:55.655027 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m05:17:55.664730 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m05:17:55.666134 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_gain
from dev.analytics.rsi_calculation
where avg_gain is null



      
    ) dbt_internal_test
[0m05:17:55.667746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:55.753830 [info ] [Thread-1 (]: 15 of 27 PASS not_null_rsi_calculation_avg_gain ................................ [[32mPASS[0m in 0.75s]
[0m05:17:55.756516 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42
[0m05:17:55.757948 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m05:17:55.760133 [info ] [Thread-1 (]: 16 of 27 START test not_null_rsi_calculation_avg_loss .......................... [RUN]
[0m05:17:55.762324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42, now test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19)
[0m05:17:55.763770 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m05:17:55.768269 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m05:17:55.793068 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m05:17:55.796331 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m05:17:55.807203 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m05:17:55.808676 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_loss
from dev.analytics.rsi_calculation
where avg_loss is null



      
    ) dbt_internal_test
[0m05:17:55.809990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:56.132961 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.465 seconds
[0m05:17:56.136746 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42: Close
[0m05:17:56.221093 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.411 seconds
[0m05:17:56.223863 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19: Close
[0m05:17:56.262227 [info ] [Thread-1 (]: 15 of 27 PASS not_null_rsi_calculation_avg_gain ................................ [[32mPASS[0m in 0.63s]
[0m05:17:56.264786 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42
[0m05:17:56.266870 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m05:17:56.268721 [info ] [Thread-1 (]: 16 of 27 START test not_null_rsi_calculation_avg_loss .......................... [RUN]
[0m05:17:56.270998 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_avg_gain.c5480cff42, now test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19)
[0m05:17:56.272936 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m05:17:56.277402 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m05:17:56.286879 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m05:17:56.289251 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m05:17:56.300469 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m05:17:56.301874 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_loss
from dev.analytics.rsi_calculation
where avg_loss is null



      
    ) dbt_internal_test
[0m05:17:56.302970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:56.325894 [info ] [Thread-1 (]: 16 of 27 PASS not_null_rsi_calculation_avg_loss ................................ [[32mPASS[0m in 0.56s]
[0m05:17:56.327585 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m05:17:56.328888 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d
[0m05:17:56.329933 [info ] [Thread-1 (]: 17 of 27 START test not_null_rsi_calculation_close ............................. [RUN]
[0m05:17:56.331835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19, now test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d)
[0m05:17:56.332630 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d
[0m05:17:56.336262 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d"
[0m05:17:56.348543 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d
[0m05:17:56.351097 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d"
[0m05:17:56.359856 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d"
[0m05:17:56.361512 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.rsi_calculation
where close is null



      
    ) dbt_internal_test
[0m05:17:56.362770 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:56.688007 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.385 seconds
[0m05:17:56.692182 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19: Close
[0m05:17:56.721475 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.359 seconds
[0m05:17:56.724642 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d: Close
[0m05:17:56.822186 [info ] [Thread-1 (]: 16 of 27 PASS not_null_rsi_calculation_avg_loss ................................ [[32mPASS[0m in 0.55s]
[0m05:17:56.824638 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m05:17:56.826032 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d
[0m05:17:56.827083 [info ] [Thread-1 (]: 17 of 27 START test not_null_rsi_calculation_close ............................. [RUN]
[0m05:17:56.828631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_avg_loss.367dd1fd19, now test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d)
[0m05:17:56.829924 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d
[0m05:17:56.834517 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d"
[0m05:17:56.842350 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d
[0m05:17:56.844648 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d"
[0m05:17:56.856184 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d"
[0m05:17:56.857470 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.rsi_calculation
where close is null



      
    ) dbt_internal_test
[0m05:17:56.858734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:56.872393 [info ] [Thread-1 (]: 17 of 27 PASS not_null_rsi_calculation_close ................................... [[32mPASS[0m in 0.54s]
[0m05:17:56.873824 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d
[0m05:17:56.874844 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76
[0m05:17:56.875443 [info ] [Thread-1 (]: 18 of 27 START test not_null_rsi_calculation_date .............................. [RUN]
[0m05:17:56.877168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d, now test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76)
[0m05:17:56.878420 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76
[0m05:17:56.924071 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76"
[0m05:17:56.935665 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76
[0m05:17:56.938789 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76"
[0m05:17:56.949602 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76"
[0m05:17:56.951600 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.rsi_calculation
where date is null



      
    ) dbt_internal_test
[0m05:17:56.953071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:57.285833 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.427 seconds
[0m05:17:57.288888 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d: Close
[0m05:17:57.427605 [info ] [Thread-1 (]: 17 of 27 PASS not_null_rsi_calculation_close ................................... [[32mPASS[0m in 0.60s]
[0m05:17:57.428507 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.475 seconds
[0m05:17:57.429430 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d
[0m05:17:57.430673 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76
[0m05:17:57.430961 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76: Close
[0m05:17:57.431523 [info ] [Thread-1 (]: 18 of 27 START test not_null_rsi_calculation_date .............................. [RUN]
[0m05:17:57.432587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_close.c21314fd4d, now test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76)
[0m05:17:57.434189 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76
[0m05:17:57.477749 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76"
[0m05:17:57.489217 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76
[0m05:17:57.491667 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76"
[0m05:17:57.500879 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76"
[0m05:17:57.501776 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.rsi_calculation
where date is null



      
    ) dbt_internal_test
[0m05:17:57.502662 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:57.579266 [info ] [Thread-1 (]: 18 of 27 PASS not_null_rsi_calculation_date .................................... [[32mPASS[0m in 0.70s]
[0m05:17:57.581319 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76
[0m05:17:57.582095 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m05:17:57.583150 [info ] [Thread-1 (]: 19 of 27 START test not_null_rsi_calculation_rsi_14d ........................... [RUN]
[0m05:17:57.584376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76, now test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8)
[0m05:17:57.585298 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m05:17:57.589387 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m05:17:57.596809 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m05:17:57.599204 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m05:17:57.615643 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m05:17:57.617258 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from dev.analytics.rsi_calculation
where rsi_14d is null



      
    ) dbt_internal_test
[0m05:17:57.618749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:57.872509 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.370 seconds
[0m05:17:57.875236 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76: Close
[0m05:17:57.994913 [info ] [Thread-1 (]: 18 of 27 PASS not_null_rsi_calculation_date .................................... [[32mPASS[0m in 0.56s]
[0m05:17:57.998237 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76
[0m05:17:58.001022 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.382 seconds
[0m05:17:58.001077 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m05:17:58.003009 [info ] [Thread-1 (]: 19 of 27 START test not_null_rsi_calculation_rsi_14d ........................... [RUN]
[0m05:17:58.004096 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8: Close
[0m05:17:58.005012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_date.f9fd5f6d76, now test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8)
[0m05:17:58.006767 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m05:17:58.011060 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m05:17:58.050934 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m05:17:58.055042 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m05:17:58.073601 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m05:17:58.075697 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from dev.analytics.rsi_calculation
where rsi_14d is null



      
    ) dbt_internal_test
[0m05:17:58.078328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:58.131315 [info ] [Thread-1 (]: 19 of 27 PASS not_null_rsi_calculation_rsi_14d ................................. [[32mPASS[0m in 0.55s]
[0m05:17:58.133204 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m05:17:58.134535 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84
[0m05:17:58.136134 [info ] [Thread-1 (]: 20 of 27 START test not_null_rsi_calculation_symbol ............................ [RUN]
[0m05:17:58.137781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8, now test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84)
[0m05:17:58.138780 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84
[0m05:17:58.142455 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m05:17:58.153189 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84
[0m05:17:58.156091 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m05:17:58.166305 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m05:17:58.167200 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.rsi_calculation
where symbol is null



      
    ) dbt_internal_test
[0m05:17:58.167987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:58.554314 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.476 seconds
[0m05:17:58.558522 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8: Close
[0m05:17:58.685568 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.517 seconds
[0m05:17:58.687374 [info ] [Thread-1 (]: 19 of 27 PASS not_null_rsi_calculation_rsi_14d ................................. [[32mPASS[0m in 0.68s]
[0m05:17:58.688629 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84: Close
[0m05:17:58.689018 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m05:17:58.690714 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84
[0m05:17:58.692034 [info ] [Thread-1 (]: 20 of 27 START test not_null_rsi_calculation_symbol ............................ [RUN]
[0m05:17:58.692951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_rsi_14d.a02bdbc6b8, now test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84)
[0m05:17:58.693673 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84
[0m05:17:58.696880 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m05:17:58.704097 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84
[0m05:17:58.706442 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m05:17:58.715158 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m05:17:58.721543 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.rsi_calculation
where symbol is null



      
    ) dbt_internal_test
[0m05:17:58.722585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:58.805123 [info ] [Thread-1 (]: 20 of 27 PASS not_null_rsi_calculation_symbol .................................. [[32mPASS[0m in 0.67s]
[0m05:17:58.807209 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84
[0m05:17:58.808574 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_close.d7e232e1ba
[0m05:17:58.809579 [info ] [Thread-1 (]: 21 of 27 START test not_null_stock_prices_close ................................ [RUN]
[0m05:17:58.810499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84, now test.stock_dbt.not_null_stock_prices_close.d7e232e1ba)
[0m05:17:58.811297 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_close.d7e232e1ba
[0m05:17:58.815011 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_close.d7e232e1ba"
[0m05:17:58.827411 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_close.d7e232e1ba
[0m05:17:58.830001 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_close.d7e232e1ba"
[0m05:17:58.842330 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_close.d7e232e1ba"
[0m05:17:58.843984 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_close.d7e232e1ba: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_close.d7e232e1ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.stock_prices
where close is null



      
    ) dbt_internal_test
[0m05:17:58.845572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:59.085440 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.363 seconds
[0m05:17:59.088357 [debug] [Thread-1 (]: On test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84: Close
[0m05:17:59.207151 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.361 seconds
[0m05:17:59.211995 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_close.d7e232e1ba: Close
[0m05:17:59.223511 [info ] [Thread-1 (]: 20 of 27 PASS not_null_rsi_calculation_symbol .................................. [[32mPASS[0m in 0.53s]
[0m05:17:59.225128 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84
[0m05:17:59.226402 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_close.d7e232e1ba
[0m05:17:59.227282 [info ] [Thread-1 (]: 21 of 27 START test not_null_stock_prices_close ................................ [RUN]
[0m05:17:59.228280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_rsi_calculation_symbol.0f9fdcec84, now test.stock_dbt.not_null_stock_prices_close.d7e232e1ba)
[0m05:17:59.229119 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_close.d7e232e1ba
[0m05:17:59.233141 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_close.d7e232e1ba"
[0m05:17:59.243822 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_close.d7e232e1ba
[0m05:17:59.246100 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_close.d7e232e1ba"
[0m05:17:59.255207 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_close.d7e232e1ba"
[0m05:17:59.256208 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_close.d7e232e1ba: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_close.d7e232e1ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.stock_prices
where close is null



      
    ) dbt_internal_test
[0m05:17:59.257119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:59.325775 [info ] [Thread-1 (]: 21 of 27 PASS not_null_stock_prices_close ...................................... [[32mPASS[0m in 0.51s]
[0m05:17:59.328002 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_close.d7e232e1ba
[0m05:17:59.329685 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_date.98a7527501
[0m05:17:59.330827 [info ] [Thread-1 (]: 22 of 27 START test not_null_stock_prices_date ................................. [RUN]
[0m05:17:59.332222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_close.d7e232e1ba, now test.stock_dbt.not_null_stock_prices_date.98a7527501)
[0m05:17:59.333282 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_date.98a7527501
[0m05:17:59.338307 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_date.98a7527501"
[0m05:17:59.348297 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_date.98a7527501
[0m05:17:59.350835 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_date.98a7527501"
[0m05:17:59.359540 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_date.98a7527501"
[0m05:17:59.360692 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_date.98a7527501: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_date.98a7527501"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.stock_prices
where date is null



      
    ) dbt_internal_test
[0m05:17:59.361783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:59.653510 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.396 seconds
[0m05:17:59.656267 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_close.d7e232e1ba: Close
[0m05:17:59.771707 [info ] [Thread-1 (]: 21 of 27 PASS not_null_stock_prices_close ...................................... [[32mPASS[0m in 0.54s]
[0m05:17:59.772877 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.411 seconds
[0m05:17:59.774931 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_close.d7e232e1ba
[0m05:17:59.776053 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_date.98a7527501: Close
[0m05:17:59.776119 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_date.98a7527501
[0m05:17:59.776912 [info ] [Thread-1 (]: 22 of 27 START test not_null_stock_prices_date ................................. [RUN]
[0m05:17:59.778203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_close.d7e232e1ba, now test.stock_dbt.not_null_stock_prices_date.98a7527501)
[0m05:17:59.779449 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_date.98a7527501
[0m05:17:59.783858 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_date.98a7527501"
[0m05:17:59.794394 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_date.98a7527501
[0m05:17:59.796740 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_date.98a7527501"
[0m05:17:59.805104 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_date.98a7527501"
[0m05:17:59.806439 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_date.98a7527501: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_date.98a7527501"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.stock_prices
where date is null



      
    ) dbt_internal_test
[0m05:17:59.807737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:17:59.889731 [info ] [Thread-1 (]: 22 of 27 PASS not_null_stock_prices_date ....................................... [[32mPASS[0m in 0.56s]
[0m05:17:59.892191 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_date.98a7527501
[0m05:17:59.893636 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc
[0m05:17:59.895217 [info ] [Thread-1 (]: 23 of 27 START test not_null_stock_prices_high ................................. [RUN]
[0m05:17:59.897341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_date.98a7527501, now test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc)
[0m05:17:59.898778 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc
[0m05:17:59.903677 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc"
[0m05:17:59.917729 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc
[0m05:17:59.920483 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc"
[0m05:17:59.929971 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc"
[0m05:17:59.931239 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select high
from dev.analytics.stock_prices
where high is null



      
    ) dbt_internal_test
[0m05:17:59.932388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:18:00.171766 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.364 seconds
[0m05:18:00.174858 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_date.98a7527501: Close
[0m05:18:00.297636 [info ] [Thread-1 (]: 22 of 27 PASS not_null_stock_prices_date ....................................... [[32mPASS[0m in 0.52s]
[0m05:18:00.299021 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_date.98a7527501
[0m05:18:00.299873 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc
[0m05:18:00.300776 [info ] [Thread-1 (]: 23 of 27 START test not_null_stock_prices_high ................................. [RUN]
[0m05:18:00.301702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_date.98a7527501, now test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc)
[0m05:18:00.302506 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc
[0m05:18:00.305849 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc"
[0m05:18:00.317442 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc
[0m05:18:00.319551 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc"
[0m05:18:00.329241 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc"
[0m05:18:00.330476 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select high
from dev.analytics.stock_prices
where high is null



      
    ) dbt_internal_test
[0m05:18:00.331596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:18:00.448388 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.516 seconds
[0m05:18:00.452432 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc: Close
[0m05:18:00.570598 [info ] [Thread-1 (]: 23 of 27 PASS not_null_stock_prices_high ....................................... [[32mPASS[0m in 0.67s]
[0m05:18:00.572678 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc
[0m05:18:00.573824 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_low.e65294ca15
[0m05:18:00.574952 [info ] [Thread-1 (]: 24 of 27 START test not_null_stock_prices_low .................................. [RUN]
[0m05:18:00.576078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc, now test.stock_dbt.not_null_stock_prices_low.e65294ca15)
[0m05:18:00.577127 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_low.e65294ca15
[0m05:18:00.580553 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_low.e65294ca15"
[0m05:18:00.592727 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_low.e65294ca15
[0m05:18:00.595411 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_low.e65294ca15"
[0m05:18:00.612829 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_low.e65294ca15"
[0m05:18:00.614231 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_low.e65294ca15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_low.e65294ca15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select low
from dev.analytics.stock_prices
where low is null



      
    ) dbt_internal_test
[0m05:18:00.616121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:18:00.719232 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.388 seconds
[0m05:18:00.722894 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc: Close
[0m05:18:00.834846 [info ] [Thread-1 (]: 23 of 27 PASS not_null_stock_prices_high ....................................... [[32mPASS[0m in 0.53s]
[0m05:18:00.836816 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc
[0m05:18:00.837623 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_low.e65294ca15
[0m05:18:00.838916 [info ] [Thread-1 (]: 24 of 27 START test not_null_stock_prices_low .................................. [RUN]
[0m05:18:00.840192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_high.0d3ed8dfcc, now test.stock_dbt.not_null_stock_prices_low.e65294ca15)
[0m05:18:00.841461 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_low.e65294ca15
[0m05:18:00.845552 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_low.e65294ca15"
[0m05:18:00.857446 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_low.e65294ca15
[0m05:18:00.860054 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_low.e65294ca15"
[0m05:18:00.871698 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_low.e65294ca15"
[0m05:18:00.872834 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_low.e65294ca15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_low.e65294ca15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select low
from dev.analytics.stock_prices
where low is null



      
    ) dbt_internal_test
[0m05:18:00.873734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:18:01.004839 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.389 seconds
[0m05:18:01.007915 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_low.e65294ca15: Close
[0m05:18:01.129171 [info ] [Thread-1 (]: 24 of 27 PASS not_null_stock_prices_low ........................................ [[32mPASS[0m in 0.55s]
[0m05:18:01.132190 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_low.e65294ca15
[0m05:18:01.133522 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_open.e09b13f215
[0m05:18:01.134515 [info ] [Thread-1 (]: 25 of 27 START test not_null_stock_prices_open ................................. [RUN]
[0m05:18:01.135992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_low.e65294ca15, now test.stock_dbt.not_null_stock_prices_open.e09b13f215)
[0m05:18:01.137037 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_open.e09b13f215
[0m05:18:01.140886 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_open.e09b13f215"
[0m05:18:01.150577 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_open.e09b13f215
[0m05:18:01.152774 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_open.e09b13f215"
[0m05:18:01.164476 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_open.e09b13f215"
[0m05:18:01.165673 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_open.e09b13f215: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_open.e09b13f215"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from dev.analytics.stock_prices
where open is null



      
    ) dbt_internal_test
[0m05:18:01.166492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:18:01.236428 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.363 seconds
[0m05:18:01.239270 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_low.e65294ca15: Close
[0m05:18:01.358689 [info ] [Thread-1 (]: 24 of 27 PASS not_null_stock_prices_low ........................................ [[32mPASS[0m in 0.52s]
[0m05:18:01.361030 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_low.e65294ca15
[0m05:18:01.362658 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_open.e09b13f215
[0m05:18:01.364034 [info ] [Thread-1 (]: 25 of 27 START test not_null_stock_prices_open ................................. [RUN]
[0m05:18:01.365057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_low.e65294ca15, now test.stock_dbt.not_null_stock_prices_open.e09b13f215)
[0m05:18:01.366061 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_open.e09b13f215
[0m05:18:01.369978 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_open.e09b13f215"
[0m05:18:01.378846 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_open.e09b13f215
[0m05:18:01.381127 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_open.e09b13f215"
[0m05:18:01.389495 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_open.e09b13f215"
[0m05:18:01.391268 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_open.e09b13f215: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_open.e09b13f215"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from dev.analytics.stock_prices
where open is null



      
    ) dbt_internal_test
[0m05:18:01.392861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:18:01.608837 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.442 seconds
[0m05:18:01.612359 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_open.e09b13f215: Close
[0m05:18:01.727492 [info ] [Thread-1 (]: 25 of 27 PASS not_null_stock_prices_open ....................................... [[32mPASS[0m in 0.59s]
[0m05:18:01.729352 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_open.e09b13f215
[0m05:18:01.730520 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8
[0m05:18:01.732120 [info ] [Thread-1 (]: 26 of 27 START test not_null_stock_prices_symbol ............................... [RUN]
[0m05:18:01.733640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_open.e09b13f215, now test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8)
[0m05:18:01.735522 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8
[0m05:18:01.740655 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8"
[0m05:18:01.753064 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8
[0m05:18:01.756086 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8"
[0m05:18:01.769452 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8"
[0m05:18:01.770656 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.stock_prices
where symbol is null



      
    ) dbt_internal_test
[0m05:18:01.771673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:18:01.820142 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.427 seconds
[0m05:18:01.824204 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_open.e09b13f215: Close
[0m05:18:01.942624 [info ] [Thread-1 (]: 25 of 27 PASS not_null_stock_prices_open ....................................... [[32mPASS[0m in 0.58s]
[0m05:18:01.944691 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_open.e09b13f215
[0m05:18:01.946052 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8
[0m05:18:01.947349 [info ] [Thread-1 (]: 26 of 27 START test not_null_stock_prices_symbol ............................... [RUN]
[0m05:18:01.948573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_open.e09b13f215, now test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8)
[0m05:18:01.949977 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8
[0m05:18:01.954260 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8"
[0m05:18:01.960792 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8
[0m05:18:01.962862 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8"
[0m05:18:01.972179 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8"
[0m05:18:01.972777 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.stock_prices
where symbol is null



      
    ) dbt_internal_test
[0m05:18:01.973586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:18:02.133341 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.361 seconds
[0m05:18:02.136264 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8: Close
[0m05:18:02.275229 [info ] [Thread-1 (]: 26 of 27 PASS not_null_stock_prices_symbol ..................................... [[32mPASS[0m in 0.54s]
[0m05:18:02.279561 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8
[0m05:18:02.281259 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_volume.71420bc956
[0m05:18:02.282480 [info ] [Thread-1 (]: 27 of 27 START test not_null_stock_prices_volume ............................... [RUN]
[0m05:18:02.283751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8, now test.stock_dbt.not_null_stock_prices_volume.71420bc956)
[0m05:18:02.284992 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_volume.71420bc956
[0m05:18:02.289234 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_volume.71420bc956"
[0m05:18:02.297995 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_volume.71420bc956
[0m05:18:02.300130 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_volume.71420bc956"
[0m05:18:02.312078 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_volume.71420bc956"
[0m05:18:02.313067 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_volume.71420bc956: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_volume.71420bc956"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume
from dev.analytics.stock_prices
where volume is null



      
    ) dbt_internal_test
[0m05:18:02.314381 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:18:02.368329 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.395 seconds
[0m05:18:02.370922 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8: Close
[0m05:18:02.507043 [info ] [Thread-1 (]: 26 of 27 PASS not_null_stock_prices_symbol ..................................... [[32mPASS[0m in 0.56s]
[0m05:18:02.508319 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8
[0m05:18:02.509483 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_stock_prices_volume.71420bc956
[0m05:18:02.510661 [info ] [Thread-1 (]: 27 of 27 START test not_null_stock_prices_volume ............................... [RUN]
[0m05:18:02.511775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_stock_prices_symbol.3c41a80ff8, now test.stock_dbt.not_null_stock_prices_volume.71420bc956)
[0m05:18:02.512695 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_stock_prices_volume.71420bc956
[0m05:18:02.516019 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_stock_prices_volume.71420bc956"
[0m05:18:02.524623 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_stock_prices_volume.71420bc956
[0m05:18:02.526886 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_stock_prices_volume.71420bc956"
[0m05:18:02.534648 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_stock_prices_volume.71420bc956"
[0m05:18:02.536304 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_volume.71420bc956: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_stock_prices_volume.71420bc956"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume
from dev.analytics.stock_prices
where volume is null



      
    ) dbt_internal_test
[0m05:18:02.537516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:18:02.687124 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.373 seconds
[0m05:18:02.690271 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_volume.71420bc956: Close
[0m05:18:02.811991 [info ] [Thread-1 (]: 27 of 27 PASS not_null_stock_prices_volume ..................................... [[32mPASS[0m in 0.53s]
[0m05:18:02.814864 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_volume.71420bc956
[0m05:18:02.817270 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:18:02.818230 [debug] [MainThread]: Connection 'test.stock_dbt.not_null_stock_prices_volume.71420bc956' was properly closed.
[0m05:18:02.819404 [info ] [MainThread]: 
[0m05:18:02.820736 [info ] [MainThread]: Finished running 27 data tests in 0 hours 0 minutes and 17.58 seconds (17.58s).
[0m05:18:02.824072 [debug] [MainThread]: Command end result
[0m05:18:02.877782 [info ] [MainThread]: 
[0m05:18:02.879761 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:18:02.881031 [info ] [MainThread]: 
[0m05:18:02.882277 [info ] [MainThread]: Done. PASS=27 WARN=0 ERROR=0 SKIP=0 TOTAL=27
[0m05:18:02.883681 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 18.859165, "process_user_time": 3.859631, "process_kernel_time": 2.944979, "process_mem_max_rss": "232720", "process_in_blocks": "1976", "process_out_blocks": "8"}
[0m05:18:02.884782 [debug] [MainThread]: Command `dbt test` succeeded at 05:18:02.884689 after 18.86 seconds
[0m05:18:02.886240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78ad27e630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78ad4a4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f784f9b6570>]}
[0m05:18:02.887845 [debug] [MainThread]: Flushing usage events
[0m05:18:02.895139 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.358 seconds
[0m05:18:02.897316 [debug] [Thread-1 (]: On test.stock_dbt.not_null_stock_prices_volume.71420bc956: Close
[0m05:18:03.012434 [info ] [Thread-1 (]: 27 of 27 PASS not_null_stock_prices_volume ..................................... [[32mPASS[0m in 0.50s]
[0m05:18:03.015208 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_stock_prices_volume.71420bc956
[0m05:18:03.018535 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:18:03.020173 [debug] [MainThread]: Connection 'test.stock_dbt.not_null_stock_prices_volume.71420bc956' was properly closed.
[0m05:18:03.022079 [info ] [MainThread]: 
[0m05:18:03.023529 [info ] [MainThread]: Finished running 27 data tests in 0 hours 0 minutes and 16.60 seconds (16.60s).
[0m05:18:03.027243 [debug] [MainThread]: Command end result
[0m05:18:03.095260 [info ] [MainThread]: 
[0m05:18:03.097166 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:18:03.098985 [info ] [MainThread]: 
[0m05:18:03.101223 [info ] [MainThread]: Done. PASS=27 WARN=0 ERROR=0 SKIP=0 TOTAL=27
[0m05:18:03.103929 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 17.899023, "process_user_time": 3.740667, "process_kernel_time": 3.120611, "process_mem_max_rss": "234344", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m05:18:03.106019 [debug] [MainThread]: Command `dbt test` succeeded at 05:18:03.105923 after 17.90 seconds
[0m05:18:03.108230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e42aca060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e42cf4bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3de80bbcb0>]}
[0m05:18:03.109974 [debug] [MainThread]: Flushing usage events
[0m05:18:04.750636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe730da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbea9eb620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe6a39ee0>]}


============================== 05:18:04.755673 | 789560f2-a110-4427-8b56-7104a1d12990 ==============================
[0m05:18:04.755673 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:18:04.757346 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/stock_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/stock_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/stock_dbt --project-dir /opt/airflow/stock_dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:18:05.323359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40bc5261b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40bbe3cce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40bcfa6780>]}


============================== 05:18:05.328095 | b4a4bf27-2375-4523-b9f4-63d6fd6219ff ==============================
[0m05:18:05.328095 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:18:05.329608 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/stock_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/stock_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/stock_dbt --project-dir /opt/airflow/stock_dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:18:05.374465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '789560f2-a110-4427-8b56-7104a1d12990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb8ed80950>]}
[0m05:18:05.446092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '789560f2-a110-4427-8b56-7104a1d12990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb90934560>]}
[0m05:18:05.449517 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:18:05.488017 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:18:05.928374 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:18:05.929849 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:18:05.966422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '789560f2-a110-4427-8b56-7104a1d12990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbea839e20>]}
[0m05:18:05.985344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4a4bf27-2375-4523-b9f4-63d6fd6219ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f405eb5c560>]}
[0m05:18:06.027032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4a4bf27-2375-4523-b9f4-63d6fd6219ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f405f231040>]}
[0m05:18:06.030390 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:18:06.039957 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:18:06.106422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '789560f2-a110-4427-8b56-7104a1d12990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb8cf055e0>]}
[0m05:18:06.108762 [info ] [MainThread]: Found 5 models, 4 snapshots, 27 data tests, 1 source, 459 macros
[0m05:18:06.110654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '789560f2-a110-4427-8b56-7104a1d12990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb8cedd490>]}
[0m05:18:06.113818 [info ] [MainThread]: 
[0m05:18:06.115566 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:18:06.120484 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m05:18:06.132679 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m05:18:06.134453 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m05:18:06.136213 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:18:06.462578 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:18:06.464855 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:18:06.504754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4a4bf27-2375-4523-b9f4-63d6fd6219ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f405e483530>]}
[0m05:18:06.562888 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.427 seconds
[0m05:18:06.566216 [debug] [ThreadPool]: On list_dev: Close
[0m05:18:06.651741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4a4bf27-2375-4523-b9f4-63d6fd6219ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f405e232cc0>]}
[0m05:18:06.653798 [info ] [MainThread]: Found 5 models, 4 snapshots, 27 data tests, 1 source, 459 macros
[0m05:18:06.655794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4a4bf27-2375-4523-b9f4-63d6fd6219ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f405e169c10>]}
[0m05:18:06.659008 [info ] [MainThread]: 
[0m05:18:06.660932 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:18:06.665389 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m05:18:06.676655 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m05:18:06.678269 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m05:18:06.679955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:18:06.695762 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_snapshot)
[0m05:18:06.703617 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m05:18:06.705444 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m05:18:06.707065 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:18:07.091447 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.411 seconds
[0m05:18:07.096215 [debug] [ThreadPool]: On list_dev: Close
[0m05:18:07.132289 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.425 seconds
[0m05:18:07.138550 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m05:18:07.219534 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m05:18:07.227796 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m05:18:07.228844 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m05:18:07.229747 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:18:07.266448 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m05:18:07.270274 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m05:18:07.271593 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m05:18:07.273124 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:18:07.671315 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.398 seconds
[0m05:18:07.674313 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m05:18:07.687694 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.458 seconds
[0m05:18:07.690794 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m05:18:07.791956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '789560f2-a110-4427-8b56-7104a1d12990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb8cf061e0>]}
[0m05:18:07.793715 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:18:07.795434 [info ] [MainThread]: 
[0m05:18:07.800168 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m05:18:07.803008 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.snapshot_atr
[0m05:18:07.803276 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m05:18:07.804746 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m05:18:07.804793 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshot.snapshot_atr .................................... [RUN]
[0m05:18:07.805991 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:18:07.806414 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now snapshot.stock_dbt.snapshot_atr)
[0m05:18:07.807710 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.snapshot_atr
[0m05:18:07.814608 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.snapshot_atr
[0m05:18:07.862183 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:18:07.864954 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
[0m05:18:07.867092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:18:08.176579 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.370 seconds
[0m05:18:08.180306 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m05:18:08.226425 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.359 seconds
[0m05:18:08.264660 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:18:08.269817 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.avg_true_range


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m05:18:08.337993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4a4bf27-2375-4523-b9f4-63d6fd6219ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f405e834c20>]}
[0m05:18:08.340768 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:18:08.342408 [info ] [MainThread]: 
[0m05:18:08.350406 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.snapshot_atr
[0m05:18:08.352219 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshot.snapshot_atr .................................... [RUN]
[0m05:18:08.353881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now snapshot.stock_dbt.snapshot_atr)
[0m05:18:08.355300 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.snapshot_atr
[0m05:18:08.361019 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.snapshot_atr
[0m05:18:08.398218 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:18:08.400556 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
[0m05:18:08.402646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:18:08.750228 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.347 seconds
[0m05:18:08.786330 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:18:08.788631 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.avg_true_range


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m05:18:09.029300 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.757 seconds
[0m05:18:09.035443 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:18:09.037889 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
[0m05:18:09.133089 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.093 seconds
[0m05:18:09.141436 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:18:09.144286 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
[0m05:18:09.267765 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.121 seconds
[0m05:18:09.273314 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:18:09.276181 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
[0m05:18:09.395652 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.118 seconds
[0m05:18:09.400224 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:18:09.401788 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
[0m05:18:09.503168 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.099 seconds
[0m05:18:09.510660 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:18:09.512860 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
[0m05:18:09.526043 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.735 seconds
[0m05:18:09.529474 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:18:09.530689 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
[0m05:18:09.588831 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.074 seconds
[0m05:18:09.606909 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:18:09.608710 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.avg_true_range


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m05:18:09.630118 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.098 seconds
[0m05:18:09.633428 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:18:09.634326 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
[0m05:18:09.740271 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.105 seconds
[0m05:18:09.746730 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:18:09.749218 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
[0m05:18:09.814471 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.203 seconds
[0m05:18:09.819653 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:18:09.820355 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m05:18:09.832065 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.081 seconds
[0m05:18:09.835127 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:18:09.836017 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
[0m05:18:09.962127 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.141 seconds
[0m05:18:09.963491 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.snapshot_atr"
[0m05:18:09.965495 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.129 seconds
[0m05:18:09.971281 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:18:09.972579 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
[0m05:18:09.982377 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:18:09.985272 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
BEGIN
[0m05:18:10.045482 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.071 seconds
[0m05:18:10.064277 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:18:10.067489 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.avg_true_range


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m05:18:10.090714 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.103 seconds
[0m05:18:10.092506 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:18:10.093648 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_ATR" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATE", "SYMBOL", "ATR_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATE", "SYMBOL", "ATR_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m05:18:10.253691 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.184 seconds
[0m05:18:10.259535 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:18:10.261133 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m05:18:10.334513 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.071 seconds
[0m05:18:10.337101 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.snapshot_atr"
[0m05:18:10.348472 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:18:10.349568 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
BEGIN
[0m05:18:10.455488 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.104 seconds
[0m05:18:10.458619 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:18:10.461088 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_ATR" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATE", "SYMBOL", "ATR_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATE", "SYMBOL", "ATR_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m05:18:10.632290 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.537 seconds
[0m05:18:10.634807 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:18:10.635925 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
COMMIT
[0m05:18:10.912488 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.276 seconds
[0m05:18:10.931276 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: Close
[0m05:18:11.038805 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '789560f2-a110-4427-8b56-7104a1d12990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb8d38c4d0>]}
[0m05:18:11.041060 [info ] [Thread-1 (]: 1 of 4 OK snapshotted snapshot.snapshot_atr .................................... [[32mSUCCESS 0[0m in 3.23s]
[0m05:18:11.042749 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.snapshot_atr
[0m05:18:11.044232 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.snapshot_bollinger
[0m05:18:11.045362 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshot.snapshot_bollinger .............................. [RUN]
[0m05:18:11.046669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_dbt.snapshot_atr, now snapshot.stock_dbt.snapshot_bollinger)
[0m05:18:11.047914 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.snapshot_bollinger
[0m05:18:11.051224 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.snapshot_bollinger
[0m05:18:11.054593 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:18:11.055418 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
[0m05:18:11.056307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:18:11.361642 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.899 seconds
[0m05:18:11.364020 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_atr"
[0m05:18:11.365571 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_atr"} */
COMMIT
[0m05:18:11.498783 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.442 seconds
[0m05:18:11.505746 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:18:11.506920 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.bollinger


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m05:18:11.575521 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.208 seconds
[0m05:18:11.594080 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_atr: Close
[0m05:18:11.711501 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4a4bf27-2375-4523-b9f4-63d6fd6219ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f405e610680>]}
[0m05:18:11.713393 [info ] [Thread-1 (]: 1 of 4 OK snapshotted snapshot.snapshot_atr .................................... [[32mSUCCESS 0[0m in 3.36s]
[0m05:18:11.714674 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.snapshot_atr
[0m05:18:11.716016 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.snapshot_bollinger
[0m05:18:11.717572 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshot.snapshot_bollinger .............................. [RUN]
[0m05:18:11.718808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_dbt.snapshot_atr, now snapshot.stock_dbt.snapshot_bollinger)
[0m05:18:11.720001 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.snapshot_bollinger
[0m05:18:11.723385 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.snapshot_bollinger
[0m05:18:11.726679 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:18:11.727621 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
[0m05:18:11.728707 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:18:12.155658 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.427 seconds
[0m05:18:12.164089 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:18:12.165508 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.bollinger


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m05:18:12.326048 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.818 seconds
[0m05:18:12.331656 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:18:12.333782 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
[0m05:18:12.425269 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.089 seconds
[0m05:18:12.430496 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:18:12.432888 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
[0m05:18:12.520177 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.085 seconds
[0m05:18:12.526436 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:18:12.528643 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
[0m05:18:12.605524 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.075 seconds
[0m05:18:12.611096 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:18:12.613137 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
[0m05:18:12.683283 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.068 seconds
[0m05:18:12.689182 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:18:12.692040 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
[0m05:18:12.778453 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.084 seconds
[0m05:18:12.783876 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:18:12.785357 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.bollinger


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m05:18:12.816731 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.650 seconds
[0m05:18:12.820994 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:18:12.822853 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
[0m05:18:12.930698 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.144 seconds
[0m05:18:12.933356 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:18:12.934867 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m05:18:12.958528 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.134 seconds
[0m05:18:12.963039 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:18:12.964300 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
[0m05:18:13.029902 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.093 seconds
[0m05:18:13.032273 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.snapshot_bollinger"
[0m05:18:13.046558 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.081 seconds
[0m05:18:13.050947 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:18:13.052698 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
[0m05:18:13.055010 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:18:13.056165 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
BEGIN
[0m05:18:13.144678 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.090 seconds
[0m05:18:13.149793 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:18:13.151736 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
[0m05:18:13.224516 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.167 seconds
[0m05:18:13.226396 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:18:13.227835 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "SMA_20D", "UPPER_BAND", "LOWER_BAND", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "SMA_20D", "UPPER_BAND", "LOWER_BAND", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m05:18:13.246985 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.094 seconds
[0m05:18:13.252995 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:18:13.255404 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
[0m05:18:13.343506 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.087 seconds
[0m05:18:13.350712 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:18:13.352857 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.bollinger


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m05:18:13.518371 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.163 seconds
[0m05:18:13.520319 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:18:13.521419 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m05:18:13.616773 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.094 seconds
[0m05:18:13.619009 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.snapshot_bollinger"
[0m05:18:13.629818 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:18:13.631110 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
BEGIN
[0m05:18:13.753660 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.524 seconds
[0m05:18:13.756973 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.125 seconds
[0m05:18:13.756583 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:18:13.758395 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:18:13.758670 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
COMMIT
[0m05:18:13.760035 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "SMA_20D", "UPPER_BAND", "LOWER_BAND", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "SMA_20D", "UPPER_BAND", "LOWER_BAND", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m05:18:14.069130 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.308 seconds
[0m05:18:14.074140 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: Close
[0m05:18:14.189061 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '789560f2-a110-4427-8b56-7104a1d12990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb8c43bd10>]}
[0m05:18:14.191701 [info ] [Thread-1 (]: 2 of 4 OK snapshotted snapshot.snapshot_bollinger .............................. [[32mSUCCESS 0[0m in 3.14s]
[0m05:18:14.194918 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.snapshot_bollinger
[0m05:18:14.197157 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.snapshot_moving_avg
[0m05:18:14.198278 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshot.snapshot_moving_avg ............................. [RUN]
[0m05:18:14.200058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_dbt.snapshot_bollinger, now snapshot.stock_dbt.snapshot_moving_avg)
[0m05:18:14.200976 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.snapshot_moving_avg
[0m05:18:14.203897 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.snapshot_moving_avg
[0m05:18:14.207619 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:18:14.208859 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
[0m05:18:14.209546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:18:14.407518 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.647 seconds
[0m05:18:14.410161 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_bollinger"
[0m05:18:14.411961 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_bollinger"} */
COMMIT
[0m05:18:14.570456 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.361 seconds
[0m05:18:14.579803 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:18:14.581835 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.moving_average


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m05:18:14.683602 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.269 seconds
[0m05:18:14.689084 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_bollinger: Close
[0m05:18:14.817417 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4a4bf27-2375-4523-b9f4-63d6fd6219ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f405d6c2bd0>]}
[0m05:18:14.819880 [info ] [Thread-1 (]: 2 of 4 OK snapshotted snapshot.snapshot_bollinger .............................. [[32mSUCCESS 0[0m in 3.10s]
[0m05:18:14.821442 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.snapshot_bollinger
[0m05:18:14.822914 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.snapshot_moving_avg
[0m05:18:14.824381 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshot.snapshot_moving_avg ............................. [RUN]
[0m05:18:14.825536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_dbt.snapshot_bollinger, now snapshot.stock_dbt.snapshot_moving_avg)
[0m05:18:14.826677 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.snapshot_moving_avg
[0m05:18:14.829613 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.snapshot_moving_avg
[0m05:18:14.833348 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:18:14.834305 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
[0m05:18:14.835069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:18:15.186315 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.351 seconds
[0m05:18:15.193927 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:18:15.195157 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.moving_average


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m05:18:15.317617 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.734 seconds
[0m05:18:15.322276 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:18:15.324019 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
[0m05:18:15.406636 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.081 seconds
[0m05:18:15.411083 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:18:15.413106 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
[0m05:18:15.530235 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.115 seconds
[0m05:18:15.536113 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:18:15.537343 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
[0m05:18:15.607148 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.068 seconds
[0m05:18:15.613002 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:18:15.615577 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
[0m05:18:15.691011 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.073 seconds
[0m05:18:15.697163 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:18:15.699926 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
[0m05:18:15.778600 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.077 seconds
[0m05:18:15.785704 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:18:15.787341 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.moving_average


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m05:18:15.788752 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.592 seconds
[0m05:18:15.792184 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:18:15.793749 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
[0m05:18:15.881016 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.086 seconds
[0m05:18:15.885155 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:18:15.886920 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
[0m05:18:16.005808 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.217 seconds
[0m05:18:16.009801 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:18:16.011000 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m05:18:16.014134 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.125 seconds
[0m05:18:16.017657 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:18:16.019349 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
[0m05:18:16.186035 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.174 seconds
[0m05:18:16.188643 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:18:16.195311 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.174 seconds
[0m05:18:16.199511 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:18:16.199698 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:18:16.200810 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
[0m05:18:16.201097 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
BEGIN
[0m05:18:16.269691 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.068 seconds
[0m05:18:16.275724 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:18:16.277324 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
[0m05:18:16.327411 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.125 seconds
[0m05:18:16.329971 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:18:16.332312 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "MOVING_AVG_5D", "MOVING_AVG_20D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "MOVING_AVG_5D", "MOVING_AVG_20D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m05:18:16.365955 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.087 seconds
[0m05:18:16.371000 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:18:16.371962 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.moving_average


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m05:18:16.531343 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.158 seconds
[0m05:18:16.534875 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:18:16.536854 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m05:18:16.605479 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.067 seconds
[0m05:18:16.609436 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:18:16.622286 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:18:16.623349 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
BEGIN
[0m05:18:16.724810 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.100 seconds
[0m05:18:16.724581 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.390 seconds
[0m05:18:16.727581 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:18:16.728117 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:18:16.729264 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "MOVING_AVG_5D", "MOVING_AVG_20D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "MOVING_AVG_5D", "MOVING_AVG_20D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m05:18:16.729617 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
COMMIT
[0m05:18:17.182114 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.451 seconds
[0m05:18:17.186940 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: Close
[0m05:18:17.306798 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '789560f2-a110-4427-8b56-7104a1d12990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb8cf05d30>]}
[0m05:18:17.309238 [info ] [Thread-1 (]: 3 of 4 OK snapshotted snapshot.snapshot_moving_avg ............................. [[32mSUCCESS 0[0m in 3.11s]
[0m05:18:17.311198 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.snapshot_moving_avg
[0m05:18:17.312572 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.snapshot_rsi
[0m05:18:17.313734 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshot.snapshot_rsi .................................... [RUN]
[0m05:18:17.315227 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_dbt.snapshot_moving_avg, now snapshot.stock_dbt.snapshot_rsi)
[0m05:18:17.316621 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.snapshot_rsi
[0m05:18:17.319816 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.snapshot_rsi
[0m05:18:17.323724 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:18:17.324587 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m05:18:17.325540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:18:17.616329 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.885 seconds
[0m05:18:17.619460 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_moving_avg"
[0m05:18:17.621394 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_moving_avg"} */
COMMIT
[0m05:18:17.844411 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.519 seconds
[0m05:18:17.850478 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:18:17.852535 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.rsi_calculation


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m05:18:17.939890 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.317 seconds
[0m05:18:17.944788 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_moving_avg: Close
[0m05:18:18.069868 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4a4bf27-2375-4523-b9f4-63d6fd6219ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f405e1ac560>]}
[0m05:18:18.072412 [info ] [Thread-1 (]: 3 of 4 OK snapshotted snapshot.snapshot_moving_avg ............................. [[32mSUCCESS 0[0m in 3.24s]
[0m05:18:18.074266 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.snapshot_moving_avg
[0m05:18:18.076115 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.snapshot_rsi
[0m05:18:18.077403 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshot.snapshot_rsi .................................... [RUN]
[0m05:18:18.078990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_dbt.snapshot_moving_avg, now snapshot.stock_dbt.snapshot_rsi)
[0m05:18:18.080248 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.snapshot_rsi
[0m05:18:18.083651 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.snapshot_rsi
[0m05:18:18.087027 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:18:18.088684 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m05:18:18.090230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:18:18.496298 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.406 seconds
[0m05:18:18.503978 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:18:18.505485 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.rsi_calculation


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m05:18:18.570126 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.715 seconds
[0m05:18:18.576171 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:18:18.579295 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m05:18:18.670659 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.089 seconds
[0m05:18:18.675613 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:18:18.677105 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m05:18:18.789918 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.111 seconds
[0m05:18:18.795898 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:18:18.798854 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m05:18:18.922238 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.122 seconds
[0m05:18:18.928061 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:18:18.929946 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m05:18:19.010222 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.079 seconds
[0m05:18:19.015463 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:18:19.017041 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m05:18:19.083259 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.065 seconds
[0m05:18:19.083112 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.576 seconds
[0m05:18:19.087656 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:18:19.089535 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m05:18:19.089464 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:18:19.090868 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.rsi_calculation


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m05:18:19.199171 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.108 seconds
[0m05:18:19.206250 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:18:19.208897 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m05:18:19.262512 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.170 seconds
[0m05:18:19.266295 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:18:19.268776 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m05:18:19.296361 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.085 seconds
[0m05:18:19.301480 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:18:19.303404 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m05:18:19.335523 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.065 seconds
[0m05:18:19.338072 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.snapshot_rsi"
[0m05:18:19.348054 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:18:19.349231 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
BEGIN
[0m05:18:19.378808 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.074 seconds
[0m05:18:19.383044 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:18:19.384740 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m05:18:19.468845 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.083 seconds
[0m05:18:19.476277 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:18:19.477233 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.127 seconds
[0m05:18:19.478522 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m05:18:19.479222 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:18:19.480648 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_RSI" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "AVG_GAIN", "AVG_LOSS", "RSI_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "AVG_GAIN", "AVG_LOSS", "RSI_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m05:18:19.600885 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.120 seconds
[0m05:18:19.609238 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:18:19.611598 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.rsi_calculation


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m05:18:19.811562 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.198 seconds
[0m05:18:19.815615 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:18:19.817681 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m05:18:19.911903 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.092 seconds
[0m05:18:19.914951 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.snapshot_rsi"
[0m05:18:19.926339 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:18:19.928025 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
BEGIN
[0m05:18:19.975247 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.493 seconds
[0m05:18:19.977834 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:18:19.979306 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
COMMIT
[0m05:18:20.077308 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.148 seconds
[0m05:18:20.078544 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:18:20.079700 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_RSI" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "AVG_GAIN", "AVG_LOSS", "RSI_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "AVG_GAIN", "AVG_LOSS", "RSI_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m05:18:20.343019 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.362 seconds
[0m05:18:20.347141 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: Close
[0m05:18:20.457190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '789560f2-a110-4427-8b56-7104a1d12990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb8c45b7a0>]}
[0m05:18:20.459757 [info ] [Thread-1 (]: 4 of 4 OK snapshotted snapshot.snapshot_rsi .................................... [[32mSUCCESS 0[0m in 3.14s]
[0m05:18:20.462093 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.snapshot_rsi
[0m05:18:20.464473 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:18:20.465286 [debug] [MainThread]: Connection 'snapshot.stock_dbt.snapshot_rsi' was properly closed.
[0m05:18:20.466466 [info ] [MainThread]: 
[0m05:18:20.467326 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 14.35 seconds (14.35s).
[0m05:18:20.469464 [debug] [MainThread]: Command end result
[0m05:18:20.588520 [info ] [MainThread]: 
[0m05:18:20.590148 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:18:20.592364 [info ] [MainThread]: 
[0m05:18:20.594304 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m05:18:20.595750 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 15.917001, "process_user_time": 3.268675, "process_kernel_time": 2.842263, "process_mem_max_rss": "246732", "process_in_blocks": "8", "process_out_blocks": "8"}
[0m05:18:20.597573 [debug] [MainThread]: Command `dbt snapshot` succeeded at 05:18:20.597471 after 15.92 seconds
[0m05:18:20.599201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe6d8ecc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe93084a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb8cfdbcb0>]}
[0m05:18:20.600193 [debug] [MainThread]: Flushing usage events
[0m05:18:20.668679 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.588 seconds
[0m05:18:20.672119 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_rsi"
[0m05:18:20.674346 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_rsi"} */
COMMIT
[0m05:18:21.001901 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.325 seconds
[0m05:18:21.004522 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_rsi: Close
[0m05:18:21.121264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4a4bf27-2375-4523-b9f4-63d6fd6219ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f405d6e0350>]}
[0m05:18:21.123271 [info ] [Thread-1 (]: 4 of 4 OK snapshotted snapshot.snapshot_rsi .................................... [[32mSUCCESS 0[0m in 3.04s]
[0m05:18:21.124643 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.snapshot_rsi
[0m05:18:21.126397 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:18:21.127871 [debug] [MainThread]: Connection 'snapshot.stock_dbt.snapshot_rsi' was properly closed.
[0m05:18:21.130086 [info ] [MainThread]: 
[0m05:18:21.131687 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 14.47 seconds (14.47s).
[0m05:18:21.133401 [debug] [MainThread]: Command end result
[0m05:18:21.289149 [info ] [MainThread]: 
[0m05:18:21.290522 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:18:21.292616 [info ] [MainThread]: 
[0m05:18:21.295046 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m05:18:21.296732 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 16.049164, "process_user_time": 3.358908, "process_kernel_time": 2.899058, "process_mem_max_rss": "248240", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m05:18:21.298666 [debug] [MainThread]: Command `dbt snapshot` succeeded at 05:18:21.298572 after 16.05 seconds
[0m05:18:21.300138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40bbe3cce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f405d80acf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f405d80b9e0>]}
[0m05:18:21.301663 [debug] [MainThread]: Flushing usage events
