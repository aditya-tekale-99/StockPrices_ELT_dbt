[0m21:37:11.529466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fe6120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104937ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104937d90>]}


============================== 21:37:11.531824 | 91b5eb55-a499-458d-9a8d-f992253a7aaa ==============================
[0m21:37:11.531824 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:37:11.532113 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/stock_prediction/logs', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m21:37:11.539482 [info ] [MainThread]: dbt version: 1.8.7
[0m21:37:11.539671 [info ] [MainThread]: python version: 3.13.0
[0m21:37:11.539795 [info ] [MainThread]: python path: /Users/adi/Downloads/DATA226/dbtVirtual/bin/python3.13
[0m21:37:11.539909 [info ] [MainThread]: os info: macOS-15.1-arm64-arm-64bit-Mach-O
[0m21:37:11.661701 [info ] [MainThread]: Using profiles dir at /Users/adi/.dbt
[0m21:37:11.661944 [info ] [MainThread]: Using profiles.yml file at /Users/adi/.dbt/profiles.yml
[0m21:37:11.662066 [info ] [MainThread]: Using dbt_project.yml file at /Users/adi/Downloads/DATA226/stock_prediction/dbt_project.yml
[0m21:37:11.663205 [info ] [MainThread]: adapter type: snowflake
[0m21:37:11.663414 [info ] [MainThread]: adapter version: 1.8.4
[0m21:37:11.701512 [info ] [MainThread]: Configuration:
[0m21:37:11.701773 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:37:11.701899 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:37:11.702002 [info ] [MainThread]: Required dependencies:
[0m21:37:11.702203 [debug] [MainThread]: Executing "git --help"
[0m21:37:11.719532 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:37:11.720076 [debug] [MainThread]: STDERR: "b''"
[0m21:37:11.720270 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:37:11.720411 [info ] [MainThread]: Connection:
[0m21:37:11.720584 [info ] [MainThread]:   account: oqkqedn-jzb09886
[0m21:37:11.720693 [info ] [MainThread]:   user: adityatekale
[0m21:37:11.720791 [info ] [MainThread]:   database: dev
[0m21:37:11.720888 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m21:37:11.720979 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m21:37:11.721076 [info ] [MainThread]:   schema: analytics
[0m21:37:11.721171 [info ] [MainThread]:   authenticator: None
[0m21:37:11.721260 [info ] [MainThread]:   oauth_client_id: None
[0m21:37:11.721361 [info ] [MainThread]:   query_tag: None
[0m21:37:11.721455 [info ] [MainThread]:   client_session_keep_alive: False
[0m21:37:11.721548 [info ] [MainThread]:   host: None
[0m21:37:11.721640 [info ] [MainThread]:   port: None
[0m21:37:11.721729 [info ] [MainThread]:   proxy_host: None
[0m21:37:11.721821 [info ] [MainThread]:   proxy_port: None
[0m21:37:11.721909 [info ] [MainThread]:   protocol: None
[0m21:37:11.721997 [info ] [MainThread]:   connect_retries: 1
[0m21:37:11.722085 [info ] [MainThread]:   connect_timeout: None
[0m21:37:11.722175 [info ] [MainThread]:   retry_on_database_errors: False
[0m21:37:11.722265 [info ] [MainThread]:   retry_all: False
[0m21:37:11.722412 [info ] [MainThread]:   insecure_mode: False
[0m21:37:11.722595 [info ] [MainThread]:   reuse_connections: None
[0m21:37:11.722978 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:37:11.727784 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m21:37:11.728734 [debug] [MainThread]: Using snowflake connection "debug"
[0m21:37:11.728878 [debug] [MainThread]: On debug: select 1 as id
[0m21:37:11.728996 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:37:12.556224 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.826 seconds
[0m21:37:12.559687 [debug] [MainThread]: On debug: Close
[0m21:37:12.685624 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:37:12.686481 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:37:12.689354 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.1928697, "process_user_time": 0.849116, "process_kernel_time": 0.145941, "process_mem_max_rss": "126844928", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:37:12.690133 [debug] [MainThread]: Command `dbt debug` succeeded at 21:37:12.689983 after 1.19 seconds
[0m21:37:12.691119 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:37:12.691967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055b36f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105789b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053fb020>]}
[0m21:37:12.692515 [debug] [MainThread]: Flushing usage events
[0m21:39:16.197698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107306120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c57ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c57d90>]}


============================== 21:39:16.200429 | b34c8fce-aec3-4132-a8ed-b6ca284c06b8 ==============================
[0m21:39:16.200429 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:39:16.200748 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/stock_prediction/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/stock_prediction', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:39:16.248659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b34c8fce-aec3-4132-a8ed-b6ca284c06b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ae68b0>]}
[0m21:39:16.256943 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.09352717, "process_user_time": 0.611989, "process_kernel_time": 0.1156, "process_mem_max_rss": "98287616", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:39:16.257209 [debug] [MainThread]: Command `dbt clean` succeeded at 21:39:16.257150 after 0.09 seconds
[0m21:39:16.257365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d9a470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d9a580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a06150>]}
[0m21:39:16.257500 [debug] [MainThread]: Flushing usage events
[0m10:08:36.183491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e4e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fb3ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fb3d90>]}


============================== 10:08:36.186725 | e590ef84-4846-4168-8679-bb3913b213fc ==============================
[0m10:08:36.186725 [info ] [MainThread]: Running with dbt=1.8.7
[0m10:08:36.187065 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'version_check': 'True', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:08:36.188620 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'stock_prediction'
[0m10:08:36.190545 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.042114582, "process_user_time": 0.553671, "process_kernel_time": 0.125678, "process_mem_max_rss": "95420416", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:08:36.190837 [debug] [MainThread]: Command `dbt run` failed at 10:08:36.190787 after 0.04 seconds
[0m10:08:36.191004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fe9350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b760f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ae7bd0>]}
[0m10:08:36.191161 [debug] [MainThread]: Flushing usage events
[0m10:09:05.503854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10281e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10436fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10436fd90>]}


============================== 10:09:05.506019 | b3893bb3-8323-4ac9-a80e-862e2b910a37 ==============================
[0m10:09:05.506019 [info ] [MainThread]: Running with dbt=1.8.7
[0m10:09:05.506310 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:09:05.765682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3893bb3-8323-4ac9-a80e-862e2b910a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105275a70>]}
[0m10:09:05.788672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3893bb3-8323-4ac9-a80e-862e2b910a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051d0490>]}
[0m10:09:05.789276 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m10:09:05.800062 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m10:09:05.800602 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:09:05.800792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b3893bb3-8323-4ac9-a80e-862e2b910a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105130050>]}
[0m10:09:06.337462 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.stock_prediction.transformations.rsi_calculation
- models.stock_prediction.transformations.moving_average
[0m10:09:06.342301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3893bb3-8323-4ac9-a80e-862e2b910a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ea47d0>]}
[0m10:09:06.385826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3893bb3-8323-4ac9-a80e-862e2b910a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053e9b70>]}
[0m10:09:06.386092 [info ] [MainThread]: Found 3 models, 2 sources, 459 macros
[0m10:09:06.386249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3893bb3-8323-4ac9-a80e-862e2b910a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105366ea0>]}
[0m10:09:06.387431 [info ] [MainThread]: 
[0m10:09:06.387701 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:09:06.389839 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m10:09:06.395895 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m10:09:06.396043 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m10:09:06.396163 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:09:07.378464 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.982 seconds
[0m10:09:07.384251 [debug] [ThreadPool]: On list_dev: Close
[0m10:09:07.529713 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m10:09:07.541751 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m10:09:07.542103 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m10:09:07.542355 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:09:07.977568 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.435 seconds
[0m10:09:07.983718 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m10:09:08.144894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3893bb3-8323-4ac9-a80e-862e2b910a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106407d10>]}
[0m10:09:08.145723 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:09:08.146138 [info ] [MainThread]: 
[0m10:09:08.150433 [debug] [Thread-1 (]: Began running node model.stock_prediction.stock_prices
[0m10:09:08.151108 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.stock_prices ............................. [RUN]
[0m10:09:08.151593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.stock_prediction.stock_prices)
[0m10:09:08.151950 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.stock_prices
[0m10:09:08.159750 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.stock_prices"
[0m10:09:08.161105 [debug] [Thread-1 (]: Began executing node model.stock_prediction.stock_prices
[0m10:09:08.182733 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.stock_prices"
[0m10:09:08.183768 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.stock_prices"
[0m10:09:08.183999 [debug] [Thread-1 (]: On model.stock_prediction.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.stock_prices"} */
create or replace   view dev.analytics.stock_prices
  
   as (
    SELECT
    symbol,
    date,
    open,
    high,
    low,
    close,
    volume
FROM dev.raw_data.stock_prices
  );
[0m10:09:08.184200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:09:09.258328 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.074 seconds
[0m10:09:09.289571 [debug] [Thread-1 (]: On model.stock_prediction.stock_prices: Close
[0m10:09:09.444632 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3893bb3-8323-4ac9-a80e-862e2b910a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106744e10>]}
[0m10:09:09.445761 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.stock_prices ........................ [[32mSUCCESS 1[0m in 1.29s]
[0m10:09:09.446592 [debug] [Thread-1 (]: Finished running node model.stock_prediction.stock_prices
[0m10:09:09.447859 [debug] [Thread-1 (]: Began running node model.stock_prediction.moving_average
[0m10:09:09.448608 [info ] [Thread-1 (]: 2 of 3 START sql view model analytics.moving_average ........................... [RUN]
[0m10:09:09.449099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.stock_prices, now model.stock_prediction.moving_average)
[0m10:09:09.449445 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.moving_average
[0m10:09:09.452623 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.moving_average"
[0m10:09:09.453894 [debug] [Thread-1 (]: Began executing node model.stock_prediction.moving_average
[0m10:09:09.457045 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.moving_average"
[0m10:09:09.458426 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.moving_average"
[0m10:09:09.458785 [debug] [Thread-1 (]: On model.stock_prediction.moving_average: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.moving_average"} */
create or replace   view dev.analytics.moving_average
  
   as (
    WITH stock_data AS (
    SELECT
        symbol,
        date,
        close
    FROM dev.analytics.stock_prices -- assuming 'stock_prices' is the name of the raw table model in dbt
)

SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
    ) AS moving_avg_5d,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
    ) AS moving_avg_20d
FROM stock_data
ORDER BY symbol, date;
[0m10:09:09.459109 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:09:09.896158 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b82101-0004-1d17-0001-97d30004ea16
[0m10:09:09.896823 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 27 at position 21 unexpected ';'.
[0m10:09:09.897358 [debug] [Thread-1 (]: On model.stock_prediction.moving_average: Close
[0m10:09:10.081900 [debug] [Thread-1 (]: Database Error in model moving_average (models/tranformations/moving_average.sql)
  001003 (42000): SQL compilation error:
  syntax error line 27 at position 21 unexpected ';'.
  compiled code at target/run/stock_prediction/models/tranformations/moving_average.sql
[0m10:09:10.082394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3893bb3-8323-4ac9-a80e-862e2b910a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067f7f70>]}
[0m10:09:10.082987 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model analytics.moving_average .................. [[31mERROR[0m in 0.63s]
[0m10:09:10.083465 [debug] [Thread-1 (]: Finished running node model.stock_prediction.moving_average
[0m10:09:10.083797 [debug] [Thread-1 (]: Began running node model.stock_prediction.rsi_calculation
[0m10:09:10.084811 [info ] [Thread-1 (]: 3 of 3 START sql view model analytics.rsi_calculation .......................... [RUN]
[0m10:09:10.085194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.moving_average, now model.stock_prediction.rsi_calculation)
[0m10:09:10.085440 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.rsi_calculation
[0m10:09:10.087992 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.rsi_calculation"
[0m10:09:10.088643 [debug] [Thread-1 (]: Began executing node model.stock_prediction.rsi_calculation
[0m10:09:10.091075 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.rsi_calculation"
[0m10:09:10.092308 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.rsi_calculation"
[0m10:09:10.092571 [debug] [Thread-1 (]: On model.stock_prediction.rsi_calculation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.rsi_calculation"} */
create or replace   view dev.analytics.rsi_calculation
  
   as (
    WITH stock_data AS (
    SELECT
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM dev.analytics.stock_prices
),

price_changes AS (
    SELECT
        symbol,
        date,
        close,
        CASE 
            WHEN close > prev_close THEN close - prev_close
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close < prev_close THEN prev_close - close
            ELSE 0 
        END AS loss
    FROM stock_data
),

average_gains_losses AS (
    SELECT
        symbol,
        date,
        close,
        AVG(gain) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain,
        AVG(loss) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss
    FROM price_changes
)

SELECT
    symbol,
    date,
    close,
    avg_gain,
    avg_loss,
    100 - (100 / (1 + (avg_gain / NULLIF(avg_loss, 0)))) AS rsi_14d
FROM average_gains_losses
ORDER BY symbol, date;
[0m10:09:10.092817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:09:10.466892 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b82101-0004-1d17-0001-97d30004ea1a
[0m10:09:10.467562 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 55 at position 21 unexpected ';'.
[0m10:09:10.468173 [debug] [Thread-1 (]: On model.stock_prediction.rsi_calculation: Close
[0m10:09:10.593818 [debug] [Thread-1 (]: Database Error in model rsi_calculation (models/tranformations/rsi_calculation.sql)
  001003 (42000): SQL compilation error:
  syntax error line 55 at position 21 unexpected ';'.
  compiled code at target/run/stock_prediction/models/tranformations/rsi_calculation.sql
[0m10:09:10.594324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3893bb3-8323-4ac9-a80e-862e2b910a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10637d6d0>]}
[0m10:09:10.594834 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model analytics.rsi_calculation ................. [[31mERROR[0m in 0.51s]
[0m10:09:10.595279 [debug] [Thread-1 (]: Finished running node model.stock_prediction.rsi_calculation
[0m10:09:10.596315 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:09:10.596564 [debug] [MainThread]: Connection 'model.stock_prediction.rsi_calculation' was properly closed.
[0m10:09:10.596810 [info ] [MainThread]: 
[0m10:09:10.597013 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 4.21 seconds (4.21s).
[0m10:09:10.597650 [debug] [MainThread]: Command end result
[0m10:09:10.615588 [info ] [MainThread]: 
[0m10:09:10.615825 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m10:09:10.615989 [info ] [MainThread]: 
[0m10:09:10.616182 [error] [MainThread]:   Database Error in model moving_average (models/tranformations/moving_average.sql)
  001003 (42000): SQL compilation error:
  syntax error line 27 at position 21 unexpected ';'.
  compiled code at target/run/stock_prediction/models/tranformations/moving_average.sql
[0m10:09:10.616336 [info ] [MainThread]: 
[0m10:09:10.616511 [error] [MainThread]:   Database Error in model rsi_calculation (models/tranformations/rsi_calculation.sql)
  001003 (42000): SQL compilation error:
  syntax error line 55 at position 21 unexpected ';'.
  compiled code at target/run/stock_prediction/models/tranformations/rsi_calculation.sql
[0m10:09:10.616651 [info ] [MainThread]: 
[0m10:09:10.616800 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m10:09:10.618067 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.1488023, "process_user_time": 1.707027, "process_kernel_time": 0.220056, "process_mem_max_rss": "138608640", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:09:10.618376 [debug] [MainThread]: Command `dbt run` failed at 10:09:10.618322 after 5.15 seconds
[0m10:09:10.618571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043b1630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100730210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100150d0>]}
[0m10:09:10.618750 [debug] [MainThread]: Flushing usage events
[0m10:10:52.495149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10574e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080b3ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080b3d90>]}


============================== 10:10:52.497175 | 618362b6-8378-4e75-8ec5-6dcfcaaaf169 ==============================
[0m10:10:52.497175 [info ] [MainThread]: Running with dbt=1.8.7
[0m10:10:52.497456 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:10:52.652907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '618362b6-8378-4e75-8ec5-6dcfcaaaf169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109005a70>]}
[0m10:10:52.675304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '618362b6-8378-4e75-8ec5-6dcfcaaaf169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dd0490>]}
[0m10:10:52.675673 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m10:10:52.683302 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m10:10:52.734106 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m10:10:52.734416 [debug] [MainThread]: Partial parsing: updated file: stock_prediction://models/tranformations/rsi_calculation.sql
[0m10:10:52.734587 [debug] [MainThread]: Partial parsing: updated file: stock_prediction://models/tranformations/moving_average.sql
[0m10:10:52.828222 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.stock_prediction.transformations.moving_average
- models.stock_prediction.transformations.rsi_calculation
[0m10:10:52.833699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '618362b6-8378-4e75-8ec5-6dcfcaaaf169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d33d50>]}
[0m10:10:52.872062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '618362b6-8378-4e75-8ec5-6dcfcaaaf169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10906a7b0>]}
[0m10:10:52.872324 [info ] [MainThread]: Found 3 models, 2 sources, 459 macros
[0m10:10:52.872469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '618362b6-8378-4e75-8ec5-6dcfcaaaf169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10917d630>]}
[0m10:10:52.873329 [info ] [MainThread]: 
[0m10:10:52.873593 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:10:52.875667 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m10:10:52.881593 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m10:10:52.881747 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m10:10:52.881867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:10:53.514470 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.632 seconds
[0m10:10:53.518533 [debug] [ThreadPool]: On list_dev: Close
[0m10:10:53.645009 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m10:10:53.656732 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m10:10:53.657132 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m10:10:53.657390 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:10:54.292355 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.635 seconds
[0m10:10:54.299034 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m10:10:54.422564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '618362b6-8378-4e75-8ec5-6dcfcaaaf169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107caa9c0>]}
[0m10:10:54.423787 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:10:54.424233 [info ] [MainThread]: 
[0m10:10:54.427859 [debug] [Thread-1 (]: Began running node model.stock_prediction.stock_prices
[0m10:10:54.428686 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.stock_prices ............................. [RUN]
[0m10:10:54.429231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.stock_prediction.stock_prices)
[0m10:10:54.429609 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.stock_prices
[0m10:10:54.438236 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.stock_prices"
[0m10:10:54.439230 [debug] [Thread-1 (]: Began executing node model.stock_prediction.stock_prices
[0m10:10:54.461634 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.stock_prices"
[0m10:10:54.462402 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.stock_prices"
[0m10:10:54.462647 [debug] [Thread-1 (]: On model.stock_prediction.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.stock_prices"} */
create or replace   view dev.analytics.stock_prices
  
   as (
    SELECT
    symbol,
    date,
    open,
    high,
    low,
    close,
    volume
FROM dev.raw_data.stock_prices
  );
[0m10:10:54.462849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:10:55.245825 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.782 seconds
[0m10:10:55.271046 [debug] [Thread-1 (]: On model.stock_prediction.stock_prices: Close
[0m10:10:55.391216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '618362b6-8378-4e75-8ec5-6dcfcaaaf169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b89a8d0>]}
[0m10:10:55.392370 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.stock_prices ........................ [[32mSUCCESS 1[0m in 0.96s]
[0m10:10:55.393206 [debug] [Thread-1 (]: Finished running node model.stock_prediction.stock_prices
[0m10:10:55.394470 [debug] [Thread-1 (]: Began running node model.stock_prediction.moving_average
[0m10:10:55.395189 [info ] [Thread-1 (]: 2 of 3 START sql view model analytics.moving_average ........................... [RUN]
[0m10:10:55.395700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.stock_prices, now model.stock_prediction.moving_average)
[0m10:10:55.396044 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.moving_average
[0m10:10:55.399884 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.moving_average"
[0m10:10:55.400963 [debug] [Thread-1 (]: Began executing node model.stock_prediction.moving_average
[0m10:10:55.403291 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.moving_average"
[0m10:10:55.404460 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.moving_average"
[0m10:10:55.404811 [debug] [Thread-1 (]: On model.stock_prediction.moving_average: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.moving_average"} */
create or replace   view dev.analytics.moving_average
  
   as (
    WITH stock_data AS (
    SELECT
        symbol,
        date,
        close
    FROM dev.analytics.stock_prices -- assuming 'stock_prices' is the name of the raw table model in dbt
)

SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
    ) AS moving_avg_5d,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
    ) AS moving_avg_20d
FROM stock_data
ORDER BY symbol, date
  );
[0m10:10:55.405130 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:10:56.109903 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.704 seconds
[0m10:10:56.116034 [debug] [Thread-1 (]: On model.stock_prediction.moving_average: Close
[0m10:10:56.237535 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '618362b6-8378-4e75-8ec5-6dcfcaaaf169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bac2570>]}
[0m10:10:56.238698 [info ] [Thread-1 (]: 2 of 3 OK created sql view model analytics.moving_average ...................... [[32mSUCCESS 1[0m in 0.84s]
[0m10:10:56.239504 [debug] [Thread-1 (]: Finished running node model.stock_prediction.moving_average
[0m10:10:56.240057 [debug] [Thread-1 (]: Began running node model.stock_prediction.rsi_calculation
[0m10:10:56.240763 [info ] [Thread-1 (]: 3 of 3 START sql view model analytics.rsi_calculation .......................... [RUN]
[0m10:10:56.241396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.moving_average, now model.stock_prediction.rsi_calculation)
[0m10:10:56.241845 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.rsi_calculation
[0m10:10:56.245434 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.rsi_calculation"
[0m10:10:56.246344 [debug] [Thread-1 (]: Began executing node model.stock_prediction.rsi_calculation
[0m10:10:56.249743 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.rsi_calculation"
[0m10:10:56.251367 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.rsi_calculation"
[0m10:10:56.251757 [debug] [Thread-1 (]: On model.stock_prediction.rsi_calculation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.rsi_calculation"} */
create or replace   view dev.analytics.rsi_calculation
  
   as (
    WITH stock_data AS (
    SELECT
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM dev.analytics.stock_prices
),

price_changes AS (
    SELECT
        symbol,
        date,
        close,
        CASE 
            WHEN close > prev_close THEN close - prev_close
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close < prev_close THEN prev_close - close
            ELSE 0 
        END AS loss
    FROM stock_data
),

average_gains_losses AS (
    SELECT
        symbol,
        date,
        close,
        AVG(gain) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain,
        AVG(loss) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss
    FROM price_changes
)

SELECT
    symbol,
    date,
    close,
    avg_gain,
    avg_loss,
    100 - (100 / (1 + (avg_gain / NULLIF(avg_loss, 0)))) AS rsi_14d
FROM average_gains_losses
ORDER BY symbol, date
  );
[0m10:10:56.252128 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:10:57.191446 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.939 seconds
[0m10:10:57.195149 [debug] [Thread-1 (]: On model.stock_prediction.rsi_calculation: Close
[0m10:10:57.330644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '618362b6-8378-4e75-8ec5-6dcfcaaaf169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba74870>]}
[0m10:10:57.332552 [info ] [Thread-1 (]: 3 of 3 OK created sql view model analytics.rsi_calculation ..................... [[32mSUCCESS 1[0m in 1.09s]
[0m10:10:57.333111 [debug] [Thread-1 (]: Finished running node model.stock_prediction.rsi_calculation
[0m10:10:57.334448 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:10:57.334675 [debug] [MainThread]: Connection 'model.stock_prediction.rsi_calculation' was properly closed.
[0m10:10:57.334975 [info ] [MainThread]: 
[0m10:10:57.335209 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 4.46 seconds (4.46s).
[0m10:10:57.335938 [debug] [MainThread]: Command end result
[0m10:10:57.358588 [info ] [MainThread]: 
[0m10:10:57.358823 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:10:57.358981 [info ] [MainThread]: 
[0m10:10:57.359138 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:10:57.360111 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.89756, "process_user_time": 1.377104, "process_kernel_time": 0.178636, "process_mem_max_rss": "134643712", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:10:57.360391 [debug] [MainThread]: Command `dbt run` succeeded at 10:10:57.360337 after 4.90 seconds
[0m10:10:57.360576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109168dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090d0dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080f5630>]}
[0m10:10:57.360750 [debug] [MainThread]: Flushing usage events
[0m10:37:36.528071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033aa120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cfbed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cfbd90>]}


============================== 10:37:36.530781 | 2054164c-eecb-489d-adeb-7717879d337f ==============================
[0m10:37:36.530781 [info ] [MainThread]: Running with dbt=1.8.7
[0m10:37:36.531087 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:37:36.742540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2054164c-eecb-489d-adeb-7717879d337f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105965a70>]}
[0m10:37:36.765217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2054164c-eecb-489d-adeb-7717879d337f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105850490>]}
[0m10:37:36.766630 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m10:37:36.776030 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m10:37:36.817283 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:37:36.817545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2054164c-eecb-489d-adeb-7717879d337f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057b1450>]}
[0m10:37:37.335795 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_prediction.transformations
[0m10:37:37.340544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2054164c-eecb-489d-adeb-7717879d337f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059ca3f0>]}
[0m10:37:37.380715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2054164c-eecb-489d-adeb-7717879d337f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cc7cb0>]}
[0m10:37:37.380962 [info ] [MainThread]: Found 3 models, 2 sources, 459 macros
[0m10:37:37.381120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2054164c-eecb-489d-adeb-7717879d337f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ab5230>]}
[0m10:37:37.381959 [info ] [MainThread]: 
[0m10:37:37.382246 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:37:37.384244 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m10:37:37.390118 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m10:37:37.390261 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m10:37:37.390374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:37:38.108490 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.718 seconds
[0m10:37:38.114190 [debug] [ThreadPool]: On list_dev: Close
[0m10:37:38.328470 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m10:37:38.336472 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m10:37:38.336750 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m10:37:38.336945 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:37:38.815394 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.478 seconds
[0m10:37:38.821951 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m10:37:38.960006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2054164c-eecb-489d-adeb-7717879d337f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ec9b50>]}
[0m10:37:38.961251 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:37:38.961686 [info ] [MainThread]: 
[0m10:37:38.966802 [debug] [Thread-1 (]: Began running node model.stock_prediction.stock_prices
[0m10:37:38.967546 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.stock_prices ............................. [RUN]
[0m10:37:38.968089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.stock_prediction.stock_prices)
[0m10:37:38.968459 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.stock_prices
[0m10:37:38.977650 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.stock_prices"
[0m10:37:38.978584 [debug] [Thread-1 (]: Began executing node model.stock_prediction.stock_prices
[0m10:37:39.000560 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.stock_prices"
[0m10:37:39.001278 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.stock_prices"
[0m10:37:39.001514 [debug] [Thread-1 (]: On model.stock_prediction.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.stock_prices"} */
create or replace   view dev.analytics.stock_prices
  
   as (
    SELECT
    symbol,
    date,
    open,
    high,
    low,
    close,
    volume
FROM dev.raw_data.stock_prices
  );
[0m10:37:39.001720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:37:39.981134 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.979 seconds
[0m10:37:40.010045 [debug] [Thread-1 (]: On model.stock_prediction.stock_prices: Close
[0m10:37:40.157619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2054164c-eecb-489d-adeb-7717879d337f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10604e8e0>]}
[0m10:37:40.158505 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.stock_prices ........................ [[32mSUCCESS 1[0m in 1.19s]
[0m10:37:40.159072 [debug] [Thread-1 (]: Finished running node model.stock_prediction.stock_prices
[0m10:37:40.159945 [debug] [Thread-1 (]: Began running node model.stock_prediction.moving_average
[0m10:37:40.160481 [info ] [Thread-1 (]: 2 of 3 START sql view model analytics.moving_average ........................... [RUN]
[0m10:37:40.160867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.stock_prices, now model.stock_prediction.moving_average)
[0m10:37:40.161155 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.moving_average
[0m10:37:40.163901 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.moving_average"
[0m10:37:40.164784 [debug] [Thread-1 (]: Began executing node model.stock_prediction.moving_average
[0m10:37:40.167609 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.moving_average"
[0m10:37:40.168697 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.moving_average"
[0m10:37:40.169034 [debug] [Thread-1 (]: On model.stock_prediction.moving_average: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.moving_average"} */
create or replace   view dev.analytics.moving_average
  
   as (
    WITH stock_data AS (
    SELECT
        symbol,
        date,
        close
    FROM dev.analytics.stock_prices -- assuming 'stock_prices' is the name of the raw table model in dbt
)

SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
    ) AS moving_avg_5d,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
    ) AS moving_avg_20d
FROM stock_data
ORDER BY symbol, date
  );
[0m10:37:40.169340 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:37:41.014026 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.844 seconds
[0m10:37:41.019665 [debug] [Thread-1 (]: On model.stock_prediction.moving_average: Close
[0m10:37:41.162224 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2054164c-eecb-489d-adeb-7717879d337f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106030050>]}
[0m10:37:41.163712 [info ] [Thread-1 (]: 2 of 3 OK created sql view model analytics.moving_average ...................... [[32mSUCCESS 1[0m in 1.00s]
[0m10:37:41.164640 [debug] [Thread-1 (]: Finished running node model.stock_prediction.moving_average
[0m10:37:41.165253 [debug] [Thread-1 (]: Began running node model.stock_prediction.rsi_calculation
[0m10:37:41.165931 [info ] [Thread-1 (]: 3 of 3 START sql view model analytics.rsi_calculation .......................... [RUN]
[0m10:37:41.166519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.moving_average, now model.stock_prediction.rsi_calculation)
[0m10:37:41.166900 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.rsi_calculation
[0m10:37:41.170519 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.rsi_calculation"
[0m10:37:41.171509 [debug] [Thread-1 (]: Began executing node model.stock_prediction.rsi_calculation
[0m10:37:41.173787 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.rsi_calculation"
[0m10:37:41.176160 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.rsi_calculation"
[0m10:37:41.176850 [debug] [Thread-1 (]: On model.stock_prediction.rsi_calculation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.rsi_calculation"} */
create or replace   view dev.analytics.rsi_calculation
  
   as (
    WITH stock_data AS (
    SELECT
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM dev.analytics.stock_prices
),

price_changes AS (
    SELECT
        symbol,
        date,
        close,
        CASE 
            WHEN close > prev_close THEN close - prev_close
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close < prev_close THEN prev_close - close
            ELSE 0 
        END AS loss
    FROM stock_data
),

average_gains_losses AS (
    SELECT
        symbol,
        date,
        close,
        AVG(gain) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain,
        AVG(loss) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss
    FROM price_changes
)

SELECT
    symbol,
    date,
    close,
    avg_gain,
    avg_loss,
    100 - (100 / (1 + (avg_gain / NULLIF(avg_loss, 0)))) AS rsi_14d
FROM average_gains_losses
ORDER BY symbol, date
  );
[0m10:37:41.177209 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:37:42.040600 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.863 seconds
[0m10:37:42.045361 [debug] [Thread-1 (]: On model.stock_prediction.rsi_calculation: Close
[0m10:37:42.198377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2054164c-eecb-489d-adeb-7717879d337f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cfbed0>]}
[0m10:37:42.200750 [info ] [Thread-1 (]: 3 of 3 OK created sql view model analytics.rsi_calculation ..................... [[32mSUCCESS 1[0m in 1.03s]
[0m10:37:42.202430 [debug] [Thread-1 (]: Finished running node model.stock_prediction.rsi_calculation
[0m10:37:42.204799 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:37:42.205440 [debug] [MainThread]: Connection 'model.stock_prediction.rsi_calculation' was properly closed.
[0m10:37:42.205957 [info ] [MainThread]: 
[0m10:37:42.206368 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 4.82 seconds (4.82s).
[0m10:37:42.207599 [debug] [MainThread]: Command end result
[0m10:37:42.233781 [info ] [MainThread]: 
[0m10:37:42.234122 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:37:42.234333 [info ] [MainThread]: 
[0m10:37:42.234553 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:37:42.236923 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.7420497, "process_user_time": 1.727377, "process_kernel_time": 0.217823, "process_mem_max_rss": "137625600", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:37:42.237408 [debug] [MainThread]: Command `dbt run` succeeded at 10:37:42.237332 after 5.74 seconds
[0m10:37:42.237696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d3d630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1012bc210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035e7410>]}
[0m10:37:42.237938 [debug] [MainThread]: Flushing usage events
[0m10:39:45.958324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b6e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084bfed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084bfd90>]}


============================== 10:39:45.960424 | fc306a43-0abf-4fd1-8a7b-b20ca0236d1d ==============================
[0m10:39:45.960424 [info ] [MainThread]: Running with dbt=1.8.7
[0m10:39:45.960721 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/adi/.dbt', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m10:39:46.006197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc306a43-0abf-4fd1-8a7b-b20ca0236d1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10735e8b0>]}
[0m10:39:46.013315 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.0863165, "process_user_time": 0.5913, "process_kernel_time": 0.090771, "process_mem_max_rss": "96337920", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:39:46.013583 [debug] [MainThread]: Command `dbt clean` succeeded at 10:39:46.013531 after 0.09 seconds
[0m10:39:46.013740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108602470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108602580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10826e150>]}
[0m10:39:46.013877 [debug] [MainThread]: Flushing usage events
[0m10:39:54.811985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050aa120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069fbed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069fbd90>]}


============================== 10:39:54.814108 | d6c86c05-34e9-4184-a215-157d445c28d9 ==============================
[0m10:39:54.814108 [info ] [MainThread]: Running with dbt=1.8.7
[0m10:39:54.814397 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/adi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m10:39:54.860302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6c86c05-34e9-4184-a215-157d445c28d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10589a8b0>]}
[0m10:39:54.866283 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.085486874, "process_user_time": 0.594883, "process_kernel_time": 0.090715, "process_mem_max_rss": "97124352", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:39:54.866577 [debug] [MainThread]: Command `dbt clean` succeeded at 10:39:54.866514 after 0.09 seconds
[0m10:39:54.866745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b3a470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b3a580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067aa150>]}
[0m10:39:54.866902 [debug] [MainThread]: Flushing usage events
[0m10:40:04.961872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102726120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104077ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104077d90>]}


============================== 10:40:04.963996 | 308b92d7-2d02-46d3-ba85-ebe49316c83c ==============================
[0m10:40:04.963996 [info ] [MainThread]: Running with dbt=1.8.7
[0m10:40:04.964290 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:40:05.126447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '308b92d7-2d02-46d3-ba85-ebe49316c83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ce1a70>]}
[0m10:40:05.148896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '308b92d7-2d02-46d3-ba85-ebe49316c83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bcc490>]}
[0m10:40:05.149292 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m10:40:05.157386 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m10:40:05.157919 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:40:05.158131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '308b92d7-2d02-46d3-ba85-ebe49316c83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b2c050>]}
[0m10:40:05.699112 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_prediction.transformations
[0m10:40:05.704065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '308b92d7-2d02-46d3-ba85-ebe49316c83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102da87d0>]}
[0m10:40:05.741463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '308b92d7-2d02-46d3-ba85-ebe49316c83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e51b70>]}
[0m10:40:05.741712 [info ] [MainThread]: Found 3 models, 2 sources, 459 macros
[0m10:40:05.741860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '308b92d7-2d02-46d3-ba85-ebe49316c83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dd2ea0>]}
[0m10:40:05.742951 [info ] [MainThread]: 
[0m10:40:05.743204 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:40:05.745557 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m10:40:05.751994 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m10:40:05.752160 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m10:40:05.752271 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:40:06.338087 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.585 seconds
[0m10:40:06.342127 [debug] [ThreadPool]: On list_dev: Close
[0m10:40:06.491633 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m10:40:06.503370 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m10:40:06.503874 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m10:40:06.504165 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:40:07.035015 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.531 seconds
[0m10:40:07.036662 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m10:40:07.164725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '308b92d7-2d02-46d3-ba85-ebe49316c83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10514fd10>]}
[0m10:40:07.165372 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:40:07.165668 [info ] [MainThread]: 
[0m10:40:07.168049 [debug] [Thread-1 (]: Began running node model.stock_prediction.stock_prices
[0m10:40:07.168658 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.stock_prices ............................. [RUN]
[0m10:40:07.169106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.stock_prediction.stock_prices)
[0m10:40:07.169413 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.stock_prices
[0m10:40:07.176439 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.stock_prices"
[0m10:40:07.177739 [debug] [Thread-1 (]: Began executing node model.stock_prediction.stock_prices
[0m10:40:07.201348 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.stock_prices"
[0m10:40:07.202600 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.stock_prices"
[0m10:40:07.202850 [debug] [Thread-1 (]: On model.stock_prediction.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.stock_prices"} */
create or replace   view dev.analytics.stock_prices
  
   as (
    SELECT
    symbol,
    date,
    open,
    high,
    low,
    close,
    volume
FROM dev.raw_data.stock_prices
  );
[0m10:40:07.203046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:40:08.154873 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.951 seconds
[0m10:40:08.179345 [debug] [Thread-1 (]: On model.stock_prediction.stock_prices: Close
[0m10:40:08.297932 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '308b92d7-2d02-46d3-ba85-ebe49316c83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040cd440>]}
[0m10:40:08.298909 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.stock_prices ........................ [[32mSUCCESS 1[0m in 1.13s]
[0m10:40:08.299707 [debug] [Thread-1 (]: Finished running node model.stock_prediction.stock_prices
[0m10:40:08.300734 [debug] [Thread-1 (]: Began running node model.stock_prediction.moving_average
[0m10:40:08.301298 [info ] [Thread-1 (]: 2 of 3 START sql view model analytics.moving_average ........................... [RUN]
[0m10:40:08.301768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.stock_prices, now model.stock_prediction.moving_average)
[0m10:40:08.302117 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.moving_average
[0m10:40:08.305951 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.moving_average"
[0m10:40:08.306966 [debug] [Thread-1 (]: Began executing node model.stock_prediction.moving_average
[0m10:40:08.309262 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.moving_average"
[0m10:40:08.310573 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.moving_average"
[0m10:40:08.310930 [debug] [Thread-1 (]: On model.stock_prediction.moving_average: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.moving_average"} */
create or replace   view dev.analytics.moving_average
  
   as (
    WITH stock_data AS (
    SELECT
        symbol,
        date,
        close
    FROM dev.analytics.stock_prices -- assuming 'stock_prices' is the name of the raw table model in dbt
)

SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
    ) AS moving_avg_5d,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
    ) AS moving_avg_20d
FROM stock_data
ORDER BY symbol, date
  );
[0m10:40:08.311246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:40:09.181232 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.869 seconds
[0m10:40:09.185856 [debug] [Thread-1 (]: On model.stock_prediction.moving_average: Close
[0m10:40:09.306651 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '308b92d7-2d02-46d3-ba85-ebe49316c83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10530acb0>]}
[0m10:40:09.307515 [info ] [Thread-1 (]: 2 of 3 OK created sql view model analytics.moving_average ...................... [[32mSUCCESS 1[0m in 1.00s]
[0m10:40:09.308180 [debug] [Thread-1 (]: Finished running node model.stock_prediction.moving_average
[0m10:40:09.308648 [debug] [Thread-1 (]: Began running node model.stock_prediction.rsi_calculation
[0m10:40:09.309262 [info ] [Thread-1 (]: 3 of 3 START sql view model analytics.rsi_calculation .......................... [RUN]
[0m10:40:09.309806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.moving_average, now model.stock_prediction.rsi_calculation)
[0m10:40:09.310192 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.rsi_calculation
[0m10:40:09.313786 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.rsi_calculation"
[0m10:40:09.314805 [debug] [Thread-1 (]: Began executing node model.stock_prediction.rsi_calculation
[0m10:40:09.317870 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.rsi_calculation"
[0m10:40:09.319547 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.rsi_calculation"
[0m10:40:09.319892 [debug] [Thread-1 (]: On model.stock_prediction.rsi_calculation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.rsi_calculation"} */
create or replace   view dev.analytics.rsi_calculation
  
   as (
    WITH stock_data AS (
    SELECT
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM dev.analytics.stock_prices
),

price_changes AS (
    SELECT
        symbol,
        date,
        close,
        CASE 
            WHEN close > prev_close THEN close - prev_close
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close < prev_close THEN prev_close - close
            ELSE 0 
        END AS loss
    FROM stock_data
),

average_gains_losses AS (
    SELECT
        symbol,
        date,
        close,
        AVG(gain) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain,
        AVG(loss) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss
    FROM price_changes
)

SELECT
    symbol,
    date,
    close,
    avg_gain,
    avg_loss,
    100 - (100 / (1 + (avg_gain / NULLIF(avg_loss, 0)))) AS rsi_14d
FROM average_gains_losses
ORDER BY symbol, date
  );
[0m10:40:09.320204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:40:10.101567 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.781 seconds
[0m10:40:10.106617 [debug] [Thread-1 (]: On model.stock_prediction.rsi_calculation: Close
[0m10:40:10.248660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '308b92d7-2d02-46d3-ba85-ebe49316c83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105383cd0>]}
[0m10:40:10.249630 [info ] [Thread-1 (]: 3 of 3 OK created sql view model analytics.rsi_calculation ..................... [[32mSUCCESS 1[0m in 0.94s]
[0m10:40:10.250437 [debug] [Thread-1 (]: Finished running node model.stock_prediction.rsi_calculation
[0m10:40:10.252164 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:40:10.252604 [debug] [MainThread]: Connection 'model.stock_prediction.rsi_calculation' was properly closed.
[0m10:40:10.253062 [info ] [MainThread]: 
[0m10:40:10.253439 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 4.51 seconds (4.51s).
[0m10:40:10.254531 [debug] [MainThread]: Command end result
[0m10:40:10.279989 [info ] [MainThread]: 
[0m10:40:10.280302 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:40:10.280507 [info ] [MainThread]: 
[0m10:40:10.280717 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:40:10.282250 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.351833, "process_user_time": 1.709345, "process_kernel_time": 0.176769, "process_mem_max_rss": "137641984", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:40:10.282611 [debug] [MainThread]: Command `dbt run` succeeded at 10:40:10.282548 after 5.35 seconds
[0m10:40:10.282840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040b5630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100638210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101df42f0>]}
[0m10:40:10.283045 [debug] [MainThread]: Flushing usage events
[0m10:47:58.950805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053ae120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eefed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eefd90>]}


============================== 10:47:58.952938 | 50606915-2d64-4f44-8947-e1261ce05a27 ==============================
[0m10:47:58.952938 [info ] [MainThread]: Running with dbt=1.8.7
[0m10:47:58.953232 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:47:58.999075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50606915-2d64-4f44-8947-e1261ce05a27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b9e8b0>]}
[0m10:47:59.005757 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.086541, "process_user_time": 0.592809, "process_kernel_time": 0.092514, "process_mem_max_rss": "98304000", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:47:59.006028 [debug] [MainThread]: Command `dbt clean` succeeded at 10:47:59.005977 after 0.09 seconds
[0m10:47:59.006181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10702e470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10702e580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c9e150>]}
[0m10:47:59.006318 [debug] [MainThread]: Flushing usage events
[0m10:48:03.613381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c4e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085b3ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085b3d90>]}


============================== 10:48:03.615710 | 7f155644-d187-4718-a049-8951c01bff5d ==============================
[0m10:48:03.615710 [info ] [MainThread]: Running with dbt=1.8.7
[0m10:48:03.616019 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:48:03.772834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f155644-d187-4718-a049-8951c01bff5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109375a70>]}
[0m10:48:03.797545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f155644-d187-4718-a049-8951c01bff5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092d0490>]}
[0m10:48:03.798023 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m10:48:03.806262 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m10:48:03.806795 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:48:03.807002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7f155644-d187-4718-a049-8951c01bff5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109234050>]}
[0m10:48:04.329280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f155644-d187-4718-a049-8951c01bff5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065247d0>]}
[0m10:48:04.366314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f155644-d187-4718-a049-8951c01bff5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109679b70>]}
[0m10:48:04.366543 [info ] [MainThread]: Found 3 models, 2 sources, 459 macros
[0m10:48:04.366686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f155644-d187-4718-a049-8951c01bff5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109466ea0>]}
[0m10:48:04.367767 [info ] [MainThread]: 
[0m10:48:04.368010 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:48:04.369981 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m10:48:04.375906 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m10:48:04.376055 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m10:48:04.376266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:48:05.002210 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.625 seconds
[0m10:48:05.007062 [debug] [ThreadPool]: On list_dev: Close
[0m10:48:05.151199 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m10:48:05.162864 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m10:48:05.163283 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m10:48:05.163547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:48:05.749609 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.586 seconds
[0m10:48:05.754630 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m10:48:05.919749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f155644-d187-4718-a049-8951c01bff5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a54bd10>]}
[0m10:48:05.920826 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:48:05.921264 [info ] [MainThread]: 
[0m10:48:05.924383 [debug] [Thread-1 (]: Began running node model.stock_prediction.stock_prices
[0m10:48:05.925099 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.stock_prices ............................. [RUN]
[0m10:48:05.925616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.stock_prediction.stock_prices)
[0m10:48:05.925973 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.stock_prices
[0m10:48:05.934032 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.stock_prices"
[0m10:48:05.935532 [debug] [Thread-1 (]: Began executing node model.stock_prediction.stock_prices
[0m10:48:05.957433 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.stock_prices"
[0m10:48:05.958527 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.stock_prices"
[0m10:48:05.958824 [debug] [Thread-1 (]: On model.stock_prediction.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.stock_prices"} */
create or replace   view dev.analytics.stock_prices
  
   as (
    SELECT
    symbol,
    date,
    open,
    high,
    low,
    close,
    volume
FROM dev.raw_data.stock_prices
  );
[0m10:48:05.959037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:48:06.769145 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.809 seconds
[0m10:48:06.797252 [debug] [Thread-1 (]: On model.stock_prediction.stock_prices: Close
[0m10:48:06.914138 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f155644-d187-4718-a049-8951c01bff5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108609440>]}
[0m10:48:06.915135 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.stock_prices ........................ [[32mSUCCESS 1[0m in 0.99s]
[0m10:48:06.915892 [debug] [Thread-1 (]: Finished running node model.stock_prediction.stock_prices
[0m10:48:06.916940 [debug] [Thread-1 (]: Began running node model.stock_prediction.moving_average
[0m10:48:06.917428 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.moving_average .......................... [RUN]
[0m10:48:06.917855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.stock_prices, now model.stock_prediction.moving_average)
[0m10:48:06.918199 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.moving_average
[0m10:48:06.922012 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.moving_average"
[0m10:48:06.923346 [debug] [Thread-1 (]: Began executing node model.stock_prediction.moving_average
[0m10:48:06.932013 [debug] [Thread-1 (]: Dropping relation "DEV"."ANALYTICS"."MOVING_AVERAGE" because it is of type view
[0m10:48:06.937909 [debug] [Thread-1 (]: Applying DROP to: "DEV"."ANALYTICS"."MOVING_AVERAGE"
[0m10:48:06.943281 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.moving_average"
[0m10:48:06.943525 [debug] [Thread-1 (]: On model.stock_prediction.moving_average: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.moving_average"} */
drop view if exists "DEV"."ANALYTICS"."MOVING_AVERAGE" cascade
[0m10:48:06.943732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:48:07.404874 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.461 seconds
[0m10:48:07.419527 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.moving_average"
[0m10:48:07.420689 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.moving_average"
[0m10:48:07.420929 [debug] [Thread-1 (]: On model.stock_prediction.moving_average: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.moving_average"} */
create or replace transient table dev.analytics.moving_average
         as
        (WITH stock_data AS (
    SELECT
        symbol,
        date,
        close
    FROM dev.analytics.stock_prices -- assuming 'stock_prices' is the name of the raw table model in dbt
)

SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
    ) AS moving_avg_5d,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
    ) AS moving_avg_20d
FROM stock_data
ORDER BY symbol, date
        );
[0m10:48:08.919733 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.498 seconds
[0m10:48:08.924167 [debug] [Thread-1 (]: On model.stock_prediction.moving_average: Close
[0m10:48:09.066852 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f155644-d187-4718-a049-8951c01bff5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097a39d0>]}
[0m10:48:09.067767 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.moving_average ..................... [[32mSUCCESS 1[0m in 2.15s]
[0m10:48:09.068473 [debug] [Thread-1 (]: Finished running node model.stock_prediction.moving_average
[0m10:48:09.068955 [debug] [Thread-1 (]: Began running node model.stock_prediction.rsi_calculation
[0m10:48:09.069571 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics.rsi_calculation ......................... [RUN]
[0m10:48:09.070160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.moving_average, now model.stock_prediction.rsi_calculation)
[0m10:48:09.070563 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.rsi_calculation
[0m10:48:09.073760 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.rsi_calculation"
[0m10:48:09.074663 [debug] [Thread-1 (]: Began executing node model.stock_prediction.rsi_calculation
[0m10:48:09.077229 [debug] [Thread-1 (]: Dropping relation "DEV"."ANALYTICS"."RSI_CALCULATION" because it is of type view
[0m10:48:09.078928 [debug] [Thread-1 (]: Applying DROP to: "DEV"."ANALYTICS"."RSI_CALCULATION"
[0m10:48:09.079760 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.rsi_calculation"
[0m10:48:09.080026 [debug] [Thread-1 (]: On model.stock_prediction.rsi_calculation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.rsi_calculation"} */
drop view if exists "DEV"."ANALYTICS"."RSI_CALCULATION" cascade
[0m10:48:09.080273 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:48:09.569299 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.488 seconds
[0m10:48:09.574504 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.rsi_calculation"
[0m10:48:09.577807 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.rsi_calculation"
[0m10:48:09.578244 [debug] [Thread-1 (]: On model.stock_prediction.rsi_calculation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.rsi_calculation"} */
create or replace transient table dev.analytics.rsi_calculation
         as
        (WITH stock_data AS (
    SELECT
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM dev.analytics.stock_prices
),

price_changes AS (
    SELECT
        symbol,
        date,
        close,
        CASE 
            WHEN close > prev_close THEN close - prev_close
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close < prev_close THEN prev_close - close
            ELSE 0 
        END AS loss
    FROM stock_data
),

average_gains_losses AS (
    SELECT
        symbol,
        date,
        close,
        AVG(gain) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain,
        AVG(loss) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss
    FROM price_changes
)

SELECT
    symbol,
    date,
    close,
    avg_gain,
    avg_loss,
    100 - (100 / (1 + (avg_gain / NULLIF(avg_loss, 0)))) AS rsi_14d
FROM average_gains_losses
ORDER BY symbol, date
        );
[0m10:48:10.458210 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.879 seconds
[0m10:48:10.465514 [debug] [Thread-1 (]: On model.stock_prediction.rsi_calculation: Close
[0m10:48:10.588721 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f155644-d187-4718-a049-8951c01bff5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092d4950>]}
[0m10:48:10.590898 [info ] [Thread-1 (]: 3 of 3 OK created sql table model analytics.rsi_calculation .................... [[32mSUCCESS 1[0m in 1.52s]
[0m10:48:10.591870 [debug] [Thread-1 (]: Finished running node model.stock_prediction.rsi_calculation
[0m10:48:10.593613 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:48:10.594062 [debug] [MainThread]: Connection 'model.stock_prediction.rsi_calculation' was properly closed.
[0m10:48:10.594549 [info ] [MainThread]: 
[0m10:48:10.594891 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 6.23 seconds (6.23s).
[0m10:48:10.595895 [debug] [MainThread]: Command end result
[0m10:48:10.620907 [info ] [MainThread]: 
[0m10:48:10.621246 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:48:10.621467 [info ] [MainThread]: 
[0m10:48:10.621689 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:48:10.623201 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.0425243, "process_user_time": 1.750275, "process_kernel_time": 0.185188, "process_mem_max_rss": "136609792", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:48:10.623554 [debug] [MainThread]: Command `dbt run` succeeded at 10:48:10.623493 after 7.04 seconds
[0m10:48:10.623781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085f1630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f68210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10606fd10>]}
[0m10:48:10.623999 [debug] [MainThread]: Flushing usage events
[0m11:14:04.393149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049da120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10632bed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10632bd90>]}


============================== 11:14:04.395778 | 4d00c0c5-f7f3-460f-8610-38a473f7d26a ==============================
[0m11:14:04.395778 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:14:04.396083 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m11:14:04.606923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d00c0c5-f7f3-460f-8610-38a473f7d26a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f95a70>]}
[0m11:14:04.629658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d00c0c5-f7f3-460f-8610-38a473f7d26a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f60490>]}
[0m11:14:04.631100 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:14:04.640676 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:14:04.701118 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:14:04.701498 [debug] [MainThread]: Partial parsing: added file: stock_prediction://models/schema.yml
[0m11:14:04.726683 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:14:04.726931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4d00c0c5-f7f3-460f-8610-38a473f7d26a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ec3350>]}
[0m11:14:04.831698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d00c0c5-f7f3-460f-8610-38a473f7d26a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10700f020>]}
[0m11:14:04.923749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d00c0c5-f7f3-460f-8610-38a473f7d26a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eaf770>]}
[0m11:14:04.924023 [info ] [MainThread]: Found 3 models, 19 data tests, 2 sources, 459 macros
[0m11:14:04.924182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d00c0c5-f7f3-460f-8610-38a473f7d26a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10747e410>]}
[0m11:14:04.925346 [info ] [MainThread]: 
[0m11:14:04.925608 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:14:04.927858 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_analytics'
[0m11:14:04.934985 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m11:14:04.935145 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m11:14:04.935262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:14:05.725031 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.789 seconds
[0m11:14:05.733313 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m11:14:05.875806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d00c0c5-f7f3-460f-8610-38a473f7d26a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107721b50>]}
[0m11:14:05.876512 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:14:05.876844 [info ] [MainThread]: 
[0m11:14:05.880743 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m11:14:05.881106 [info ] [Thread-1 (]: 1 of 19 START test not_null_moving_average_date ................................ [RUN]
[0m11:14:05.881467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now test.stock_prediction.not_null_moving_average_date.3ad00158b5)
[0m11:14:05.881727 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m11:14:05.895820 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_date.3ad00158b5"
[0m11:14:05.896455 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m11:14:05.908599 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_date.3ad00158b5"
[0m11:14:05.909262 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_date.3ad00158b5"
[0m11:14:05.909476 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_date.3ad00158b5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_date.3ad00158b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.moving_average
where date is null



      
    ) dbt_internal_test
[0m11:14:05.909664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:14:06.989860 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.080 seconds
[0m11:14:07.001531 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_date.3ad00158b5: Close
[0m11:14:07.121778 [info ] [Thread-1 (]: 1 of 19 PASS not_null_moving_average_date ...................................... [[32mPASS[0m in 1.24s]
[0m11:14:07.122481 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m11:14:07.122920 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_moving_avg.c8743581c8
[0m11:14:07.123353 [info ] [Thread-1 (]: 2 of 19 START test not_null_moving_average_moving_avg .......................... [RUN]
[0m11:14:07.123775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_date.3ad00158b5, now test.stock_prediction.not_null_moving_average_moving_avg.c8743581c8)
[0m11:14:07.124084 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_moving_avg.c8743581c8
[0m11:14:07.127926 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_moving_avg.c8743581c8"
[0m11:14:07.128814 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_moving_avg.c8743581c8
[0m11:14:07.130543 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_moving_avg.c8743581c8"
[0m11:14:07.131298 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_moving_avg.c8743581c8"
[0m11:14:07.131548 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg.c8743581c8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_moving_avg.c8743581c8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg
from dev.analytics.moving_average
where moving_avg is null



      
    ) dbt_internal_test
[0m11:14:07.131778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:14:07.531868 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b82142-0004-1d17-0001-97d30004ec4e
[0m11:14:07.532525 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'MOVING_AVG'
[0m11:14:07.533045 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg.c8743581c8: Close
[0m11:14:07.670310 [debug] [Thread-1 (]: Database Error in test not_null_moving_average_moving_avg (models/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MOVING_AVG'
  compiled code at target/run/stock_prediction/models/schema.yml/not_null_moving_average_moving_avg.sql
[0m11:14:07.670859 [error] [Thread-1 (]: 2 of 19 ERROR not_null_moving_average_moving_avg ............................... [[31mERROR[0m in 0.55s]
[0m11:14:07.671359 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_moving_avg.c8743581c8
[0m11:14:07.671703 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m11:14:07.672644 [info ] [Thread-1 (]: 3 of 19 START test not_null_moving_average_symbol .............................. [RUN]
[0m11:14:07.673018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_moving_avg.c8743581c8, now test.stock_prediction.not_null_moving_average_symbol.75a6f7473c)
[0m11:14:07.673267 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m11:14:07.676666 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"
[0m11:14:07.677354 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m11:14:07.678743 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"
[0m11:14:07.679404 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"
[0m11:14:07.679631 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_symbol.75a6f7473c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.moving_average
where symbol is null



      
    ) dbt_internal_test
[0m11:14:07.679841 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:14:08.183983 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.503 seconds
[0m11:14:08.190664 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_symbol.75a6f7473c: Close
[0m11:14:08.318600 [info ] [Thread-1 (]: 3 of 19 PASS not_null_moving_average_symbol .................................... [[32mPASS[0m in 0.64s]
[0m11:14:08.320180 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m11:14:08.320656 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m11:14:08.321083 [info ] [Thread-1 (]: 4 of 19 START test not_null_rsi_calculation_avg_gain ........................... [RUN]
[0m11:14:08.321537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_symbol.75a6f7473c, now test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42)
[0m11:14:08.321835 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m11:14:08.325735 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m11:14:08.326679 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m11:14:08.328428 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m11:14:08.329301 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m11:14:08.329557 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_gain
from dev.analytics.rsi_calculation
where avg_gain is null



      
    ) dbt_internal_test
[0m11:14:08.329792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:14:08.788100 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.458 seconds
[0m11:14:08.793540 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42: Close
[0m11:14:08.915962 [info ] [Thread-1 (]: 4 of 19 PASS not_null_rsi_calculation_avg_gain ................................. [[32mPASS[0m in 0.59s]
[0m11:14:08.916913 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m11:14:08.917497 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m11:14:08.918096 [info ] [Thread-1 (]: 5 of 19 START test not_null_rsi_calculation_avg_loss ........................... [RUN]
[0m11:14:08.918798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42, now test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19)
[0m11:14:08.919264 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m11:14:08.924570 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m11:14:08.925658 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m11:14:08.927888 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m11:14:08.928838 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m11:14:08.929154 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_loss
from dev.analytics.rsi_calculation
where avg_loss is null



      
    ) dbt_internal_test
[0m11:14:08.929453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:14:09.334298 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.404 seconds
[0m11:14:09.341393 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19: Close
[0m11:14:09.459471 [info ] [Thread-1 (]: 5 of 19 PASS not_null_rsi_calculation_avg_loss ................................. [[32mPASS[0m in 0.54s]
[0m11:14:09.460344 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m11:14:09.460816 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m11:14:09.461248 [info ] [Thread-1 (]: 6 of 19 START test not_null_rsi_calculation_date ............................... [RUN]
[0m11:14:09.461696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19, now test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76)
[0m11:14:09.462018 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m11:14:09.466312 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"
[0m11:14:09.467290 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m11:14:09.468988 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"
[0m11:14:09.469782 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"
[0m11:14:09.470069 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.rsi_calculation
where date is null



      
    ) dbt_internal_test
[0m11:14:09.470331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:14:09.869890 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.399 seconds
[0m11:14:09.874236 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76: Close
[0m11:14:10.013021 [info ] [Thread-1 (]: 6 of 19 PASS not_null_rsi_calculation_date ..................................... [[32mPASS[0m in 0.55s]
[0m11:14:10.014132 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m11:14:10.014702 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_rsi.7783e32ddd
[0m11:14:10.015404 [info ] [Thread-1 (]: 7 of 19 START test not_null_rsi_calculation_rsi ................................ [RUN]
[0m11:14:10.016224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76, now test.stock_prediction.not_null_rsi_calculation_rsi.7783e32ddd)
[0m11:14:10.016708 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_rsi.7783e32ddd
[0m11:14:10.021937 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_rsi.7783e32ddd"
[0m11:14:10.023128 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_rsi.7783e32ddd
[0m11:14:10.025182 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_rsi.7783e32ddd"
[0m11:14:10.026157 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_rsi.7783e32ddd"
[0m11:14:10.026495 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_rsi.7783e32ddd: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_rsi.7783e32ddd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi
from dev.analytics.rsi_calculation
where rsi is null



      
    ) dbt_internal_test
[0m11:14:10.026793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:14:10.459104 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b82142-0004-1c21-0001-97d30004fb5a
[0m11:14:10.460761 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'RSI'
[0m11:14:10.461650 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_rsi.7783e32ddd: Close
[0m11:14:10.578120 [debug] [Thread-1 (]: Database Error in test not_null_rsi_calculation_rsi (models/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'RSI'
  compiled code at target/run/stock_prediction/models/schema.yml/not_null_rsi_calculation_rsi.sql
[0m11:14:10.578896 [error] [Thread-1 (]: 7 of 19 ERROR not_null_rsi_calculation_rsi ..................................... [[31mERROR[0m in 0.56s]
[0m11:14:10.579472 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_rsi.7783e32ddd
[0m11:14:10.579860 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m11:14:10.580170 [info ] [Thread-1 (]: 8 of 19 START test not_null_rsi_calculation_symbol ............................. [RUN]
[0m11:14:10.580557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_rsi.7783e32ddd, now test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84)
[0m11:14:10.580860 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m11:14:10.585137 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m11:14:10.586206 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m11:14:10.588087 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m11:14:10.588969 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m11:14:10.589260 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.rsi_calculation
where symbol is null



      
    ) dbt_internal_test
[0m11:14:10.589527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:14:11.232704 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.642 seconds
[0m11:14:11.238289 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84: Close
[0m11:14:11.355468 [info ] [Thread-1 (]: 8 of 19 PASS not_null_rsi_calculation_symbol ................................... [[32mPASS[0m in 0.77s]
[0m11:14:11.356680 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m11:14:11.357113 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m11:14:11.357553 [info ] [Thread-1 (]: 9 of 19 START test not_null_stock_prices_close ................................. [RUN]
[0m11:14:11.358045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84, now test.stock_prediction.not_null_stock_prices_close.d7e232e1ba)
[0m11:14:11.358376 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m11:14:11.362347 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"
[0m11:14:11.363265 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m11:14:11.364970 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"
[0m11:14:11.365770 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"
[0m11:14:11.366047 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_close.d7e232e1ba: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.stock_prices
where close is null



      
    ) dbt_internal_test
[0m11:14:11.366305 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:14:11.793106 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.426 seconds
[0m11:14:11.799242 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_close.d7e232e1ba: Close
[0m11:14:11.918341 [info ] [Thread-1 (]: 9 of 19 PASS not_null_stock_prices_close ....................................... [[32mPASS[0m in 0.56s]
[0m11:14:11.919116 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m11:14:11.919518 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m11:14:11.919933 [info ] [Thread-1 (]: 10 of 19 START test not_null_stock_prices_date ................................. [RUN]
[0m11:14:11.920364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_close.d7e232e1ba, now test.stock_prediction.not_null_stock_prices_date.98a7527501)
[0m11:14:11.920676 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m11:14:11.924555 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_date.98a7527501"
[0m11:14:11.925445 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m11:14:11.927132 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_date.98a7527501"
[0m11:14:11.927816 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_date.98a7527501"
[0m11:14:11.928066 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_date.98a7527501: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_date.98a7527501"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.stock_prices
where date is null



      
    ) dbt_internal_test
[0m11:14:11.928291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:14:12.404899 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.476 seconds
[0m11:14:12.412297 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_date.98a7527501: Close
[0m11:14:12.571136 [info ] [Thread-1 (]: 10 of 19 PASS not_null_stock_prices_date ....................................... [[32mPASS[0m in 0.65s]
[0m11:14:12.572539 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m11:14:12.573007 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m11:14:12.573434 [info ] [Thread-1 (]: 11 of 19 START test not_null_stock_prices_high ................................. [RUN]
[0m11:14:12.573914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_date.98a7527501, now test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc)
[0m11:14:12.574232 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m11:14:12.578554 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"
[0m11:14:12.579499 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m11:14:12.581245 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"
[0m11:14:12.582043 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"
[0m11:14:12.582321 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select high
from dev.analytics.stock_prices
where high is null



      
    ) dbt_internal_test
[0m11:14:12.582580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:14:13.012114 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.429 seconds
[0m11:14:13.016022 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc: Close
[0m11:14:13.151963 [info ] [Thread-1 (]: 11 of 19 PASS not_null_stock_prices_high ....................................... [[32mPASS[0m in 0.58s]
[0m11:14:13.154547 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m11:14:13.155626 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m11:14:13.156383 [info ] [Thread-1 (]: 12 of 19 START test not_null_stock_prices_low .................................. [RUN]
[0m11:14:13.157075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc, now test.stock_prediction.not_null_stock_prices_low.e65294ca15)
[0m11:14:13.157545 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m11:14:13.162720 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_low.e65294ca15"
[0m11:14:13.163812 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m11:14:13.166013 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_low.e65294ca15"
[0m11:14:13.166878 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_low.e65294ca15"
[0m11:14:13.167190 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_low.e65294ca15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_low.e65294ca15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select low
from dev.analytics.stock_prices
where low is null



      
    ) dbt_internal_test
[0m11:14:13.167480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:14:13.579712 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.412 seconds
[0m11:14:13.586266 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_low.e65294ca15: Close
[0m11:14:13.700419 [info ] [Thread-1 (]: 12 of 19 PASS not_null_stock_prices_low ........................................ [[32mPASS[0m in 0.54s]
[0m11:14:13.701302 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m11:14:13.701847 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m11:14:13.702394 [info ] [Thread-1 (]: 13 of 19 START test not_null_stock_prices_open ................................. [RUN]
[0m11:14:13.702912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_low.e65294ca15, now test.stock_prediction.not_null_stock_prices_open.e09b13f215)
[0m11:14:13.703274 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m11:14:13.708097 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_open.e09b13f215"
[0m11:14:13.709175 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m11:14:13.711283 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_open.e09b13f215"
[0m11:14:13.712175 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_open.e09b13f215"
[0m11:14:13.712499 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_open.e09b13f215: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_open.e09b13f215"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from dev.analytics.stock_prices
where open is null



      
    ) dbt_internal_test
[0m11:14:13.712797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:14:14.206651 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.493 seconds
[0m11:14:14.210656 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_open.e09b13f215: Close
[0m11:14:14.331526 [info ] [Thread-1 (]: 13 of 19 PASS not_null_stock_prices_open ....................................... [[32mPASS[0m in 0.63s]
[0m11:14:14.332897 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m11:14:14.333272 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m11:14:14.333624 [info ] [Thread-1 (]: 14 of 19 START test not_null_stock_prices_symbol ............................... [RUN]
[0m11:14:14.334007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_open.e09b13f215, now test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8)
[0m11:14:14.334271 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m11:14:14.337811 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"
[0m11:14:14.338634 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m11:14:14.340076 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"
[0m11:14:14.340729 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"
[0m11:14:14.340944 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.stock_prices
where symbol is null



      
    ) dbt_internal_test
[0m11:14:14.341144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:14:14.867249 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.525 seconds
[0m11:14:14.873487 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8: Close
[0m11:14:15.013576 [info ] [Thread-1 (]: 14 of 19 PASS not_null_stock_prices_symbol ..................................... [[32mPASS[0m in 0.68s]
[0m11:14:15.014713 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m11:14:15.015028 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m11:14:15.015315 [info ] [Thread-1 (]: 15 of 19 START test not_null_stock_prices_volume ............................... [RUN]
[0m11:14:15.015760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8, now test.stock_prediction.not_null_stock_prices_volume.71420bc956)
[0m11:14:15.015961 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m11:14:15.020483 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_volume.71420bc956"
[0m11:14:15.021622 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m11:14:15.023912 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_volume.71420bc956"
[0m11:14:15.024934 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_volume.71420bc956"
[0m11:14:15.025253 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_volume.71420bc956: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_volume.71420bc956"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume
from dev.analytics.stock_prices
where volume is null



      
    ) dbt_internal_test
[0m11:14:15.025595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:14:15.441959 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.416 seconds
[0m11:14:15.449016 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_volume.71420bc956: Close
[0m11:14:15.564759 [info ] [Thread-1 (]: 15 of 19 PASS not_null_stock_prices_volume ..................................... [[32mPASS[0m in 0.55s]
[0m11:14:15.565615 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m11:14:15.566151 [debug] [Thread-1 (]: Began running node test.stock_prediction.unique_moving_average_date.a93c28e495
[0m11:14:15.566703 [info ] [Thread-1 (]: 16 of 19 START test unique_moving_average_date ................................. [RUN]
[0m11:14:15.567303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_volume.71420bc956, now test.stock_prediction.unique_moving_average_date.a93c28e495)
[0m11:14:15.567746 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.unique_moving_average_date.a93c28e495
[0m11:14:15.575610 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.unique_moving_average_date.a93c28e495"
[0m11:14:15.576673 [debug] [Thread-1 (]: Began executing node test.stock_prediction.unique_moving_average_date.a93c28e495
[0m11:14:15.578629 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.unique_moving_average_date.a93c28e495"
[0m11:14:15.579605 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.unique_moving_average_date.a93c28e495"
[0m11:14:15.579932 [debug] [Thread-1 (]: On test.stock_prediction.unique_moving_average_date.a93c28e495: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.unique_moving_average_date.a93c28e495"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from dev.analytics.moving_average
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m11:14:15.580227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:14:16.145183 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.564 seconds
[0m11:14:16.152328 [debug] [Thread-1 (]: On test.stock_prediction.unique_moving_average_date.a93c28e495: Close
[0m11:14:16.278146 [error] [Thread-1 (]: 16 of 19 FAIL 90 unique_moving_average_date .................................... [[31mFAIL 90[0m in 0.71s]
[0m11:14:16.279586 [debug] [Thread-1 (]: Finished running node test.stock_prediction.unique_moving_average_date.a93c28e495
[0m11:14:16.280208 [debug] [Thread-1 (]: Began running node test.stock_prediction.unique_rsi_calculation_date.057b856de2
[0m11:14:16.280780 [info ] [Thread-1 (]: 17 of 19 START test unique_rsi_calculation_date ................................ [RUN]
[0m11:14:16.281454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.unique_moving_average_date.a93c28e495, now test.stock_prediction.unique_rsi_calculation_date.057b856de2)
[0m11:14:16.281911 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.unique_rsi_calculation_date.057b856de2
[0m11:14:16.286943 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.unique_rsi_calculation_date.057b856de2"
[0m11:14:16.288016 [debug] [Thread-1 (]: Began executing node test.stock_prediction.unique_rsi_calculation_date.057b856de2
[0m11:14:16.290026 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.unique_rsi_calculation_date.057b856de2"
[0m11:14:16.291045 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.unique_rsi_calculation_date.057b856de2"
[0m11:14:16.291367 [debug] [Thread-1 (]: On test.stock_prediction.unique_rsi_calculation_date.057b856de2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.unique_rsi_calculation_date.057b856de2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from dev.analytics.rsi_calculation
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m11:14:16.291671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:14:16.823548 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.531 seconds
[0m11:14:16.827314 [debug] [Thread-1 (]: On test.stock_prediction.unique_rsi_calculation_date.057b856de2: Close
[0m11:14:16.980846 [error] [Thread-1 (]: 17 of 19 FAIL 90 unique_rsi_calculation_date ................................... [[31mFAIL 90[0m in 0.70s]
[0m11:14:16.982206 [debug] [Thread-1 (]: Finished running node test.stock_prediction.unique_rsi_calculation_date.057b856de2
[0m11:14:16.982570 [debug] [Thread-1 (]: Began running node test.stock_prediction.unique_stock_prices_date.1d2e222e60
[0m11:14:16.982922 [info ] [Thread-1 (]: 18 of 19 START test unique_stock_prices_date ................................... [RUN]
[0m11:14:16.983323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.unique_rsi_calculation_date.057b856de2, now test.stock_prediction.unique_stock_prices_date.1d2e222e60)
[0m11:14:16.983587 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.unique_stock_prices_date.1d2e222e60
[0m11:14:16.987086 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.unique_stock_prices_date.1d2e222e60"
[0m11:14:16.987948 [debug] [Thread-1 (]: Began executing node test.stock_prediction.unique_stock_prices_date.1d2e222e60
[0m11:14:16.989394 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.unique_stock_prices_date.1d2e222e60"
[0m11:14:16.990165 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.unique_stock_prices_date.1d2e222e60"
[0m11:14:16.990394 [debug] [Thread-1 (]: On test.stock_prediction.unique_stock_prices_date.1d2e222e60: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.unique_stock_prices_date.1d2e222e60"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from dev.analytics.stock_prices
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m11:14:16.990601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:14:17.525274 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.533 seconds
[0m11:14:17.530386 [debug] [Thread-1 (]: On test.stock_prediction.unique_stock_prices_date.1d2e222e60: Close
[0m11:14:17.673318 [error] [Thread-1 (]: 18 of 19 FAIL 90 unique_stock_prices_date ...................................... [[31mFAIL 90[0m in 0.69s]
[0m11:14:17.674708 [debug] [Thread-1 (]: Finished running node test.stock_prediction.unique_stock_prices_date.1d2e222e60
[0m11:14:17.675107 [debug] [Thread-1 (]: Began running node test.stock_prediction.unique_stock_prices_symbol.e6ae7e0ef5
[0m11:14:17.675481 [info ] [Thread-1 (]: 19 of 19 START test unique_stock_prices_symbol ................................. [RUN]
[0m11:14:17.675913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.unique_stock_prices_date.1d2e222e60, now test.stock_prediction.unique_stock_prices_symbol.e6ae7e0ef5)
[0m11:14:17.676198 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.unique_stock_prices_symbol.e6ae7e0ef5
[0m11:14:17.680037 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.unique_stock_prices_symbol.e6ae7e0ef5"
[0m11:14:17.680959 [debug] [Thread-1 (]: Began executing node test.stock_prediction.unique_stock_prices_symbol.e6ae7e0ef5
[0m11:14:17.682630 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.unique_stock_prices_symbol.e6ae7e0ef5"
[0m11:14:17.683414 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.unique_stock_prices_symbol.e6ae7e0ef5"
[0m11:14:17.683669 [debug] [Thread-1 (]: On test.stock_prediction.unique_stock_prices_symbol.e6ae7e0ef5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.unique_stock_prices_symbol.e6ae7e0ef5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    symbol as unique_field,
    count(*) as n_records

from dev.analytics.stock_prices
where symbol is not null
group by symbol
having count(*) > 1



      
    ) dbt_internal_test
[0m11:14:17.683899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:14:18.205739 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.521 seconds
[0m11:14:18.210544 [debug] [Thread-1 (]: On test.stock_prediction.unique_stock_prices_symbol.e6ae7e0ef5: Close
[0m11:14:18.325306 [error] [Thread-1 (]: 19 of 19 FAIL 2 unique_stock_prices_symbol ..................................... [[31mFAIL 2[0m in 0.65s]
[0m11:14:18.326180 [debug] [Thread-1 (]: Finished running node test.stock_prediction.unique_stock_prices_symbol.e6ae7e0ef5
[0m11:14:18.328015 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:14:18.328347 [debug] [MainThread]: Connection 'test.stock_prediction.unique_stock_prices_symbol.e6ae7e0ef5' was properly closed.
[0m11:14:18.328678 [info ] [MainThread]: 
[0m11:14:18.328976 [info ] [MainThread]: Finished running 19 data tests in 0 hours 0 minutes and 13.40 seconds (13.40s).
[0m11:14:18.332064 [debug] [MainThread]: Command end result
[0m11:14:18.359003 [info ] [MainThread]: 
[0m11:14:18.359260 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m11:14:18.359429 [info ] [MainThread]: 
[0m11:14:18.359645 [error] [MainThread]:   Database Error in test not_null_moving_average_moving_avg (models/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MOVING_AVG'
  compiled code at target/run/stock_prediction/models/schema.yml/not_null_moving_average_moving_avg.sql
[0m11:14:18.359801 [info ] [MainThread]: 
[0m11:14:18.359992 [error] [MainThread]:   Database Error in test not_null_rsi_calculation_rsi (models/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'RSI'
  compiled code at target/run/stock_prediction/models/schema.yml/not_null_rsi_calculation_rsi.sql
[0m11:14:18.360141 [info ] [MainThread]: 
[0m11:14:18.360326 [error] [MainThread]: [31mFailure in test unique_moving_average_date (models/schema.yml)[0m
[0m11:14:18.360502 [error] [MainThread]:   Got 90 results, configured to fail if != 0
[0m11:14:18.360639 [info ] [MainThread]: 
[0m11:14:18.360815 [info ] [MainThread]:   compiled code at target/compiled/stock_prediction/models/schema.yml/unique_moving_average_date.sql
[0m11:14:18.360953 [info ] [MainThread]: 
[0m11:14:18.361132 [error] [MainThread]: [31mFailure in test unique_rsi_calculation_date (models/schema.yml)[0m
[0m11:14:18.361307 [error] [MainThread]:   Got 90 results, configured to fail if != 0
[0m11:14:18.361439 [info ] [MainThread]: 
[0m11:14:18.361607 [info ] [MainThread]:   compiled code at target/compiled/stock_prediction/models/schema.yml/unique_rsi_calculation_date.sql
[0m11:14:18.361749 [info ] [MainThread]: 
[0m11:14:18.361929 [error] [MainThread]: [31mFailure in test unique_stock_prices_date (models/schema.yml)[0m
[0m11:14:18.362101 [error] [MainThread]:   Got 90 results, configured to fail if != 0
[0m11:14:18.362227 [info ] [MainThread]: 
[0m11:14:18.362395 [info ] [MainThread]:   compiled code at target/compiled/stock_prediction/models/schema.yml/unique_stock_prices_date.sql
[0m11:14:18.362529 [info ] [MainThread]: 
[0m11:14:18.362702 [error] [MainThread]: [31mFailure in test unique_stock_prices_symbol (models/schema.yml)[0m
[0m11:14:18.362872 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m11:14:18.363005 [info ] [MainThread]: 
[0m11:14:18.363282 [info ] [MainThread]:   compiled code at target/compiled/stock_prediction/models/schema.yml/unique_stock_prices_symbol.sql
[0m11:14:18.363465 [info ] [MainThread]: 
[0m11:14:18.363647 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=6 SKIP=0 TOTAL=19
[0m11:14:18.365416 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 14.005169, "process_user_time": 2.502102, "process_kernel_time": 0.34325, "process_mem_max_rss": "140984320", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:14:18.365748 [debug] [MainThread]: Command `dbt test` failed at 11:14:18.365689 after 14.01 seconds
[0m11:14:18.365970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107572780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108639450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108638190>]}
[0m11:14:18.366161 [debug] [MainThread]: Flushing usage events
[0m11:18:48.691548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10489e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061efed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061efd90>]}


============================== 11:18:48.694298 | 8956d920-a2f7-4a9a-b794-3f777a97de60 ==============================
[0m11:18:48.694298 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:18:48.694599 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:18:48.744159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8956d920-a2f7-4a9a-b794-3f777a97de60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10508e8b0>]}
[0m11:18:48.756172 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.09899625, "process_user_time": 0.60396, "process_kernel_time": 0.117244, "process_mem_max_rss": "98041856", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:18:48.756439 [debug] [MainThread]: Command `dbt clean` succeeded at 11:18:48.756386 after 0.10 seconds
[0m11:18:48.756596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106332470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106332580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f9e150>]}
[0m11:18:48.756740 [debug] [MainThread]: Flushing usage events
[0m11:20:32.604078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105336120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c87ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c87d90>]}


============================== 11:20:32.606757 | 6fd24118-59c7-455f-8810-e1cdf2e27705 ==============================
[0m11:20:32.606757 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:20:32.607076 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'profiles_dir': '/Users/adi/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:20:32.825033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6fd24118-59c7-455f-8810-e1cdf2e27705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078f1a70>]}
[0m11:20:32.847625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6fd24118-59c7-455f-8810-e1cdf2e27705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077dc490>]}
[0m11:20:32.849039 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:20:32.861143 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:20:32.861668 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:20:32.861862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6fd24118-59c7-455f-8810-e1cdf2e27705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10773c050>]}
[0m11:20:33.344516 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:20:33.344804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6fd24118-59c7-455f-8810-e1cdf2e27705', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a04e60>]}
[0m11:20:33.481706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6fd24118-59c7-455f-8810-e1cdf2e27705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b7a7b0>]}
[0m11:20:33.534886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6fd24118-59c7-455f-8810-e1cdf2e27705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d14e20>]}
[0m11:20:33.535165 [info ] [MainThread]: Found 3 models, 19 data tests, 2 sources, 459 macros
[0m11:20:33.535326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fd24118-59c7-455f-8810-e1cdf2e27705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ccf7d0>]}
[0m11:20:33.536311 [info ] [MainThread]: 
[0m11:20:33.536579 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:20:33.538667 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m11:20:33.544648 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m11:20:33.544812 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m11:20:33.544932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:20:34.125856 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.580 seconds
[0m11:20:34.128390 [debug] [ThreadPool]: On list_dev: Close
[0m11:20:34.262411 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m11:20:34.274498 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m11:20:34.274852 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m11:20:34.275111 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:20:34.765131 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.490 seconds
[0m11:20:34.769976 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m11:20:34.898145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fd24118-59c7-455f-8810-e1cdf2e27705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ed5f40>]}
[0m11:20:34.898933 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:20:34.899345 [info ] [MainThread]: 
[0m11:20:34.903402 [debug] [Thread-1 (]: Began running node model.stock_prediction.stock_prices
[0m11:20:34.904058 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.stock_prices ............................. [RUN]
[0m11:20:34.904546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.stock_prediction.stock_prices)
[0m11:20:34.904913 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.stock_prices
[0m11:20:34.913267 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.stock_prices"
[0m11:20:34.914566 [debug] [Thread-1 (]: Began executing node model.stock_prediction.stock_prices
[0m11:20:34.936633 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.stock_prices"
[0m11:20:34.937636 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.stock_prices"
[0m11:20:34.937878 [debug] [Thread-1 (]: On model.stock_prediction.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.stock_prices"} */
create or replace   view dev.analytics.stock_prices
  
   as (
    SELECT
    symbol,
    date,
    open,
    high,
    low,
    close,
    volume
FROM dev.raw_data.stock_prices
  );
[0m11:20:34.938081 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:20:35.683402 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.745 seconds
[0m11:20:35.704847 [debug] [Thread-1 (]: On model.stock_prediction.stock_prices: Close
[0m11:20:35.845292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fd24118-59c7-455f-8810-e1cdf2e27705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062493b0>]}
[0m11:20:35.846241 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.stock_prices ........................ [[32mSUCCESS 1[0m in 0.94s]
[0m11:20:35.847046 [debug] [Thread-1 (]: Finished running node model.stock_prediction.stock_prices
[0m11:20:35.848123 [debug] [Thread-1 (]: Began running node model.stock_prediction.moving_average
[0m11:20:35.848698 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.moving_average .......................... [RUN]
[0m11:20:35.849180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.stock_prices, now model.stock_prediction.moving_average)
[0m11:20:35.849543 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.moving_average
[0m11:20:35.853311 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.moving_average"
[0m11:20:35.854425 [debug] [Thread-1 (]: Began executing node model.stock_prediction.moving_average
[0m11:20:35.872779 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.moving_average"
[0m11:20:35.873918 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.moving_average"
[0m11:20:35.874189 [debug] [Thread-1 (]: On model.stock_prediction.moving_average: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.moving_average"} */
create or replace transient table dev.analytics.moving_average
         as
        (WITH stock_data AS (
    SELECT
        symbol,
        date,
        close
    FROM dev.analytics.stock_prices -- assuming 'stock_prices' is the name of the raw table model in dbt
)

SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
    ) AS moving_avg_5d,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
    ) AS moving_avg_20d
FROM stock_data
ORDER BY symbol, date
        );
[0m11:20:35.874432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:20:37.221104 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.346 seconds
[0m11:20:37.224709 [debug] [Thread-1 (]: On model.stock_prediction.moving_average: Close
[0m11:20:37.370344 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fd24118-59c7-455f-8810-e1cdf2e27705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c9cdd0>]}
[0m11:20:37.371311 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.moving_average ..................... [[32mSUCCESS 1[0m in 1.52s]
[0m11:20:37.372122 [debug] [Thread-1 (]: Finished running node model.stock_prediction.moving_average
[0m11:20:37.372673 [debug] [Thread-1 (]: Began running node model.stock_prediction.rsi_calculation
[0m11:20:37.373423 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics.rsi_calculation ......................... [RUN]
[0m11:20:37.374091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.moving_average, now model.stock_prediction.rsi_calculation)
[0m11:20:37.374555 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.rsi_calculation
[0m11:20:37.378273 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.rsi_calculation"
[0m11:20:37.379401 [debug] [Thread-1 (]: Began executing node model.stock_prediction.rsi_calculation
[0m11:20:37.381756 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.rsi_calculation"
[0m11:20:37.383590 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.rsi_calculation"
[0m11:20:37.383990 [debug] [Thread-1 (]: On model.stock_prediction.rsi_calculation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.rsi_calculation"} */
create or replace transient table dev.analytics.rsi_calculation
         as
        (WITH stock_data AS (
    SELECT
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM dev.analytics.stock_prices
),

price_changes AS (
    SELECT
        symbol,
        date,
        close,
        CASE 
            WHEN close > prev_close THEN close - prev_close
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close < prev_close THEN prev_close - close
            ELSE 0 
        END AS loss
    FROM stock_data
),

average_gains_losses AS (
    SELECT
        symbol,
        date,
        close,
        -- Calculate the average gain over the last 14 days, including current row
        AVG(gain) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain,
        -- Calculate the average loss over the last 14 days, including current row
        AVG(loss) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss
    FROM price_changes
)

SELECT
    symbol,
    date,
    close,
    avg_gain,
    avg_loss,
    -- Calculate RSI, handling division by zero with NULLIF
    100 - (100 / (1 + (NULLIF(avg_gain, 0) / NULLIF(avg_loss, 0)))) AS rsi_14d
FROM average_gains_losses
WHERE avg_gain IS NOT NULL OR avg_loss IS NOT NULL -- Ensure we only select meaningful data
ORDER BY symbol, date;
[0m11:20:37.384373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:20:37.814394 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b82148-0004-1d17-0001-97d30004ed0e
[0m11:20:37.815041 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 58 at position 21 unexpected ';'.
[0m11:20:37.815551 [debug] [Thread-1 (]: On model.stock_prediction.rsi_calculation: Close
[0m11:20:37.968634 [debug] [Thread-1 (]: Database Error in model rsi_calculation (models/tranformations/rsi_calculation.sql)
  001003 (42000): SQL compilation error:
  syntax error line 58 at position 21 unexpected ';'.
  compiled code at target/run/stock_prediction/models/tranformations/rsi_calculation.sql
[0m11:20:37.969098 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fd24118-59c7-455f-8810-e1cdf2e27705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ffadd0>]}
[0m11:20:37.969664 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model analytics.rsi_calculation ................ [[31mERROR[0m in 0.60s]
[0m11:20:37.970108 [debug] [Thread-1 (]: Finished running node model.stock_prediction.rsi_calculation
[0m11:20:37.971605 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:20:37.971808 [debug] [MainThread]: Connection 'model.stock_prediction.rsi_calculation' was properly closed.
[0m11:20:37.972036 [info ] [MainThread]: 
[0m11:20:37.972218 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 4.44 seconds (4.44s).
[0m11:20:37.972806 [debug] [MainThread]: Command end result
[0m11:20:37.991431 [info ] [MainThread]: 
[0m11:20:37.991649 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:20:37.991794 [info ] [MainThread]: 
[0m11:20:37.991983 [error] [MainThread]:   Database Error in model rsi_calculation (models/tranformations/rsi_calculation.sql)
  001003 (42000): SQL compilation error:
  syntax error line 58 at position 21 unexpected ';'.
  compiled code at target/run/stock_prediction/models/tranformations/rsi_calculation.sql
[0m11:20:37.992120 [info ] [MainThread]: 
[0m11:20:37.992265 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m11:20:37.993661 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.4232917, "process_user_time": 1.799301, "process_kernel_time": 0.220433, "process_mem_max_rss": "139952128", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:20:37.993929 [debug] [MainThread]: Command `dbt run` failed at 11:20:37.993882 after 5.42 seconds
[0m11:20:37.994107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056ada90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081ebad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081ebb30>]}
[0m11:20:37.994266 [debug] [MainThread]: Flushing usage events
[0m11:20:57.422955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10479a120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060ebed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060ebd90>]}


============================== 11:20:57.425123 | b457fe24-dad9-4d78-b2c5-06b5db7f3ef7 ==============================
[0m11:20:57.425123 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:20:57.425419 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:20:57.471191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b457fe24-dad9-4d78-b2c5-06b5db7f3ef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f8a8b0>]}
[0m11:20:57.478798 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.08716742, "process_user_time": 0.589722, "process_kernel_time": 0.090124, "process_mem_max_rss": "95485952", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:20:57.479064 [debug] [MainThread]: Command `dbt clean` succeeded at 11:20:57.479007 after 0.09 seconds
[0m11:20:57.479211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10622e470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10622e580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e9a150>]}
[0m11:20:57.479351 [debug] [MainThread]: Flushing usage events
[0m11:21:01.562309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10291e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10426fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10426fd90>]}


============================== 11:21:01.564494 | 4ea1cfa8-208f-4b71-a8c2-9d72beb40dca ==============================
[0m11:21:01.564494 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:21:01.564778 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:21:01.725487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ea1cfa8-208f-4b71-a8c2-9d72beb40dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ed9a70>]}
[0m11:21:01.748263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ea1cfa8-208f-4b71-a8c2-9d72beb40dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dc4490>]}
[0m11:21:01.748645 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:21:01.756982 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:21:01.757532 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:21:01.757758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4ea1cfa8-208f-4b71-a8c2-9d72beb40dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d28050>]}
[0m11:21:02.225463 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:21:02.225746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4ea1cfa8-208f-4b71-a8c2-9d72beb40dca', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe8e60>]}
[0m11:21:02.361962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ea1cfa8-208f-4b71-a8c2-9d72beb40dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051a27b0>]}
[0m11:21:02.410573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ea1cfa8-208f-4b71-a8c2-9d72beb40dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104300e20>]}
[0m11:21:02.410844 [info ] [MainThread]: Found 3 models, 19 data tests, 2 sources, 459 macros
[0m11:21:02.410997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ea1cfa8-208f-4b71-a8c2-9d72beb40dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052b77d0>]}
[0m11:21:02.411968 [info ] [MainThread]: 
[0m11:21:02.412234 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:21:02.414325 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m11:21:02.420249 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m11:21:02.420400 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m11:21:02.420543 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:21:03.057697 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.637 seconds
[0m11:21:03.060515 [debug] [ThreadPool]: On list_dev: Close
[0m11:21:03.182653 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m11:21:03.187816 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m11:21:03.188006 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m11:21:03.188131 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:21:03.598661 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.410 seconds
[0m11:21:03.601097 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m11:21:03.724475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ea1cfa8-208f-4b71-a8c2-9d72beb40dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054bdf40>]}
[0m11:21:03.725166 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:21:03.725508 [info ] [MainThread]: 
[0m11:21:03.727744 [debug] [Thread-1 (]: Began running node model.stock_prediction.stock_prices
[0m11:21:03.728304 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.stock_prices ............................. [RUN]
[0m11:21:03.728753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.stock_prediction.stock_prices)
[0m11:21:03.729084 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.stock_prices
[0m11:21:03.736538 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.stock_prices"
[0m11:21:03.737646 [debug] [Thread-1 (]: Began executing node model.stock_prediction.stock_prices
[0m11:21:03.758801 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.stock_prices"
[0m11:21:03.759682 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.stock_prices"
[0m11:21:03.759913 [debug] [Thread-1 (]: On model.stock_prediction.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.stock_prices"} */
create or replace   view dev.analytics.stock_prices
  
   as (
    SELECT
    symbol,
    date,
    open,
    high,
    low,
    close,
    volume
FROM dev.raw_data.stock_prices
  );
[0m11:21:03.760113 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:21:04.458561 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.697 seconds
[0m11:21:04.484554 [debug] [Thread-1 (]: On model.stock_prediction.stock_prices: Close
[0m11:21:04.620000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ea1cfa8-208f-4b71-a8c2-9d72beb40dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038313b0>]}
[0m11:21:04.620867 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.stock_prices ........................ [[32mSUCCESS 1[0m in 0.89s]
[0m11:21:04.621691 [debug] [Thread-1 (]: Finished running node model.stock_prediction.stock_prices
[0m11:21:04.622958 [debug] [Thread-1 (]: Began running node model.stock_prediction.moving_average
[0m11:21:04.623600 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.moving_average .......................... [RUN]
[0m11:21:04.624059 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.stock_prices, now model.stock_prediction.moving_average)
[0m11:21:04.624406 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.moving_average
[0m11:21:04.628542 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.moving_average"
[0m11:21:04.629742 [debug] [Thread-1 (]: Began executing node model.stock_prediction.moving_average
[0m11:21:04.648215 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.moving_average"
[0m11:21:04.649709 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.moving_average"
[0m11:21:04.650006 [debug] [Thread-1 (]: On model.stock_prediction.moving_average: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.moving_average"} */
create or replace transient table dev.analytics.moving_average
         as
        (WITH stock_data AS (
    SELECT
        symbol,
        date,
        close
    FROM dev.analytics.stock_prices -- assuming 'stock_prices' is the name of the raw table model in dbt
)

SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
    ) AS moving_avg_5d,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
    ) AS moving_avg_20d
FROM stock_data
ORDER BY symbol, date
        );
[0m11:21:04.650261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:21:05.995799 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.345 seconds
[0m11:21:06.001352 [debug] [Thread-1 (]: On model.stock_prediction.moving_average: Close
[0m11:21:06.136817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ea1cfa8-208f-4b71-a8c2-9d72beb40dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104284dd0>]}
[0m11:21:06.138515 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.moving_average ..................... [[32mSUCCESS 1[0m in 1.51s]
[0m11:21:06.139481 [debug] [Thread-1 (]: Finished running node model.stock_prediction.moving_average
[0m11:21:06.140117 [debug] [Thread-1 (]: Began running node model.stock_prediction.rsi_calculation
[0m11:21:06.140801 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics.rsi_calculation ......................... [RUN]
[0m11:21:06.141371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.moving_average, now model.stock_prediction.rsi_calculation)
[0m11:21:06.141744 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.rsi_calculation
[0m11:21:06.145115 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.rsi_calculation"
[0m11:21:06.146077 [debug] [Thread-1 (]: Began executing node model.stock_prediction.rsi_calculation
[0m11:21:06.148296 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.rsi_calculation"
[0m11:21:06.149995 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.rsi_calculation"
[0m11:21:06.150343 [debug] [Thread-1 (]: On model.stock_prediction.rsi_calculation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.rsi_calculation"} */
create or replace transient table dev.analytics.rsi_calculation
         as
        (WITH stock_data AS (
    SELECT
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM dev.analytics.stock_prices
),

price_changes AS (
    SELECT
        symbol,
        date,
        close,
        CASE 
            WHEN close > prev_close THEN close - prev_close
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close < prev_close THEN prev_close - close
            ELSE 0 
        END AS loss
    FROM stock_data
),

average_gains_losses AS (
    SELECT
        symbol,
        date,
        close,
        -- Calculate the average gain over the last 14 days, including current row
        AVG(gain) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain,
        -- Calculate the average loss over the last 14 days, including current row
        AVG(loss) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss
    FROM price_changes
)

SELECT
    symbol,
    date,
    close,
    avg_gain,
    avg_loss,
    -- Calculate RSI, handling division by zero with NULLIF
    100 - (100 / (1 + (NULLIF(avg_gain, 0) / NULLIF(avg_loss, 0)))) AS rsi_14d
FROM average_gains_losses
WHERE avg_gain IS NOT NULL OR avg_loss IS NOT NULL -- Ensure we only select meaningful data
ORDER BY symbol, date
        );
[0m11:21:06.150674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:21:07.327434 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.176 seconds
[0m11:21:07.332259 [debug] [Thread-1 (]: On model.stock_prediction.rsi_calculation: Close
[0m11:21:07.474795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ea1cfa8-208f-4b71-a8c2-9d72beb40dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051c3930>]}
[0m11:21:07.476429 [info ] [Thread-1 (]: 3 of 3 OK created sql table model analytics.rsi_calculation .................... [[32mSUCCESS 1[0m in 1.33s]
[0m11:21:07.477228 [debug] [Thread-1 (]: Finished running node model.stock_prediction.rsi_calculation
[0m11:21:07.478529 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:21:07.478795 [debug] [MainThread]: Connection 'model.stock_prediction.rsi_calculation' was properly closed.
[0m11:21:07.479102 [info ] [MainThread]: 
[0m11:21:07.479340 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 5.07 seconds (5.07s).
[0m11:21:07.480018 [debug] [MainThread]: Command end result
[0m11:21:07.500653 [info ] [MainThread]: 
[0m11:21:07.500892 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:21:07.501057 [info ] [MainThread]: 
[0m11:21:07.501225 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:21:07.502487 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.9716954, "process_user_time": 1.76268, "process_kernel_time": 0.181095, "process_mem_max_rss": "140034048", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:21:07.502767 [debug] [MainThread]: Command `dbt run` succeeded at 11:21:07.502715 after 5.97 seconds
[0m11:21:07.502957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055d9d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030542f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10572a4b0>]}
[0m11:21:07.503132 [debug] [MainThread]: Flushing usage events
[0m11:22:53.887729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10703e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10898fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10898fd90>]}


============================== 11:22:53.889791 | 94423921-c00a-40f0-8590-7ab5292444d3 ==============================
[0m11:22:53.889791 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:22:53.890084 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:22:53.935575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94423921-c00a-40f0-8590-7ab5292444d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10782e8b0>]}
[0m11:22:53.943543 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.08851016, "process_user_time": 0.594099, "process_kernel_time": 0.090801, "process_mem_max_rss": "97288192", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:22:53.943832 [debug] [MainThread]: Command `dbt clean` succeeded at 11:22:53.943775 after 0.09 seconds
[0m11:22:53.944000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ad2470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ad2580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10873e150>]}
[0m11:22:53.944155 [debug] [MainThread]: Flushing usage events
[0m11:22:58.025982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10641a120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d6bed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d6bd90>]}


============================== 11:22:58.028181 | 55f7879a-04cc-4892-84a9-4ed9c21e1f75 ==============================
[0m11:22:58.028181 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:22:58.028488 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:22:58.186157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55f7879a-04cc-4892-84a9-4ed9c21e1f75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089d5a70>]}
[0m11:22:58.208592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55f7879a-04cc-4892-84a9-4ed9c21e1f75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c0490>]}
[0m11:22:58.208968 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:22:58.218016 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:22:58.218554 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:22:58.218733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '55f7879a-04cc-4892-84a9-4ed9c21e1f75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108820050>]}
[0m11:22:58.692795 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:22:58.693077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '55f7879a-04cc-4892-84a9-4ed9c21e1f75', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ae8e60>]}
[0m11:22:58.829306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55f7879a-04cc-4892-84a9-4ed9c21e1f75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cba7b0>]}
[0m11:22:58.875953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55f7879a-04cc-4892-84a9-4ed9c21e1f75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dfce20>]}
[0m11:22:58.876185 [info ] [MainThread]: Found 3 models, 19 data tests, 2 sources, 459 macros
[0m11:22:58.876343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55f7879a-04cc-4892-84a9-4ed9c21e1f75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108db37d0>]}
[0m11:22:58.877302 [info ] [MainThread]: 
[0m11:22:58.877547 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:22:58.879484 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m11:22:58.885264 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m11:22:58.885409 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m11:22:58.885520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:22:59.423548 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.538 seconds
[0m11:22:59.426359 [debug] [ThreadPool]: On list_dev: Close
[0m11:22:59.550618 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m11:22:59.561924 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m11:22:59.562333 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m11:22:59.562601 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:23:00.278665 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.716 seconds
[0m11:23:00.282633 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m11:23:00.418491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55f7879a-04cc-4892-84a9-4ed9c21e1f75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fb9f40>]}
[0m11:23:00.419283 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:23:00.419704 [info ] [MainThread]: 
[0m11:23:00.422711 [debug] [Thread-1 (]: Began running node model.stock_prediction.stock_prices
[0m11:23:00.423311 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.stock_prices ............................. [RUN]
[0m11:23:00.423791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.stock_prediction.stock_prices)
[0m11:23:00.424134 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.stock_prices
[0m11:23:00.432427 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.stock_prices"
[0m11:23:00.433767 [debug] [Thread-1 (]: Began executing node model.stock_prediction.stock_prices
[0m11:23:00.455345 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.stock_prices"
[0m11:23:00.456435 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.stock_prices"
[0m11:23:00.456668 [debug] [Thread-1 (]: On model.stock_prediction.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.stock_prices"} */
create or replace   view dev.analytics.stock_prices
  
   as (
    SELECT
    symbol,
    date,
    open,
    high,
    low,
    close,
    volume
FROM dev.raw_data.stock_prices
  );
[0m11:23:00.456860 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:23:01.195923 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.738 seconds
[0m11:23:01.221251 [debug] [Thread-1 (]: On model.stock_prediction.stock_prices: Close
[0m11:23:01.351838 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55f7879a-04cc-4892-84a9-4ed9c21e1f75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10732d3b0>]}
[0m11:23:01.352819 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.stock_prices ........................ [[32mSUCCESS 1[0m in 0.93s]
[0m11:23:01.353507 [debug] [Thread-1 (]: Finished running node model.stock_prediction.stock_prices
[0m11:23:01.354570 [debug] [Thread-1 (]: Began running node model.stock_prediction.moving_average
[0m11:23:01.355065 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.moving_average .......................... [RUN]
[0m11:23:01.355503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.stock_prices, now model.stock_prediction.moving_average)
[0m11:23:01.355846 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.moving_average
[0m11:23:01.359641 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.moving_average"
[0m11:23:01.360702 [debug] [Thread-1 (]: Began executing node model.stock_prediction.moving_average
[0m11:23:01.378295 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.moving_average"
[0m11:23:01.379334 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.moving_average"
[0m11:23:01.379606 [debug] [Thread-1 (]: On model.stock_prediction.moving_average: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.moving_average"} */
create or replace transient table dev.analytics.moving_average
         as
        (WITH stock_data AS (
    SELECT
        symbol,
        date,
        close
    FROM dev.analytics.stock_prices -- assuming 'stock_prices' is the name of the raw table model in dbt
)

SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
    ) AS moving_avg_5d,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
    ) AS moving_avg_20d
FROM stock_data
ORDER BY symbol, date
        );
[0m11:23:01.379845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:23:02.531278 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.151 seconds
[0m11:23:02.534809 [debug] [Thread-1 (]: On model.stock_prediction.moving_average: Close
[0m11:23:02.669744 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55f7879a-04cc-4892-84a9-4ed9c21e1f75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d80dd0>]}
[0m11:23:02.670582 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.moving_average ..................... [[32mSUCCESS 1[0m in 1.31s]
[0m11:23:02.671185 [debug] [Thread-1 (]: Finished running node model.stock_prediction.moving_average
[0m11:23:02.671590 [debug] [Thread-1 (]: Began running node model.stock_prediction.rsi_calculation
[0m11:23:02.672113 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics.rsi_calculation ......................... [RUN]
[0m11:23:02.672577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.moving_average, now model.stock_prediction.rsi_calculation)
[0m11:23:02.672913 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.rsi_calculation
[0m11:23:02.676132 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.rsi_calculation"
[0m11:23:02.677052 [debug] [Thread-1 (]: Began executing node model.stock_prediction.rsi_calculation
[0m11:23:02.678952 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.rsi_calculation"
[0m11:23:02.680540 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.rsi_calculation"
[0m11:23:02.680883 [debug] [Thread-1 (]: On model.stock_prediction.rsi_calculation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.rsi_calculation"} */
create or replace transient table dev.analytics.rsi_calculation
         as
        (WITH stock_data AS (
    SELECT
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM dev.analytics.stock_prices
),

price_changes AS (
    SELECT
        symbol,
        date,
        close,
        CASE 
            WHEN close > prev_close THEN close - prev_close
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close < prev_close THEN prev_close - close
            ELSE 0 
        END AS loss
    FROM stock_data
),

average_gains_losses AS (
    SELECT
        symbol,
        date,
        close,
        -- Calculate the average gain over the last 14 days, including the current row
        AVG(gain) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain,
        -- Calculate the average loss over the last 14 days, including the current row
        AVG(loss) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss
    FROM price_changes
)

SELECT
    symbol,
    date,
    close,
    avg_gain,
    avg_loss,
    -- Calculate RSI, using COALESCE to set to 0 if result is NULL
    COALESCE(100 - (100 / (1 + (NULLIF(avg_gain, 0) / NULLIF(avg_loss, 0)))), 0) AS rsi_14d
FROM average_gains_losses
ORDER BY symbol, date
        );
[0m11:23:02.681215 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:23:03.858558 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.177 seconds
[0m11:23:03.863313 [debug] [Thread-1 (]: On model.stock_prediction.rsi_calculation: Close
[0m11:23:04.015908 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55f7879a-04cc-4892-84a9-4ed9c21e1f75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109263f50>]}
[0m11:23:04.016997 [info ] [Thread-1 (]: 3 of 3 OK created sql table model analytics.rsi_calculation .................... [[32mSUCCESS 1[0m in 1.34s]
[0m11:23:04.017796 [debug] [Thread-1 (]: Finished running node model.stock_prediction.rsi_calculation
[0m11:23:04.019580 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:23:04.020032 [debug] [MainThread]: Connection 'model.stock_prediction.rsi_calculation' was properly closed.
[0m11:23:04.020504 [info ] [MainThread]: 
[0m11:23:04.020847 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 5.14 seconds (5.14s).
[0m11:23:04.021810 [debug] [MainThread]: Command end result
[0m11:23:04.049004 [info ] [MainThread]: 
[0m11:23:04.049287 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:23:04.049469 [info ] [MainThread]: 
[0m11:23:04.049654 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:23:04.050921 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.0575666, "process_user_time": 1.805848, "process_kernel_time": 0.180843, "process_mem_max_rss": "140165120", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:23:04.051240 [debug] [MainThread]: Command `dbt run` succeeded at 11:23:04.051181 after 6.06 seconds
[0m11:23:04.051452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090d6570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072c1bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109222570>]}
[0m11:23:04.051648 [debug] [MainThread]: Flushing usage events
[0m11:26:16.226576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104862120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061b3ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061b3d90>]}


============================== 11:26:16.228680 | e0b4f7bc-736e-471e-97b9-7478a19c3652 ==============================
[0m11:26:16.228680 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:26:16.228980 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/adi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:26:16.386478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0b4f7bc-736e-471e-97b9-7478a19c3652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107205a70>]}
[0m11:26:16.409032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0b4f7bc-736e-471e-97b9-7478a19c3652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fd0490>]}
[0m11:26:16.409426 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:26:16.417689 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:26:16.475789 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:26:16.475999 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:26:16.495135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0b4f7bc-736e-471e-97b9-7478a19c3652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f33950>]}
[0m11:26:16.549455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0b4f7bc-736e-471e-97b9-7478a19c3652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107739c70>]}
[0m11:26:16.549752 [info ] [MainThread]: Found 3 models, 19 data tests, 2 sources, 459 macros
[0m11:26:16.549902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0b4f7bc-736e-471e-97b9-7478a19c3652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107752190>]}
[0m11:26:16.551136 [info ] [MainThread]: 
[0m11:26:16.551428 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:26:16.553488 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_analytics'
[0m11:26:16.561372 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m11:26:16.561523 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m11:26:16.561645 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:26:17.164381 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.602 seconds
[0m11:26:17.168182 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m11:26:17.294049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0b4f7bc-736e-471e-97b9-7478a19c3652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077772b0>]}
[0m11:26:17.294686 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:26:17.295032 [info ] [MainThread]: 
[0m11:26:17.297937 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m11:26:17.298329 [info ] [Thread-1 (]: 1 of 19 START test not_null_moving_average_date ................................ [RUN]
[0m11:26:17.298705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now test.stock_prediction.not_null_moving_average_date.3ad00158b5)
[0m11:26:17.299003 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m11:26:17.313535 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_date.3ad00158b5"
[0m11:26:17.314278 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m11:26:17.327769 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_date.3ad00158b5"
[0m11:26:17.328461 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_date.3ad00158b5"
[0m11:26:17.328670 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_date.3ad00158b5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_date.3ad00158b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.moving_average
where date is null



      
    ) dbt_internal_test
[0m11:26:17.328858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:17.795447 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.466 seconds
[0m11:26:17.808989 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_date.3ad00158b5: Close
[0m11:26:17.938058 [info ] [Thread-1 (]: 1 of 19 PASS not_null_moving_average_date ...................................... [[32mPASS[0m in 0.64s]
[0m11:26:17.939316 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m11:26:17.940011 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_moving_avg.c8743581c8
[0m11:26:17.940661 [info ] [Thread-1 (]: 2 of 19 START test not_null_moving_average_moving_avg .......................... [RUN]
[0m11:26:17.941379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_date.3ad00158b5, now test.stock_prediction.not_null_moving_average_moving_avg.c8743581c8)
[0m11:26:17.941865 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_moving_avg.c8743581c8
[0m11:26:17.946591 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_moving_avg.c8743581c8"
[0m11:26:17.947645 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_moving_avg.c8743581c8
[0m11:26:17.949769 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_moving_avg.c8743581c8"
[0m11:26:17.950717 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_moving_avg.c8743581c8"
[0m11:26:17.951039 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg.c8743581c8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_moving_avg.c8743581c8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg
from dev.analytics.moving_average
where moving_avg is null



      
    ) dbt_internal_test
[0m11:26:17.951343 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:18.419389 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8214e-0004-1d17-0001-97d30004edd6
[0m11:26:18.419984 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'MOVING_AVG'
[0m11:26:18.420486 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg.c8743581c8: Close
[0m11:26:18.558432 [debug] [Thread-1 (]: Database Error in test not_null_moving_average_moving_avg (models/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MOVING_AVG'
  compiled code at target/run/stock_prediction/models/schema.yml/not_null_moving_average_moving_avg.sql
[0m11:26:18.559112 [error] [Thread-1 (]: 2 of 19 ERROR not_null_moving_average_moving_avg ............................... [[31mERROR[0m in 0.62s]
[0m11:26:18.559711 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_moving_avg.c8743581c8
[0m11:26:18.560139 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m11:26:18.561298 [info ] [Thread-1 (]: 3 of 19 START test not_null_moving_average_symbol .............................. [RUN]
[0m11:26:18.561761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_moving_avg.c8743581c8, now test.stock_prediction.not_null_moving_average_symbol.75a6f7473c)
[0m11:26:18.562069 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m11:26:18.566201 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"
[0m11:26:18.566927 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m11:26:18.568624 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"
[0m11:26:18.569458 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"
[0m11:26:18.569735 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_symbol.75a6f7473c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.moving_average
where symbol is null



      
    ) dbt_internal_test
[0m11:26:18.569993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:19.143697 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.573 seconds
[0m11:26:19.147259 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_symbol.75a6f7473c: Close
[0m11:26:19.272593 [info ] [Thread-1 (]: 3 of 19 PASS not_null_moving_average_symbol .................................... [[32mPASS[0m in 0.71s]
[0m11:26:19.273481 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m11:26:19.274015 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m11:26:19.274591 [info ] [Thread-1 (]: 4 of 19 START test not_null_rsi_calculation_avg_gain ........................... [RUN]
[0m11:26:19.275191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_symbol.75a6f7473c, now test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42)
[0m11:26:19.275576 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m11:26:19.280442 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m11:26:19.281417 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m11:26:19.283547 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m11:26:19.284432 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m11:26:19.284752 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_gain
from dev.analytics.rsi_calculation
where avg_gain is null



      
    ) dbt_internal_test
[0m11:26:19.285045 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:19.779344 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.494 seconds
[0m11:26:19.785253 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42: Close
[0m11:26:19.914053 [info ] [Thread-1 (]: 4 of 19 PASS not_null_rsi_calculation_avg_gain ................................. [[32mPASS[0m in 0.64s]
[0m11:26:19.914871 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m11:26:19.915249 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m11:26:19.915658 [info ] [Thread-1 (]: 5 of 19 START test not_null_rsi_calculation_avg_loss ........................... [RUN]
[0m11:26:19.916078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42, now test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19)
[0m11:26:19.916398 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m11:26:19.921162 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m11:26:19.922297 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m11:26:19.924429 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m11:26:19.925370 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m11:26:19.925710 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_loss
from dev.analytics.rsi_calculation
where avg_loss is null



      
    ) dbt_internal_test
[0m11:26:19.926012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:20.297015 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.371 seconds
[0m11:26:20.300650 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19: Close
[0m11:26:20.417272 [info ] [Thread-1 (]: 5 of 19 PASS not_null_rsi_calculation_avg_loss ................................. [[32mPASS[0m in 0.50s]
[0m11:26:20.418357 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m11:26:20.418907 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m11:26:20.419526 [info ] [Thread-1 (]: 6 of 19 START test not_null_rsi_calculation_date ............................... [RUN]
[0m11:26:20.420239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19, now test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76)
[0m11:26:20.420711 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m11:26:20.425974 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"
[0m11:26:20.427135 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m11:26:20.429390 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"
[0m11:26:20.430289 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"
[0m11:26:20.430612 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.rsi_calculation
where date is null



      
    ) dbt_internal_test
[0m11:26:20.430909 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:20.873718 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.442 seconds
[0m11:26:20.877714 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76: Close
[0m11:26:21.027710 [info ] [Thread-1 (]: 6 of 19 PASS not_null_rsi_calculation_date ..................................... [[32mPASS[0m in 0.61s]
[0m11:26:21.028652 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m11:26:21.029201 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_rsi.7783e32ddd
[0m11:26:21.029769 [info ] [Thread-1 (]: 7 of 19 START test not_null_rsi_calculation_rsi ................................ [RUN]
[0m11:26:21.030397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76, now test.stock_prediction.not_null_rsi_calculation_rsi.7783e32ddd)
[0m11:26:21.030829 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_rsi.7783e32ddd
[0m11:26:21.035730 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_rsi.7783e32ddd"
[0m11:26:21.036783 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_rsi.7783e32ddd
[0m11:26:21.038684 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_rsi.7783e32ddd"
[0m11:26:21.039591 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_rsi.7783e32ddd"
[0m11:26:21.039910 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_rsi.7783e32ddd: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_rsi.7783e32ddd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi
from dev.analytics.rsi_calculation
where rsi is null



      
    ) dbt_internal_test
[0m11:26:21.040207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:21.486183 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8214e-0004-1d17-0001-97d30004edea
[0m11:26:21.487018 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'RSI'
[0m11:26:21.487653 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_rsi.7783e32ddd: Close
[0m11:26:21.619610 [debug] [Thread-1 (]: Database Error in test not_null_rsi_calculation_rsi (models/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'RSI'
  compiled code at target/run/stock_prediction/models/schema.yml/not_null_rsi_calculation_rsi.sql
[0m11:26:21.620207 [error] [Thread-1 (]: 7 of 19 ERROR not_null_rsi_calculation_rsi ..................................... [[31mERROR[0m in 0.59s]
[0m11:26:21.620771 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_rsi.7783e32ddd
[0m11:26:21.621163 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m11:26:21.621630 [info ] [Thread-1 (]: 8 of 19 START test not_null_rsi_calculation_symbol ............................. [RUN]
[0m11:26:21.622119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_rsi.7783e32ddd, now test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84)
[0m11:26:21.622444 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m11:26:21.626545 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m11:26:21.627465 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m11:26:21.629213 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m11:26:21.629982 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m11:26:21.630256 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.rsi_calculation
where symbol is null



      
    ) dbt_internal_test
[0m11:26:21.630516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:22.044675 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.414 seconds
[0m11:26:22.048267 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84: Close
[0m11:26:22.184525 [info ] [Thread-1 (]: 8 of 19 PASS not_null_rsi_calculation_symbol ................................... [[32mPASS[0m in 0.56s]
[0m11:26:22.185466 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m11:26:22.186020 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m11:26:22.186569 [info ] [Thread-1 (]: 9 of 19 START test not_null_stock_prices_close ................................. [RUN]
[0m11:26:22.187161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84, now test.stock_prediction.not_null_stock_prices_close.d7e232e1ba)
[0m11:26:22.187599 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m11:26:22.192526 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"
[0m11:26:22.193589 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m11:26:22.195735 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"
[0m11:26:22.196613 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"
[0m11:26:22.196931 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_close.d7e232e1ba: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.stock_prices
where close is null



      
    ) dbt_internal_test
[0m11:26:22.197227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:22.596153 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.398 seconds
[0m11:26:22.600516 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_close.d7e232e1ba: Close
[0m11:26:22.724710 [info ] [Thread-1 (]: 9 of 19 PASS not_null_stock_prices_close ....................................... [[32mPASS[0m in 0.54s]
[0m11:26:22.725563 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m11:26:22.726118 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m11:26:22.726691 [info ] [Thread-1 (]: 10 of 19 START test not_null_stock_prices_date ................................. [RUN]
[0m11:26:22.727341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_close.d7e232e1ba, now test.stock_prediction.not_null_stock_prices_date.98a7527501)
[0m11:26:22.727791 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m11:26:22.732645 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_date.98a7527501"
[0m11:26:22.733629 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m11:26:22.735857 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_date.98a7527501"
[0m11:26:22.736769 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_date.98a7527501"
[0m11:26:22.737076 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_date.98a7527501: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_date.98a7527501"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.stock_prices
where date is null



      
    ) dbt_internal_test
[0m11:26:22.737372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:23.177331 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.440 seconds
[0m11:26:23.181248 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_date.98a7527501: Close
[0m11:26:23.294494 [info ] [Thread-1 (]: 10 of 19 PASS not_null_stock_prices_date ....................................... [[32mPASS[0m in 0.57s]
[0m11:26:23.295572 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m11:26:23.296112 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m11:26:23.296681 [info ] [Thread-1 (]: 11 of 19 START test not_null_stock_prices_high ................................. [RUN]
[0m11:26:23.297291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_date.98a7527501, now test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc)
[0m11:26:23.297684 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m11:26:23.302820 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"
[0m11:26:23.303964 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m11:26:23.306070 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"
[0m11:26:23.307005 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"
[0m11:26:23.307323 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select high
from dev.analytics.stock_prices
where high is null



      
    ) dbt_internal_test
[0m11:26:23.307618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:23.818467 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.510 seconds
[0m11:26:23.823284 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc: Close
[0m11:26:23.943249 [info ] [Thread-1 (]: 11 of 19 PASS not_null_stock_prices_high ....................................... [[32mPASS[0m in 0.65s]
[0m11:26:23.944563 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m11:26:23.945115 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m11:26:23.945578 [info ] [Thread-1 (]: 12 of 19 START test not_null_stock_prices_low .................................. [RUN]
[0m11:26:23.946105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc, now test.stock_prediction.not_null_stock_prices_low.e65294ca15)
[0m11:26:23.946481 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m11:26:23.951367 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_low.e65294ca15"
[0m11:26:23.952395 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m11:26:23.954348 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_low.e65294ca15"
[0m11:26:23.955358 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_low.e65294ca15"
[0m11:26:23.955683 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_low.e65294ca15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_low.e65294ca15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select low
from dev.analytics.stock_prices
where low is null



      
    ) dbt_internal_test
[0m11:26:23.955977 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:24.415441 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.459 seconds
[0m11:26:24.420039 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_low.e65294ca15: Close
[0m11:26:24.531999 [info ] [Thread-1 (]: 12 of 19 PASS not_null_stock_prices_low ........................................ [[32mPASS[0m in 0.59s]
[0m11:26:24.532903 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m11:26:24.533460 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m11:26:24.533973 [info ] [Thread-1 (]: 13 of 19 START test not_null_stock_prices_open ................................. [RUN]
[0m11:26:24.534479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_low.e65294ca15, now test.stock_prediction.not_null_stock_prices_open.e09b13f215)
[0m11:26:24.534887 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m11:26:24.540036 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_open.e09b13f215"
[0m11:26:24.540940 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m11:26:24.543072 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_open.e09b13f215"
[0m11:26:24.543955 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_open.e09b13f215"
[0m11:26:24.544263 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_open.e09b13f215: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_open.e09b13f215"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from dev.analytics.stock_prices
where open is null



      
    ) dbt_internal_test
[0m11:26:24.544558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:24.950060 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.405 seconds
[0m11:26:24.955071 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_open.e09b13f215: Close
[0m11:26:25.070289 [info ] [Thread-1 (]: 13 of 19 PASS not_null_stock_prices_open ....................................... [[32mPASS[0m in 0.54s]
[0m11:26:25.071273 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m11:26:25.071844 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m11:26:25.072347 [info ] [Thread-1 (]: 14 of 19 START test not_null_stock_prices_symbol ............................... [RUN]
[0m11:26:25.072959 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_open.e09b13f215, now test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8)
[0m11:26:25.073440 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m11:26:25.078470 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"
[0m11:26:25.079555 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m11:26:25.081506 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"
[0m11:26:25.082456 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"
[0m11:26:25.082790 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.stock_prices
where symbol is null



      
    ) dbt_internal_test
[0m11:26:25.083105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:25.488091 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.404 seconds
[0m11:26:25.494446 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8: Close
[0m11:26:25.657133 [info ] [Thread-1 (]: 14 of 19 PASS not_null_stock_prices_symbol ..................................... [[32mPASS[0m in 0.58s]
[0m11:26:25.658027 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m11:26:25.658599 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m11:26:25.659155 [info ] [Thread-1 (]: 15 of 19 START test not_null_stock_prices_volume ............................... [RUN]
[0m11:26:25.659729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8, now test.stock_prediction.not_null_stock_prices_volume.71420bc956)
[0m11:26:25.660116 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m11:26:25.665176 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_volume.71420bc956"
[0m11:26:25.666306 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m11:26:25.668327 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_volume.71420bc956"
[0m11:26:25.669275 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_volume.71420bc956"
[0m11:26:25.669594 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_volume.71420bc956: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_volume.71420bc956"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume
from dev.analytics.stock_prices
where volume is null



      
    ) dbt_internal_test
[0m11:26:25.669898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:26.137902 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.467 seconds
[0m11:26:26.143441 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_volume.71420bc956: Close
[0m11:26:26.267102 [info ] [Thread-1 (]: 15 of 19 PASS not_null_stock_prices_volume ..................................... [[32mPASS[0m in 0.61s]
[0m11:26:26.267786 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m11:26:26.268237 [debug] [Thread-1 (]: Began running node test.stock_prediction.unique_moving_average_date.a93c28e495
[0m11:26:26.268716 [info ] [Thread-1 (]: 16 of 19 START test unique_moving_average_date ................................. [RUN]
[0m11:26:26.269219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_volume.71420bc956, now test.stock_prediction.unique_moving_average_date.a93c28e495)
[0m11:26:26.269586 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.unique_moving_average_date.a93c28e495
[0m11:26:26.276196 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.unique_moving_average_date.a93c28e495"
[0m11:26:26.277179 [debug] [Thread-1 (]: Began executing node test.stock_prediction.unique_moving_average_date.a93c28e495
[0m11:26:26.278936 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.unique_moving_average_date.a93c28e495"
[0m11:26:26.279777 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.unique_moving_average_date.a93c28e495"
[0m11:26:26.280058 [debug] [Thread-1 (]: On test.stock_prediction.unique_moving_average_date.a93c28e495: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.unique_moving_average_date.a93c28e495"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from dev.analytics.moving_average
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m11:26:26.280335 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:26.761531 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.481 seconds
[0m11:26:26.765711 [debug] [Thread-1 (]: On test.stock_prediction.unique_moving_average_date.a93c28e495: Close
[0m11:26:26.892194 [error] [Thread-1 (]: 16 of 19 FAIL 90 unique_moving_average_date .................................... [[31mFAIL 90[0m in 0.62s]
[0m11:26:26.893066 [debug] [Thread-1 (]: Finished running node test.stock_prediction.unique_moving_average_date.a93c28e495
[0m11:26:26.893601 [debug] [Thread-1 (]: Began running node test.stock_prediction.unique_rsi_calculation_date.057b856de2
[0m11:26:26.894106 [info ] [Thread-1 (]: 17 of 19 START test unique_rsi_calculation_date ................................ [RUN]
[0m11:26:26.894595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.unique_moving_average_date.a93c28e495, now test.stock_prediction.unique_rsi_calculation_date.057b856de2)
[0m11:26:26.894951 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.unique_rsi_calculation_date.057b856de2
[0m11:26:26.899794 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.unique_rsi_calculation_date.057b856de2"
[0m11:26:26.900732 [debug] [Thread-1 (]: Began executing node test.stock_prediction.unique_rsi_calculation_date.057b856de2
[0m11:26:26.902698 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.unique_rsi_calculation_date.057b856de2"
[0m11:26:26.903679 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.unique_rsi_calculation_date.057b856de2"
[0m11:26:26.904015 [debug] [Thread-1 (]: On test.stock_prediction.unique_rsi_calculation_date.057b856de2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.unique_rsi_calculation_date.057b856de2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from dev.analytics.rsi_calculation
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m11:26:26.904315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:27.381227 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.476 seconds
[0m11:26:27.386758 [debug] [Thread-1 (]: On test.stock_prediction.unique_rsi_calculation_date.057b856de2: Close
[0m11:26:27.515463 [error] [Thread-1 (]: 17 of 19 FAIL 90 unique_rsi_calculation_date ................................... [[31mFAIL 90[0m in 0.62s]
[0m11:26:27.516334 [debug] [Thread-1 (]: Finished running node test.stock_prediction.unique_rsi_calculation_date.057b856de2
[0m11:26:27.516882 [debug] [Thread-1 (]: Began running node test.stock_prediction.unique_stock_prices_date.1d2e222e60
[0m11:26:27.517386 [info ] [Thread-1 (]: 18 of 19 START test unique_stock_prices_date ................................... [RUN]
[0m11:26:27.517919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.unique_rsi_calculation_date.057b856de2, now test.stock_prediction.unique_stock_prices_date.1d2e222e60)
[0m11:26:27.518294 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.unique_stock_prices_date.1d2e222e60
[0m11:26:27.523240 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.unique_stock_prices_date.1d2e222e60"
[0m11:26:27.524218 [debug] [Thread-1 (]: Began executing node test.stock_prediction.unique_stock_prices_date.1d2e222e60
[0m11:26:27.526186 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.unique_stock_prices_date.1d2e222e60"
[0m11:26:27.527167 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.unique_stock_prices_date.1d2e222e60"
[0m11:26:27.527501 [debug] [Thread-1 (]: On test.stock_prediction.unique_stock_prices_date.1d2e222e60: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.unique_stock_prices_date.1d2e222e60"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from dev.analytics.stock_prices
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m11:26:27.527803 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:27.934406 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.406 seconds
[0m11:26:27.939640 [debug] [Thread-1 (]: On test.stock_prediction.unique_stock_prices_date.1d2e222e60: Close
[0m11:26:28.069922 [error] [Thread-1 (]: 18 of 19 FAIL 90 unique_stock_prices_date ...................................... [[31mFAIL 90[0m in 0.55s]
[0m11:26:28.071285 [debug] [Thread-1 (]: Finished running node test.stock_prediction.unique_stock_prices_date.1d2e222e60
[0m11:26:28.071870 [debug] [Thread-1 (]: Began running node test.stock_prediction.unique_stock_prices_symbol.e6ae7e0ef5
[0m11:26:28.072420 [info ] [Thread-1 (]: 19 of 19 START test unique_stock_prices_symbol ................................. [RUN]
[0m11:26:28.072988 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.unique_stock_prices_date.1d2e222e60, now test.stock_prediction.unique_stock_prices_symbol.e6ae7e0ef5)
[0m11:26:28.073349 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.unique_stock_prices_symbol.e6ae7e0ef5
[0m11:26:28.078056 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.unique_stock_prices_symbol.e6ae7e0ef5"
[0m11:26:28.078984 [debug] [Thread-1 (]: Began executing node test.stock_prediction.unique_stock_prices_symbol.e6ae7e0ef5
[0m11:26:28.080959 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.unique_stock_prices_symbol.e6ae7e0ef5"
[0m11:26:28.081953 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.unique_stock_prices_symbol.e6ae7e0ef5"
[0m11:26:28.082331 [debug] [Thread-1 (]: On test.stock_prediction.unique_stock_prices_symbol.e6ae7e0ef5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.unique_stock_prices_symbol.e6ae7e0ef5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    symbol as unique_field,
    count(*) as n_records

from dev.analytics.stock_prices
where symbol is not null
group by symbol
having count(*) > 1



      
    ) dbt_internal_test
[0m11:26:28.082620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:28.606825 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.524 seconds
[0m11:26:28.611882 [debug] [Thread-1 (]: On test.stock_prediction.unique_stock_prices_symbol.e6ae7e0ef5: Close
[0m11:26:28.767425 [error] [Thread-1 (]: 19 of 19 FAIL 2 unique_stock_prices_symbol ..................................... [[31mFAIL 2[0m in 0.69s]
[0m11:26:28.768277 [debug] [Thread-1 (]: Finished running node test.stock_prediction.unique_stock_prices_symbol.e6ae7e0ef5
[0m11:26:28.770008 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:26:28.770369 [debug] [MainThread]: Connection 'test.stock_prediction.unique_stock_prices_symbol.e6ae7e0ef5' was properly closed.
[0m11:26:28.770723 [info ] [MainThread]: 
[0m11:26:28.771034 [info ] [MainThread]: Finished running 19 data tests in 0 hours 0 minutes and 12.22 seconds (12.22s).
[0m11:26:28.774087 [debug] [MainThread]: Command end result
[0m11:26:28.802818 [info ] [MainThread]: 
[0m11:26:28.803089 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m11:26:28.803258 [info ] [MainThread]: 
[0m11:26:28.803473 [error] [MainThread]:   Database Error in test not_null_moving_average_moving_avg (models/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MOVING_AVG'
  compiled code at target/run/stock_prediction/models/schema.yml/not_null_moving_average_moving_avg.sql
[0m11:26:28.803634 [info ] [MainThread]: 
[0m11:26:28.803833 [error] [MainThread]:   Database Error in test not_null_rsi_calculation_rsi (models/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'RSI'
  compiled code at target/run/stock_prediction/models/schema.yml/not_null_rsi_calculation_rsi.sql
[0m11:26:28.803982 [info ] [MainThread]: 
[0m11:26:28.804172 [error] [MainThread]: [31mFailure in test unique_moving_average_date (models/schema.yml)[0m
[0m11:26:28.804354 [error] [MainThread]:   Got 90 results, configured to fail if != 0
[0m11:26:28.804490 [info ] [MainThread]: 
[0m11:26:28.804671 [info ] [MainThread]:   compiled code at target/compiled/stock_prediction/models/schema.yml/unique_moving_average_date.sql
[0m11:26:28.804815 [info ] [MainThread]: 
[0m11:26:28.804989 [error] [MainThread]: [31mFailure in test unique_rsi_calculation_date (models/schema.yml)[0m
[0m11:26:28.805148 [error] [MainThread]:   Got 90 results, configured to fail if != 0
[0m11:26:28.805269 [info ] [MainThread]: 
[0m11:26:28.805507 [info ] [MainThread]:   compiled code at target/compiled/stock_prediction/models/schema.yml/unique_rsi_calculation_date.sql
[0m11:26:28.805658 [info ] [MainThread]: 
[0m11:26:28.805846 [error] [MainThread]: [31mFailure in test unique_stock_prices_date (models/schema.yml)[0m
[0m11:26:28.806014 [error] [MainThread]:   Got 90 results, configured to fail if != 0
[0m11:26:28.806146 [info ] [MainThread]: 
[0m11:26:28.806308 [info ] [MainThread]:   compiled code at target/compiled/stock_prediction/models/schema.yml/unique_stock_prices_date.sql
[0m11:26:28.806434 [info ] [MainThread]: 
[0m11:26:28.806601 [error] [MainThread]: [31mFailure in test unique_stock_prices_symbol (models/schema.yml)[0m
[0m11:26:28.806763 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m11:26:28.806886 [info ] [MainThread]: 
[0m11:26:28.807040 [info ] [MainThread]:   compiled code at target/compiled/stock_prediction/models/schema.yml/unique_stock_prices_symbol.sql
[0m11:26:28.807178 [info ] [MainThread]: 
[0m11:26:28.807326 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=6 SKIP=0 TOTAL=19
[0m11:26:28.808422 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 12.613442, "process_user_time": 2.376605, "process_kernel_time": 0.317555, "process_mem_max_rss": "141737984", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:26:28.808717 [debug] [MainThread]: Command `dbt test` failed at 11:26:28.808664 after 12.61 seconds
[0m11:26:28.808916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105edb050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ae5650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ae7e30>]}
[0m11:26:28.809108 [debug] [MainThread]: Flushing usage events
[0m11:28:15.652435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106baa120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084fbed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084fbd90>]}


============================== 11:28:15.654717 | d342023a-5b59-43c5-a1cb-752342c2b0d6 ==============================
[0m11:28:15.654717 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:28:15.655027 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'version_check': 'True', 'profiles_dir': '/Users/adi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:28:15.701719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd342023a-5b59-43c5-a1cb-752342c2b0d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10739a8b0>]}
[0m11:28:15.710791 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.0902485, "process_user_time": 0.59516, "process_kernel_time": 0.090621, "process_mem_max_rss": "98058240", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:28:15.711079 [debug] [MainThread]: Command `dbt clean` succeeded at 11:28:15.711013 after 0.09 seconds
[0m11:28:15.711242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10863a470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10863a580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082ae150>]}
[0m11:28:15.711389 [debug] [MainThread]: Flushing usage events
[0m11:28:20.398085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105332120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c83ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c83d90>]}


============================== 11:28:20.400275 | 1149034d-b9ea-42d7-8d9f-17d4ec70aa55 ==============================
[0m11:28:20.400275 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:28:20.400576 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/adi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:28:20.561122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1149034d-b9ea-42d7-8d9f-17d4ec70aa55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078eda70>]}
[0m11:28:20.583662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1149034d-b9ea-42d7-8d9f-17d4ec70aa55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078b8490>]}
[0m11:28:20.584046 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:28:20.592188 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:28:20.592732 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:28:20.592910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1149034d-b9ea-42d7-8d9f-17d4ec70aa55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107818050>]}
[0m11:28:21.071864 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:28:21.072150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1149034d-b9ea-42d7-8d9f-17d4ec70aa55', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a033e0>]}
[0m11:28:21.212472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1149034d-b9ea-42d7-8d9f-17d4ec70aa55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b97150>]}
[0m11:28:21.267368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1149034d-b9ea-42d7-8d9f-17d4ec70aa55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dfef70>]}
[0m11:28:21.267662 [info ] [MainThread]: Found 3 models, 18 data tests, 2 sources, 459 macros
[0m11:28:21.267837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1149034d-b9ea-42d7-8d9f-17d4ec70aa55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e3f7d0>]}
[0m11:28:21.268992 [info ] [MainThread]: 
[0m11:28:21.269297 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:28:21.271344 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_analytics'
[0m11:28:21.278583 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m11:28:21.278740 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m11:28:21.278857 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:28:21.921394 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.642 seconds
[0m11:28:21.926089 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m11:28:22.076583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1149034d-b9ea-42d7-8d9f-17d4ec70aa55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108107ac0>]}
[0m11:28:22.077445 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:28:22.077795 [info ] [MainThread]: 
[0m11:28:22.080813 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m11:28:22.081279 [info ] [Thread-1 (]: 1 of 18 START test not_null_moving_average_date ................................ [RUN]
[0m11:28:22.081734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now test.stock_prediction.not_null_moving_average_date.3ad00158b5)
[0m11:28:22.082084 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m11:28:22.097485 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_date.3ad00158b5"
[0m11:28:22.098670 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m11:28:22.112711 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_date.3ad00158b5"
[0m11:28:22.113599 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_date.3ad00158b5"
[0m11:28:22.113816 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_date.3ad00158b5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_date.3ad00158b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.moving_average
where date is null



      
    ) dbt_internal_test
[0m11:28:22.114091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:22.524070 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.409 seconds
[0m11:28:22.539056 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_date.3ad00158b5: Close
[0m11:28:22.670801 [info ] [Thread-1 (]: 1 of 18 PASS not_null_moving_average_date ...................................... [[32mPASS[0m in 0.59s]
[0m11:28:22.672081 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m11:28:22.672682 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_moving_avg.c8743581c8
[0m11:28:22.673245 [info ] [Thread-1 (]: 2 of 18 START test not_null_moving_average_moving_avg .......................... [RUN]
[0m11:28:22.673759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_date.3ad00158b5, now test.stock_prediction.not_null_moving_average_moving_avg.c8743581c8)
[0m11:28:22.674095 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_moving_avg.c8743581c8
[0m11:28:22.683626 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_moving_avg.c8743581c8"
[0m11:28:22.684714 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_moving_avg.c8743581c8
[0m11:28:22.686544 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_moving_avg.c8743581c8"
[0m11:28:22.687348 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_moving_avg.c8743581c8"
[0m11:28:22.687610 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg.c8743581c8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_moving_avg.c8743581c8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg
from dev.analytics.moving_average
where moving_avg is null



      
    ) dbt_internal_test
[0m11:28:22.687846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:23.117785 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b82150-0004-1c21-0001-97d30004fce6
[0m11:28:23.118344 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'MOVING_AVG'
[0m11:28:23.118747 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg.c8743581c8: Close
[0m11:28:23.243845 [debug] [Thread-1 (]: Database Error in test not_null_moving_average_moving_avg (models/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MOVING_AVG'
  compiled code at target/run/stock_prediction/models/schema.yml/not_null_moving_average_moving_avg.sql
[0m11:28:23.244570 [error] [Thread-1 (]: 2 of 18 ERROR not_null_moving_average_moving_avg ............................... [[31mERROR[0m in 0.57s]
[0m11:28:23.245244 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_moving_avg.c8743581c8
[0m11:28:23.245700 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m11:28:23.246927 [info ] [Thread-1 (]: 3 of 18 START test not_null_moving_average_symbol .............................. [RUN]
[0m11:28:23.247393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_moving_avg.c8743581c8, now test.stock_prediction.not_null_moving_average_symbol.75a6f7473c)
[0m11:28:23.247722 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m11:28:23.252030 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"
[0m11:28:23.252952 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m11:28:23.255659 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"
[0m11:28:23.256524 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"
[0m11:28:23.256821 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_symbol.75a6f7473c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.moving_average
where symbol is null



      
    ) dbt_internal_test
[0m11:28:23.257087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:23.696763 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.439 seconds
[0m11:28:23.701786 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_symbol.75a6f7473c: Close
[0m11:28:23.842825 [info ] [Thread-1 (]: 3 of 18 PASS not_null_moving_average_symbol .................................... [[32mPASS[0m in 0.59s]
[0m11:28:23.844281 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m11:28:23.844788 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m11:28:23.845200 [info ] [Thread-1 (]: 4 of 18 START test not_null_rsi_calculation_avg_gain ........................... [RUN]
[0m11:28:23.845683 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_symbol.75a6f7473c, now test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42)
[0m11:28:23.845964 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m11:28:23.849732 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m11:28:23.850552 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m11:28:23.852662 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m11:28:23.853411 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m11:28:23.853665 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_gain
from dev.analytics.rsi_calculation
where avg_gain is null



      
    ) dbt_internal_test
[0m11:28:23.853899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:24.264566 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.410 seconds
[0m11:28:24.270178 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42: Close
[0m11:28:24.412972 [info ] [Thread-1 (]: 4 of 18 PASS not_null_rsi_calculation_avg_gain ................................. [[32mPASS[0m in 0.57s]
[0m11:28:24.413982 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m11:28:24.414549 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m11:28:24.415093 [info ] [Thread-1 (]: 5 of 18 START test not_null_rsi_calculation_avg_loss ........................... [RUN]
[0m11:28:24.415686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42, now test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19)
[0m11:28:24.416150 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m11:28:24.421858 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m11:28:24.423152 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m11:28:24.426406 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m11:28:24.427738 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m11:28:24.428089 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_loss
from dev.analytics.rsi_calculation
where avg_loss is null



      
    ) dbt_internal_test
[0m11:28:24.428403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:24.970692 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.542 seconds
[0m11:28:24.974335 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19: Close
[0m11:28:25.119511 [info ] [Thread-1 (]: 5 of 18 PASS not_null_rsi_calculation_avg_loss ................................. [[32mPASS[0m in 0.70s]
[0m11:28:25.120533 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m11:28:25.121103 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m11:28:25.121668 [info ] [Thread-1 (]: 6 of 18 START test not_null_rsi_calculation_date ............................... [RUN]
[0m11:28:25.122287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19, now test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76)
[0m11:28:25.122744 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m11:28:25.127796 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"
[0m11:28:25.128993 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m11:28:25.131016 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"
[0m11:28:25.131938 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"
[0m11:28:25.132253 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.rsi_calculation
where date is null



      
    ) dbt_internal_test
[0m11:28:25.132557 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:25.541257 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.408 seconds
[0m11:28:25.546656 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76: Close
[0m11:28:25.680003 [info ] [Thread-1 (]: 6 of 18 PASS not_null_rsi_calculation_date ..................................... [[32mPASS[0m in 0.56s]
[0m11:28:25.680972 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m11:28:25.681523 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_rsi.7783e32ddd
[0m11:28:25.682083 [info ] [Thread-1 (]: 7 of 18 START test not_null_rsi_calculation_rsi ................................ [RUN]
[0m11:28:25.682698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76, now test.stock_prediction.not_null_rsi_calculation_rsi.7783e32ddd)
[0m11:28:25.683165 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_rsi.7783e32ddd
[0m11:28:25.688156 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_rsi.7783e32ddd"
[0m11:28:25.689238 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_rsi.7783e32ddd
[0m11:28:25.691301 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_rsi.7783e32ddd"
[0m11:28:25.692252 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_rsi.7783e32ddd"
[0m11:28:25.692574 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_rsi.7783e32ddd: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_rsi.7783e32ddd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi
from dev.analytics.rsi_calculation
where rsi is null



      
    ) dbt_internal_test
[0m11:28:25.692884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:26.199182 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b82150-0004-1c21-0001-97d30004fcee
[0m11:28:26.200744 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'RSI'
[0m11:28:26.201532 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_rsi.7783e32ddd: Close
[0m11:28:26.324878 [debug] [Thread-1 (]: Database Error in test not_null_rsi_calculation_rsi (models/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'RSI'
  compiled code at target/run/stock_prediction/models/schema.yml/not_null_rsi_calculation_rsi.sql
[0m11:28:26.325514 [error] [Thread-1 (]: 7 of 18 ERROR not_null_rsi_calculation_rsi ..................................... [[31mERROR[0m in 0.64s]
[0m11:28:26.326126 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_rsi.7783e32ddd
[0m11:28:26.326500 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m11:28:26.326962 [info ] [Thread-1 (]: 8 of 18 START test not_null_rsi_calculation_symbol ............................. [RUN]
[0m11:28:26.327416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_rsi.7783e32ddd, now test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84)
[0m11:28:26.327754 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m11:28:26.332035 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m11:28:26.333047 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m11:28:26.334902 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m11:28:26.335717 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m11:28:26.335995 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.rsi_calculation
where symbol is null



      
    ) dbt_internal_test
[0m11:28:26.336254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:26.774788 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.438 seconds
[0m11:28:26.778937 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84: Close
[0m11:28:26.889659 [info ] [Thread-1 (]: 8 of 18 PASS not_null_rsi_calculation_symbol ................................... [[32mPASS[0m in 0.56s]
[0m11:28:26.890629 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m11:28:26.891192 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m11:28:26.891771 [info ] [Thread-1 (]: 9 of 18 START test not_null_stock_prices_close ................................. [RUN]
[0m11:28:26.892419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84, now test.stock_prediction.not_null_stock_prices_close.d7e232e1ba)
[0m11:28:26.892876 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m11:28:26.897900 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"
[0m11:28:26.899083 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m11:28:26.901076 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"
[0m11:28:26.901983 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"
[0m11:28:26.902294 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_close.d7e232e1ba: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.stock_prices
where close is null



      
    ) dbt_internal_test
[0m11:28:26.902581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:27.359784 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.456 seconds
[0m11:28:27.364721 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_close.d7e232e1ba: Close
[0m11:28:27.501781 [info ] [Thread-1 (]: 9 of 18 PASS not_null_stock_prices_close ....................................... [[32mPASS[0m in 0.61s]
[0m11:28:27.503194 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m11:28:27.503857 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m11:28:27.504437 [info ] [Thread-1 (]: 10 of 18 START test not_null_stock_prices_date ................................. [RUN]
[0m11:28:27.505121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_close.d7e232e1ba, now test.stock_prediction.not_null_stock_prices_date.98a7527501)
[0m11:28:27.505557 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m11:28:27.510684 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_date.98a7527501"
[0m11:28:27.511750 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m11:28:27.513764 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_date.98a7527501"
[0m11:28:27.514697 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_date.98a7527501"
[0m11:28:27.515010 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_date.98a7527501: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_date.98a7527501"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.stock_prices
where date is null



      
    ) dbt_internal_test
[0m11:28:27.515299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:27.918926 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.403 seconds
[0m11:28:27.923259 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_date.98a7527501: Close
[0m11:28:28.046324 [info ] [Thread-1 (]: 10 of 18 PASS not_null_stock_prices_date ....................................... [[32mPASS[0m in 0.54s]
[0m11:28:28.047249 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m11:28:28.047796 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m11:28:28.048347 [info ] [Thread-1 (]: 11 of 18 START test not_null_stock_prices_high ................................. [RUN]
[0m11:28:28.048865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_date.98a7527501, now test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc)
[0m11:28:28.049237 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m11:28:28.054250 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"
[0m11:28:28.055285 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m11:28:28.057252 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"
[0m11:28:28.058163 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"
[0m11:28:28.058483 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select high
from dev.analytics.stock_prices
where high is null



      
    ) dbt_internal_test
[0m11:28:28.058773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:28.471307 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.412 seconds
[0m11:28:28.475887 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc: Close
[0m11:28:28.597328 [info ] [Thread-1 (]: 11 of 18 PASS not_null_stock_prices_high ....................................... [[32mPASS[0m in 0.55s]
[0m11:28:28.598209 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m11:28:28.598682 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m11:28:28.599150 [info ] [Thread-1 (]: 12 of 18 START test not_null_stock_prices_low .................................. [RUN]
[0m11:28:28.599656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc, now test.stock_prediction.not_null_stock_prices_low.e65294ca15)
[0m11:28:28.600043 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m11:28:28.604922 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_low.e65294ca15"
[0m11:28:28.606060 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m11:28:28.608001 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_low.e65294ca15"
[0m11:28:28.608929 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_low.e65294ca15"
[0m11:28:28.609251 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_low.e65294ca15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_low.e65294ca15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select low
from dev.analytics.stock_prices
where low is null



      
    ) dbt_internal_test
[0m11:28:28.609545 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:29.085019 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.475 seconds
[0m11:28:29.090623 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_low.e65294ca15: Close
[0m11:28:29.201398 [info ] [Thread-1 (]: 12 of 18 PASS not_null_stock_prices_low ........................................ [[32mPASS[0m in 0.60s]
[0m11:28:29.202435 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m11:28:29.202973 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m11:28:29.203438 [info ] [Thread-1 (]: 13 of 18 START test not_null_stock_prices_open ................................. [RUN]
[0m11:28:29.203946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_low.e65294ca15, now test.stock_prediction.not_null_stock_prices_open.e09b13f215)
[0m11:28:29.204323 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m11:28:29.209258 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_open.e09b13f215"
[0m11:28:29.210373 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m11:28:29.212419 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_open.e09b13f215"
[0m11:28:29.213306 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_open.e09b13f215"
[0m11:28:29.213624 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_open.e09b13f215: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_open.e09b13f215"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from dev.analytics.stock_prices
where open is null



      
    ) dbt_internal_test
[0m11:28:29.213915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:29.803434 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.589 seconds
[0m11:28:29.808481 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_open.e09b13f215: Close
[0m11:28:29.938881 [info ] [Thread-1 (]: 13 of 18 PASS not_null_stock_prices_open ....................................... [[32mPASS[0m in 0.73s]
[0m11:28:29.940025 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m11:28:29.940589 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m11:28:29.941171 [info ] [Thread-1 (]: 14 of 18 START test not_null_stock_prices_symbol ............................... [RUN]
[0m11:28:29.941820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_open.e09b13f215, now test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8)
[0m11:28:29.942304 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m11:28:29.947573 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"
[0m11:28:29.948750 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m11:28:29.950734 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"
[0m11:28:29.951687 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"
[0m11:28:29.952010 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.stock_prices
where symbol is null



      
    ) dbt_internal_test
[0m11:28:29.952310 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:30.407194 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.454 seconds
[0m11:28:30.413189 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8: Close
[0m11:28:30.530825 [info ] [Thread-1 (]: 14 of 18 PASS not_null_stock_prices_symbol ..................................... [[32mPASS[0m in 0.59s]
[0m11:28:30.532096 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m11:28:30.532628 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m11:28:30.533120 [info ] [Thread-1 (]: 15 of 18 START test not_null_stock_prices_volume ............................... [RUN]
[0m11:28:30.533682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8, now test.stock_prediction.not_null_stock_prices_volume.71420bc956)
[0m11:28:30.534045 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m11:28:30.538622 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_volume.71420bc956"
[0m11:28:30.539602 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m11:28:30.541543 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_volume.71420bc956"
[0m11:28:30.542460 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_volume.71420bc956"
[0m11:28:30.542779 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_volume.71420bc956: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_volume.71420bc956"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume
from dev.analytics.stock_prices
where volume is null



      
    ) dbt_internal_test
[0m11:28:30.543085 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:30.992176 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.448 seconds
[0m11:28:30.999400 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_volume.71420bc956: Close
[0m11:28:31.123646 [info ] [Thread-1 (]: 15 of 18 PASS not_null_stock_prices_volume ..................................... [[32mPASS[0m in 0.59s]
[0m11:28:31.125034 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m11:28:31.125704 [debug] [Thread-1 (]: Began running node test.stock_prediction.unique_moving_average_date.a93c28e495
[0m11:28:31.126273 [info ] [Thread-1 (]: 16 of 18 START test unique_moving_average_date ................................. [RUN]
[0m11:28:31.127017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_volume.71420bc956, now test.stock_prediction.unique_moving_average_date.a93c28e495)
[0m11:28:31.127489 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.unique_moving_average_date.a93c28e495
[0m11:28:31.135129 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.unique_moving_average_date.a93c28e495"
[0m11:28:31.136234 [debug] [Thread-1 (]: Began executing node test.stock_prediction.unique_moving_average_date.a93c28e495
[0m11:28:31.138290 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.unique_moving_average_date.a93c28e495"
[0m11:28:31.139316 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.unique_moving_average_date.a93c28e495"
[0m11:28:31.139644 [debug] [Thread-1 (]: On test.stock_prediction.unique_moving_average_date.a93c28e495: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.unique_moving_average_date.a93c28e495"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from dev.analytics.moving_average
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m11:28:31.139919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:31.546410 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.406 seconds
[0m11:28:31.551903 [debug] [Thread-1 (]: On test.stock_prediction.unique_moving_average_date.a93c28e495: Close
[0m11:28:31.665881 [error] [Thread-1 (]: 16 of 18 FAIL 90 unique_moving_average_date .................................... [[31mFAIL 90[0m in 0.54s]
[0m11:28:31.666773 [debug] [Thread-1 (]: Finished running node test.stock_prediction.unique_moving_average_date.a93c28e495
[0m11:28:31.667309 [debug] [Thread-1 (]: Began running node test.stock_prediction.unique_rsi_calculation_date.057b856de2
[0m11:28:31.667839 [info ] [Thread-1 (]: 17 of 18 START test unique_rsi_calculation_date ................................ [RUN]
[0m11:28:31.668423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.unique_moving_average_date.a93c28e495, now test.stock_prediction.unique_rsi_calculation_date.057b856de2)
[0m11:28:31.668864 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.unique_rsi_calculation_date.057b856de2
[0m11:28:31.673806 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.unique_rsi_calculation_date.057b856de2"
[0m11:28:31.674897 [debug] [Thread-1 (]: Began executing node test.stock_prediction.unique_rsi_calculation_date.057b856de2
[0m11:28:31.676891 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.unique_rsi_calculation_date.057b856de2"
[0m11:28:31.677866 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.unique_rsi_calculation_date.057b856de2"
[0m11:28:31.678191 [debug] [Thread-1 (]: On test.stock_prediction.unique_rsi_calculation_date.057b856de2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.unique_rsi_calculation_date.057b856de2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from dev.analytics.rsi_calculation
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m11:28:31.678493 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:32.192239 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.513 seconds
[0m11:28:32.196216 [debug] [Thread-1 (]: On test.stock_prediction.unique_rsi_calculation_date.057b856de2: Close
[0m11:28:32.339074 [error] [Thread-1 (]: 17 of 18 FAIL 90 unique_rsi_calculation_date ................................... [[31mFAIL 90[0m in 0.67s]
[0m11:28:32.340434 [debug] [Thread-1 (]: Finished running node test.stock_prediction.unique_rsi_calculation_date.057b856de2
[0m11:28:32.341056 [debug] [Thread-1 (]: Began running node test.stock_prediction.unique_stock_prices_date.1d2e222e60
[0m11:28:32.341623 [info ] [Thread-1 (]: 18 of 18 START test unique_stock_prices_date ................................... [RUN]
[0m11:28:32.342157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.unique_rsi_calculation_date.057b856de2, now test.stock_prediction.unique_stock_prices_date.1d2e222e60)
[0m11:28:32.342542 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.unique_stock_prices_date.1d2e222e60
[0m11:28:32.347558 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.unique_stock_prices_date.1d2e222e60"
[0m11:28:32.348696 [debug] [Thread-1 (]: Began executing node test.stock_prediction.unique_stock_prices_date.1d2e222e60
[0m11:28:32.350779 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.unique_stock_prices_date.1d2e222e60"
[0m11:28:32.351806 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.unique_stock_prices_date.1d2e222e60"
[0m11:28:32.352125 [debug] [Thread-1 (]: On test.stock_prediction.unique_stock_prices_date.1d2e222e60: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.unique_stock_prices_date.1d2e222e60"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from dev.analytics.stock_prices
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m11:28:32.352420 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:32.807019 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.454 seconds
[0m11:28:32.813341 [debug] [Thread-1 (]: On test.stock_prediction.unique_stock_prices_date.1d2e222e60: Close
[0m11:28:32.931124 [error] [Thread-1 (]: 18 of 18 FAIL 90 unique_stock_prices_date ...................................... [[31mFAIL 90[0m in 0.59s]
[0m11:28:32.931769 [debug] [Thread-1 (]: Finished running node test.stock_prediction.unique_stock_prices_date.1d2e222e60
[0m11:28:32.933214 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:28:32.933496 [debug] [MainThread]: Connection 'test.stock_prediction.unique_stock_prices_date.1d2e222e60' was properly closed.
[0m11:28:32.933761 [info ] [MainThread]: 
[0m11:28:32.934010 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 11.66 seconds (11.66s).
[0m11:28:32.936259 [debug] [MainThread]: Command end result
[0m11:28:32.959299 [info ] [MainThread]: 
[0m11:28:32.959535 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m11:28:32.959693 [info ] [MainThread]: 
[0m11:28:32.959898 [error] [MainThread]:   Database Error in test not_null_moving_average_moving_avg (models/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MOVING_AVG'
  compiled code at target/run/stock_prediction/models/schema.yml/not_null_moving_average_moving_avg.sql
[0m11:28:32.960046 [info ] [MainThread]: 
[0m11:28:32.960219 [error] [MainThread]:   Database Error in test not_null_rsi_calculation_rsi (models/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'RSI'
  compiled code at target/run/stock_prediction/models/schema.yml/not_null_rsi_calculation_rsi.sql
[0m11:28:32.960356 [info ] [MainThread]: 
[0m11:28:32.960535 [error] [MainThread]: [31mFailure in test unique_moving_average_date (models/schema.yml)[0m
[0m11:28:32.960701 [error] [MainThread]:   Got 90 results, configured to fail if != 0
[0m11:28:32.960820 [info ] [MainThread]: 
[0m11:28:32.960978 [info ] [MainThread]:   compiled code at target/compiled/stock_prediction/models/schema.yml/unique_moving_average_date.sql
[0m11:28:32.961104 [info ] [MainThread]: 
[0m11:28:32.961263 [error] [MainThread]: [31mFailure in test unique_rsi_calculation_date (models/schema.yml)[0m
[0m11:28:32.961420 [error] [MainThread]:   Got 90 results, configured to fail if != 0
[0m11:28:32.961540 [info ] [MainThread]: 
[0m11:28:32.961689 [info ] [MainThread]:   compiled code at target/compiled/stock_prediction/models/schema.yml/unique_rsi_calculation_date.sql
[0m11:28:32.961810 [info ] [MainThread]: 
[0m11:28:32.961969 [error] [MainThread]: [31mFailure in test unique_stock_prices_date (models/schema.yml)[0m
[0m11:28:32.962125 [error] [MainThread]:   Got 90 results, configured to fail if != 0
[0m11:28:32.962240 [info ] [MainThread]: 
[0m11:28:32.962391 [info ] [MainThread]:   compiled code at target/compiled/stock_prediction/models/schema.yml/unique_stock_prices_date.sql
[0m11:28:32.962527 [info ] [MainThread]: 
[0m11:28:32.962672 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=5 SKIP=0 TOTAL=18
[0m11:28:32.963694 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 12.597179, "process_user_time": 2.845798, "process_kernel_time": 0.306832, "process_mem_max_rss": "144621568", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:28:32.963983 [debug] [MainThread]: Command `dbt test` failed at 11:28:32.963932 after 12.60 seconds
[0m11:28:32.964182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e7d8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d37d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bd8fd0>]}
[0m11:28:32.964362 [debug] [MainThread]: Flushing usage events
[0m11:33:22.059335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104562120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eb3ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eb3d90>]}


============================== 11:33:22.062323 | d3c30fc3-c88c-437d-9177-10480dae510f ==============================
[0m11:33:22.062323 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:33:22.062646 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:33:22.279500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3c30fc3-c88c-437d-9177-10480dae510f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b1da70>]}
[0m11:33:22.302386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3c30fc3-c88c-437d-9177-10480dae510f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ae8490>]}
[0m11:33:22.303027 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:33:22.312386 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:33:22.380334 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:33:22.380799 [debug] [MainThread]: Partial parsing: updated file: stock_prediction://models/schema.yml
[0m11:33:22.480534 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:33:22.480836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd3c30fc3-c88c-437d-9177-10480dae510f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d40750>]}
[0m11:33:22.602136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3c30fc3-c88c-437d-9177-10480dae510f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b967b0>]}
[0m11:33:22.659592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3c30fc3-c88c-437d-9177-10480dae510f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c99390>]}
[0m11:33:22.659871 [info ] [MainThread]: Found 3 models, 22 data tests, 2 sources, 459 macros
[0m11:33:22.660023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3c30fc3-c88c-437d-9177-10480dae510f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070a69c0>]}
[0m11:33:22.661261 [info ] [MainThread]: 
[0m11:33:22.661514 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:33:22.663554 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_analytics'
[0m11:33:22.670858 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m11:33:22.671013 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m11:33:22.671131 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:33:23.287737 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.616 seconds
[0m11:33:23.290916 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m11:33:23.463243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3c30fc3-c88c-437d-9177-10480dae510f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10720d910>]}
[0m11:33:23.463792 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:33:23.464063 [info ] [MainThread]: 
[0m11:33:23.468099 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m11:33:23.468428 [info ] [Thread-1 (]: 1 of 22 START test not_null_moving_average_close ............................... [RUN]
[0m11:33:23.468750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now test.stock_prediction.not_null_moving_average_close.6d037dd588)
[0m11:33:23.468982 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m11:33:23.481419 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_close.6d037dd588"
[0m11:33:23.481984 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m11:33:23.494405 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_close.6d037dd588"
[0m11:33:23.495116 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_close.6d037dd588"
[0m11:33:23.495328 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_close.6d037dd588: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_close.6d037dd588"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.moving_average
where close is null



      
    ) dbt_internal_test
[0m11:33:23.495511 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:23.985005 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.489 seconds
[0m11:33:23.999750 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_close.6d037dd588: Close
[0m11:33:24.132501 [info ] [Thread-1 (]: 1 of 22 PASS not_null_moving_average_close ..................................... [[32mPASS[0m in 0.66s]
[0m11:33:24.133550 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m11:33:24.134173 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m11:33:24.134823 [info ] [Thread-1 (]: 2 of 22 START test not_null_moving_average_date ................................ [RUN]
[0m11:33:24.135510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_close.6d037dd588, now test.stock_prediction.not_null_moving_average_date.3ad00158b5)
[0m11:33:24.135989 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m11:33:24.141238 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_date.3ad00158b5"
[0m11:33:24.142262 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m11:33:24.144439 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_date.3ad00158b5"
[0m11:33:24.145366 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_date.3ad00158b5"
[0m11:33:24.145697 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_date.3ad00158b5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_date.3ad00158b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.moving_average
where date is null



      
    ) dbt_internal_test
[0m11:33:24.146000 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:24.615927 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.469 seconds
[0m11:33:24.622008 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_date.3ad00158b5: Close
[0m11:33:24.737113 [info ] [Thread-1 (]: 2 of 22 PASS not_null_moving_average_date ...................................... [[32mPASS[0m in 0.60s]
[0m11:33:24.738026 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m11:33:24.738601 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m11:33:24.739163 [info ] [Thread-1 (]: 3 of 22 START test not_null_moving_average_moving_avg_20d ...................... [RUN]
[0m11:33:24.739743 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_date.3ad00158b5, now test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22)
[0m11:33:24.740193 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m11:33:24.745066 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m11:33:24.746099 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m11:33:24.748322 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m11:33:24.749249 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m11:33:24.749575 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg_20d
from dev.analytics.moving_average
where moving_avg_20d is null



      
    ) dbt_internal_test
[0m11:33:24.749893 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:25.156862 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.406 seconds
[0m11:33:25.162267 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22: Close
[0m11:33:25.301321 [info ] [Thread-1 (]: 3 of 22 PASS not_null_moving_average_moving_avg_20d ............................ [[32mPASS[0m in 0.56s]
[0m11:33:25.302203 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m11:33:25.302759 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m11:33:25.303295 [info ] [Thread-1 (]: 4 of 22 START test not_null_moving_average_moving_avg_5d ....................... [RUN]
[0m11:33:25.303890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22, now test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca)
[0m11:33:25.304344 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m11:33:25.309363 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m11:33:25.310479 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m11:33:25.312595 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m11:33:25.313526 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m11:33:25.313859 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg_5d
from dev.analytics.moving_average
where moving_avg_5d is null



      
    ) dbt_internal_test
[0m11:33:25.314179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:25.802736 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.488 seconds
[0m11:33:25.806252 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca: Close
[0m11:33:25.923446 [info ] [Thread-1 (]: 4 of 22 PASS not_null_moving_average_moving_avg_5d ............................. [[32mPASS[0m in 0.62s]
[0m11:33:25.924778 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m11:33:25.925313 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m11:33:25.925839 [info ] [Thread-1 (]: 5 of 22 START test not_null_moving_average_symbol .............................. [RUN]
[0m11:33:25.926432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca, now test.stock_prediction.not_null_moving_average_symbol.75a6f7473c)
[0m11:33:25.926819 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m11:33:25.931771 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"
[0m11:33:25.932681 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m11:33:25.934656 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"
[0m11:33:25.935527 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"
[0m11:33:25.935848 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_symbol.75a6f7473c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.moving_average
where symbol is null



      
    ) dbt_internal_test
[0m11:33:25.936143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:26.334976 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.398 seconds
[0m11:33:26.340019 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_symbol.75a6f7473c: Close
[0m11:33:26.480986 [info ] [Thread-1 (]: 5 of 22 PASS not_null_moving_average_symbol .................................... [[32mPASS[0m in 0.55s]
[0m11:33:26.482106 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m11:33:26.482683 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m11:33:26.483297 [info ] [Thread-1 (]: 6 of 22 START test not_null_rsi_calculation_avg_gain ........................... [RUN]
[0m11:33:26.483950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_symbol.75a6f7473c, now test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42)
[0m11:33:26.484432 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m11:33:26.489535 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m11:33:26.490629 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m11:33:26.492752 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m11:33:26.493721 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m11:33:26.494147 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_gain
from dev.analytics.rsi_calculation
where avg_gain is null



      
    ) dbt_internal_test
[0m11:33:26.494492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:26.906683 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.412 seconds
[0m11:33:26.911612 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42: Close
[0m11:33:27.072823 [info ] [Thread-1 (]: 6 of 22 PASS not_null_rsi_calculation_avg_gain ................................. [[32mPASS[0m in 0.59s]
[0m11:33:27.073821 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m11:33:27.074383 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m11:33:27.074872 [info ] [Thread-1 (]: 7 of 22 START test not_null_rsi_calculation_avg_loss ........................... [RUN]
[0m11:33:27.075415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42, now test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19)
[0m11:33:27.075818 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m11:33:27.080776 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m11:33:27.081693 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m11:33:27.083664 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m11:33:27.084519 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m11:33:27.084848 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_loss
from dev.analytics.rsi_calculation
where avg_loss is null



      
    ) dbt_internal_test
[0m11:33:27.085151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:27.564671 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.479 seconds
[0m11:33:27.568075 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19: Close
[0m11:33:27.696883 [info ] [Thread-1 (]: 7 of 22 PASS not_null_rsi_calculation_avg_loss ................................. [[32mPASS[0m in 0.62s]
[0m11:33:27.697940 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m11:33:27.698417 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m11:33:27.698760 [info ] [Thread-1 (]: 8 of 22 START test not_null_rsi_calculation_close .............................. [RUN]
[0m11:33:27.699164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19, now test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d)
[0m11:33:27.699484 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m11:33:27.704866 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"
[0m11:33:27.705750 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m11:33:27.707010 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"
[0m11:33:27.708018 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"
[0m11:33:27.708365 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.rsi_calculation
where close is null



      
    ) dbt_internal_test
[0m11:33:27.708686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:28.163051 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.454 seconds
[0m11:33:28.168547 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d: Close
[0m11:33:28.302939 [info ] [Thread-1 (]: 8 of 22 PASS not_null_rsi_calculation_close .................................... [[32mPASS[0m in 0.60s]
[0m11:33:28.303622 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m11:33:28.303906 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m11:33:28.304186 [info ] [Thread-1 (]: 9 of 22 START test not_null_rsi_calculation_date ............................... [RUN]
[0m11:33:28.304507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d, now test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76)
[0m11:33:28.304755 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m11:33:28.308009 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"
[0m11:33:28.308579 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m11:33:28.309835 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"
[0m11:33:28.310372 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"
[0m11:33:28.310575 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.rsi_calculation
where date is null



      
    ) dbt_internal_test
[0m11:33:28.310756 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:28.701685 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.391 seconds
[0m11:33:28.705057 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76: Close
[0m11:33:28.820367 [info ] [Thread-1 (]: 9 of 22 PASS not_null_rsi_calculation_date ..................................... [[32mPASS[0m in 0.52s]
[0m11:33:28.822193 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m11:33:28.822861 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m11:33:28.823350 [info ] [Thread-1 (]: 10 of 22 START test not_null_rsi_calculation_rsi_14d ........................... [RUN]
[0m11:33:28.823903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76, now test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8)
[0m11:33:28.824290 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m11:33:28.829786 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m11:33:28.830746 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m11:33:28.832699 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m11:33:28.833677 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m11:33:28.834081 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from dev.analytics.rsi_calculation
where rsi_14d is null



      
    ) dbt_internal_test
[0m11:33:28.834479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:29.338878 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.503 seconds
[0m11:33:29.346482 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8: Close
[0m11:33:29.465776 [info ] [Thread-1 (]: 10 of 22 PASS not_null_rsi_calculation_rsi_14d ................................. [[32mPASS[0m in 0.64s]
[0m11:33:29.467049 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m11:33:29.467769 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m11:33:29.468343 [info ] [Thread-1 (]: 11 of 22 START test not_null_rsi_calculation_symbol ............................ [RUN]
[0m11:33:29.468972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8, now test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84)
[0m11:33:29.469419 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m11:33:29.474551 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m11:33:29.475541 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m11:33:29.477634 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m11:33:29.478525 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m11:33:29.478848 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.rsi_calculation
where symbol is null



      
    ) dbt_internal_test
[0m11:33:29.479146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:29.928756 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.449 seconds
[0m11:33:29.932283 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84: Close
[0m11:33:30.059375 [info ] [Thread-1 (]: 11 of 22 PASS not_null_rsi_calculation_symbol .................................. [[32mPASS[0m in 0.59s]
[0m11:33:30.060287 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m11:33:30.060834 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m11:33:30.061453 [info ] [Thread-1 (]: 12 of 22 START test not_null_stock_prices_close ................................ [RUN]
[0m11:33:30.062157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84, now test.stock_prediction.not_null_stock_prices_close.d7e232e1ba)
[0m11:33:30.062652 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m11:33:30.067507 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"
[0m11:33:30.068488 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m11:33:30.070411 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"
[0m11:33:30.071284 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"
[0m11:33:30.071598 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_close.d7e232e1ba: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.stock_prices
where close is null



      
    ) dbt_internal_test
[0m11:33:30.071887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:30.483358 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.411 seconds
[0m11:33:30.494006 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_close.d7e232e1ba: Close
[0m11:33:30.627749 [info ] [Thread-1 (]: 12 of 22 PASS not_null_stock_prices_close ...................................... [[32mPASS[0m in 0.57s]
[0m11:33:30.628786 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m11:33:30.629335 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m11:33:30.629906 [info ] [Thread-1 (]: 13 of 22 START test not_null_stock_prices_date ................................. [RUN]
[0m11:33:30.630562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_close.d7e232e1ba, now test.stock_prediction.not_null_stock_prices_date.98a7527501)
[0m11:33:30.631004 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m11:33:30.636006 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_date.98a7527501"
[0m11:33:30.637024 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m11:33:30.638972 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_date.98a7527501"
[0m11:33:30.639888 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_date.98a7527501"
[0m11:33:30.640211 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_date.98a7527501: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_date.98a7527501"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.stock_prices
where date is null



      
    ) dbt_internal_test
[0m11:33:30.640503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:31.041598 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.400 seconds
[0m11:33:31.046228 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_date.98a7527501: Close
[0m11:33:31.163555 [info ] [Thread-1 (]: 13 of 22 PASS not_null_stock_prices_date ....................................... [[32mPASS[0m in 0.53s]
[0m11:33:31.164261 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m11:33:31.164701 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m11:33:31.165162 [info ] [Thread-1 (]: 14 of 22 START test not_null_stock_prices_high ................................. [RUN]
[0m11:33:31.165688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_date.98a7527501, now test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc)
[0m11:33:31.166057 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m11:33:31.170506 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"
[0m11:33:31.171449 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m11:33:31.173382 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"
[0m11:33:31.174242 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"
[0m11:33:31.174520 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select high
from dev.analytics.stock_prices
where high is null



      
    ) dbt_internal_test
[0m11:33:31.174779 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:32.301913 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.127 seconds
[0m11:33:32.307819 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc: Close
[0m11:33:32.445384 [info ] [Thread-1 (]: 14 of 22 PASS not_null_stock_prices_high ....................................... [[32mPASS[0m in 1.28s]
[0m11:33:32.447534 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m11:33:32.448694 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m11:33:32.449308 [info ] [Thread-1 (]: 15 of 22 START test not_null_stock_prices_low .................................. [RUN]
[0m11:33:32.450474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc, now test.stock_prediction.not_null_stock_prices_low.e65294ca15)
[0m11:33:32.451378 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m11:33:32.467315 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_low.e65294ca15"
[0m11:33:32.468848 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m11:33:32.472003 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_low.e65294ca15"
[0m11:33:32.473119 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_low.e65294ca15"
[0m11:33:32.473518 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_low.e65294ca15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_low.e65294ca15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select low
from dev.analytics.stock_prices
where low is null



      
    ) dbt_internal_test
[0m11:33:32.473865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:33.426149 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.952 seconds
[0m11:33:33.432525 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_low.e65294ca15: Close
[0m11:33:33.553002 [info ] [Thread-1 (]: 15 of 22 PASS not_null_stock_prices_low ........................................ [[32mPASS[0m in 1.10s]
[0m11:33:33.555898 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m11:33:33.559348 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m11:33:33.560300 [info ] [Thread-1 (]: 16 of 22 START test not_null_stock_prices_open ................................. [RUN]
[0m11:33:33.561477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_low.e65294ca15, now test.stock_prediction.not_null_stock_prices_open.e09b13f215)
[0m11:33:33.562312 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m11:33:33.569546 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_open.e09b13f215"
[0m11:33:33.571098 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m11:33:33.574025 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_open.e09b13f215"
[0m11:33:33.575606 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_open.e09b13f215"
[0m11:33:33.576011 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_open.e09b13f215: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_open.e09b13f215"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from dev.analytics.stock_prices
where open is null



      
    ) dbt_internal_test
[0m11:33:33.576486 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:34.064695 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.488 seconds
[0m11:33:34.072661 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_open.e09b13f215: Close
[0m11:33:34.241550 [info ] [Thread-1 (]: 16 of 22 PASS not_null_stock_prices_open ....................................... [[32mPASS[0m in 0.68s]
[0m11:33:34.244299 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m11:33:34.245621 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m11:33:34.246440 [info ] [Thread-1 (]: 17 of 22 START test not_null_stock_prices_symbol ............................... [RUN]
[0m11:33:34.247406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_open.e09b13f215, now test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8)
[0m11:33:34.248011 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m11:33:34.257067 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"
[0m11:33:34.258547 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m11:33:34.261460 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"
[0m11:33:34.262535 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"
[0m11:33:34.262928 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.stock_prices
where symbol is null



      
    ) dbt_internal_test
[0m11:33:34.263285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:34.759067 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.496 seconds
[0m11:33:34.762239 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8: Close
[0m11:33:34.935048 [info ] [Thread-1 (]: 17 of 22 PASS not_null_stock_prices_symbol ..................................... [[32mPASS[0m in 0.69s]
[0m11:33:34.937361 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m11:33:34.938700 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m11:33:34.939438 [info ] [Thread-1 (]: 18 of 22 START test not_null_stock_prices_volume ............................... [RUN]
[0m11:33:34.940452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8, now test.stock_prediction.not_null_stock_prices_volume.71420bc956)
[0m11:33:34.941103 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m11:33:34.951312 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_volume.71420bc956"
[0m11:33:34.953511 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m11:33:34.956894 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_volume.71420bc956"
[0m11:33:34.958569 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_volume.71420bc956"
[0m11:33:34.959058 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_volume.71420bc956: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_volume.71420bc956"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume
from dev.analytics.stock_prices
where volume is null



      
    ) dbt_internal_test
[0m11:33:34.959501 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:35.511191 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.551 seconds
[0m11:33:35.519052 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_volume.71420bc956: Close
[0m11:33:35.755973 [info ] [Thread-1 (]: 18 of 22 PASS not_null_stock_prices_volume ..................................... [[32mPASS[0m in 0.82s]
[0m11:33:35.757812 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m11:33:35.758991 [debug] [Thread-1 (]: Began running node test.stock_prediction.unique_moving_average_close.9a9b7fca9f
[0m11:33:35.760190 [info ] [Thread-1 (]: 19 of 22 START test unique_moving_average_close ................................ [RUN]
[0m11:33:35.760982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_volume.71420bc956, now test.stock_prediction.unique_moving_average_close.9a9b7fca9f)
[0m11:33:35.761407 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.unique_moving_average_close.9a9b7fca9f
[0m11:33:35.771103 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.unique_moving_average_close.9a9b7fca9f"
[0m11:33:35.772366 [debug] [Thread-1 (]: Began executing node test.stock_prediction.unique_moving_average_close.9a9b7fca9f
[0m11:33:35.774446 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.unique_moving_average_close.9a9b7fca9f"
[0m11:33:35.775447 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.unique_moving_average_close.9a9b7fca9f"
[0m11:33:35.775750 [debug] [Thread-1 (]: On test.stock_prediction.unique_moving_average_close.9a9b7fca9f: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.unique_moving_average_close.9a9b7fca9f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    close as unique_field,
    count(*) as n_records

from dev.analytics.moving_average
where close is not null
group by close
having count(*) > 1



      
    ) dbt_internal_test
[0m11:33:35.776010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:36.327904 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.551 seconds
[0m11:33:36.332372 [debug] [Thread-1 (]: On test.stock_prediction.unique_moving_average_close.9a9b7fca9f: Close
[0m11:33:36.492181 [error] [Thread-1 (]: 19 of 22 FAIL 5 unique_moving_average_close .................................... [[31mFAIL 5[0m in 0.73s]
[0m11:33:36.493973 [debug] [Thread-1 (]: Finished running node test.stock_prediction.unique_moving_average_close.9a9b7fca9f
[0m11:33:36.494606 [debug] [Thread-1 (]: Began running node test.stock_prediction.unique_moving_average_date.a93c28e495
[0m11:33:36.495118 [info ] [Thread-1 (]: 20 of 22 START test unique_moving_average_date ................................. [RUN]
[0m11:33:36.495836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.unique_moving_average_close.9a9b7fca9f, now test.stock_prediction.unique_moving_average_date.a93c28e495)
[0m11:33:36.496562 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.unique_moving_average_date.a93c28e495
[0m11:33:36.506040 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.unique_moving_average_date.a93c28e495"
[0m11:33:36.509790 [debug] [Thread-1 (]: Began executing node test.stock_prediction.unique_moving_average_date.a93c28e495
[0m11:33:36.511868 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.unique_moving_average_date.a93c28e495"
[0m11:33:36.512757 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.unique_moving_average_date.a93c28e495"
[0m11:33:36.513018 [debug] [Thread-1 (]: On test.stock_prediction.unique_moving_average_date.a93c28e495: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.unique_moving_average_date.a93c28e495"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from dev.analytics.moving_average
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m11:33:36.513222 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:37.055595 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.542 seconds
[0m11:33:37.063367 [debug] [Thread-1 (]: On test.stock_prediction.unique_moving_average_date.a93c28e495: Close
[0m11:33:37.181424 [error] [Thread-1 (]: 20 of 22 FAIL 90 unique_moving_average_date .................................... [[31mFAIL 90[0m in 0.69s]
[0m11:33:37.183479 [debug] [Thread-1 (]: Finished running node test.stock_prediction.unique_moving_average_date.a93c28e495
[0m11:33:37.184597 [debug] [Thread-1 (]: Began running node test.stock_prediction.unique_rsi_calculation_date.057b856de2
[0m11:33:37.185499 [info ] [Thread-1 (]: 21 of 22 START test unique_rsi_calculation_date ................................ [RUN]
[0m11:33:37.186799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.unique_moving_average_date.a93c28e495, now test.stock_prediction.unique_rsi_calculation_date.057b856de2)
[0m11:33:37.187647 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.unique_rsi_calculation_date.057b856de2
[0m11:33:37.196257 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.unique_rsi_calculation_date.057b856de2"
[0m11:33:37.199960 [debug] [Thread-1 (]: Began executing node test.stock_prediction.unique_rsi_calculation_date.057b856de2
[0m11:33:37.203190 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.unique_rsi_calculation_date.057b856de2"
[0m11:33:37.204717 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.unique_rsi_calculation_date.057b856de2"
[0m11:33:37.205213 [debug] [Thread-1 (]: On test.stock_prediction.unique_rsi_calculation_date.057b856de2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.unique_rsi_calculation_date.057b856de2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from dev.analytics.rsi_calculation
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m11:33:37.205663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:37.643692 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.437 seconds
[0m11:33:37.650930 [debug] [Thread-1 (]: On test.stock_prediction.unique_rsi_calculation_date.057b856de2: Close
[0m11:33:37.775877 [error] [Thread-1 (]: 21 of 22 FAIL 90 unique_rsi_calculation_date ................................... [[31mFAIL 90[0m in 0.59s]
[0m11:33:37.778183 [debug] [Thread-1 (]: Finished running node test.stock_prediction.unique_rsi_calculation_date.057b856de2
[0m11:33:37.779037 [debug] [Thread-1 (]: Began running node test.stock_prediction.unique_stock_prices_date.1d2e222e60
[0m11:33:37.779594 [info ] [Thread-1 (]: 22 of 22 START test unique_stock_prices_date ................................... [RUN]
[0m11:33:37.780539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.unique_rsi_calculation_date.057b856de2, now test.stock_prediction.unique_stock_prices_date.1d2e222e60)
[0m11:33:37.781435 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.unique_stock_prices_date.1d2e222e60
[0m11:33:37.790412 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.unique_stock_prices_date.1d2e222e60"
[0m11:33:37.792556 [debug] [Thread-1 (]: Began executing node test.stock_prediction.unique_stock_prices_date.1d2e222e60
[0m11:33:37.795948 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.unique_stock_prices_date.1d2e222e60"
[0m11:33:37.797329 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.unique_stock_prices_date.1d2e222e60"
[0m11:33:37.797650 [debug] [Thread-1 (]: On test.stock_prediction.unique_stock_prices_date.1d2e222e60: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.unique_stock_prices_date.1d2e222e60"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from dev.analytics.stock_prices
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m11:33:37.797929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:38.237158 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.439 seconds
[0m11:33:38.240194 [debug] [Thread-1 (]: On test.stock_prediction.unique_stock_prices_date.1d2e222e60: Close
[0m11:33:38.370304 [error] [Thread-1 (]: 22 of 22 FAIL 90 unique_stock_prices_date ...................................... [[31mFAIL 90[0m in 0.59s]
[0m11:33:38.372618 [debug] [Thread-1 (]: Finished running node test.stock_prediction.unique_stock_prices_date.1d2e222e60
[0m11:33:38.375464 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:33:38.376016 [debug] [MainThread]: Connection 'test.stock_prediction.unique_stock_prices_date.1d2e222e60' was properly closed.
[0m11:33:38.376541 [info ] [MainThread]: 
[0m11:33:38.377509 [info ] [MainThread]: Finished running 22 data tests in 0 hours 0 minutes and 15.71 seconds (15.71s).
[0m11:33:38.385120 [debug] [MainThread]: Command end result
[0m11:33:38.423960 [info ] [MainThread]: 
[0m11:33:38.424551 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m11:33:38.424778 [info ] [MainThread]: 
[0m11:33:38.425067 [error] [MainThread]: [31mFailure in test unique_moving_average_close (models/schema.yml)[0m
[0m11:33:38.425310 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m11:33:38.425473 [info ] [MainThread]: 
[0m11:33:38.425686 [info ] [MainThread]:   compiled code at target/compiled/stock_prediction/models/schema.yml/unique_moving_average_close.sql
[0m11:33:38.425857 [info ] [MainThread]: 
[0m11:33:38.426069 [error] [MainThread]: [31mFailure in test unique_moving_average_date (models/schema.yml)[0m
[0m11:33:38.426280 [error] [MainThread]:   Got 90 results, configured to fail if != 0
[0m11:33:38.426558 [info ] [MainThread]: 
[0m11:33:38.426889 [info ] [MainThread]:   compiled code at target/compiled/stock_prediction/models/schema.yml/unique_moving_average_date.sql
[0m11:33:38.427135 [info ] [MainThread]: 
[0m11:33:38.427559 [error] [MainThread]: [31mFailure in test unique_rsi_calculation_date (models/schema.yml)[0m
[0m11:33:38.427899 [error] [MainThread]:   Got 90 results, configured to fail if != 0
[0m11:33:38.428094 [info ] [MainThread]: 
[0m11:33:38.428324 [info ] [MainThread]:   compiled code at target/compiled/stock_prediction/models/schema.yml/unique_rsi_calculation_date.sql
[0m11:33:38.428484 [info ] [MainThread]: 
[0m11:33:38.428685 [error] [MainThread]: [31mFailure in test unique_stock_prices_date (models/schema.yml)[0m
[0m11:33:38.428882 [error] [MainThread]:   Got 90 results, configured to fail if != 0
[0m11:33:38.429033 [info ] [MainThread]: 
[0m11:33:38.429220 [info ] [MainThread]:   compiled code at target/compiled/stock_prediction/models/schema.yml/unique_stock_prices_date.sql
[0m11:33:38.429391 [info ] [MainThread]: 
[0m11:33:38.429594 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=4 SKIP=0 TOTAL=22
[0m11:33:38.431891 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 16.407986, "process_user_time": 3.025281, "process_kernel_time": 0.418854, "process_mem_max_rss": "144080896", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:33:38.432382 [debug] [MainThread]: Command `dbt test` failed at 11:33:38.432312 after 16.41 seconds
[0m11:33:38.432715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071ca2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074c4550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074c51d0>]}
[0m11:33:38.433001 [debug] [MainThread]: Flushing usage events
[0m11:39:21.045092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10564e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110b3ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110b3d90>]}


============================== 11:39:21.047704 | 0d98b9ee-223d-4b39-b53e-376f17fa2f17 ==============================
[0m11:39:21.047704 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:39:21.047998 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'version_check': 'True', 'profiles_dir': '/Users/adi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:39:21.242042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d98b9ee-223d-4b39-b53e-376f17fa2f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112201a70>]}
[0m11:39:21.264623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d98b9ee-223d-4b39-b53e-376f17fa2f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112040490>]}
[0m11:39:21.265914 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:39:21.274733 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:39:21.341860 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:39:21.342340 [debug] [MainThread]: Partial parsing: updated file: stock_prediction://models/schema.yml
[0m11:39:21.436698 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:39:21.437006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0d98b9ee-223d-4b39-b53e-376f17fa2f17', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112530050>]}
[0m11:39:21.553363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d98b9ee-223d-4b39-b53e-376f17fa2f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e9f4d0>]}
[0m11:39:21.607999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d98b9ee-223d-4b39-b53e-376f17fa2f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131c5fd0>]}
[0m11:39:21.608234 [info ] [MainThread]: Found 3 models, 20 data tests, 2 sources, 459 macros
[0m11:39:21.608384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d98b9ee-223d-4b39-b53e-376f17fa2f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132a29c0>]}
[0m11:39:21.609550 [info ] [MainThread]: 
[0m11:39:21.609807 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:39:21.611786 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_analytics'
[0m11:39:21.619002 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m11:39:21.619152 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m11:39:21.619269 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:39:22.377458 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.758 seconds
[0m11:39:22.381648 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m11:39:22.505021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d98b9ee-223d-4b39-b53e-376f17fa2f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134116d0>]}
[0m11:39:22.505803 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:39:22.506216 [info ] [MainThread]: 
[0m11:39:22.510668 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m11:39:22.511198 [info ] [Thread-1 (]: 1 of 20 START test not_null_moving_average_close ............................... [RUN]
[0m11:39:22.511686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now test.stock_prediction.not_null_moving_average_close.6d037dd588)
[0m11:39:22.512050 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m11:39:22.527408 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_close.6d037dd588"
[0m11:39:22.528281 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m11:39:22.542402 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_close.6d037dd588"
[0m11:39:22.543210 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_close.6d037dd588"
[0m11:39:22.543451 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_close.6d037dd588: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_close.6d037dd588"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.moving_average
where close is null



      
    ) dbt_internal_test
[0m11:39:22.543658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:23.049913 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.506 seconds
[0m11:39:23.061312 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_close.6d037dd588: Close
[0m11:39:23.187002 [info ] [Thread-1 (]: 1 of 20 PASS not_null_moving_average_close ..................................... [[32mPASS[0m in 0.68s]
[0m11:39:23.188135 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m11:39:23.188725 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m11:39:23.189354 [info ] [Thread-1 (]: 2 of 20 START test not_null_moving_average_date ................................ [RUN]
[0m11:39:23.190024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_close.6d037dd588, now test.stock_prediction.not_null_moving_average_date.3ad00158b5)
[0m11:39:23.190503 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m11:39:23.196346 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_date.3ad00158b5"
[0m11:39:23.197301 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m11:39:23.199278 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_date.3ad00158b5"
[0m11:39:23.200173 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_date.3ad00158b5"
[0m11:39:23.200507 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_date.3ad00158b5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_date.3ad00158b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.moving_average
where date is null



      
    ) dbt_internal_test
[0m11:39:23.200814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:23.587570 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.386 seconds
[0m11:39:23.592253 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_date.3ad00158b5: Close
[0m11:39:23.709580 [info ] [Thread-1 (]: 2 of 20 PASS not_null_moving_average_date ...................................... [[32mPASS[0m in 0.52s]
[0m11:39:23.710794 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m11:39:23.711375 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m11:39:23.711964 [info ] [Thread-1 (]: 3 of 20 START test not_null_moving_average_moving_avg_20d ...................... [RUN]
[0m11:39:23.712651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_date.3ad00158b5, now test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22)
[0m11:39:23.713113 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m11:39:23.718057 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m11:39:23.718999 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m11:39:23.721811 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m11:39:23.722715 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m11:39:23.723050 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg_20d
from dev.analytics.moving_average
where moving_avg_20d is null



      
    ) dbt_internal_test
[0m11:39:23.723361 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:24.125890 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.402 seconds
[0m11:39:24.129615 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22: Close
[0m11:39:24.274907 [info ] [Thread-1 (]: 3 of 20 PASS not_null_moving_average_moving_avg_20d ............................ [[32mPASS[0m in 0.56s]
[0m11:39:24.275510 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m11:39:24.275903 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m11:39:24.276306 [info ] [Thread-1 (]: 4 of 20 START test not_null_moving_average_moving_avg_5d ....................... [RUN]
[0m11:39:24.276757 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22, now test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca)
[0m11:39:24.277076 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m11:39:24.281019 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m11:39:24.281881 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m11:39:24.284225 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m11:39:24.285050 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m11:39:24.285343 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg_5d
from dev.analytics.moving_average
where moving_avg_5d is null



      
    ) dbt_internal_test
[0m11:39:24.285614 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:24.691410 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.405 seconds
[0m11:39:24.696282 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca: Close
[0m11:39:24.813920 [info ] [Thread-1 (]: 4 of 20 PASS not_null_moving_average_moving_avg_5d ............................. [[32mPASS[0m in 0.54s]
[0m11:39:24.814824 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m11:39:24.815836 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m11:39:24.816558 [info ] [Thread-1 (]: 5 of 20 START test not_null_moving_average_symbol .............................. [RUN]
[0m11:39:24.817235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca, now test.stock_prediction.not_null_moving_average_symbol.75a6f7473c)
[0m11:39:24.817632 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m11:39:24.822644 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"
[0m11:39:24.823704 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m11:39:24.825816 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"
[0m11:39:24.826819 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"
[0m11:39:24.827158 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_symbol.75a6f7473c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.moving_average
where symbol is null



      
    ) dbt_internal_test
[0m11:39:24.827464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:25.242010 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.414 seconds
[0m11:39:25.245499 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_symbol.75a6f7473c: Close
[0m11:39:25.372582 [info ] [Thread-1 (]: 5 of 20 PASS not_null_moving_average_symbol .................................... [[32mPASS[0m in 0.55s]
[0m11:39:25.373964 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m11:39:25.374662 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m11:39:25.375278 [info ] [Thread-1 (]: 6 of 20 START test not_null_rsi_calculation_avg_gain ........................... [RUN]
[0m11:39:25.375954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_symbol.75a6f7473c, now test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42)
[0m11:39:25.376367 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m11:39:25.381412 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m11:39:25.382436 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m11:39:25.384438 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m11:39:25.385341 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m11:39:25.385666 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_gain
from dev.analytics.rsi_calculation
where avg_gain is null



      
    ) dbt_internal_test
[0m11:39:25.385969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:25.830977 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.444 seconds
[0m11:39:25.834919 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42: Close
[0m11:39:25.956892 [info ] [Thread-1 (]: 6 of 20 PASS not_null_rsi_calculation_avg_gain ................................. [[32mPASS[0m in 0.58s]
[0m11:39:25.958185 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m11:39:25.958745 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m11:39:25.959215 [info ] [Thread-1 (]: 7 of 20 START test not_null_rsi_calculation_avg_loss ........................... [RUN]
[0m11:39:25.959758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42, now test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19)
[0m11:39:25.960118 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m11:39:25.965062 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m11:39:25.966000 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m11:39:25.967955 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m11:39:25.968882 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m11:39:25.969219 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_loss
from dev.analytics.rsi_calculation
where avg_loss is null



      
    ) dbt_internal_test
[0m11:39:25.969534 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:26.352077 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.382 seconds
[0m11:39:26.357795 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19: Close
[0m11:39:26.463544 [info ] [Thread-1 (]: 7 of 20 PASS not_null_rsi_calculation_avg_loss ................................. [[32mPASS[0m in 0.50s]
[0m11:39:26.464979 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m11:39:26.465656 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m11:39:26.466173 [info ] [Thread-1 (]: 8 of 20 START test not_null_rsi_calculation_close .............................. [RUN]
[0m11:39:26.466781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19, now test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d)
[0m11:39:26.467176 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m11:39:26.472159 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"
[0m11:39:26.473186 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m11:39:26.475224 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"
[0m11:39:26.476138 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"
[0m11:39:26.476468 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.rsi_calculation
where close is null



      
    ) dbt_internal_test
[0m11:39:26.476762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:26.869845 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.393 seconds
[0m11:39:26.873059 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d: Close
[0m11:39:26.994387 [info ] [Thread-1 (]: 8 of 20 PASS not_null_rsi_calculation_close .................................... [[32mPASS[0m in 0.53s]
[0m11:39:26.995632 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m11:39:26.996249 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m11:39:26.996771 [info ] [Thread-1 (]: 9 of 20 START test not_null_rsi_calculation_date ............................... [RUN]
[0m11:39:26.997362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d, now test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76)
[0m11:39:26.997757 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m11:39:27.002619 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"
[0m11:39:27.003542 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m11:39:27.005493 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"
[0m11:39:27.006383 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"
[0m11:39:27.006709 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.rsi_calculation
where date is null



      
    ) dbt_internal_test
[0m11:39:27.007013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:27.434065 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.426 seconds
[0m11:39:27.439197 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76: Close
[0m11:39:27.589312 [info ] [Thread-1 (]: 9 of 20 PASS not_null_rsi_calculation_date ..................................... [[32mPASS[0m in 0.59s]
[0m11:39:27.590148 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m11:39:27.590685 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m11:39:27.591223 [info ] [Thread-1 (]: 10 of 20 START test not_null_rsi_calculation_rsi_14d ........................... [RUN]
[0m11:39:27.591796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76, now test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8)
[0m11:39:27.592232 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m11:39:27.597314 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m11:39:27.598275 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m11:39:27.600505 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m11:39:27.601355 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m11:39:27.601670 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from dev.analytics.rsi_calculation
where rsi_14d is null



      
    ) dbt_internal_test
[0m11:39:27.601975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:28.092808 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.490 seconds
[0m11:39:28.097841 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8: Close
[0m11:39:28.243569 [info ] [Thread-1 (]: 10 of 20 PASS not_null_rsi_calculation_rsi_14d ................................. [[32mPASS[0m in 0.65s]
[0m11:39:28.244497 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m11:39:28.245063 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m11:39:28.245639 [info ] [Thread-1 (]: 11 of 20 START test not_null_rsi_calculation_symbol ............................ [RUN]
[0m11:39:28.246280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8, now test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84)
[0m11:39:28.246756 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m11:39:28.251929 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m11:39:28.253038 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m11:39:28.255161 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m11:39:28.256065 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m11:39:28.256392 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.rsi_calculation
where symbol is null



      
    ) dbt_internal_test
[0m11:39:28.256693 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:28.681891 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.425 seconds
[0m11:39:28.688620 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84: Close
[0m11:39:28.818590 [info ] [Thread-1 (]: 11 of 20 PASS not_null_rsi_calculation_symbol .................................. [[32mPASS[0m in 0.57s]
[0m11:39:28.819422 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m11:39:28.819868 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m11:39:28.820265 [info ] [Thread-1 (]: 12 of 20 START test not_null_stock_prices_close ................................ [RUN]
[0m11:39:28.820697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84, now test.stock_prediction.not_null_stock_prices_close.d7e232e1ba)
[0m11:39:28.821016 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m11:39:28.825317 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"
[0m11:39:28.826231 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m11:39:28.827971 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"
[0m11:39:28.828737 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"
[0m11:39:28.829018 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_close.d7e232e1ba: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.stock_prices
where close is null



      
    ) dbt_internal_test
[0m11:39:28.829283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:29.259246 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.429 seconds
[0m11:39:29.263774 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_close.d7e232e1ba: Close
[0m11:39:29.388629 [info ] [Thread-1 (]: 12 of 20 PASS not_null_stock_prices_close ...................................... [[32mPASS[0m in 0.57s]
[0m11:39:29.389498 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m11:39:29.390029 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m11:39:29.390595 [info ] [Thread-1 (]: 13 of 20 START test not_null_stock_prices_date ................................. [RUN]
[0m11:39:29.391243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_close.d7e232e1ba, now test.stock_prediction.not_null_stock_prices_date.98a7527501)
[0m11:39:29.391704 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m11:39:29.396736 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_date.98a7527501"
[0m11:39:29.397750 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m11:39:29.399783 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_date.98a7527501"
[0m11:39:29.400700 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_date.98a7527501"
[0m11:39:29.401019 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_date.98a7527501: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_date.98a7527501"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.stock_prices
where date is null



      
    ) dbt_internal_test
[0m11:39:29.401320 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:29.804037 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.402 seconds
[0m11:39:29.807722 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_date.98a7527501: Close
[0m11:39:29.934263 [info ] [Thread-1 (]: 13 of 20 PASS not_null_stock_prices_date ....................................... [[32mPASS[0m in 0.54s]
[0m11:39:29.935148 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m11:39:29.935703 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m11:39:29.936278 [info ] [Thread-1 (]: 14 of 20 START test not_null_stock_prices_high ................................. [RUN]
[0m11:39:29.936911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_date.98a7527501, now test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc)
[0m11:39:29.937358 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m11:39:29.942610 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"
[0m11:39:29.943641 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m11:39:29.945786 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"
[0m11:39:29.946676 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"
[0m11:39:29.946993 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select high
from dev.analytics.stock_prices
where high is null



      
    ) dbt_internal_test
[0m11:39:29.947302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:30.369911 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.422 seconds
[0m11:39:30.374256 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc: Close
[0m11:39:30.499410 [info ] [Thread-1 (]: 14 of 20 PASS not_null_stock_prices_high ....................................... [[32mPASS[0m in 0.56s]
[0m11:39:30.499945 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m11:39:30.500292 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m11:39:30.500672 [info ] [Thread-1 (]: 15 of 20 START test not_null_stock_prices_low .................................. [RUN]
[0m11:39:30.501087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc, now test.stock_prediction.not_null_stock_prices_low.e65294ca15)
[0m11:39:30.501372 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m11:39:30.505049 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_low.e65294ca15"
[0m11:39:30.505928 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m11:39:30.507483 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_low.e65294ca15"
[0m11:39:30.508199 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_low.e65294ca15"
[0m11:39:30.508453 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_low.e65294ca15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_low.e65294ca15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select low
from dev.analytics.stock_prices
where low is null



      
    ) dbt_internal_test
[0m11:39:30.508686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:30.910355 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.401 seconds
[0m11:39:30.915716 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_low.e65294ca15: Close
[0m11:39:31.039670 [info ] [Thread-1 (]: 15 of 20 PASS not_null_stock_prices_low ........................................ [[32mPASS[0m in 0.54s]
[0m11:39:31.040831 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m11:39:31.041386 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m11:39:31.041960 [info ] [Thread-1 (]: 16 of 20 START test not_null_stock_prices_open ................................. [RUN]
[0m11:39:31.042609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_low.e65294ca15, now test.stock_prediction.not_null_stock_prices_open.e09b13f215)
[0m11:39:31.043060 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m11:39:31.048134 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_open.e09b13f215"
[0m11:39:31.049229 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m11:39:31.051241 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_open.e09b13f215"
[0m11:39:31.052164 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_open.e09b13f215"
[0m11:39:31.052487 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_open.e09b13f215: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_open.e09b13f215"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from dev.analytics.stock_prices
where open is null



      
    ) dbt_internal_test
[0m11:39:31.052792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:31.486502 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.433 seconds
[0m11:39:31.491573 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_open.e09b13f215: Close
[0m11:39:31.617912 [info ] [Thread-1 (]: 16 of 20 PASS not_null_stock_prices_open ....................................... [[32mPASS[0m in 0.57s]
[0m11:39:31.619173 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m11:39:31.619808 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m11:39:31.620388 [info ] [Thread-1 (]: 17 of 20 START test not_null_stock_prices_symbol ............................... [RUN]
[0m11:39:31.620943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_open.e09b13f215, now test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8)
[0m11:39:31.621325 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m11:39:31.626246 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"
[0m11:39:31.627262 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m11:39:31.629219 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"
[0m11:39:31.630108 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"
[0m11:39:31.630430 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.stock_prices
where symbol is null



      
    ) dbt_internal_test
[0m11:39:31.630731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:32.023704 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.392 seconds
[0m11:39:32.027952 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8: Close
[0m11:39:32.152946 [info ] [Thread-1 (]: 17 of 20 PASS not_null_stock_prices_symbol ..................................... [[32mPASS[0m in 0.53s]
[0m11:39:32.153822 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m11:39:32.154374 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m11:39:32.154932 [info ] [Thread-1 (]: 18 of 20 START test not_null_stock_prices_volume ............................... [RUN]
[0m11:39:32.155510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8, now test.stock_prediction.not_null_stock_prices_volume.71420bc956)
[0m11:39:32.155930 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m11:39:32.160733 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_volume.71420bc956"
[0m11:39:32.161752 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m11:39:32.164040 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_volume.71420bc956"
[0m11:39:32.164940 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_volume.71420bc956"
[0m11:39:32.165258 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_volume.71420bc956: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_volume.71420bc956"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume
from dev.analytics.stock_prices
where volume is null



      
    ) dbt_internal_test
[0m11:39:32.165558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:32.651711 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.485 seconds
[0m11:39:32.656110 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_volume.71420bc956: Close
[0m11:39:32.779573 [info ] [Thread-1 (]: 18 of 20 PASS not_null_stock_prices_volume ..................................... [[32mPASS[0m in 0.62s]
[0m11:39:32.780927 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m11:39:32.781513 [debug] [Thread-1 (]: Began running node test.stock_prediction.unique_moving_average_date.a93c28e495
[0m11:39:32.781966 [info ] [Thread-1 (]: 19 of 20 START test unique_moving_average_date ................................. [RUN]
[0m11:39:32.782457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_volume.71420bc956, now test.stock_prediction.unique_moving_average_date.a93c28e495)
[0m11:39:32.782778 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.unique_moving_average_date.a93c28e495
[0m11:39:32.789143 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.unique_moving_average_date.a93c28e495"
[0m11:39:32.790114 [debug] [Thread-1 (]: Began executing node test.stock_prediction.unique_moving_average_date.a93c28e495
[0m11:39:32.791911 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.unique_moving_average_date.a93c28e495"
[0m11:39:32.792752 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.unique_moving_average_date.a93c28e495"
[0m11:39:32.793037 [debug] [Thread-1 (]: On test.stock_prediction.unique_moving_average_date.a93c28e495: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.unique_moving_average_date.a93c28e495"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from dev.analytics.moving_average
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m11:39:32.793301 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:33.220477 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.426 seconds
[0m11:39:33.224474 [debug] [Thread-1 (]: On test.stock_prediction.unique_moving_average_date.a93c28e495: Close
[0m11:39:33.343926 [error] [Thread-1 (]: 19 of 20 FAIL 90 unique_moving_average_date .................................... [[31mFAIL 90[0m in 0.56s]
[0m11:39:33.344809 [debug] [Thread-1 (]: Finished running node test.stock_prediction.unique_moving_average_date.a93c28e495
[0m11:39:33.345357 [debug] [Thread-1 (]: Began running node test.stock_prediction.unique_stock_prices_date.1d2e222e60
[0m11:39:33.345915 [info ] [Thread-1 (]: 20 of 20 START test unique_stock_prices_date ................................... [RUN]
[0m11:39:33.346527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.unique_moving_average_date.a93c28e495, now test.stock_prediction.unique_stock_prices_date.1d2e222e60)
[0m11:39:33.346975 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.unique_stock_prices_date.1d2e222e60
[0m11:39:33.351934 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.unique_stock_prices_date.1d2e222e60"
[0m11:39:33.352988 [debug] [Thread-1 (]: Began executing node test.stock_prediction.unique_stock_prices_date.1d2e222e60
[0m11:39:33.354991 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.unique_stock_prices_date.1d2e222e60"
[0m11:39:33.355917 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.unique_stock_prices_date.1d2e222e60"
[0m11:39:33.356241 [debug] [Thread-1 (]: On test.stock_prediction.unique_stock_prices_date.1d2e222e60: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.unique_stock_prices_date.1d2e222e60"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from dev.analytics.stock_prices
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m11:39:33.356544 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:33.765663 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.408 seconds
[0m11:39:33.769442 [debug] [Thread-1 (]: On test.stock_prediction.unique_stock_prices_date.1d2e222e60: Close
[0m11:39:33.888026 [error] [Thread-1 (]: 20 of 20 FAIL 90 unique_stock_prices_date ...................................... [[31mFAIL 90[0m in 0.54s]
[0m11:39:33.888856 [debug] [Thread-1 (]: Finished running node test.stock_prediction.unique_stock_prices_date.1d2e222e60
[0m11:39:33.890551 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:39:33.890896 [debug] [MainThread]: Connection 'test.stock_prediction.unique_stock_prices_date.1d2e222e60' was properly closed.
[0m11:39:33.891209 [info ] [MainThread]: 
[0m11:39:33.891506 [info ] [MainThread]: Finished running 20 data tests in 0 hours 0 minutes and 12.28 seconds (12.28s).
[0m11:39:33.894614 [debug] [MainThread]: Command end result
[0m11:39:33.926516 [info ] [MainThread]: 
[0m11:39:33.926908 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m11:39:33.927087 [info ] [MainThread]: 
[0m11:39:33.927322 [error] [MainThread]: [31mFailure in test unique_moving_average_date (models/schema.yml)[0m
[0m11:39:33.927526 [error] [MainThread]:   Got 90 results, configured to fail if != 0
[0m11:39:33.927668 [info ] [MainThread]: 
[0m11:39:33.927848 [info ] [MainThread]:   compiled code at target/compiled/stock_prediction/models/schema.yml/unique_moving_average_date.sql
[0m11:39:33.927992 [info ] [MainThread]: 
[0m11:39:33.928181 [error] [MainThread]: [31mFailure in test unique_stock_prices_date (models/schema.yml)[0m
[0m11:39:33.928355 [error] [MainThread]:   Got 90 results, configured to fail if != 0
[0m11:39:33.928479 [info ] [MainThread]: 
[0m11:39:33.928633 [info ] [MainThread]:   compiled code at target/compiled/stock_prediction/models/schema.yml/unique_stock_prices_date.sql
[0m11:39:33.928768 [info ] [MainThread]: 
[0m11:39:33.928912 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=2 SKIP=0 TOTAL=20
[0m11:39:33.929972 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 12.920182, "process_user_time": 2.648959, "process_kernel_time": 0.331509, "process_mem_max_rss": "141459456", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:39:33.930272 [debug] [MainThread]: Command `dbt test` failed at 11:39:33.930215 after 12.92 seconds
[0m11:39:33.930475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133d2570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1152b1d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1152b3610>]}
[0m11:39:33.930659 [debug] [MainThread]: Flushing usage events
[0m11:40:07.143311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106472120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dc3ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dc3d90>]}


============================== 11:40:07.145465 | 14801aa3-e3b6-4914-8ff2-950114f7bf28 ==============================
[0m11:40:07.145465 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:40:07.145759 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/adi/.dbt', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:40:07.304259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14801aa3-e3b6-4914-8ff2-950114f7bf28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a29a70>]}
[0m11:40:07.326939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14801aa3-e3b6-4914-8ff2-950114f7bf28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089f8490>]}
[0m11:40:07.327313 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:40:07.335324 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:40:07.392742 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:40:07.393177 [debug] [MainThread]: Partial parsing: updated file: stock_prediction://models/schema.yml
[0m11:40:07.487528 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:40:07.487837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '14801aa3-e3b6-4914-8ff2-950114f7bf28', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c54d50>]}
[0m11:40:07.600164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14801aa3-e3b6-4914-8ff2-950114f7bf28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aa4320>]}
[0m11:40:07.650584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14801aa3-e3b6-4914-8ff2-950114f7bf28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d2dd30>]}
[0m11:40:07.650821 [info ] [MainThread]: Found 3 models, 19 data tests, 2 sources, 459 macros
[0m11:40:07.650974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14801aa3-e3b6-4914-8ff2-950114f7bf28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fba750>]}
[0m11:40:07.652129 [info ] [MainThread]: 
[0m11:40:07.652377 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:40:07.654400 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_analytics'
[0m11:40:07.661631 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m11:40:07.661782 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m11:40:07.661907 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:40:08.254182 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.592 seconds
[0m11:40:08.257864 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m11:40:08.390711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14801aa3-e3b6-4914-8ff2-950114f7bf28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ff8110>]}
[0m11:40:08.391474 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:40:08.391897 [info ] [MainThread]: 
[0m11:40:08.394823 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m11:40:08.395331 [info ] [Thread-1 (]: 1 of 19 START test not_null_moving_average_close ............................... [RUN]
[0m11:40:08.395814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now test.stock_prediction.not_null_moving_average_close.6d037dd588)
[0m11:40:08.396171 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m11:40:08.412051 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_close.6d037dd588"
[0m11:40:08.413087 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m11:40:08.428173 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_close.6d037dd588"
[0m11:40:08.428990 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_close.6d037dd588"
[0m11:40:08.429232 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_close.6d037dd588: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_close.6d037dd588"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.moving_average
where close is null



      
    ) dbt_internal_test
[0m11:40:08.429432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:08.853078 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.423 seconds
[0m11:40:08.866510 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_close.6d037dd588: Close
[0m11:40:08.983792 [info ] [Thread-1 (]: 1 of 19 PASS not_null_moving_average_close ..................................... [[32mPASS[0m in 0.59s]
[0m11:40:08.984907 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m11:40:08.985559 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m11:40:08.986046 [info ] [Thread-1 (]: 2 of 19 START test not_null_moving_average_date ................................ [RUN]
[0m11:40:08.986587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_close.6d037dd588, now test.stock_prediction.not_null_moving_average_date.3ad00158b5)
[0m11:40:08.987021 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m11:40:08.993151 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_date.3ad00158b5"
[0m11:40:08.994210 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m11:40:08.996366 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_date.3ad00158b5"
[0m11:40:08.997301 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_date.3ad00158b5"
[0m11:40:08.997635 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_date.3ad00158b5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_date.3ad00158b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.moving_average
where date is null



      
    ) dbt_internal_test
[0m11:40:08.997950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:09.388923 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.390 seconds
[0m11:40:09.392913 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_date.3ad00158b5: Close
[0m11:40:09.517757 [info ] [Thread-1 (]: 2 of 19 PASS not_null_moving_average_date ...................................... [[32mPASS[0m in 0.53s]
[0m11:40:09.518677 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m11:40:09.519276 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m11:40:09.519884 [info ] [Thread-1 (]: 3 of 19 START test not_null_moving_average_moving_avg_20d ...................... [RUN]
[0m11:40:09.520495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_date.3ad00158b5, now test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22)
[0m11:40:09.520877 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m11:40:09.525984 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m11:40:09.526958 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m11:40:09.529751 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m11:40:09.530692 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m11:40:09.531025 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg_20d
from dev.analytics.moving_average
where moving_avg_20d is null



      
    ) dbt_internal_test
[0m11:40:09.531326 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:09.969999 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.438 seconds
[0m11:40:09.975682 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22: Close
[0m11:40:10.100418 [info ] [Thread-1 (]: 3 of 19 PASS not_null_moving_average_moving_avg_20d ............................ [[32mPASS[0m in 0.58s]
[0m11:40:10.101344 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m11:40:10.101810 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m11:40:10.102299 [info ] [Thread-1 (]: 4 of 19 START test not_null_moving_average_moving_avg_5d ....................... [RUN]
[0m11:40:10.102833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22, now test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca)
[0m11:40:10.103232 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m11:40:10.107842 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m11:40:10.108849 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m11:40:10.111586 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m11:40:10.112518 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m11:40:10.112843 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg_5d
from dev.analytics.moving_average
where moving_avg_5d is null



      
    ) dbt_internal_test
[0m11:40:10.113125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:10.548421 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.435 seconds
[0m11:40:10.551247 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca: Close
[0m11:40:10.672285 [info ] [Thread-1 (]: 4 of 19 PASS not_null_moving_average_moving_avg_5d ............................. [[32mPASS[0m in 0.57s]
[0m11:40:10.673079 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m11:40:10.673348 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m11:40:10.673535 [info ] [Thread-1 (]: 5 of 19 START test not_null_moving_average_symbol .............................. [RUN]
[0m11:40:10.673767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca, now test.stock_prediction.not_null_moving_average_symbol.75a6f7473c)
[0m11:40:10.673924 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m11:40:10.675970 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"
[0m11:40:10.676486 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m11:40:10.677540 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"
[0m11:40:10.677993 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"
[0m11:40:10.678157 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_symbol.75a6f7473c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.moving_average
where symbol is null



      
    ) dbt_internal_test
[0m11:40:10.678306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:11.118992 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.440 seconds
[0m11:40:11.121310 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_symbol.75a6f7473c: Close
[0m11:40:11.232288 [info ] [Thread-1 (]: 5 of 19 PASS not_null_moving_average_symbol .................................... [[32mPASS[0m in 0.56s]
[0m11:40:11.233273 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m11:40:11.233815 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m11:40:11.234385 [info ] [Thread-1 (]: 6 of 19 START test not_null_rsi_calculation_avg_gain ........................... [RUN]
[0m11:40:11.235057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_symbol.75a6f7473c, now test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42)
[0m11:40:11.235548 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m11:40:11.240165 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m11:40:11.241017 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m11:40:11.243162 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m11:40:11.244017 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m11:40:11.244360 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_gain
from dev.analytics.rsi_calculation
where avg_gain is null



      
    ) dbt_internal_test
[0m11:40:11.244662 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:11.664905 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.420 seconds
[0m11:40:11.669190 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42: Close
[0m11:40:11.805026 [info ] [Thread-1 (]: 6 of 19 PASS not_null_rsi_calculation_avg_gain ................................. [[32mPASS[0m in 0.57s]
[0m11:40:11.806216 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m11:40:11.806810 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m11:40:11.807240 [info ] [Thread-1 (]: 7 of 19 START test not_null_rsi_calculation_avg_loss ........................... [RUN]
[0m11:40:11.807758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42, now test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19)
[0m11:40:11.808229 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m11:40:11.813425 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m11:40:11.814447 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m11:40:11.816493 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m11:40:11.817415 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m11:40:11.817744 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_loss
from dev.analytics.rsi_calculation
where avg_loss is null



      
    ) dbt_internal_test
[0m11:40:11.818058 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:12.192921 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.375 seconds
[0m11:40:12.195606 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19: Close
[0m11:40:12.306143 [info ] [Thread-1 (]: 7 of 19 PASS not_null_rsi_calculation_avg_loss ................................. [[32mPASS[0m in 0.50s]
[0m11:40:12.307475 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m11:40:12.307710 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m11:40:12.307875 [info ] [Thread-1 (]: 8 of 19 START test not_null_rsi_calculation_close .............................. [RUN]
[0m11:40:12.308098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19, now test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d)
[0m11:40:12.308255 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m11:40:12.310346 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"
[0m11:40:12.310923 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m11:40:12.311981 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"
[0m11:40:12.312491 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"
[0m11:40:12.312651 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.rsi_calculation
where close is null



      
    ) dbt_internal_test
[0m11:40:12.312798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:12.698098 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.385 seconds
[0m11:40:12.701378 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d: Close
[0m11:40:12.814162 [info ] [Thread-1 (]: 8 of 19 PASS not_null_rsi_calculation_close .................................... [[32mPASS[0m in 0.51s]
[0m11:40:12.814958 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m11:40:12.815406 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m11:40:12.815875 [info ] [Thread-1 (]: 9 of 19 START test not_null_rsi_calculation_date ............................... [RUN]
[0m11:40:12.816411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d, now test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76)
[0m11:40:12.816803 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m11:40:12.821472 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"
[0m11:40:12.822354 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m11:40:12.824302 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"
[0m11:40:12.825145 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"
[0m11:40:12.825467 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.rsi_calculation
where date is null



      
    ) dbt_internal_test
[0m11:40:12.827526 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:13.230122 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.402 seconds
[0m11:40:13.233911 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76: Close
[0m11:40:13.356766 [info ] [Thread-1 (]: 9 of 19 PASS not_null_rsi_calculation_date ..................................... [[32mPASS[0m in 0.54s]
[0m11:40:13.357626 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m11:40:13.358184 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m11:40:13.358734 [info ] [Thread-1 (]: 10 of 19 START test not_null_rsi_calculation_rsi_14d ........................... [RUN]
[0m11:40:13.359304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76, now test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8)
[0m11:40:13.359747 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m11:40:13.364863 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m11:40:13.365755 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m11:40:13.367950 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m11:40:13.368802 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m11:40:13.369118 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from dev.analytics.rsi_calculation
where rsi_14d is null



      
    ) dbt_internal_test
[0m11:40:13.369411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:13.778295 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.408 seconds
[0m11:40:13.782686 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8: Close
[0m11:40:13.916358 [info ] [Thread-1 (]: 10 of 19 PASS not_null_rsi_calculation_rsi_14d ................................. [[32mPASS[0m in 0.56s]
[0m11:40:13.917988 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m11:40:13.918605 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m11:40:13.919119 [info ] [Thread-1 (]: 11 of 19 START test not_null_rsi_calculation_symbol ............................ [RUN]
[0m11:40:13.919769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8, now test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84)
[0m11:40:13.920180 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m11:40:13.925051 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m11:40:13.925995 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m11:40:13.927981 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m11:40:13.928890 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m11:40:13.929226 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.rsi_calculation
where symbol is null



      
    ) dbt_internal_test
[0m11:40:13.929531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:14.357300 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.427 seconds
[0m11:40:14.363765 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84: Close
[0m11:40:14.510145 [info ] [Thread-1 (]: 11 of 19 PASS not_null_rsi_calculation_symbol .................................. [[32mPASS[0m in 0.59s]
[0m11:40:14.511590 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m11:40:14.512298 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m11:40:14.512840 [info ] [Thread-1 (]: 12 of 19 START test not_null_stock_prices_close ................................ [RUN]
[0m11:40:14.513393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84, now test.stock_prediction.not_null_stock_prices_close.d7e232e1ba)
[0m11:40:14.513758 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m11:40:14.518762 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"
[0m11:40:14.519734 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m11:40:14.521709 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"
[0m11:40:14.522579 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"
[0m11:40:14.522913 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_close.d7e232e1ba: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.stock_prices
where close is null



      
    ) dbt_internal_test
[0m11:40:14.523209 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:14.935752 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.412 seconds
[0m11:40:14.944141 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_close.d7e232e1ba: Close
[0m11:40:15.064779 [info ] [Thread-1 (]: 12 of 19 PASS not_null_stock_prices_close ...................................... [[32mPASS[0m in 0.55s]
[0m11:40:15.065792 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m11:40:15.066355 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m11:40:15.066903 [info ] [Thread-1 (]: 13 of 19 START test not_null_stock_prices_date ................................. [RUN]
[0m11:40:15.067492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_close.d7e232e1ba, now test.stock_prediction.not_null_stock_prices_date.98a7527501)
[0m11:40:15.067939 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m11:40:15.072961 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_date.98a7527501"
[0m11:40:15.073981 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m11:40:15.076011 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_date.98a7527501"
[0m11:40:15.076908 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_date.98a7527501"
[0m11:40:15.077231 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_date.98a7527501: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_date.98a7527501"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.stock_prices
where date is null



      
    ) dbt_internal_test
[0m11:40:15.077528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:15.491329 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.413 seconds
[0m11:40:15.496327 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_date.98a7527501: Close
[0m11:40:15.632307 [info ] [Thread-1 (]: 13 of 19 PASS not_null_stock_prices_date ....................................... [[32mPASS[0m in 0.56s]
[0m11:40:15.633172 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m11:40:15.633715 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m11:40:15.634254 [info ] [Thread-1 (]: 14 of 19 START test not_null_stock_prices_high ................................. [RUN]
[0m11:40:15.634823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_date.98a7527501, now test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc)
[0m11:40:15.635255 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m11:40:15.640475 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"
[0m11:40:15.641466 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m11:40:15.643688 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"
[0m11:40:15.644548 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"
[0m11:40:15.644860 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select high
from dev.analytics.stock_prices
where high is null



      
    ) dbt_internal_test
[0m11:40:15.645153 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:16.077339 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.432 seconds
[0m11:40:16.082961 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc: Close
[0m11:40:16.208049 [info ] [Thread-1 (]: 14 of 19 PASS not_null_stock_prices_high ....................................... [[32mPASS[0m in 0.57s]
[0m11:40:16.208772 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m11:40:16.209229 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m11:40:16.209715 [info ] [Thread-1 (]: 15 of 19 START test not_null_stock_prices_low .................................. [RUN]
[0m11:40:16.210251 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc, now test.stock_prediction.not_null_stock_prices_low.e65294ca15)
[0m11:40:16.210644 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m11:40:16.215629 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_low.e65294ca15"
[0m11:40:16.216583 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m11:40:16.218517 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_low.e65294ca15"
[0m11:40:16.219392 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_low.e65294ca15"
[0m11:40:16.219717 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_low.e65294ca15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_low.e65294ca15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select low
from dev.analytics.stock_prices
where low is null



      
    ) dbt_internal_test
[0m11:40:16.220009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:16.626518 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.406 seconds
[0m11:40:16.631882 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_low.e65294ca15: Close
[0m11:40:16.754219 [info ] [Thread-1 (]: 15 of 19 PASS not_null_stock_prices_low ........................................ [[32mPASS[0m in 0.54s]
[0m11:40:16.755329 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m11:40:16.755899 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m11:40:16.756469 [info ] [Thread-1 (]: 16 of 19 START test not_null_stock_prices_open ................................. [RUN]
[0m11:40:16.757052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_low.e65294ca15, now test.stock_prediction.not_null_stock_prices_open.e09b13f215)
[0m11:40:16.757421 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m11:40:16.762346 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_open.e09b13f215"
[0m11:40:16.763336 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m11:40:16.765283 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_open.e09b13f215"
[0m11:40:16.766158 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_open.e09b13f215"
[0m11:40:16.766484 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_open.e09b13f215: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_open.e09b13f215"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from dev.analytics.stock_prices
where open is null



      
    ) dbt_internal_test
[0m11:40:16.766785 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:17.196985 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.430 seconds
[0m11:40:17.201834 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_open.e09b13f215: Close
[0m11:40:17.398064 [info ] [Thread-1 (]: 16 of 19 PASS not_null_stock_prices_open ....................................... [[32mPASS[0m in 0.64s]
[0m11:40:17.398912 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m11:40:17.399374 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m11:40:17.399837 [info ] [Thread-1 (]: 17 of 19 START test not_null_stock_prices_symbol ............................... [RUN]
[0m11:40:17.400365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_open.e09b13f215, now test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8)
[0m11:40:17.400742 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m11:40:17.405633 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"
[0m11:40:17.406565 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m11:40:17.408511 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"
[0m11:40:17.409384 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"
[0m11:40:17.409718 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.stock_prices
where symbol is null



      
    ) dbt_internal_test
[0m11:40:17.410019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:18.109499 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.699 seconds
[0m11:40:18.113908 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8: Close
[0m11:40:18.262901 [info ] [Thread-1 (]: 17 of 19 PASS not_null_stock_prices_symbol ..................................... [[32mPASS[0m in 0.86s]
[0m11:40:18.263776 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m11:40:18.264331 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m11:40:18.264905 [info ] [Thread-1 (]: 18 of 19 START test not_null_stock_prices_volume ............................... [RUN]
[0m11:40:18.265548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8, now test.stock_prediction.not_null_stock_prices_volume.71420bc956)
[0m11:40:18.266020 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m11:40:18.271080 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_volume.71420bc956"
[0m11:40:18.271954 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m11:40:18.273978 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_volume.71420bc956"
[0m11:40:18.274823 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_volume.71420bc956"
[0m11:40:18.275144 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_volume.71420bc956: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_volume.71420bc956"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume
from dev.analytics.stock_prices
where volume is null



      
    ) dbt_internal_test
[0m11:40:18.275440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:18.777964 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.502 seconds
[0m11:40:18.784251 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_volume.71420bc956: Close
[0m11:40:18.941648 [info ] [Thread-1 (]: 18 of 19 PASS not_null_stock_prices_volume ..................................... [[32mPASS[0m in 0.68s]
[0m11:40:18.942648 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m11:40:18.943191 [debug] [Thread-1 (]: Began running node test.stock_prediction.unique_stock_prices_date.1d2e222e60
[0m11:40:18.943759 [info ] [Thread-1 (]: 19 of 19 START test unique_stock_prices_date ................................... [RUN]
[0m11:40:18.944366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_volume.71420bc956, now test.stock_prediction.unique_stock_prices_date.1d2e222e60)
[0m11:40:18.944820 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.unique_stock_prices_date.1d2e222e60
[0m11:40:18.952593 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.unique_stock_prices_date.1d2e222e60"
[0m11:40:18.953545 [debug] [Thread-1 (]: Began executing node test.stock_prediction.unique_stock_prices_date.1d2e222e60
[0m11:40:18.955519 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.unique_stock_prices_date.1d2e222e60"
[0m11:40:18.956477 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.unique_stock_prices_date.1d2e222e60"
[0m11:40:18.956799 [debug] [Thread-1 (]: On test.stock_prediction.unique_stock_prices_date.1d2e222e60: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.unique_stock_prices_date.1d2e222e60"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from dev.analytics.stock_prices
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m11:40:18.957102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:19.393805 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.436 seconds
[0m11:40:19.397811 [debug] [Thread-1 (]: On test.stock_prediction.unique_stock_prices_date.1d2e222e60: Close
[0m11:40:19.553366 [error] [Thread-1 (]: 19 of 19 FAIL 90 unique_stock_prices_date ...................................... [[31mFAIL 90[0m in 0.61s]
[0m11:40:19.554535 [debug] [Thread-1 (]: Finished running node test.stock_prediction.unique_stock_prices_date.1d2e222e60
[0m11:40:19.556117 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:40:19.556434 [debug] [MainThread]: Connection 'test.stock_prediction.unique_stock_prices_date.1d2e222e60' was properly closed.
[0m11:40:19.556747 [info ] [MainThread]: 
[0m11:40:19.557038 [info ] [MainThread]: Finished running 19 data tests in 0 hours 0 minutes and 11.90 seconds (11.90s).
[0m11:40:19.559668 [debug] [MainThread]: Command end result
[0m11:40:19.586299 [info ] [MainThread]: 
[0m11:40:19.586532 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:40:19.586682 [info ] [MainThread]: 
[0m11:40:19.586876 [error] [MainThread]: [31mFailure in test unique_stock_prices_date (models/schema.yml)[0m
[0m11:40:19.587048 [error] [MainThread]:   Got 90 results, configured to fail if != 0
[0m11:40:19.587179 [info ] [MainThread]: 
[0m11:40:19.587341 [info ] [MainThread]:   compiled code at target/compiled/stock_prediction/models/schema.yml/unique_stock_prices_date.sql
[0m11:40:19.587480 [info ] [MainThread]: 
[0m11:40:19.587629 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=1 SKIP=0 TOTAL=19
[0m11:40:19.589012 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 12.477624, "process_user_time": 2.511003, "process_kernel_time": 0.297352, "process_mem_max_rss": "143409152", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:40:19.589323 [debug] [MainThread]: Command `dbt test` failed at 11:40:19.589268 after 12.48 seconds
[0m11:40:19.589524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090e6620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109213cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109213d90>]}
[0m11:40:19.589711 [debug] [MainThread]: Flushing usage events
[0m11:40:52.896802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cfe120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10664fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10664fd90>]}


============================== 11:40:52.899111 | 257cab8f-b9be-404f-bf16-7687cd69ec78 ==============================
[0m11:40:52.899111 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:40:52.899431 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:40:53.057110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '257cab8f-b9be-404f-bf16-7687cd69ec78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072b9a70>]}
[0m11:40:53.079969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '257cab8f-b9be-404f-bf16-7687cd69ec78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107284490>]}
[0m11:40:53.080340 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:40:53.089316 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:40:53.147266 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:40:53.147706 [debug] [MainThread]: Partial parsing: updated file: stock_prediction://models/schema.yml
[0m11:40:53.242299 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:40:53.242627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '257cab8f-b9be-404f-bf16-7687cd69ec78', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074eca50>]}
[0m11:40:53.354795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '257cab8f-b9be-404f-bf16-7687cd69ec78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073334d0>]}
[0m11:40:53.405011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '257cab8f-b9be-404f-bf16-7687cd69ec78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077652b0>]}
[0m11:40:53.405251 [info ] [MainThread]: Found 3 models, 18 data tests, 2 sources, 459 macros
[0m11:40:53.405399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '257cab8f-b9be-404f-bf16-7687cd69ec78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10783f040>]}
[0m11:40:53.406510 [info ] [MainThread]: 
[0m11:40:53.406761 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:40:53.408745 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_analytics'
[0m11:40:53.415900 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m11:40:53.416051 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m11:40:53.416167 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:40:53.943137 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.527 seconds
[0m11:40:53.946347 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m11:40:54.070716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '257cab8f-b9be-404f-bf16-7687cd69ec78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107884350>]}
[0m11:40:54.071506 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:40:54.071925 [info ] [MainThread]: 
[0m11:40:54.074966 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m11:40:54.075409 [info ] [Thread-1 (]: 1 of 18 START test not_null_moving_average_close ............................... [RUN]
[0m11:40:54.075880 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now test.stock_prediction.not_null_moving_average_close.6d037dd588)
[0m11:40:54.076236 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m11:40:54.092217 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_close.6d037dd588"
[0m11:40:54.093056 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m11:40:54.107530 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_close.6d037dd588"
[0m11:40:54.108301 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_close.6d037dd588"
[0m11:40:54.108569 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_close.6d037dd588: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_close.6d037dd588"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.moving_average
where close is null



      
    ) dbt_internal_test
[0m11:40:54.108784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:54.550061 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.441 seconds
[0m11:40:54.561193 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_close.6d037dd588: Close
[0m11:40:54.670011 [info ] [Thread-1 (]: 1 of 18 PASS not_null_moving_average_close ..................................... [[32mPASS[0m in 0.59s]
[0m11:40:54.670934 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m11:40:54.671420 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m11:40:54.671948 [info ] [Thread-1 (]: 2 of 18 START test not_null_moving_average_date ................................ [RUN]
[0m11:40:54.672504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_close.6d037dd588, now test.stock_prediction.not_null_moving_average_date.3ad00158b5)
[0m11:40:54.672898 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m11:40:54.678040 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_date.3ad00158b5"
[0m11:40:54.678977 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m11:40:54.680890 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_date.3ad00158b5"
[0m11:40:54.681681 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_date.3ad00158b5"
[0m11:40:54.681983 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_date.3ad00158b5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_date.3ad00158b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.moving_average
where date is null



      
    ) dbt_internal_test
[0m11:40:54.682247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:55.043999 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.361 seconds
[0m11:40:55.048475 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_date.3ad00158b5: Close
[0m11:40:55.170548 [info ] [Thread-1 (]: 2 of 18 PASS not_null_moving_average_date ...................................... [[32mPASS[0m in 0.50s]
[0m11:40:55.171685 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m11:40:55.172288 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m11:40:55.172906 [info ] [Thread-1 (]: 3 of 18 START test not_null_moving_average_moving_avg_20d ...................... [RUN]
[0m11:40:55.173601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_date.3ad00158b5, now test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22)
[0m11:40:55.174096 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m11:40:55.179245 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m11:40:55.180344 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m11:40:55.183126 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m11:40:55.184022 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m11:40:55.184358 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg_20d
from dev.analytics.moving_average
where moving_avg_20d is null



      
    ) dbt_internal_test
[0m11:40:55.184666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:55.571764 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.386 seconds
[0m11:40:55.578474 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22: Close
[0m11:40:55.687761 [info ] [Thread-1 (]: 3 of 18 PASS not_null_moving_average_moving_avg_20d ............................ [[32mPASS[0m in 0.51s]
[0m11:40:55.688697 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m11:40:55.689256 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m11:40:55.689696 [info ] [Thread-1 (]: 4 of 18 START test not_null_moving_average_moving_avg_5d ....................... [RUN]
[0m11:40:55.690479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22, now test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca)
[0m11:40:55.690882 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m11:40:55.695849 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m11:40:55.696822 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m11:40:55.699499 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m11:40:55.700447 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m11:40:55.700780 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg_5d
from dev.analytics.moving_average
where moving_avg_5d is null



      
    ) dbt_internal_test
[0m11:40:55.701090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:56.079387 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.378 seconds
[0m11:40:56.083166 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca: Close
[0m11:40:56.202083 [info ] [Thread-1 (]: 4 of 18 PASS not_null_moving_average_moving_avg_5d ............................. [[32mPASS[0m in 0.51s]
[0m11:40:56.202942 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m11:40:56.203496 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m11:40:56.203999 [info ] [Thread-1 (]: 5 of 18 START test not_null_moving_average_symbol .............................. [RUN]
[0m11:40:56.204513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca, now test.stock_prediction.not_null_moving_average_symbol.75a6f7473c)
[0m11:40:56.204887 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m11:40:56.209867 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"
[0m11:40:56.210849 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m11:40:56.212816 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"
[0m11:40:56.213737 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"
[0m11:40:56.214080 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_symbol.75a6f7473c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.moving_average
where symbol is null



      
    ) dbt_internal_test
[0m11:40:56.214380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:56.623439 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.408 seconds
[0m11:40:56.628446 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_symbol.75a6f7473c: Close
[0m11:40:56.755029 [info ] [Thread-1 (]: 5 of 18 PASS not_null_moving_average_symbol .................................... [[32mPASS[0m in 0.55s]
[0m11:40:56.756190 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m11:40:56.756763 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m11:40:56.757382 [info ] [Thread-1 (]: 6 of 18 START test not_null_rsi_calculation_avg_gain ........................... [RUN]
[0m11:40:56.758042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_symbol.75a6f7473c, now test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42)
[0m11:40:56.758461 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m11:40:56.763652 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m11:40:56.764697 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m11:40:56.766674 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m11:40:56.767591 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m11:40:56.767916 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_gain
from dev.analytics.rsi_calculation
where avg_gain is null



      
    ) dbt_internal_test
[0m11:40:56.768225 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:57.178822 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.410 seconds
[0m11:40:57.183854 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42: Close
[0m11:40:57.307053 [info ] [Thread-1 (]: 6 of 18 PASS not_null_rsi_calculation_avg_gain ................................. [[32mPASS[0m in 0.55s]
[0m11:40:57.307900 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m11:40:57.308451 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m11:40:57.309014 [info ] [Thread-1 (]: 7 of 18 START test not_null_rsi_calculation_avg_loss ........................... [RUN]
[0m11:40:57.309644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42, now test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19)
[0m11:40:57.310102 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m11:40:57.315371 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m11:40:57.316415 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m11:40:57.318530 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m11:40:57.319382 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m11:40:57.319703 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_loss
from dev.analytics.rsi_calculation
where avg_loss is null



      
    ) dbt_internal_test
[0m11:40:57.320000 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:57.726279 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.406 seconds
[0m11:40:57.730720 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19: Close
[0m11:40:57.874360 [info ] [Thread-1 (]: 7 of 18 PASS not_null_rsi_calculation_avg_loss ................................. [[32mPASS[0m in 0.56s]
[0m11:40:57.875828 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m11:40:57.876203 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m11:40:57.876559 [info ] [Thread-1 (]: 8 of 18 START test not_null_rsi_calculation_close .............................. [RUN]
[0m11:40:57.876964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19, now test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d)
[0m11:40:57.877248 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m11:40:57.880838 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"
[0m11:40:57.881677 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m11:40:57.883235 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"
[0m11:40:57.883958 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"
[0m11:40:57.884215 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.rsi_calculation
where close is null



      
    ) dbt_internal_test
[0m11:40:57.884461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:58.267908 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.383 seconds
[0m11:40:58.272122 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d: Close
[0m11:40:58.380865 [info ] [Thread-1 (]: 8 of 18 PASS not_null_rsi_calculation_close .................................... [[32mPASS[0m in 0.50s]
[0m11:40:58.381737 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m11:40:58.382286 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m11:40:58.382845 [info ] [Thread-1 (]: 9 of 18 START test not_null_rsi_calculation_date ............................... [RUN]
[0m11:40:58.383464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d, now test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76)
[0m11:40:58.383909 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m11:40:58.389134 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"
[0m11:40:58.389973 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m11:40:58.392217 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"
[0m11:40:58.393116 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"
[0m11:40:58.393432 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.rsi_calculation
where date is null



      
    ) dbt_internal_test
[0m11:40:58.393736 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:58.808067 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.414 seconds
[0m11:40:58.812342 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76: Close
[0m11:40:58.929249 [info ] [Thread-1 (]: 9 of 18 PASS not_null_rsi_calculation_date ..................................... [[32mPASS[0m in 0.55s]
[0m11:40:58.930137 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m11:40:58.930695 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m11:40:58.931263 [info ] [Thread-1 (]: 10 of 18 START test not_null_rsi_calculation_rsi_14d ........................... [RUN]
[0m11:40:58.931919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76, now test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8)
[0m11:40:58.932385 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m11:40:58.937381 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m11:40:58.938495 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m11:40:58.940715 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m11:40:58.941603 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m11:40:58.941927 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from dev.analytics.rsi_calculation
where rsi_14d is null



      
    ) dbt_internal_test
[0m11:40:58.942226 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:59.329838 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.387 seconds
[0m11:40:59.334594 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8: Close
[0m11:40:59.454658 [info ] [Thread-1 (]: 10 of 18 PASS not_null_rsi_calculation_rsi_14d ................................. [[32mPASS[0m in 0.52s]
[0m11:40:59.456049 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m11:40:59.456404 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m11:40:59.456744 [info ] [Thread-1 (]: 11 of 18 START test not_null_rsi_calculation_symbol ............................ [RUN]
[0m11:40:59.457150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8, now test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84)
[0m11:40:59.457434 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m11:40:59.461045 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m11:40:59.461929 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m11:40:59.463419 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m11:40:59.464084 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m11:40:59.464316 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.rsi_calculation
where symbol is null



      
    ) dbt_internal_test
[0m11:40:59.464531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:59.899930 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.435 seconds
[0m11:40:59.904102 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84: Close
[0m11:41:00.035651 [info ] [Thread-1 (]: 11 of 18 PASS not_null_rsi_calculation_symbol .................................. [[32mPASS[0m in 0.58s]
[0m11:41:00.036476 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m11:41:00.037053 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m11:41:00.037603 [info ] [Thread-1 (]: 12 of 18 START test not_null_stock_prices_close ................................ [RUN]
[0m11:41:00.038192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84, now test.stock_prediction.not_null_stock_prices_close.d7e232e1ba)
[0m11:41:00.038637 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m11:41:00.043917 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"
[0m11:41:00.045015 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m11:41:00.047100 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"
[0m11:41:00.047988 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"
[0m11:41:00.048307 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_close.d7e232e1ba: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.stock_prices
where close is null



      
    ) dbt_internal_test
[0m11:41:00.048605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:00.428464 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.379 seconds
[0m11:41:00.433386 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_close.d7e232e1ba: Close
[0m11:41:00.562415 [info ] [Thread-1 (]: 12 of 18 PASS not_null_stock_prices_close ...................................... [[32mPASS[0m in 0.52s]
[0m11:41:00.563304 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m11:41:00.563854 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m11:41:00.564432 [info ] [Thread-1 (]: 13 of 18 START test not_null_stock_prices_date ................................. [RUN]
[0m11:41:00.565089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_close.d7e232e1ba, now test.stock_prediction.not_null_stock_prices_date.98a7527501)
[0m11:41:00.565556 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m11:41:00.570822 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_date.98a7527501"
[0m11:41:00.571818 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m11:41:00.574077 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_date.98a7527501"
[0m11:41:00.574919 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_date.98a7527501"
[0m11:41:00.575246 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_date.98a7527501: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_date.98a7527501"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.stock_prices
where date is null



      
    ) dbt_internal_test
[0m11:41:00.575543 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:00.984578 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.408 seconds
[0m11:41:00.989533 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_date.98a7527501: Close
[0m11:41:01.117834 [info ] [Thread-1 (]: 13 of 18 PASS not_null_stock_prices_date ....................................... [[32mPASS[0m in 0.55s]
[0m11:41:01.118780 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m11:41:01.119346 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m11:41:01.119934 [info ] [Thread-1 (]: 14 of 18 START test not_null_stock_prices_high ................................. [RUN]
[0m11:41:01.120658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_date.98a7527501, now test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc)
[0m11:41:01.121127 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m11:41:01.126192 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"
[0m11:41:01.127179 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m11:41:01.129145 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"
[0m11:41:01.130063 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"
[0m11:41:01.130381 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select high
from dev.analytics.stock_prices
where high is null



      
    ) dbt_internal_test
[0m11:41:01.130687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:01.551886 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.421 seconds
[0m11:41:01.557403 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc: Close
[0m11:41:01.677273 [info ] [Thread-1 (]: 14 of 18 PASS not_null_stock_prices_high ....................................... [[32mPASS[0m in 0.56s]
[0m11:41:01.678199 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m11:41:01.678755 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m11:41:01.679328 [info ] [Thread-1 (]: 15 of 18 START test not_null_stock_prices_low .................................. [RUN]
[0m11:41:01.679960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc, now test.stock_prediction.not_null_stock_prices_low.e65294ca15)
[0m11:41:01.680435 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m11:41:01.685356 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_low.e65294ca15"
[0m11:41:01.686366 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m11:41:01.688335 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_low.e65294ca15"
[0m11:41:01.689181 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_low.e65294ca15"
[0m11:41:01.689508 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_low.e65294ca15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_low.e65294ca15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select low
from dev.analytics.stock_prices
where low is null



      
    ) dbt_internal_test
[0m11:41:01.689802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:02.094377 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.404 seconds
[0m11:41:02.101255 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_low.e65294ca15: Close
[0m11:41:02.207820 [info ] [Thread-1 (]: 15 of 18 PASS not_null_stock_prices_low ........................................ [[32mPASS[0m in 0.53s]
[0m11:41:02.208549 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m11:41:02.209004 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m11:41:02.209470 [info ] [Thread-1 (]: 16 of 18 START test not_null_stock_prices_open ................................. [RUN]
[0m11:41:02.209969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_low.e65294ca15, now test.stock_prediction.not_null_stock_prices_open.e09b13f215)
[0m11:41:02.210340 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m11:41:02.214997 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_open.e09b13f215"
[0m11:41:02.215943 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m11:41:02.217876 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_open.e09b13f215"
[0m11:41:02.218733 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_open.e09b13f215"
[0m11:41:02.219055 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_open.e09b13f215: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_open.e09b13f215"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from dev.analytics.stock_prices
where open is null



      
    ) dbt_internal_test
[0m11:41:02.219355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:02.657569 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.438 seconds
[0m11:41:02.663887 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_open.e09b13f215: Close
[0m11:41:02.781955 [info ] [Thread-1 (]: 16 of 18 PASS not_null_stock_prices_open ....................................... [[32mPASS[0m in 0.57s]
[0m11:41:02.782862 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m11:41:02.783361 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m11:41:02.783672 [info ] [Thread-1 (]: 17 of 18 START test not_null_stock_prices_symbol ............................... [RUN]
[0m11:41:02.784065 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_open.e09b13f215, now test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8)
[0m11:41:02.784345 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m11:41:02.788495 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"
[0m11:41:02.789477 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m11:41:02.791350 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"
[0m11:41:02.792144 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"
[0m11:41:02.792417 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.stock_prices
where symbol is null



      
    ) dbt_internal_test
[0m11:41:02.792665 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:03.228253 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.435 seconds
[0m11:41:03.233653 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8: Close
[0m11:41:03.357730 [info ] [Thread-1 (]: 17 of 18 PASS not_null_stock_prices_symbol ..................................... [[32mPASS[0m in 0.57s]
[0m11:41:03.358758 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m11:41:03.359334 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m11:41:03.359918 [info ] [Thread-1 (]: 18 of 18 START test not_null_stock_prices_volume ............................... [RUN]
[0m11:41:03.360589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8, now test.stock_prediction.not_null_stock_prices_volume.71420bc956)
[0m11:41:03.361080 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m11:41:03.366245 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_volume.71420bc956"
[0m11:41:03.367260 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m11:41:03.369267 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_volume.71420bc956"
[0m11:41:03.370191 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_volume.71420bc956"
[0m11:41:03.370513 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_volume.71420bc956: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_volume.71420bc956"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume
from dev.analytics.stock_prices
where volume is null



      
    ) dbt_internal_test
[0m11:41:03.370808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:03.779022 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.408 seconds
[0m11:41:03.783476 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_volume.71420bc956: Close
[0m11:41:03.897709 [info ] [Thread-1 (]: 18 of 18 PASS not_null_stock_prices_volume ..................................... [[32mPASS[0m in 0.54s]
[0m11:41:03.898587 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m11:41:03.900157 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:41:03.900458 [debug] [MainThread]: Connection 'test.stock_prediction.not_null_stock_prices_volume.71420bc956' was properly closed.
[0m11:41:03.900783 [info ] [MainThread]: 
[0m11:41:03.901081 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 10.49 seconds (10.49s).
[0m11:41:03.903949 [debug] [MainThread]: Command end result
[0m11:41:03.930602 [info ] [MainThread]: 
[0m11:41:03.930862 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:41:03.931045 [info ] [MainThread]: 
[0m11:41:03.931222 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m11:41:03.932337 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 11.068769, "process_user_time": 2.454055, "process_kernel_time": 0.296406, "process_mem_max_rss": "140050432", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:41:03.932675 [debug] [MainThread]: Command `dbt test` succeeded at 11:41:03.932616 after 11.07 seconds
[0m11:41:03.932893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066a1440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c18550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c18870>]}
[0m11:41:03.933099 [debug] [MainThread]: Flushing usage events
[0m11:53:53.061736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107326120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c77ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c77d90>]}


============================== 11:53:53.064466 | 614a6878-3aa3-46ec-bae9-5b19c5ac26e5 ==============================
[0m11:53:53.064466 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:53:53.064775 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'debug': 'False', 'profiles_dir': '/Users/adi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:53:53.285495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '614a6878-3aa3-46ec-bae9-5b19c5ac26e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098e1a70>]}
[0m11:53:53.307991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '614a6878-3aa3-46ec-bae9-5b19c5ac26e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097cc490>]}
[0m11:53:53.308567 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:53:53.317737 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:53:53.387939 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:53:53.388247 [debug] [MainThread]: Partial parsing: added file: stock_prediction://snapshots/snapshot_rsi.sql
[0m11:53:53.514373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '614a6878-3aa3-46ec-bae9-5b19c5ac26e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b14050>]}
[0m11:53:53.606671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '614a6878-3aa3-46ec-bae9-5b19c5ac26e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cd4b90>]}
[0m11:53:53.606956 [info ] [MainThread]: Found 3 models, 18 data tests, 1 snapshot, 2 sources, 459 macros
[0m11:53:53.607115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '614a6878-3aa3-46ec-bae9-5b19c5ac26e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10994a0b0>]}
[0m11:53:53.608116 [info ] [MainThread]: 
[0m11:53:53.608374 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:53:53.608769 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m11:53:53.614649 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m11:53:53.614802 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m11:53:53.614932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:54.205116 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.590 seconds
[0m11:53:54.208129 [debug] [ThreadPool]: On list_dev: Close
[0m11:53:54.335356 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_snapshot)
[0m11:53:54.336368 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "snapshot"
"
[0m11:53:54.342588 [debug] [ThreadPool]: Using snowflake connection "create_dev_snapshot"
[0m11:53:54.342961 [debug] [ThreadPool]: On create_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "create_dev_snapshot"} */
create schema if not exists dev.snapshot
[0m11:53:54.343258 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:53:54.867832 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.524 seconds
[0m11:53:54.872008 [debug] [ThreadPool]: On create_dev_snapshot: Close
[0m11:53:55.024692 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_snapshot, now list_dev_analytics)
[0m11:53:55.029873 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m11:53:55.030101 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m11:53:55.030252 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:53:55.453933 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.423 seconds
[0m11:53:55.459991 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m11:53:55.604825 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m11:53:55.609133 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m11:53:55.609536 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m11:53:55.609848 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:53:56.029522 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.420 seconds
[0m11:53:56.032108 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m11:53:56.153112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '614a6878-3aa3-46ec-bae9-5b19c5ac26e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c66340>]}
[0m11:53:56.153964 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:53:56.154402 [info ] [MainThread]: 
[0m11:53:56.159121 [debug] [Thread-1 (]: Began running node snapshot.stock_prediction.snapshot_rsi
[0m11:53:56.159761 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_rsi .................................... [RUN]
[0m11:53:56.160220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now snapshot.stock_prediction.snapshot_rsi)
[0m11:53:56.160563 [debug] [Thread-1 (]: Began compiling node snapshot.stock_prediction.snapshot_rsi
[0m11:53:56.169229 [debug] [Thread-1 (]: Began executing node snapshot.stock_prediction.snapshot_rsi
[0m11:53:56.217741 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m11:53:56.218037 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id,
        date as dbt_updated_at,
        date as dbt_valid_from,
        
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to

    from (
        



SELECT * FROM dev.analytics.rsi_calculation

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m11:53:56.218216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:53:56.983174 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.764 seconds
[0m11:53:56.991908 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m11:53:56.992328 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m11:53:57.072312 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.080 seconds
[0m11:53:57.073173 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_prediction.snapshot_rsi"
[0m11:53:57.076425 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m11:53:57.076831 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
create or replace transient table dev.snapshot.snapshot_rsi
         as
        (
    

    select *,
        md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id,
        date as dbt_updated_at,
        date as dbt_valid_from,
        
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to

    from (
        



SELECT * FROM dev.analytics.rsi_calculation

    ) sbq



        );
[0m11:53:57.710267 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.633 seconds
[0m11:53:57.736350 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: Close
[0m11:53:57.855107 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '614a6878-3aa3-46ec-bae9-5b19c5ac26e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e9ef90>]}
[0m11:53:57.855850 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.snapshot_rsi .................................... [[32mSUCCESS 1[0m in 1.69s]
[0m11:53:57.856292 [debug] [Thread-1 (]: Finished running node snapshot.stock_prediction.snapshot_rsi
[0m11:53:57.857355 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:53:57.857569 [debug] [MainThread]: Connection 'snapshot.stock_prediction.snapshot_rsi' was properly closed.
[0m11:53:57.857758 [info ] [MainThread]: 
[0m11:53:57.857934 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 4.25 seconds (4.25s).
[0m11:53:57.858347 [debug] [MainThread]: Command end result
[0m11:53:57.878398 [info ] [MainThread]: 
[0m11:53:57.878626 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:53:57.878766 [info ] [MainThread]: 
[0m11:53:57.878904 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:53:57.880161 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 4.853063, "process_user_time": 1.447256, "process_kernel_time": 0.212986, "process_mem_max_rss": "139673600", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:53:57.880420 [debug] [MainThread]: Command `dbt snapshot` succeeded at 11:53:57.880374 after 4.85 seconds
[0m11:53:57.880584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ed95a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10995f1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10995eb70>]}
[0m11:53:57.880737 [debug] [MainThread]: Flushing usage events
[0m11:55:17.759230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10448e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ddfed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ddfd90>]}


============================== 11:55:17.761267 | 01fdbd16-2a65-419a-93d4-a7134890874c ==============================
[0m11:55:17.761267 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:55:17.761552 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:55:17.920691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01fdbd16-2a65-419a-93d4-a7134890874c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a49a70>]}
[0m11:55:17.943712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01fdbd16-2a65-419a-93d4-a7134890874c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106934490>]}
[0m11:55:17.944111 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:55:17.952466 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:55:18.017549 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:55:18.017938 [debug] [MainThread]: Partial parsing: added file: stock_prediction://snapshots/snapshot_moving_avg.sql
[0m11:55:18.135834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01fdbd16-2a65-419a-93d4-a7134890874c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ce0e50>]}
[0m11:55:18.219871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01fdbd16-2a65-419a-93d4-a7134890874c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e40b90>]}
[0m11:55:18.220155 [info ] [MainThread]: Found 3 models, 18 data tests, 2 snapshots, 2 sources, 459 macros
[0m11:55:18.220326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01fdbd16-2a65-419a-93d4-a7134890874c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ab20b0>]}
[0m11:55:18.221379 [info ] [MainThread]: 
[0m11:55:18.221642 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:55:18.223607 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m11:55:18.229720 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m11:55:18.229870 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m11:55:18.229987 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:18.982373 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.752 seconds
[0m11:55:18.987174 [debug] [ThreadPool]: On list_dev: Close
[0m11:55:19.108958 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_snapshot)
[0m11:55:19.119574 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m11:55:19.119926 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m11:55:19.120181 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:55:19.670608 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.550 seconds
[0m11:55:19.673887 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m11:55:19.801105 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m11:55:19.804014 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m11:55:19.804376 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m11:55:19.804664 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:55:20.221658 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.416 seconds
[0m11:55:20.226185 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m11:55:20.355056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01fdbd16-2a65-419a-93d4-a7134890874c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dd2270>]}
[0m11:55:20.355640 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:55:20.355917 [info ] [MainThread]: 
[0m11:55:20.358353 [debug] [Thread-1 (]: Began running node snapshot.stock_prediction.snapshot_moving_avg
[0m11:55:20.358859 [info ] [Thread-1 (]: 1 of 2 START snapshot snapshot.snapshot_moving_avg ............................. [RUN]
[0m11:55:20.359225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now snapshot.stock_prediction.snapshot_moving_avg)
[0m11:55:20.359501 [debug] [Thread-1 (]: Began compiling node snapshot.stock_prediction.snapshot_moving_avg
[0m11:55:20.366903 [debug] [Thread-1 (]: Began executing node snapshot.stock_prediction.snapshot_moving_avg
[0m11:55:20.411610 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m11:55:20.411900 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id,
        date as dbt_updated_at,
        date as dbt_valid_from,
        
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to

    from (
        



SELECT * FROM dev.analytics.moving_average

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m11:55:20.412072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:55:20.825899 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.414 seconds
[0m11:55:20.833236 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m11:55:20.833695 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m11:55:20.913773 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.079 seconds
[0m11:55:20.915673 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_prediction.snapshot_moving_avg"
[0m11:55:20.917686 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m11:55:20.918196 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
create or replace transient table dev.snapshot.snapshot_moving_avg
         as
        (
    

    select *,
        md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id,
        date as dbt_updated_at,
        date as dbt_valid_from,
        
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to

    from (
        



SELECT * FROM dev.analytics.moving_average

    ) sbq



        );
[0m11:55:21.904486 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.986 seconds
[0m11:55:21.931197 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: Close
[0m11:55:22.062545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01fdbd16-2a65-419a-93d4-a7134890874c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eef050>]}
[0m11:55:22.063943 [info ] [Thread-1 (]: 1 of 2 OK snapshotted snapshot.snapshot_moving_avg ............................. [[32mSUCCESS 1[0m in 1.70s]
[0m11:55:22.064679 [debug] [Thread-1 (]: Finished running node snapshot.stock_prediction.snapshot_moving_avg
[0m11:55:22.065228 [debug] [Thread-1 (]: Began running node snapshot.stock_prediction.snapshot_rsi
[0m11:55:22.065923 [info ] [Thread-1 (]: 2 of 2 START snapshot snapshot.snapshot_rsi .................................... [RUN]
[0m11:55:22.066495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_prediction.snapshot_moving_avg, now snapshot.stock_prediction.snapshot_rsi)
[0m11:55:22.066882 [debug] [Thread-1 (]: Began compiling node snapshot.stock_prediction.snapshot_rsi
[0m11:55:22.071433 [debug] [Thread-1 (]: Began executing node snapshot.stock_prediction.snapshot_rsi
[0m11:55:22.081737 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m11:55:22.082217 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m11:55:22.082459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:55:22.460747 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.378 seconds
[0m11:55:22.495985 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m11:55:22.496500 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.rsi_calculation


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m11:55:23.234061 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.737 seconds
[0m11:55:23.239489 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m11:55:23.239981 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m11:55:23.321183 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.081 seconds
[0m11:55:23.325127 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m11:55:23.325533 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m11:55:23.394007 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.068 seconds
[0m11:55:23.399460 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m11:55:23.399890 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m11:55:23.512589 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.112 seconds
[0m11:55:23.517735 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m11:55:23.518169 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m11:55:23.624963 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.106 seconds
[0m11:55:23.635672 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m11:55:23.636177 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m11:55:23.747773 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.111 seconds
[0m11:55:23.762878 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m11:55:23.763404 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.rsi_calculation


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m11:55:23.925120 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.161 seconds
[0m11:55:23.927160 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m11:55:23.927541 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m11:55:24.029110 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.101 seconds
[0m11:55:24.030431 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_prediction.snapshot_rsi"
[0m11:55:24.032436 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m11:55:24.032839 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
BEGIN
[0m11:55:24.152302 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.119 seconds
[0m11:55:24.154079 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m11:55:24.154864 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_RSI" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "AVG_GAIN", "AVG_LOSS", "RSI_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "AVG_GAIN", "AVG_LOSS", "RSI_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m11:55:24.665621 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.510 seconds
[0m11:55:24.667328 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m11:55:24.668206 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
COMMIT
[0m11:55:25.002090 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.333 seconds
[0m11:55:25.013087 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: Close
[0m11:55:25.158483 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01fdbd16-2a65-419a-93d4-a7134890874c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070a2620>]}
[0m11:55:25.160609 [info ] [Thread-1 (]: 2 of 2 OK snapshotted snapshot.snapshot_rsi .................................... [[32mSUCCESS 0[0m in 3.09s]
[0m11:55:25.161692 [debug] [Thread-1 (]: Finished running node snapshot.stock_prediction.snapshot_rsi
[0m11:55:25.163420 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:55:25.163734 [debug] [MainThread]: Connection 'snapshot.stock_prediction.snapshot_rsi' was properly closed.
[0m11:55:25.164081 [info ] [MainThread]: 
[0m11:55:25.164404 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 6.94 seconds (6.94s).
[0m11:55:25.165232 [debug] [MainThread]: Command end result
[0m11:55:25.191460 [info ] [MainThread]: 
[0m11:55:25.191743 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:55:25.191925 [info ] [MainThread]: 
[0m11:55:25.192107 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:55:25.193254 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 7.4650683, "process_user_time": 1.587811, "process_kernel_time": 0.190736, "process_mem_max_rss": "139018240", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:55:25.193593 [debug] [MainThread]: Command `dbt snapshot` succeeded at 11:55:25.193534 after 7.47 seconds
[0m11:55:25.193805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aa1770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10715d520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c06bd0>]}
[0m11:55:25.193998 [debug] [MainThread]: Flushing usage events
[0m12:00:05.905377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1025a2120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ef3ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ef3d90>]}


============================== 12:00:05.907545 | 4e5cce77-cf57-4837-af1d-54344cb5c5f5 ==============================
[0m12:00:05.907545 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:00:05.907847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'version_check': 'True', 'profiles_dir': '/Users/adi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:00:05.953029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e5cce77-cf57-4837-af1d-54344cb5c5f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d928b0>]}
[0m12:00:05.962915 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.089740165, "process_user_time": 0.592971, "process_kernel_time": 0.087206, "process_mem_max_rss": "98942976", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:00:05.963181 [debug] [MainThread]: Command `dbt clean` succeeded at 12:00:05.963131 after 0.09 seconds
[0m12:00:05.963336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104036470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104036580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ca2150>]}
[0m12:00:05.963474 [debug] [MainThread]: Flushing usage events
[0m12:00:10.813665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1027ba120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10410bed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10410bd90>]}


============================== 12:00:10.815752 | 33cc666e-9cd1-4b87-b4de-a07b4ae7c7a7 ==============================
[0m12:00:10.815752 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:00:10.816046 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'debug': 'False', 'profiles_dir': '/Users/adi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:00:10.976558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33cc666e-9cd1-4b87-b4de-a07b4ae7c7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d75a70>]}
[0m12:00:10.999276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33cc666e-9cd1-4b87-b4de-a07b4ae7c7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c60490>]}
[0m12:00:10.999663 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:00:11.009048 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:00:11.009631 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:00:11.009821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '33cc666e-9cd1-4b87-b4de-a07b4ae7c7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bc0050>]}
[0m12:00:11.565876 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:00:11.566175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '33cc666e-9cd1-4b87-b4de-a07b4ae7c7a7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e8e6c0>]}
[0m12:00:11.705966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33cc666e-9cd1-4b87-b4de-a07b4ae7c7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eee190>]}
[0m12:00:11.763342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33cc666e-9cd1-4b87-b4de-a07b4ae7c7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eb4050>]}
[0m12:00:11.763612 [info ] [MainThread]: Found 5 models, 2 snapshots, 18 data tests, 2 sources, 459 macros
[0m12:00:11.763766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33cc666e-9cd1-4b87-b4de-a07b4ae7c7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10501b7d0>]}
[0m12:00:11.764773 [info ] [MainThread]: 
[0m12:00:11.765039 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:00:11.767135 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m12:00:11.773092 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m12:00:11.773244 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m12:00:11.773362 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:00:12.584387 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.811 seconds
[0m12:00:12.587628 [debug] [ThreadPool]: On list_dev: Close
[0m12:00:12.731952 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m12:00:12.742636 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m12:00:12.742980 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m12:00:12.743243 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:00:13.400430 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.657 seconds
[0m12:00:13.403587 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m12:00:13.534460 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m12:00:13.538112 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m12:00:13.538449 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m12:00:13.538719 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:00:14.067908 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.529 seconds
[0m12:00:14.072199 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m12:00:14.207007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33cc666e-9cd1-4b87-b4de-a07b4ae7c7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105640520>]}
[0m12:00:14.207836 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:00:14.208269 [info ] [MainThread]: 
[0m12:00:14.211287 [debug] [Thread-1 (]: Began running node model.stock_prediction.stock_prices
[0m12:00:14.211895 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stock_prices ............................. [RUN]
[0m12:00:14.212358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now model.stock_prediction.stock_prices)
[0m12:00:14.212703 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.stock_prices
[0m12:00:14.221870 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.stock_prices"
[0m12:00:14.223303 [debug] [Thread-1 (]: Began executing node model.stock_prediction.stock_prices
[0m12:00:14.244611 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.stock_prices"
[0m12:00:14.245724 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.stock_prices"
[0m12:00:14.246000 [debug] [Thread-1 (]: On model.stock_prediction.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.stock_prices"} */
create or replace   view dev.analytics.stock_prices
  
   as (
    SELECT
    symbol,
    date,
    open,
    high,
    low,
    close,
    volume
FROM dev.raw_data.stock_prices
  );
[0m12:00:14.246198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:14.972855 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.726 seconds
[0m12:00:14.997663 [debug] [Thread-1 (]: On model.stock_prediction.stock_prices: Close
[0m12:00:15.151095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33cc666e-9cd1-4b87-b4de-a07b4ae7c7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036cd3b0>]}
[0m12:00:15.152231 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stock_prices ........................ [[32mSUCCESS 1[0m in 0.94s]
[0m12:00:15.152988 [debug] [Thread-1 (]: Finished running node model.stock_prediction.stock_prices
[0m12:00:15.154062 [debug] [Thread-1 (]: Began running node model.stock_prediction.bollinger
[0m12:00:15.154548 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.bollinger ............................... [RUN]
[0m12:00:15.154996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.stock_prices, now model.stock_prediction.bollinger)
[0m12:00:15.155328 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.bollinger
[0m12:00:15.158472 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.bollinger"
[0m12:00:15.159700 [debug] [Thread-1 (]: Began executing node model.stock_prediction.bollinger
[0m12:00:15.178551 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.bollinger"
[0m12:00:15.179720 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.bollinger"
[0m12:00:15.179999 [debug] [Thread-1 (]: On model.stock_prediction.bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.bollinger"} */
create or replace transient table dev.analytics.bollinger
         as
        (WITH bollinger AS (
    SELECT
        symbol,
        date,
        close,
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) AS sma_20d,
        STDDEV(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) AS stddev_20d
    FROM dev.analytics.stock_prices
)

SELECT
    symbol,
    date,
    close,
    sma_20d,
    sma_20d + (2 * stddev_20d) AS upper_band,
    sma_20d - (2 * stddev_20d) AS lower_band
FROM bollinger
ORDER BY symbol, date
        );
[0m12:00:15.180248 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:16.510497 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.329 seconds
[0m12:00:16.515479 [debug] [Thread-1 (]: On model.stock_prediction.bollinger: Close
[0m12:00:16.644803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33cc666e-9cd1-4b87-b4de-a07b4ae7c7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f76b50>]}
[0m12:00:16.645682 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.bollinger .......................... [[32mSUCCESS 1[0m in 1.49s]
[0m12:00:16.646368 [debug] [Thread-1 (]: Finished running node model.stock_prediction.bollinger
[0m12:00:16.646830 [debug] [Thread-1 (]: Began running node model.stock_prediction.moving_average
[0m12:00:16.647369 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.moving_average .......................... [RUN]
[0m12:00:16.647904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.bollinger, now model.stock_prediction.moving_average)
[0m12:00:16.648243 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.moving_average
[0m12:00:16.651425 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.moving_average"
[0m12:00:16.652429 [debug] [Thread-1 (]: Began executing node model.stock_prediction.moving_average
[0m12:00:16.655260 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.moving_average"
[0m12:00:16.656419 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.moving_average"
[0m12:00:16.656739 [debug] [Thread-1 (]: On model.stock_prediction.moving_average: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.moving_average"} */
create or replace transient table dev.analytics.moving_average
         as
        (WITH stock_data AS (
    SELECT
        symbol,
        date,
        close
    FROM dev.analytics.stock_prices -- assuming 'stock_prices' is the name of the raw table model in dbt
)

SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
    ) AS moving_avg_5d,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
    ) AS moving_avg_20d
FROM stock_data
ORDER BY symbol, date
        );
[0m12:00:16.657030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:17.945286 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.288 seconds
[0m12:00:17.949193 [debug] [Thread-1 (]: On model.stock_prediction.moving_average: Close
[0m12:00:18.173032 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33cc666e-9cd1-4b87-b4de-a07b4ae7c7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1026b7a80>]}
[0m12:00:18.174165 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.moving_average ..................... [[32mSUCCESS 1[0m in 1.53s]
[0m12:00:18.174948 [debug] [Thread-1 (]: Finished running node model.stock_prediction.moving_average
[0m12:00:18.175482 [debug] [Thread-1 (]: Began running node model.stock_prediction.price_momentum
[0m12:00:18.176169 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.price_momentum .......................... [RUN]
[0m12:00:18.176818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.moving_average, now model.stock_prediction.price_momentum)
[0m12:00:18.177197 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.price_momentum
[0m12:00:18.180631 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.price_momentum"
[0m12:00:18.181775 [debug] [Thread-1 (]: Began executing node model.stock_prediction.price_momentum
[0m12:00:18.184063 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.price_momentum"
[0m12:00:18.185215 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.price_momentum"
[0m12:00:18.185549 [debug] [Thread-1 (]: On model.stock_prediction.price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.price_momentum"} */
create or replace transient table dev.analytics.price_momentum
         as
        (WITH momentum_calculation AS (
    SELECT
        symbol,
        date,
        close,
        LAG(close, 10) OVER (
            PARTITION BY symbol
            ORDER BY date
        ) AS close_10_days_ago
    FROM dev.analytics.stock_prices
)

SELECT
    symbol,
    date,
    close,
    close - close_10_days_ago AS momentum_10d
FROM momentum_calculation
ORDER BY symbol, date
        );
[0m12:00:18.185866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:19.445299 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.259 seconds
[0m12:00:19.449995 [debug] [Thread-1 (]: On model.stock_prediction.price_momentum: Close
[0m12:00:19.614926 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33cc666e-9cd1-4b87-b4de-a07b4ae7c7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060b1730>]}
[0m12:00:19.615896 [info ] [Thread-1 (]: 4 of 5 OK created sql table model analytics.price_momentum ..................... [[32mSUCCESS 1[0m in 1.44s]
[0m12:00:19.616571 [debug] [Thread-1 (]: Finished running node model.stock_prediction.price_momentum
[0m12:00:19.617045 [debug] [Thread-1 (]: Began running node model.stock_prediction.rsi_calculation
[0m12:00:19.617610 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.rsi_calculation ......................... [RUN]
[0m12:00:19.618143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.price_momentum, now model.stock_prediction.rsi_calculation)
[0m12:00:19.618523 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.rsi_calculation
[0m12:00:19.622084 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.rsi_calculation"
[0m12:00:19.623100 [debug] [Thread-1 (]: Began executing node model.stock_prediction.rsi_calculation
[0m12:00:19.625285 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.rsi_calculation"
[0m12:00:19.627092 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.rsi_calculation"
[0m12:00:19.627467 [debug] [Thread-1 (]: On model.stock_prediction.rsi_calculation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.rsi_calculation"} */
create or replace transient table dev.analytics.rsi_calculation
         as
        (WITH stock_data AS (
    SELECT
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM dev.analytics.stock_prices
),

price_changes AS (
    SELECT
        symbol,
        date,
        close,
        CASE 
            WHEN close > prev_close THEN close - prev_close
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close < prev_close THEN prev_close - close
            ELSE 0 
        END AS loss
    FROM stock_data
),

average_gains_losses AS (
    SELECT
        symbol,
        date,
        close,
        -- Calculate the average gain over the last 14 days, including the current row
        AVG(gain) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain,
        -- Calculate the average loss over the last 14 days, including the current row
        AVG(loss) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss
    FROM price_changes
)

SELECT
    symbol,
    date,
    close,
    avg_gain,
    avg_loss,
    -- Calculate RSI, using COALESCE to set to 0 if result is NULL
    COALESCE(100 - (100 / (1 + (NULLIF(avg_gain, 0) / NULLIF(avg_loss, 0)))), 0) AS rsi_14d
FROM average_gains_losses
ORDER BY symbol, date
        );
[0m12:00:19.627788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:20.913846 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.285 seconds
[0m12:00:20.918008 [debug] [Thread-1 (]: On model.stock_prediction.rsi_calculation: Close
[0m12:00:21.032410 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33cc666e-9cd1-4b87-b4de-a07b4ae7c7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064409b0>]}
[0m12:00:21.033482 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.rsi_calculation .................... [[32mSUCCESS 1[0m in 1.41s]
[0m12:00:21.034273 [debug] [Thread-1 (]: Finished running node model.stock_prediction.rsi_calculation
[0m12:00:21.035874 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:00:21.036238 [debug] [MainThread]: Connection 'model.stock_prediction.rsi_calculation' was properly closed.
[0m12:00:21.036636 [info ] [MainThread]: 
[0m12:00:21.036960 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 9.27 seconds (9.27s).
[0m12:00:21.038191 [debug] [MainThread]: Command end result
[0m12:00:21.064919 [info ] [MainThread]: 
[0m12:00:21.065177 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:00:21.065367 [info ] [MainThread]: 
[0m12:00:21.065547 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:00:21.066650 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.284243, "process_user_time": 2.105694, "process_kernel_time": 0.200432, "process_mem_max_rss": "141770752", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:00:21.066972 [debug] [MainThread]: Command `dbt run` succeeded at 12:00:21.066912 after 10.28 seconds
[0m12:00:21.067176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10180edb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106441190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106443fb0>]}
[0m12:00:21.067373 [debug] [MainThread]: Flushing usage events
[0m12:01:58.440167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10339a120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cebed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cebd90>]}


============================== 12:01:58.442815 | 69351fb7-ddbe-49a9-9aa8-770fde1f0929 ==============================
[0m12:01:58.442815 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:01:58.443121 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:01:58.488508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69351fb7-ddbe-49a9-9aa8-770fde1f0929', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b8a8b0>]}
[0m12:01:58.498554 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.0917835, "process_user_time": 0.598912, "process_kernel_time": 0.111104, "process_mem_max_rss": "97615872", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:01:58.498821 [debug] [MainThread]: Command `dbt clean` succeeded at 12:01:58.498768 after 0.09 seconds
[0m12:01:58.498972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e2e470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e2e580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a9a150>]}
[0m12:01:58.499113 [debug] [MainThread]: Flushing usage events
[0m12:02:01.809021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104612120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f63ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f63d90>]}


============================== 12:02:01.811088 | cca79bce-b4a1-4ed6-bf18-db425c3a6d96 ==============================
[0m12:02:01.811088 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:02:01.811373 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:02:02.022811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cca79bce-b4a1-4ed6-bf18-db425c3a6d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bcda70>]}
[0m12:02:02.045486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cca79bce-b4a1-4ed6-bf18-db425c3a6d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ab8490>]}
[0m12:02:02.046912 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:02:02.055900 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:02:02.056440 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:02:02.056656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cca79bce-b4a1-4ed6-bf18-db425c3a6d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a18050>]}
[0m12:02:02.622601 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:02:02.622895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cca79bce-b4a1-4ed6-bf18-db425c3a6d96', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ce66c0>]}
[0m12:02:02.762146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cca79bce-b4a1-4ed6-bf18-db425c3a6d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d46190>]}
[0m12:02:02.816359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cca79bce-b4a1-4ed6-bf18-db425c3a6d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d0c050>]}
[0m12:02:02.816655 [info ] [MainThread]: Found 5 models, 2 snapshots, 18 data tests, 2 sources, 459 macros
[0m12:02:02.816807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cca79bce-b4a1-4ed6-bf18-db425c3a6d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e7f7d0>]}
[0m12:02:02.817822 [info ] [MainThread]: 
[0m12:02:02.818080 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:02:02.820197 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m12:02:02.826122 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m12:02:02.826268 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m12:02:02.826381 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:02:03.501213 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.674 seconds
[0m12:02:03.504520 [debug] [ThreadPool]: On list_dev: Close
[0m12:02:03.640367 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m12:02:03.651353 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m12:02:03.651712 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m12:02:03.651973 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:02:04.161535 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.509 seconds
[0m12:02:04.163941 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m12:02:04.311806 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m12:02:04.316191 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m12:02:04.316547 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m12:02:04.316796 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:02:04.834504 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.517 seconds
[0m12:02:04.838303 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m12:02:04.962227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cca79bce-b4a1-4ed6-bf18-db425c3a6d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107304520>]}
[0m12:02:04.962989 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:02:04.963402 [info ] [MainThread]: 
[0m12:02:04.967546 [debug] [Thread-1 (]: Began running node model.stock_prediction.stock_prices
[0m12:02:04.968169 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stock_prices ............................. [RUN]
[0m12:02:04.968623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now model.stock_prediction.stock_prices)
[0m12:02:04.968969 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.stock_prices
[0m12:02:04.977977 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.stock_prices"
[0m12:02:04.979184 [debug] [Thread-1 (]: Began executing node model.stock_prediction.stock_prices
[0m12:02:05.000112 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.stock_prices"
[0m12:02:05.001188 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.stock_prices"
[0m12:02:05.001468 [debug] [Thread-1 (]: On model.stock_prediction.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.stock_prices"} */
create or replace   view dev.analytics.stock_prices
  
   as (
    SELECT
    symbol,
    date,
    open,
    high,
    low,
    close,
    volume
FROM dev.raw_data.stock_prices
  );
[0m12:02:05.001667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:05.673238 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.671 seconds
[0m12:02:05.701293 [debug] [Thread-1 (]: On model.stock_prediction.stock_prices: Close
[0m12:02:05.837051 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cca79bce-b4a1-4ed6-bf18-db425c3a6d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055253b0>]}
[0m12:02:05.838078 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stock_prices ........................ [[32mSUCCESS 1[0m in 0.87s]
[0m12:02:05.838779 [debug] [Thread-1 (]: Finished running node model.stock_prediction.stock_prices
[0m12:02:05.839858 [debug] [Thread-1 (]: Began running node model.stock_prediction.bollinger
[0m12:02:05.840343 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.bollinger ............................... [RUN]
[0m12:02:05.840791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.stock_prices, now model.stock_prediction.bollinger)
[0m12:02:05.841129 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.bollinger
[0m12:02:05.844207 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.bollinger"
[0m12:02:05.845398 [debug] [Thread-1 (]: Began executing node model.stock_prediction.bollinger
[0m12:02:05.863181 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.bollinger"
[0m12:02:05.864338 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.bollinger"
[0m12:02:05.864600 [debug] [Thread-1 (]: On model.stock_prediction.bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.bollinger"} */
create or replace transient table dev.analytics.bollinger
         as
        (WITH bollinger AS (
    SELECT
        symbol,
        date,
        close,
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) AS sma_20d,
        STDDEV(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) AS stddev_20d
    FROM dev.analytics.stock_prices
)

SELECT
    symbol,
    date,
    close,
    COALESCE(sma_20d, 0) AS sma_20d,
    COALESCE(sma_20d + (2 * stddev_20d), 0) AS upper_band,
    COALESCE(sma_20d - (2 * stddev_20d), 0) AS lower_band
FROM bollinger
ORDER BY symbol, date
        );
[0m12:02:05.864824 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:07.204828 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.340 seconds
[0m12:02:07.208899 [debug] [Thread-1 (]: On model.stock_prediction.bollinger: Close
[0m12:02:07.337892 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cca79bce-b4a1-4ed6-bf18-db425c3a6d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071d87d0>]}
[0m12:02:07.338415 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.bollinger .......................... [[32mSUCCESS 1[0m in 1.50s]
[0m12:02:07.338768 [debug] [Thread-1 (]: Finished running node model.stock_prediction.bollinger
[0m12:02:07.339003 [debug] [Thread-1 (]: Began running node model.stock_prediction.moving_average
[0m12:02:07.339210 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.moving_average .......................... [RUN]
[0m12:02:07.339433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.bollinger, now model.stock_prediction.moving_average)
[0m12:02:07.339590 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.moving_average
[0m12:02:07.340964 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.moving_average"
[0m12:02:07.341454 [debug] [Thread-1 (]: Began executing node model.stock_prediction.moving_average
[0m12:02:07.343822 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.moving_average"
[0m12:02:07.345112 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.moving_average"
[0m12:02:07.345656 [debug] [Thread-1 (]: On model.stock_prediction.moving_average: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.moving_average"} */
create or replace transient table dev.analytics.moving_average
         as
        (WITH stock_data AS (
    SELECT
        symbol,
        date,
        close
    FROM dev.analytics.stock_prices -- assuming 'stock_prices' is the name of the raw table model in dbt
)

SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
    ) AS moving_avg_5d,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
    ) AS moving_avg_20d
FROM stock_data
ORDER BY symbol, date
        );
[0m12:02:07.346054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:08.513797 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.167 seconds
[0m12:02:08.517132 [debug] [Thread-1 (]: On model.stock_prediction.moving_average: Close
[0m12:02:08.658739 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cca79bce-b4a1-4ed6-bf18-db425c3a6d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10450fa80>]}
[0m12:02:08.659772 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.moving_average ..................... [[32mSUCCESS 1[0m in 1.32s]
[0m12:02:08.660510 [debug] [Thread-1 (]: Finished running node model.stock_prediction.moving_average
[0m12:02:08.661052 [debug] [Thread-1 (]: Began running node model.stock_prediction.price_momentum
[0m12:02:08.661556 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.price_momentum .......................... [RUN]
[0m12:02:08.661910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.moving_average, now model.stock_prediction.price_momentum)
[0m12:02:08.662153 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.price_momentum
[0m12:02:08.665116 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.price_momentum"
[0m12:02:08.666137 [debug] [Thread-1 (]: Began executing node model.stock_prediction.price_momentum
[0m12:02:08.668619 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.price_momentum"
[0m12:02:08.669849 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.price_momentum"
[0m12:02:08.670230 [debug] [Thread-1 (]: On model.stock_prediction.price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.price_momentum"} */
create or replace transient table dev.analytics.price_momentum
         as
        (WITH momentum_calculation AS (
    SELECT
        symbol,
        date,
        close,
        LAG(close, 10) OVER (
            PARTITION BY symbol
            ORDER BY date
        ) AS close_10_days_ago
    FROM dev.analytics.stock_prices
)

SELECT
    symbol,
    date,
    close,
    COALESCE(close - close_10_days_ago, 0) AS momentum_10d
FROM momentum_calculation
ORDER BY symbol, date
        );
[0m12:02:08.670577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:09.971175 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.300 seconds
[0m12:02:09.976500 [debug] [Thread-1 (]: On model.stock_prediction.price_momentum: Close
[0m12:02:10.103367 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cca79bce-b4a1-4ed6-bf18-db425c3a6d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10746a930>]}
[0m12:02:10.104751 [info ] [Thread-1 (]: 4 of 5 OK created sql table model analytics.price_momentum ..................... [[32mSUCCESS 1[0m in 1.44s]
[0m12:02:10.105557 [debug] [Thread-1 (]: Finished running node model.stock_prediction.price_momentum
[0m12:02:10.106063 [debug] [Thread-1 (]: Began running node model.stock_prediction.rsi_calculation
[0m12:02:10.106663 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.rsi_calculation ......................... [RUN]
[0m12:02:10.107212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.price_momentum, now model.stock_prediction.rsi_calculation)
[0m12:02:10.107597 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.rsi_calculation
[0m12:02:10.111232 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.rsi_calculation"
[0m12:02:10.112273 [debug] [Thread-1 (]: Began executing node model.stock_prediction.rsi_calculation
[0m12:02:10.114573 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.rsi_calculation"
[0m12:02:10.116461 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.rsi_calculation"
[0m12:02:10.116858 [debug] [Thread-1 (]: On model.stock_prediction.rsi_calculation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.rsi_calculation"} */
create or replace transient table dev.analytics.rsi_calculation
         as
        (WITH stock_data AS (
    SELECT
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM dev.analytics.stock_prices
),

price_changes AS (
    SELECT
        symbol,
        date,
        close,
        CASE 
            WHEN close > prev_close THEN close - prev_close
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close < prev_close THEN prev_close - close
            ELSE 0 
        END AS loss
    FROM stock_data
),

average_gains_losses AS (
    SELECT
        symbol,
        date,
        close,
        -- Calculate the average gain over the last 14 days, including the current row
        AVG(gain) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain,
        -- Calculate the average loss over the last 14 days, including the current row
        AVG(loss) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss
    FROM price_changes
)

SELECT
    symbol,
    date,
    close,
    avg_gain,
    avg_loss,
    -- Calculate RSI, using COALESCE to set to 0 if result is NULL
    COALESCE(100 - (100 / (1 + (NULLIF(avg_gain, 0) / NULLIF(avg_loss, 0)))), 0) AS rsi_14d
FROM average_gains_losses
ORDER BY symbol, date
        );
[0m12:02:10.117225 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:11.257921 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.140 seconds
[0m12:02:11.262174 [debug] [Thread-1 (]: On model.stock_prediction.rsi_calculation: Close
[0m12:02:11.406600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cca79bce-b4a1-4ed6-bf18-db425c3a6d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107514590>]}
[0m12:02:11.408167 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.rsi_calculation .................... [[32mSUCCESS 1[0m in 1.30s]
[0m12:02:11.408709 [debug] [Thread-1 (]: Finished running node model.stock_prediction.rsi_calculation
[0m12:02:11.409994 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:02:11.410270 [debug] [MainThread]: Connection 'model.stock_prediction.rsi_calculation' was properly closed.
[0m12:02:11.410593 [info ] [MainThread]: 
[0m12:02:11.410839 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 8.59 seconds (8.59s).
[0m12:02:11.411771 [debug] [MainThread]: Command end result
[0m12:02:11.433716 [info ] [MainThread]: 
[0m12:02:11.433957 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:02:11.434121 [info ] [MainThread]: 
[0m12:02:11.434284 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:02:11.435598 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.657844, "process_user_time": 2.080618, "process_kernel_time": 0.208903, "process_mem_max_rss": "143032320", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:02:11.435898 [debug] [MainThread]: Command `dbt run` succeeded at 12:02:11.435842 after 9.66 seconds
[0m12:02:11.436091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c6be30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107514ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107517d70>]}
[0m12:02:11.436271 [debug] [MainThread]: Flushing usage events
[0m12:05:08.591582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10521a120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b6bed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b6bd90>]}


============================== 12:05:08.593622 | 0a6c3a9e-5420-4e39-ac79-bcbb06a6879a ==============================
[0m12:05:08.593622 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:05:08.593918 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:05:08.786633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a6c3a9e-5420-4e39-ac79-bcbb06a6879a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077d5a70>]}
[0m12:05:08.809146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a6c3a9e-5420-4e39-ac79-bcbb06a6879a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077a0490>]}
[0m12:05:08.810527 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:05:08.818603 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:05:08.894831 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:05:08.895247 [debug] [MainThread]: Partial parsing: updated file: stock_prediction://models/schema.yml
[0m12:05:08.920236 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:05:08.920507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0a6c3a9e-5420-4e39-ac79-bcbb06a6879a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107703d50>]}
[0m12:05:08.926742 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'bollinger_bands' in the 'models' section of file 'models/schema.yml'
[0m12:05:08.974322 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stock_prediction.not_null_bollinger_bands_symbol.e0c85147bb' (models/schema.yml) depends on a node named 'bollinger_bands' in package '' which was not found
[0m12:05:08.974599 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stock_prediction.not_null_bollinger_bands_date.630192e3f4' (models/schema.yml) depends on a node named 'bollinger_bands' in package '' which was not found
[0m12:05:08.974748 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stock_prediction.not_null_bollinger_bands_close.99aad898a0' (models/schema.yml) depends on a node named 'bollinger_bands' in package '' which was not found
[0m12:05:08.974878 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stock_prediction.not_null_bollinger_bands_sma_20d.c21a1af534' (models/schema.yml) depends on a node named 'bollinger_bands' in package '' which was not found
[0m12:05:08.975004 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stock_prediction.not_null_bollinger_bands_upper_band.a8a6e83fc1' (models/schema.yml) depends on a node named 'bollinger_bands' in package '' which was not found
[0m12:05:08.975126 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stock_prediction.not_null_bollinger_bands_lower_band.afb2b8a98f' (models/schema.yml) depends on a node named 'bollinger_bands' in package '' which was not found
[0m12:05:09.016386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a6c3a9e-5420-4e39-ac79-bcbb06a6879a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10783b7a0>]}
[0m12:05:09.110694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a6c3a9e-5420-4e39-ac79-bcbb06a6879a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10775f930>]}
[0m12:05:09.110952 [info ] [MainThread]: Found 5 models, 2 snapshots, 22 data tests, 2 sources, 459 macros
[0m12:05:09.111100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a6c3a9e-5420-4e39-ac79-bcbb06a6879a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d05980>]}
[0m12:05:09.112330 [info ] [MainThread]: 
[0m12:05:09.112585 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:05:09.114684 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_analytics'
[0m12:05:09.121854 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m12:05:09.122010 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m12:05:09.122136 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:10.000954 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.878 seconds
[0m12:05:10.005406 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m12:05:10.141590 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m12:05:10.145674 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m12:05:10.146033 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m12:05:10.146320 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:05:10.665885 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.519 seconds
[0m12:05:10.669427 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m12:05:10.893412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a6c3a9e-5420-4e39-ac79-bcbb06a6879a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e1e810>]}
[0m12:05:10.894413 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:05:10.894786 [info ] [MainThread]: 
[0m12:05:10.899111 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m12:05:10.899624 [info ] [Thread-1 (]: 1 of 22 START test not_null_moving_average_close ............................... [RUN]
[0m12:05:10.900100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now test.stock_prediction.not_null_moving_average_close.6d037dd588)
[0m12:05:10.900454 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m12:05:10.915795 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_close.6d037dd588"
[0m12:05:10.916739 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m12:05:10.930662 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_close.6d037dd588"
[0m12:05:10.931449 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_close.6d037dd588"
[0m12:05:10.931689 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_close.6d037dd588: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_close.6d037dd588"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.moving_average
where close is null



      
    ) dbt_internal_test
[0m12:05:10.931895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:11.791496 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.859 seconds
[0m12:05:11.798283 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_close.6d037dd588: Close
[0m12:05:12.118067 [info ] [Thread-1 (]: 1 of 22 PASS not_null_moving_average_close ..................................... [[32mPASS[0m in 1.22s]
[0m12:05:12.118685 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m12:05:12.118907 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m12:05:12.119225 [info ] [Thread-1 (]: 2 of 22 START test not_null_moving_average_date ................................ [RUN]
[0m12:05:12.119539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_close.6d037dd588, now test.stock_prediction.not_null_moving_average_date.3ad00158b5)
[0m12:05:12.119705 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m12:05:12.122049 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_date.3ad00158b5"
[0m12:05:12.122517 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m12:05:12.124003 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_date.3ad00158b5"
[0m12:05:12.124709 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_date.3ad00158b5"
[0m12:05:12.124890 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_date.3ad00158b5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_date.3ad00158b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.moving_average
where date is null



      
    ) dbt_internal_test
[0m12:05:12.125035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:12.797221 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.671 seconds
[0m12:05:12.800672 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_date.3ad00158b5: Close
[0m12:05:12.937736 [info ] [Thread-1 (]: 2 of 22 PASS not_null_moving_average_date ...................................... [[32mPASS[0m in 0.82s]
[0m12:05:12.938633 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m12:05:12.939190 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m12:05:12.939804 [info ] [Thread-1 (]: 3 of 22 START test not_null_moving_average_moving_avg_20d ...................... [RUN]
[0m12:05:12.940465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_date.3ad00158b5, now test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22)
[0m12:05:12.940944 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m12:05:12.946101 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m12:05:12.947257 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m12:05:12.950115 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m12:05:12.951067 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m12:05:12.951402 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg_20d
from dev.analytics.moving_average
where moving_avg_20d is null



      
    ) dbt_internal_test
[0m12:05:12.951718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:13.371904 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.420 seconds
[0m12:05:13.374865 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22: Close
[0m12:05:13.509505 [info ] [Thread-1 (]: 3 of 22 PASS not_null_moving_average_moving_avg_20d ............................ [[32mPASS[0m in 0.57s]
[0m12:05:13.510853 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m12:05:13.511462 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m12:05:13.512080 [info ] [Thread-1 (]: 4 of 22 START test not_null_moving_average_moving_avg_5d ....................... [RUN]
[0m12:05:13.512812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22, now test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca)
[0m12:05:13.513301 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m12:05:13.518529 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m12:05:13.519636 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m12:05:13.522335 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m12:05:13.523296 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m12:05:13.523617 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg_5d
from dev.analytics.moving_average
where moving_avg_5d is null



      
    ) dbt_internal_test
[0m12:05:13.523929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:13.965804 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.441 seconds
[0m12:05:13.970112 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca: Close
[0m12:05:14.104711 [info ] [Thread-1 (]: 4 of 22 PASS not_null_moving_average_moving_avg_5d ............................. [[32mPASS[0m in 0.59s]
[0m12:05:14.105721 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m12:05:14.106316 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m12:05:14.106891 [info ] [Thread-1 (]: 5 of 22 START test not_null_moving_average_symbol .............................. [RUN]
[0m12:05:14.107538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca, now test.stock_prediction.not_null_moving_average_symbol.75a6f7473c)
[0m12:05:14.107999 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m12:05:14.113058 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"
[0m12:05:14.114182 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m12:05:14.116427 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"
[0m12:05:14.117286 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"
[0m12:05:14.117597 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_symbol.75a6f7473c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.moving_average
where symbol is null



      
    ) dbt_internal_test
[0m12:05:14.117897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:14.565542 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.447 seconds
[0m12:05:14.568734 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_symbol.75a6f7473c: Close
[0m12:05:14.732910 [info ] [Thread-1 (]: 5 of 22 PASS not_null_moving_average_symbol .................................... [[32mPASS[0m in 0.63s]
[0m12:05:14.733743 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m12:05:14.734284 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_price_momentum_close.1bd03322c7
[0m12:05:14.734850 [info ] [Thread-1 (]: 6 of 22 START test not_null_price_momentum_close ............................... [RUN]
[0m12:05:14.735405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_symbol.75a6f7473c, now test.stock_prediction.not_null_price_momentum_close.1bd03322c7)
[0m12:05:14.735793 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_price_momentum_close.1bd03322c7
[0m12:05:14.740740 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_price_momentum_close.1bd03322c7"
[0m12:05:14.741799 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_price_momentum_close.1bd03322c7
[0m12:05:14.743748 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_price_momentum_close.1bd03322c7"
[0m12:05:14.744674 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_price_momentum_close.1bd03322c7"
[0m12:05:14.745009 [debug] [Thread-1 (]: On test.stock_prediction.not_null_price_momentum_close.1bd03322c7: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_price_momentum_close.1bd03322c7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.price_momentum
where close is null



      
    ) dbt_internal_test
[0m12:05:14.745310 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:15.237831 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.492 seconds
[0m12:05:15.242970 [debug] [Thread-1 (]: On test.stock_prediction.not_null_price_momentum_close.1bd03322c7: Close
[0m12:05:15.372401 [info ] [Thread-1 (]: 6 of 22 PASS not_null_price_momentum_close ..................................... [[32mPASS[0m in 0.64s]
[0m12:05:15.373757 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_price_momentum_close.1bd03322c7
[0m12:05:15.374394 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_price_momentum_date.d7330e89cb
[0m12:05:15.374959 [info ] [Thread-1 (]: 7 of 22 START test not_null_price_momentum_date ................................ [RUN]
[0m12:05:15.375501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_price_momentum_close.1bd03322c7, now test.stock_prediction.not_null_price_momentum_date.d7330e89cb)
[0m12:05:15.375868 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_price_momentum_date.d7330e89cb
[0m12:05:15.380792 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_price_momentum_date.d7330e89cb"
[0m12:05:15.381778 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_price_momentum_date.d7330e89cb
[0m12:05:15.383695 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_price_momentum_date.d7330e89cb"
[0m12:05:15.384563 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_price_momentum_date.d7330e89cb"
[0m12:05:15.384891 [debug] [Thread-1 (]: On test.stock_prediction.not_null_price_momentum_date.d7330e89cb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_price_momentum_date.d7330e89cb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.price_momentum
where date is null



      
    ) dbt_internal_test
[0m12:05:15.385187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:15.888490 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.503 seconds
[0m12:05:15.892230 [debug] [Thread-1 (]: On test.stock_prediction.not_null_price_momentum_date.d7330e89cb: Close
[0m12:05:16.019477 [info ] [Thread-1 (]: 7 of 22 PASS not_null_price_momentum_date ...................................... [[32mPASS[0m in 0.64s]
[0m12:05:16.020452 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_price_momentum_date.d7330e89cb
[0m12:05:16.020996 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_price_momentum_momentum_10d.3ed05a427e
[0m12:05:16.021559 [info ] [Thread-1 (]: 8 of 22 START test not_null_price_momentum_momentum_10d ........................ [RUN]
[0m12:05:16.021987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_price_momentum_date.d7330e89cb, now test.stock_prediction.not_null_price_momentum_momentum_10d.3ed05a427e)
[0m12:05:16.022217 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_price_momentum_momentum_10d.3ed05a427e
[0m12:05:16.024859 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_price_momentum_momentum_10d.3ed05a427e"
[0m12:05:16.025744 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_price_momentum_momentum_10d.3ed05a427e
[0m12:05:16.027913 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_price_momentum_momentum_10d.3ed05a427e"
[0m12:05:16.028944 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_price_momentum_momentum_10d.3ed05a427e"
[0m12:05:16.029296 [debug] [Thread-1 (]: On test.stock_prediction.not_null_price_momentum_momentum_10d.3ed05a427e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_price_momentum_momentum_10d.3ed05a427e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select momentum_10d
from dev.analytics.price_momentum
where momentum_10d is null



      
    ) dbt_internal_test
[0m12:05:16.029589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:16.522405 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.492 seconds
[0m12:05:16.528031 [debug] [Thread-1 (]: On test.stock_prediction.not_null_price_momentum_momentum_10d.3ed05a427e: Close
[0m12:05:16.717443 [info ] [Thread-1 (]: 8 of 22 PASS not_null_price_momentum_momentum_10d .............................. [[32mPASS[0m in 0.70s]
[0m12:05:16.718308 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_price_momentum_momentum_10d.3ed05a427e
[0m12:05:16.718853 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_price_momentum_symbol.2b4dd3b3ec
[0m12:05:16.719408 [info ] [Thread-1 (]: 9 of 22 START test not_null_price_momentum_symbol .............................. [RUN]
[0m12:05:16.720042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_price_momentum_momentum_10d.3ed05a427e, now test.stock_prediction.not_null_price_momentum_symbol.2b4dd3b3ec)
[0m12:05:16.720509 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_price_momentum_symbol.2b4dd3b3ec
[0m12:05:16.725710 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_price_momentum_symbol.2b4dd3b3ec"
[0m12:05:16.726799 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_price_momentum_symbol.2b4dd3b3ec
[0m12:05:16.728971 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_price_momentum_symbol.2b4dd3b3ec"
[0m12:05:16.729905 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_price_momentum_symbol.2b4dd3b3ec"
[0m12:05:16.730243 [debug] [Thread-1 (]: On test.stock_prediction.not_null_price_momentum_symbol.2b4dd3b3ec: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_price_momentum_symbol.2b4dd3b3ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.price_momentum
where symbol is null



      
    ) dbt_internal_test
[0m12:05:16.730552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:17.382510 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.651 seconds
[0m12:05:17.387473 [debug] [Thread-1 (]: On test.stock_prediction.not_null_price_momentum_symbol.2b4dd3b3ec: Close
[0m12:05:17.541301 [info ] [Thread-1 (]: 9 of 22 PASS not_null_price_momentum_symbol .................................... [[32mPASS[0m in 0.82s]
[0m12:05:17.542030 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_price_momentum_symbol.2b4dd3b3ec
[0m12:05:17.542476 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m12:05:17.542940 [info ] [Thread-1 (]: 10 of 22 START test not_null_rsi_calculation_avg_gain .......................... [RUN]
[0m12:05:17.543468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_price_momentum_symbol.2b4dd3b3ec, now test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42)
[0m12:05:17.543846 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m12:05:17.548428 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m12:05:17.549388 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m12:05:17.551359 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m12:05:17.552287 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m12:05:17.552615 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_gain
from dev.analytics.rsi_calculation
where avg_gain is null



      
    ) dbt_internal_test
[0m12:05:17.552927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:18.148117 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.592 seconds
[0m12:05:18.152952 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42: Close
[0m12:05:18.280529 [info ] [Thread-1 (]: 10 of 22 PASS not_null_rsi_calculation_avg_gain ................................ [[32mPASS[0m in 0.74s]
[0m12:05:18.281156 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m12:05:18.281535 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m12:05:18.281920 [info ] [Thread-1 (]: 11 of 22 START test not_null_rsi_calculation_avg_loss .......................... [RUN]
[0m12:05:18.282369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42, now test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19)
[0m12:05:18.282678 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m12:05:18.286384 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m12:05:18.287253 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m12:05:18.288795 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m12:05:18.289527 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m12:05:18.289785 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_loss
from dev.analytics.rsi_calculation
where avg_loss is null



      
    ) dbt_internal_test
[0m12:05:18.290025 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:18.824707 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.534 seconds
[0m12:05:18.828776 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19: Close
[0m12:05:18.962821 [info ] [Thread-1 (]: 11 of 22 PASS not_null_rsi_calculation_avg_loss ................................ [[32mPASS[0m in 0.68s]
[0m12:05:18.964081 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m12:05:18.964649 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m12:05:18.965129 [info ] [Thread-1 (]: 12 of 22 START test not_null_rsi_calculation_close ............................. [RUN]
[0m12:05:18.965658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19, now test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d)
[0m12:05:18.966031 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m12:05:18.970287 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"
[0m12:05:18.971269 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m12:05:18.973132 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"
[0m12:05:18.973942 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"
[0m12:05:18.974224 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.rsi_calculation
where close is null



      
    ) dbt_internal_test
[0m12:05:18.974484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:19.425631 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.450 seconds
[0m12:05:19.429784 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d: Close
[0m12:05:19.557709 [info ] [Thread-1 (]: 12 of 22 PASS not_null_rsi_calculation_close ................................... [[32mPASS[0m in 0.59s]
[0m12:05:19.558446 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m12:05:19.558916 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m12:05:19.559393 [info ] [Thread-1 (]: 13 of 22 START test not_null_rsi_calculation_date .............................. [RUN]
[0m12:05:19.559866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d, now test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76)
[0m12:05:19.560203 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m12:05:19.564521 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"
[0m12:05:19.565508 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m12:05:19.567445 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"
[0m12:05:19.568221 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"
[0m12:05:19.568504 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.rsi_calculation
where date is null



      
    ) dbt_internal_test
[0m12:05:19.568767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:20.138384 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.569 seconds
[0m12:05:20.144507 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76: Close
[0m12:05:20.289771 [info ] [Thread-1 (]: 13 of 22 PASS not_null_rsi_calculation_date .................................... [[32mPASS[0m in 0.73s]
[0m12:05:20.291058 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m12:05:20.291555 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m12:05:20.291960 [info ] [Thread-1 (]: 14 of 22 START test not_null_rsi_calculation_rsi_14d ........................... [RUN]
[0m12:05:20.292456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76, now test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8)
[0m12:05:20.292742 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m12:05:20.296405 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m12:05:20.297295 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m12:05:20.298852 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m12:05:20.299596 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m12:05:20.299852 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from dev.analytics.rsi_calculation
where rsi_14d is null



      
    ) dbt_internal_test
[0m12:05:20.300085 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:20.715515 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.415 seconds
[0m12:05:20.721142 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8: Close
[0m12:05:20.873007 [info ] [Thread-1 (]: 14 of 22 PASS not_null_rsi_calculation_rsi_14d ................................. [[32mPASS[0m in 0.58s]
[0m12:05:20.874162 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m12:05:20.874745 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m12:05:20.875308 [info ] [Thread-1 (]: 15 of 22 START test not_null_rsi_calculation_symbol ............................ [RUN]
[0m12:05:20.875949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8, now test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84)
[0m12:05:20.876396 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m12:05:20.881400 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m12:05:20.882511 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m12:05:20.884485 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m12:05:20.885396 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m12:05:20.885720 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.rsi_calculation
where symbol is null



      
    ) dbt_internal_test
[0m12:05:20.886021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:21.330589 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.444 seconds
[0m12:05:21.334834 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84: Close
[0m12:05:21.507135 [info ] [Thread-1 (]: 15 of 22 PASS not_null_rsi_calculation_symbol .................................. [[32mPASS[0m in 0.63s]
[0m12:05:21.508036 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m12:05:21.508588 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m12:05:21.508968 [info ] [Thread-1 (]: 16 of 22 START test not_null_stock_prices_close ................................ [RUN]
[0m12:05:21.509727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84, now test.stock_prediction.not_null_stock_prices_close.d7e232e1ba)
[0m12:05:21.510523 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m12:05:21.515885 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"
[0m12:05:21.517077 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m12:05:21.519154 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"
[0m12:05:21.520447 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"
[0m12:05:21.520790 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_close.d7e232e1ba: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.stock_prices
where close is null



      
    ) dbt_internal_test
[0m12:05:21.521092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:22.028395 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.507 seconds
[0m12:05:22.032219 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_close.d7e232e1ba: Close
[0m12:05:22.160612 [info ] [Thread-1 (]: 16 of 22 PASS not_null_stock_prices_close ...................................... [[32mPASS[0m in 0.65s]
[0m12:05:22.161523 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m12:05:22.162071 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m12:05:22.162650 [info ] [Thread-1 (]: 17 of 22 START test not_null_stock_prices_date ................................. [RUN]
[0m12:05:22.163321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_close.d7e232e1ba, now test.stock_prediction.not_null_stock_prices_date.98a7527501)
[0m12:05:22.163801 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m12:05:22.168824 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_date.98a7527501"
[0m12:05:22.169953 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m12:05:22.172176 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_date.98a7527501"
[0m12:05:22.173099 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_date.98a7527501"
[0m12:05:22.173419 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_date.98a7527501: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_date.98a7527501"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.stock_prices
where date is null



      
    ) dbt_internal_test
[0m12:05:22.173714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:22.666406 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.492 seconds
[0m12:05:22.670426 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_date.98a7527501: Close
[0m12:05:22.793589 [info ] [Thread-1 (]: 17 of 22 PASS not_null_stock_prices_date ....................................... [[32mPASS[0m in 0.63s]
[0m12:05:22.794434 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m12:05:22.794967 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m12:05:22.795483 [info ] [Thread-1 (]: 18 of 22 START test not_null_stock_prices_high ................................. [RUN]
[0m12:05:22.796016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_date.98a7527501, now test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc)
[0m12:05:22.796406 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m12:05:22.801325 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"
[0m12:05:22.802335 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m12:05:22.804284 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"
[0m12:05:22.805199 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"
[0m12:05:22.805537 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select high
from dev.analytics.stock_prices
where high is null



      
    ) dbt_internal_test
[0m12:05:22.805838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:23.224251 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.418 seconds
[0m12:05:23.227842 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc: Close
[0m12:05:23.347375 [info ] [Thread-1 (]: 18 of 22 PASS not_null_stock_prices_high ....................................... [[32mPASS[0m in 0.55s]
[0m12:05:23.348560 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m12:05:23.349096 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m12:05:23.349576 [info ] [Thread-1 (]: 19 of 22 START test not_null_stock_prices_low .................................. [RUN]
[0m12:05:23.350110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc, now test.stock_prediction.not_null_stock_prices_low.e65294ca15)
[0m12:05:23.350431 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m12:05:23.354795 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_low.e65294ca15"
[0m12:05:23.355868 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m12:05:23.357818 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_low.e65294ca15"
[0m12:05:23.358618 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_low.e65294ca15"
[0m12:05:23.358905 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_low.e65294ca15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_low.e65294ca15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select low
from dev.analytics.stock_prices
where low is null



      
    ) dbt_internal_test
[0m12:05:23.359174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:23.792500 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.433 seconds
[0m12:05:23.797110 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_low.e65294ca15: Close
[0m12:05:23.933400 [info ] [Thread-1 (]: 19 of 22 PASS not_null_stock_prices_low ........................................ [[32mPASS[0m in 0.58s]
[0m12:05:23.934901 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m12:05:23.935247 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m12:05:23.935557 [info ] [Thread-1 (]: 20 of 22 START test not_null_stock_prices_open ................................. [RUN]
[0m12:05:23.935929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_low.e65294ca15, now test.stock_prediction.not_null_stock_prices_open.e09b13f215)
[0m12:05:23.936174 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m12:05:23.939460 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_open.e09b13f215"
[0m12:05:23.940243 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m12:05:23.941581 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_open.e09b13f215"
[0m12:05:23.942241 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_open.e09b13f215"
[0m12:05:23.942447 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_open.e09b13f215: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_open.e09b13f215"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from dev.analytics.stock_prices
where open is null



      
    ) dbt_internal_test
[0m12:05:23.942636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:24.379050 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.435 seconds
[0m12:05:24.384827 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_open.e09b13f215: Close
[0m12:05:24.510254 [info ] [Thread-1 (]: 20 of 22 PASS not_null_stock_prices_open ....................................... [[32mPASS[0m in 0.57s]
[0m12:05:24.511107 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m12:05:24.511649 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m12:05:24.512193 [info ] [Thread-1 (]: 21 of 22 START test not_null_stock_prices_symbol ............................... [RUN]
[0m12:05:24.512777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_open.e09b13f215, now test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8)
[0m12:05:24.513221 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m12:05:24.518223 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"
[0m12:05:24.519225 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m12:05:24.521259 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"
[0m12:05:24.522145 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"
[0m12:05:24.522461 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.stock_prices
where symbol is null



      
    ) dbt_internal_test
[0m12:05:24.522755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:24.954613 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.431 seconds
[0m12:05:24.963570 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8: Close
[0m12:05:25.094268 [info ] [Thread-1 (]: 21 of 22 PASS not_null_stock_prices_symbol ..................................... [[32mPASS[0m in 0.58s]
[0m12:05:25.095291 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m12:05:25.095778 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m12:05:25.096272 [info ] [Thread-1 (]: 22 of 22 START test not_null_stock_prices_volume ............................... [RUN]
[0m12:05:25.096806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8, now test.stock_prediction.not_null_stock_prices_volume.71420bc956)
[0m12:05:25.097194 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m12:05:25.101858 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_volume.71420bc956"
[0m12:05:25.102728 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m12:05:25.104265 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_volume.71420bc956"
[0m12:05:25.105004 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_volume.71420bc956"
[0m12:05:25.105277 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_volume.71420bc956: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_volume.71420bc956"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume
from dev.analytics.stock_prices
where volume is null



      
    ) dbt_internal_test
[0m12:05:25.105513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:25.503888 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.398 seconds
[0m12:05:25.506813 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_volume.71420bc956: Close
[0m12:05:25.639903 [info ] [Thread-1 (]: 22 of 22 PASS not_null_stock_prices_volume ..................................... [[32mPASS[0m in 0.54s]
[0m12:05:25.640662 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m12:05:25.642271 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:05:25.642574 [debug] [MainThread]: Connection 'test.stock_prediction.not_null_stock_prices_volume.71420bc956' was properly closed.
[0m12:05:25.642860 [info ] [MainThread]: 
[0m12:05:25.643123 [info ] [MainThread]: Finished running 22 data tests in 0 hours 0 minutes and 16.53 seconds (16.53s).
[0m12:05:25.646557 [debug] [MainThread]: Command end result
[0m12:05:25.678799 [info ] [MainThread]: 
[0m12:05:25.679110 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:05:25.679303 [info ] [MainThread]: 
[0m12:05:25.679486 [info ] [MainThread]: Done. PASS=22 WARN=0 ERROR=0 SKIP=0 TOTAL=22
[0m12:05:25.680966 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 17.122215, "process_user_time": 2.745054, "process_kernel_time": 0.33957, "process_mem_max_rss": "138952704", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:05:25.681266 [debug] [MainThread]: Command `dbt test` succeeded at 12:05:25.681211 after 17.12 seconds
[0m12:05:25.681466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bbd4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10805d950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10805de50>]}
[0m12:05:25.681654 [debug] [MainThread]: Flushing usage events
[0m12:08:49.839533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104db2120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106703ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106703d90>]}


============================== 12:08:49.841713 | 76bc42a9-75a9-4535-be4a-bfac679f47aa ==============================
[0m12:08:49.841713 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:08:49.842011 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'profiles_dir': '/Users/adi/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:08:50.003254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76bc42a9-75a9-4535-be4a-bfac679f47aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111005a70>]}
[0m12:08:50.026098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76bc42a9-75a9-4535-be4a-bfac679f47aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e40490>]}
[0m12:08:50.026492 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:08:50.034809 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:08:50.100431 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:08:50.100878 [debug] [MainThread]: Partial parsing: updated file: stock_prediction://models/schema.yml
[0m12:08:50.125447 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:08:50.125686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '76bc42a9-75a9-4535-be4a-bfac679f47aa', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110da3d50>]}
[0m12:08:50.218345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76bc42a9-75a9-4535-be4a-bfac679f47aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bed9a0>]}
[0m12:08:50.310134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76bc42a9-75a9-4535-be4a-bfac679f47aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11105d0f0>]}
[0m12:08:50.310388 [info ] [MainThread]: Found 5 models, 2 snapshots, 28 data tests, 2 sources, 459 macros
[0m12:08:50.310537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76bc42a9-75a9-4535-be4a-bfac679f47aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111df5e60>]}
[0m12:08:50.311898 [info ] [MainThread]: 
[0m12:08:50.312156 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:08:50.314242 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_snapshot'
[0m12:08:50.321500 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m12:08:50.321660 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m12:08:50.321783 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:08:50.897913 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.576 seconds
[0m12:08:50.901224 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m12:08:51.043928 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m12:08:51.046963 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m12:08:51.047321 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m12:08:51.047613 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:08:51.527892 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.480 seconds
[0m12:08:51.531930 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m12:08:51.658514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76bc42a9-75a9-4535-be4a-bfac679f47aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129525d0>]}
[0m12:08:51.659384 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:08:51.659823 [info ] [MainThread]: 
[0m12:08:51.663228 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_close.4ccb16a429
[0m12:08:51.663707 [info ] [Thread-1 (]: 1 of 28 START test not_null_bollinger_close .................................... [RUN]
[0m12:08:51.664166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now test.stock_prediction.not_null_bollinger_close.4ccb16a429)
[0m12:08:51.664505 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_close.4ccb16a429
[0m12:08:51.681295 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_close.4ccb16a429"
[0m12:08:51.682321 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_close.4ccb16a429
[0m12:08:51.696096 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_bollinger_close.4ccb16a429"
[0m12:08:51.696826 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_bollinger_close.4ccb16a429"
[0m12:08:51.697065 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_close.4ccb16a429: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_bollinger_close.4ccb16a429"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.bollinger
where close is null



      
    ) dbt_internal_test
[0m12:08:51.697271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:52.414659 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.717 seconds
[0m12:08:52.426296 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_close.4ccb16a429: Close
[0m12:08:52.543733 [info ] [Thread-1 (]: 1 of 28 PASS not_null_bollinger_close .......................................... [[32mPASS[0m in 0.88s]
[0m12:08:52.544659 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_close.4ccb16a429
[0m12:08:52.545251 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_date.9d77bdd20c
[0m12:08:52.545882 [info ] [Thread-1 (]: 2 of 28 START test not_null_bollinger_date ..................................... [RUN]
[0m12:08:52.546531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_close.4ccb16a429, now test.stock_prediction.not_null_bollinger_date.9d77bdd20c)
[0m12:08:52.546992 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_date.9d77bdd20c
[0m12:08:52.552611 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_date.9d77bdd20c"
[0m12:08:52.553792 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_date.9d77bdd20c
[0m12:08:52.555754 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_bollinger_date.9d77bdd20c"
[0m12:08:52.557093 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_bollinger_date.9d77bdd20c"
[0m12:08:52.557426 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_date.9d77bdd20c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_bollinger_date.9d77bdd20c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.bollinger
where date is null



      
    ) dbt_internal_test
[0m12:08:52.557725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:52.948891 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.390 seconds
[0m12:08:52.953548 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_date.9d77bdd20c: Close
[0m12:08:53.069622 [info ] [Thread-1 (]: 2 of 28 PASS not_null_bollinger_date ........................................... [[32mPASS[0m in 0.52s]
[0m12:08:53.070548 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_date.9d77bdd20c
[0m12:08:53.071092 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e
[0m12:08:53.071648 [info ] [Thread-1 (]: 3 of 28 START test not_null_bollinger_lower_band ............................... [RUN]
[0m12:08:53.072213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_date.9d77bdd20c, now test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e)
[0m12:08:53.072672 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e
[0m12:08:53.077685 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e"
[0m12:08:53.078805 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e
[0m12:08:53.081750 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e"
[0m12:08:53.082704 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e"
[0m12:08:53.083037 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select lower_band
from dev.analytics.bollinger
where lower_band is null



      
    ) dbt_internal_test
[0m12:08:53.083341 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:53.509299 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.425 seconds
[0m12:08:53.512900 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e: Close
[0m12:08:53.633435 [info ] [Thread-1 (]: 3 of 28 PASS not_null_bollinger_lower_band ..................................... [[32mPASS[0m in 0.56s]
[0m12:08:53.633984 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e
[0m12:08:53.634316 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3
[0m12:08:53.634655 [info ] [Thread-1 (]: 4 of 28 START test not_null_bollinger_sma_20d .................................. [RUN]
[0m12:08:53.635039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e, now test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3)
[0m12:08:53.635297 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3
[0m12:08:53.638846 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3"
[0m12:08:53.639774 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3
[0m12:08:53.641830 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3"
[0m12:08:53.642565 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3"
[0m12:08:53.642793 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sma_20d
from dev.analytics.bollinger
where sma_20d is null



      
    ) dbt_internal_test
[0m12:08:53.643010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:54.048163 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.404 seconds
[0m12:08:54.053072 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3: Close
[0m12:08:54.179766 [info ] [Thread-1 (]: 4 of 28 PASS not_null_bollinger_sma_20d ........................................ [[32mPASS[0m in 0.54s]
[0m12:08:54.180672 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3
[0m12:08:54.181206 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_symbol.a932e30f82
[0m12:08:54.181774 [info ] [Thread-1 (]: 5 of 28 START test not_null_bollinger_symbol ................................... [RUN]
[0m12:08:54.182392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3, now test.stock_prediction.not_null_bollinger_symbol.a932e30f82)
[0m12:08:54.182768 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_symbol.a932e30f82
[0m12:08:54.187698 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_symbol.a932e30f82"
[0m12:08:54.188749 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_symbol.a932e30f82
[0m12:08:54.191429 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_bollinger_symbol.a932e30f82"
[0m12:08:54.192434 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_bollinger_symbol.a932e30f82"
[0m12:08:54.192776 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_symbol.a932e30f82: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_bollinger_symbol.a932e30f82"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.bollinger
where symbol is null



      
    ) dbt_internal_test
[0m12:08:54.193084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:54.593958 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.400 seconds
[0m12:08:54.598993 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_symbol.a932e30f82: Close
[0m12:08:54.723989 [info ] [Thread-1 (]: 5 of 28 PASS not_null_bollinger_symbol ......................................... [[32mPASS[0m in 0.54s]
[0m12:08:54.724868 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_symbol.a932e30f82
[0m12:08:54.725441 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_upper_band.e4db87564c
[0m12:08:54.726024 [info ] [Thread-1 (]: 6 of 28 START test not_null_bollinger_upper_band ............................... [RUN]
[0m12:08:54.726642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_symbol.a932e30f82, now test.stock_prediction.not_null_bollinger_upper_band.e4db87564c)
[0m12:08:54.727102 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_upper_band.e4db87564c
[0m12:08:54.732293 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_upper_band.e4db87564c"
[0m12:08:54.733417 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_upper_band.e4db87564c
[0m12:08:54.735644 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_bollinger_upper_band.e4db87564c"
[0m12:08:54.736551 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_bollinger_upper_band.e4db87564c"
[0m12:08:54.736883 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_upper_band.e4db87564c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_bollinger_upper_band.e4db87564c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select upper_band
from dev.analytics.bollinger
where upper_band is null



      
    ) dbt_internal_test
[0m12:08:54.737178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:55.166931 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.429 seconds
[0m12:08:55.171762 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_upper_band.e4db87564c: Close
[0m12:08:55.293837 [info ] [Thread-1 (]: 6 of 28 PASS not_null_bollinger_upper_band ..................................... [[32mPASS[0m in 0.57s]
[0m12:08:55.294824 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_upper_band.e4db87564c
[0m12:08:55.295374 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m12:08:55.295937 [info ] [Thread-1 (]: 7 of 28 START test not_null_moving_average_close ............................... [RUN]
[0m12:08:55.296512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_upper_band.e4db87564c, now test.stock_prediction.not_null_moving_average_close.6d037dd588)
[0m12:08:55.296884 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m12:08:55.301823 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_close.6d037dd588"
[0m12:08:55.302989 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m12:08:55.305158 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_close.6d037dd588"
[0m12:08:55.306068 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_close.6d037dd588"
[0m12:08:55.306384 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_close.6d037dd588: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_close.6d037dd588"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.moving_average
where close is null



      
    ) dbt_internal_test
[0m12:08:55.306683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:55.758911 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.452 seconds
[0m12:08:55.763662 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_close.6d037dd588: Close
[0m12:08:55.896123 [info ] [Thread-1 (]: 7 of 28 PASS not_null_moving_average_close ..................................... [[32mPASS[0m in 0.60s]
[0m12:08:55.896863 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m12:08:55.897305 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m12:08:55.897790 [info ] [Thread-1 (]: 8 of 28 START test not_null_moving_average_date ................................ [RUN]
[0m12:08:55.898275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_close.6d037dd588, now test.stock_prediction.not_null_moving_average_date.3ad00158b5)
[0m12:08:55.898581 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m12:08:55.902734 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_date.3ad00158b5"
[0m12:08:55.903667 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m12:08:55.905397 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_date.3ad00158b5"
[0m12:08:55.906183 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_date.3ad00158b5"
[0m12:08:55.906474 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_date.3ad00158b5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_date.3ad00158b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.moving_average
where date is null



      
    ) dbt_internal_test
[0m12:08:55.906732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:56.350143 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.443 seconds
[0m12:08:56.354519 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_date.3ad00158b5: Close
[0m12:08:56.480882 [info ] [Thread-1 (]: 8 of 28 PASS not_null_moving_average_date ...................................... [[32mPASS[0m in 0.58s]
[0m12:08:56.481636 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m12:08:56.482083 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m12:08:56.482545 [info ] [Thread-1 (]: 9 of 28 START test not_null_moving_average_moving_avg_20d ...................... [RUN]
[0m12:08:56.483055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_date.3ad00158b5, now test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22)
[0m12:08:56.483425 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m12:08:56.487899 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m12:08:56.488841 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m12:08:56.490803 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m12:08:56.491724 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m12:08:56.492012 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg_20d
from dev.analytics.moving_average
where moving_avg_20d is null



      
    ) dbt_internal_test
[0m12:08:56.492276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:56.888256 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.395 seconds
[0m12:08:56.892862 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22: Close
[0m12:08:57.019282 [info ] [Thread-1 (]: 9 of 28 PASS not_null_moving_average_moving_avg_20d ............................ [[32mPASS[0m in 0.54s]
[0m12:08:57.020434 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m12:08:57.021238 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m12:08:57.021871 [info ] [Thread-1 (]: 10 of 28 START test not_null_moving_average_moving_avg_5d ...................... [RUN]
[0m12:08:57.022536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22, now test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca)
[0m12:08:57.022972 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m12:08:57.028006 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m12:08:57.029116 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m12:08:57.031100 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m12:08:57.032030 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m12:08:57.032359 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg_5d
from dev.analytics.moving_average
where moving_avg_5d is null



      
    ) dbt_internal_test
[0m12:08:57.032658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:57.427993 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.395 seconds
[0m12:08:57.432328 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca: Close
[0m12:08:57.565855 [info ] [Thread-1 (]: 10 of 28 PASS not_null_moving_average_moving_avg_5d ............................ [[32mPASS[0m in 0.54s]
[0m12:08:57.566775 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m12:08:57.567328 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m12:08:57.567737 [info ] [Thread-1 (]: 11 of 28 START test not_null_moving_average_symbol ............................. [RUN]
[0m12:08:57.568258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca, now test.stock_prediction.not_null_moving_average_symbol.75a6f7473c)
[0m12:08:57.568712 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m12:08:57.573648 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"
[0m12:08:57.574697 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m12:08:57.576725 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"
[0m12:08:57.577601 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"
[0m12:08:57.577918 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_symbol.75a6f7473c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.moving_average
where symbol is null



      
    ) dbt_internal_test
[0m12:08:57.578214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:58.051350 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.473 seconds
[0m12:08:58.055283 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_symbol.75a6f7473c: Close
[0m12:08:58.201770 [info ] [Thread-1 (]: 11 of 28 PASS not_null_moving_average_symbol ................................... [[32mPASS[0m in 0.63s]
[0m12:08:58.202783 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m12:08:58.203336 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_price_momentum_close.1bd03322c7
[0m12:08:58.203882 [info ] [Thread-1 (]: 12 of 28 START test not_null_price_momentum_close .............................. [RUN]
[0m12:08:58.204504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_symbol.75a6f7473c, now test.stock_prediction.not_null_price_momentum_close.1bd03322c7)
[0m12:08:58.204924 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_price_momentum_close.1bd03322c7
[0m12:08:58.209947 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_price_momentum_close.1bd03322c7"
[0m12:08:58.211013 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_price_momentum_close.1bd03322c7
[0m12:08:58.212976 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_price_momentum_close.1bd03322c7"
[0m12:08:58.213900 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_price_momentum_close.1bd03322c7"
[0m12:08:58.214222 [debug] [Thread-1 (]: On test.stock_prediction.not_null_price_momentum_close.1bd03322c7: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_price_momentum_close.1bd03322c7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.price_momentum
where close is null



      
    ) dbt_internal_test
[0m12:08:58.214515 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:58.623132 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.408 seconds
[0m12:08:58.627281 [debug] [Thread-1 (]: On test.stock_prediction.not_null_price_momentum_close.1bd03322c7: Close
[0m12:08:58.742070 [info ] [Thread-1 (]: 12 of 28 PASS not_null_price_momentum_close .................................... [[32mPASS[0m in 0.54s]
[0m12:08:58.743368 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_price_momentum_close.1bd03322c7
[0m12:08:58.744001 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_price_momentum_date.d7330e89cb
[0m12:08:58.744566 [info ] [Thread-1 (]: 13 of 28 START test not_null_price_momentum_date ............................... [RUN]
[0m12:08:58.745152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_price_momentum_close.1bd03322c7, now test.stock_prediction.not_null_price_momentum_date.d7330e89cb)
[0m12:08:58.745584 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_price_momentum_date.d7330e89cb
[0m12:08:58.750615 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_price_momentum_date.d7330e89cb"
[0m12:08:58.751658 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_price_momentum_date.d7330e89cb
[0m12:08:58.753708 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_price_momentum_date.d7330e89cb"
[0m12:08:58.754584 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_price_momentum_date.d7330e89cb"
[0m12:08:58.754923 [debug] [Thread-1 (]: On test.stock_prediction.not_null_price_momentum_date.d7330e89cb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_price_momentum_date.d7330e89cb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.price_momentum
where date is null



      
    ) dbt_internal_test
[0m12:08:58.755212 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:59.142638 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.386 seconds
[0m12:08:59.146052 [debug] [Thread-1 (]: On test.stock_prediction.not_null_price_momentum_date.d7330e89cb: Close
[0m12:08:59.271670 [info ] [Thread-1 (]: 13 of 28 PASS not_null_price_momentum_date ..................................... [[32mPASS[0m in 0.53s]
[0m12:08:59.273134 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_price_momentum_date.d7330e89cb
[0m12:08:59.273796 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_price_momentum_momentum_10d.3ed05a427e
[0m12:08:59.274314 [info ] [Thread-1 (]: 14 of 28 START test not_null_price_momentum_momentum_10d ....................... [RUN]
[0m12:08:59.274860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_price_momentum_date.d7330e89cb, now test.stock_prediction.not_null_price_momentum_momentum_10d.3ed05a427e)
[0m12:08:59.275235 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_price_momentum_momentum_10d.3ed05a427e
[0m12:08:59.280217 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_price_momentum_momentum_10d.3ed05a427e"
[0m12:08:59.281271 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_price_momentum_momentum_10d.3ed05a427e
[0m12:08:59.283294 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_price_momentum_momentum_10d.3ed05a427e"
[0m12:08:59.284218 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_price_momentum_momentum_10d.3ed05a427e"
[0m12:08:59.284544 [debug] [Thread-1 (]: On test.stock_prediction.not_null_price_momentum_momentum_10d.3ed05a427e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_price_momentum_momentum_10d.3ed05a427e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select momentum_10d
from dev.analytics.price_momentum
where momentum_10d is null



      
    ) dbt_internal_test
[0m12:08:59.284839 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:59.690521 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.405 seconds
[0m12:08:59.695065 [debug] [Thread-1 (]: On test.stock_prediction.not_null_price_momentum_momentum_10d.3ed05a427e: Close
[0m12:08:59.821655 [info ] [Thread-1 (]: 14 of 28 PASS not_null_price_momentum_momentum_10d ............................. [[32mPASS[0m in 0.55s]
[0m12:08:59.822497 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_price_momentum_momentum_10d.3ed05a427e
[0m12:08:59.822959 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_price_momentum_symbol.2b4dd3b3ec
[0m12:08:59.823429 [info ] [Thread-1 (]: 15 of 28 START test not_null_price_momentum_symbol ............................. [RUN]
[0m12:08:59.823922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_price_momentum_momentum_10d.3ed05a427e, now test.stock_prediction.not_null_price_momentum_symbol.2b4dd3b3ec)
[0m12:08:59.824283 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_price_momentum_symbol.2b4dd3b3ec
[0m12:08:59.829216 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_price_momentum_symbol.2b4dd3b3ec"
[0m12:08:59.830285 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_price_momentum_symbol.2b4dd3b3ec
[0m12:08:59.832231 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_price_momentum_symbol.2b4dd3b3ec"
[0m12:08:59.833116 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_price_momentum_symbol.2b4dd3b3ec"
[0m12:08:59.833450 [debug] [Thread-1 (]: On test.stock_prediction.not_null_price_momentum_symbol.2b4dd3b3ec: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_price_momentum_symbol.2b4dd3b3ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.price_momentum
where symbol is null



      
    ) dbt_internal_test
[0m12:08:59.833746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:00.350662 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.516 seconds
[0m12:09:00.355757 [debug] [Thread-1 (]: On test.stock_prediction.not_null_price_momentum_symbol.2b4dd3b3ec: Close
[0m12:09:00.472118 [info ] [Thread-1 (]: 15 of 28 PASS not_null_price_momentum_symbol ................................... [[32mPASS[0m in 0.65s]
[0m12:09:00.472757 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_price_momentum_symbol.2b4dd3b3ec
[0m12:09:00.473134 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m12:09:00.473553 [info ] [Thread-1 (]: 16 of 28 START test not_null_rsi_calculation_avg_gain .......................... [RUN]
[0m12:09:00.474005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_price_momentum_symbol.2b4dd3b3ec, now test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42)
[0m12:09:00.474330 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m12:09:00.478497 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m12:09:00.479431 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m12:09:00.481169 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m12:09:00.482001 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m12:09:00.482289 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_gain
from dev.analytics.rsi_calculation
where avg_gain is null



      
    ) dbt_internal_test
[0m12:09:00.482551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:01.037936 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.555 seconds
[0m12:09:01.041825 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42: Close
[0m12:09:01.160332 [info ] [Thread-1 (]: 16 of 28 PASS not_null_rsi_calculation_avg_gain ................................ [[32mPASS[0m in 0.69s]
[0m12:09:01.161187 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m12:09:01.161741 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m12:09:01.162318 [info ] [Thread-1 (]: 17 of 28 START test not_null_rsi_calculation_avg_loss .......................... [RUN]
[0m12:09:01.162931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42, now test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19)
[0m12:09:01.163383 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m12:09:01.168308 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m12:09:01.169329 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m12:09:01.171577 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m12:09:01.172470 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m12:09:01.172784 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_loss
from dev.analytics.rsi_calculation
where avg_loss is null



      
    ) dbt_internal_test
[0m12:09:01.173080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:01.612261 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.438 seconds
[0m12:09:01.617992 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19: Close
[0m12:09:01.742649 [info ] [Thread-1 (]: 17 of 28 PASS not_null_rsi_calculation_avg_loss ................................ [[32mPASS[0m in 0.58s]
[0m12:09:01.743800 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m12:09:01.744292 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m12:09:01.744733 [info ] [Thread-1 (]: 18 of 28 START test not_null_rsi_calculation_close ............................. [RUN]
[0m12:09:01.745230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19, now test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d)
[0m12:09:01.745560 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m12:09:01.749740 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"
[0m12:09:01.750669 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m12:09:01.752410 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"
[0m12:09:01.753228 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"
[0m12:09:01.753492 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.rsi_calculation
where close is null



      
    ) dbt_internal_test
[0m12:09:01.753724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:02.173148 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.419 seconds
[0m12:09:02.177706 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d: Close
[0m12:09:02.322050 [info ] [Thread-1 (]: 18 of 28 PASS not_null_rsi_calculation_close ................................... [[32mPASS[0m in 0.58s]
[0m12:09:02.322929 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m12:09:02.323497 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m12:09:02.324070 [info ] [Thread-1 (]: 19 of 28 START test not_null_rsi_calculation_date .............................. [RUN]
[0m12:09:02.324753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d, now test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76)
[0m12:09:02.325207 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m12:09:02.330266 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"
[0m12:09:02.331321 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m12:09:02.333386 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"
[0m12:09:02.334304 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"
[0m12:09:02.334621 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.rsi_calculation
where date is null



      
    ) dbt_internal_test
[0m12:09:02.334920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:02.837174 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.502 seconds
[0m12:09:02.840475 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76: Close
[0m12:09:02.957320 [info ] [Thread-1 (]: 19 of 28 PASS not_null_rsi_calculation_date .................................... [[32mPASS[0m in 0.63s]
[0m12:09:02.958167 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m12:09:02.958690 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m12:09:02.959249 [info ] [Thread-1 (]: 20 of 28 START test not_null_rsi_calculation_rsi_14d ........................... [RUN]
[0m12:09:02.959846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76, now test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8)
[0m12:09:02.960307 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m12:09:02.965055 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m12:09:02.966050 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m12:09:02.968042 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m12:09:02.968897 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m12:09:02.969226 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from dev.analytics.rsi_calculation
where rsi_14d is null



      
    ) dbt_internal_test
[0m12:09:02.969518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:03.379362 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.409 seconds
[0m12:09:03.384951 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8: Close
[0m12:09:03.513037 [info ] [Thread-1 (]: 20 of 28 PASS not_null_rsi_calculation_rsi_14d ................................. [[32mPASS[0m in 0.55s]
[0m12:09:03.513878 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m12:09:03.514414 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m12:09:03.514973 [info ] [Thread-1 (]: 21 of 28 START test not_null_rsi_calculation_symbol ............................ [RUN]
[0m12:09:03.515595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8, now test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84)
[0m12:09:03.516047 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m12:09:03.521060 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m12:09:03.522095 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m12:09:03.524222 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m12:09:03.525109 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m12:09:03.525436 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.rsi_calculation
where symbol is null



      
    ) dbt_internal_test
[0m12:09:03.525733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:03.966077 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.440 seconds
[0m12:09:03.970865 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84: Close
[0m12:09:04.087657 [info ] [Thread-1 (]: 21 of 28 PASS not_null_rsi_calculation_symbol .................................. [[32mPASS[0m in 0.57s]
[0m12:09:04.089057 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m12:09:04.089725 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m12:09:04.090326 [info ] [Thread-1 (]: 22 of 28 START test not_null_stock_prices_close ................................ [RUN]
[0m12:09:04.090950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84, now test.stock_prediction.not_null_stock_prices_close.d7e232e1ba)
[0m12:09:04.091329 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m12:09:04.096392 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"
[0m12:09:04.097494 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m12:09:04.099636 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"
[0m12:09:04.100563 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"
[0m12:09:04.100905 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_close.d7e232e1ba: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.stock_prices
where close is null



      
    ) dbt_internal_test
[0m12:09:04.101210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:04.631047 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.529 seconds
[0m12:09:04.635218 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_close.d7e232e1ba: Close
[0m12:09:04.757171 [info ] [Thread-1 (]: 22 of 28 PASS not_null_stock_prices_close ...................................... [[32mPASS[0m in 0.67s]
[0m12:09:04.758035 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m12:09:04.758586 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m12:09:04.759176 [info ] [Thread-1 (]: 23 of 28 START test not_null_stock_prices_date ................................. [RUN]
[0m12:09:04.759834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_close.d7e232e1ba, now test.stock_prediction.not_null_stock_prices_date.98a7527501)
[0m12:09:04.760288 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m12:09:04.765380 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_date.98a7527501"
[0m12:09:04.766472 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m12:09:04.768562 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_date.98a7527501"
[0m12:09:04.769453 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_date.98a7527501"
[0m12:09:04.769772 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_date.98a7527501: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_date.98a7527501"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.stock_prices
where date is null



      
    ) dbt_internal_test
[0m12:09:04.770066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:05.247846 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.477 seconds
[0m12:09:05.251203 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_date.98a7527501: Close
[0m12:09:05.404890 [info ] [Thread-1 (]: 23 of 28 PASS not_null_stock_prices_date ....................................... [[32mPASS[0m in 0.64s]
[0m12:09:05.405724 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m12:09:05.406239 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m12:09:05.406735 [info ] [Thread-1 (]: 24 of 28 START test not_null_stock_prices_high ................................. [RUN]
[0m12:09:05.407222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_date.98a7527501, now test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc)
[0m12:09:05.407569 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m12:09:05.412357 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"
[0m12:09:05.413250 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m12:09:05.415189 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"
[0m12:09:05.416067 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"
[0m12:09:05.416383 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select high
from dev.analytics.stock_prices
where high is null



      
    ) dbt_internal_test
[0m12:09:05.416681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:05.833409 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.416 seconds
[0m12:09:05.838108 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc: Close
[0m12:09:05.952863 [info ] [Thread-1 (]: 24 of 28 PASS not_null_stock_prices_high ....................................... [[32mPASS[0m in 0.55s]
[0m12:09:05.953759 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m12:09:05.954306 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m12:09:05.954884 [info ] [Thread-1 (]: 25 of 28 START test not_null_stock_prices_low .................................. [RUN]
[0m12:09:05.955438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc, now test.stock_prediction.not_null_stock_prices_low.e65294ca15)
[0m12:09:05.955808 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m12:09:05.960639 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_low.e65294ca15"
[0m12:09:05.961654 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m12:09:05.963587 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_low.e65294ca15"
[0m12:09:05.964492 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_low.e65294ca15"
[0m12:09:05.964816 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_low.e65294ca15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_low.e65294ca15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select low
from dev.analytics.stock_prices
where low is null



      
    ) dbt_internal_test
[0m12:09:05.965107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:06.366412 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.400 seconds
[0m12:09:06.371074 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_low.e65294ca15: Close
[0m12:09:06.508656 [info ] [Thread-1 (]: 25 of 28 PASS not_null_stock_prices_low ........................................ [[32mPASS[0m in 0.55s]
[0m12:09:06.509617 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m12:09:06.510149 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m12:09:06.510498 [info ] [Thread-1 (]: 26 of 28 START test not_null_stock_prices_open ................................. [RUN]
[0m12:09:06.511028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_low.e65294ca15, now test.stock_prediction.not_null_stock_prices_open.e09b13f215)
[0m12:09:06.511466 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m12:09:06.516444 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_open.e09b13f215"
[0m12:09:06.517472 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m12:09:06.519445 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_open.e09b13f215"
[0m12:09:06.520363 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_open.e09b13f215"
[0m12:09:06.520690 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_open.e09b13f215: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_open.e09b13f215"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from dev.analytics.stock_prices
where open is null



      
    ) dbt_internal_test
[0m12:09:06.520999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:06.953226 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.432 seconds
[0m12:09:06.956651 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_open.e09b13f215: Close
[0m12:09:07.083691 [info ] [Thread-1 (]: 26 of 28 PASS not_null_stock_prices_open ....................................... [[32mPASS[0m in 0.57s]
[0m12:09:07.085144 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m12:09:07.085834 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m12:09:07.086383 [info ] [Thread-1 (]: 27 of 28 START test not_null_stock_prices_symbol ............................... [RUN]
[0m12:09:07.086941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_open.e09b13f215, now test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8)
[0m12:09:07.087316 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m12:09:07.092258 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"
[0m12:09:07.093302 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m12:09:07.095274 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"
[0m12:09:07.096182 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"
[0m12:09:07.096512 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.stock_prices
where symbol is null



      
    ) dbt_internal_test
[0m12:09:07.096813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:07.543510 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.446 seconds
[0m12:09:07.548752 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8: Close
[0m12:09:07.679212 [info ] [Thread-1 (]: 27 of 28 PASS not_null_stock_prices_symbol ..................................... [[32mPASS[0m in 0.59s]
[0m12:09:07.680337 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m12:09:07.680806 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m12:09:07.681216 [info ] [Thread-1 (]: 28 of 28 START test not_null_stock_prices_volume ............................... [RUN]
[0m12:09:07.681699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8, now test.stock_prediction.not_null_stock_prices_volume.71420bc956)
[0m12:09:07.682013 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m12:09:07.686018 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_volume.71420bc956"
[0m12:09:07.686905 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m12:09:07.688604 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_volume.71420bc956"
[0m12:09:07.689383 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_volume.71420bc956"
[0m12:09:07.689676 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_volume.71420bc956: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_volume.71420bc956"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume
from dev.analytics.stock_prices
where volume is null



      
    ) dbt_internal_test
[0m12:09:07.689929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:08.150735 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.460 seconds
[0m12:09:08.157797 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_volume.71420bc956: Close
[0m12:09:08.287457 [info ] [Thread-1 (]: 28 of 28 PASS not_null_stock_prices_volume ..................................... [[32mPASS[0m in 0.61s]
[0m12:09:08.288207 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m12:09:08.289518 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:09:08.289759 [debug] [MainThread]: Connection 'test.stock_prediction.not_null_stock_prices_volume.71420bc956' was properly closed.
[0m12:09:08.290013 [info ] [MainThread]: 
[0m12:09:08.290229 [info ] [MainThread]: Finished running 28 data tests in 0 hours 0 minutes and 17.98 seconds (17.98s).
[0m12:09:08.293486 [debug] [MainThread]: Command end result
[0m12:09:08.320936 [info ] [MainThread]: 
[0m12:09:08.321249 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:09:08.321446 [info ] [MainThread]: 
[0m12:09:08.321622 [info ] [MainThread]: Done. PASS=28 WARN=0 ERROR=0 SKIP=0 TOTAL=28
[0m12:09:08.322778 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 18.516249, "process_user_time": 3.219369, "process_kernel_time": 0.381237, "process_mem_max_rss": "140460032", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:09:08.323114 [debug] [MainThread]: Command `dbt test` succeeded at 12:09:08.323052 after 18.52 seconds
[0m12:09:08.323341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112aefa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b85770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b86530>]}
[0m12:09:08.323547 [debug] [MainThread]: Flushing usage events
[0m12:09:14.634828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104656120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fa7ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fa7d90>]}


============================== 12:09:14.637030 | 4204d817-a4af-44a2-a046-3244b0df493a ==============================
[0m12:09:14.637030 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:09:14.637327 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:09:14.682871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4204d817-a4af-44a2-a046-3244b0df493a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e468b0>]}
[0m12:09:14.694118 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.09099487, "process_user_time": 0.597965, "process_kernel_time": 0.097627, "process_mem_max_rss": "101253120", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:09:14.694395 [debug] [MainThread]: Command `dbt clean` succeeded at 12:09:14.694335 after 0.09 seconds
[0m12:09:14.694555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060ea470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060ea580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d56150>]}
[0m12:09:14.694700 [debug] [MainThread]: Flushing usage events
[0m12:09:19.153368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e4e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095efed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095efd90>]}


============================== 12:09:19.155451 | e7a69ee8-b4b5-4284-8d2b-4ecd59b199ce ==============================
[0m12:09:19.155451 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:09:19.155740 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/adi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:09:19.314251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7a69ee8-b4b5-4284-8d2b-4ecd59b199ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a605a70>]}
[0m12:09:19.337402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7a69ee8-b4b5-4284-8d2b-4ecd59b199ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3d0490>]}
[0m12:09:19.337790 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:09:19.346366 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:09:19.346882 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:09:19.347057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e7a69ee8-b4b5-4284-8d2b-4ecd59b199ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a330050>]}
[0m12:09:19.894225 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:09:19.894500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e7a69ee8-b4b5-4284-8d2b-4ecd59b199ce', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7206e0>]}
[0m12:09:20.042210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7a69ee8-b4b5-4284-8d2b-4ecd59b199ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109512a50>]}
[0m12:09:20.097103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7a69ee8-b4b5-4284-8d2b-4ecd59b199ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094e69c0>]}
[0m12:09:20.097372 [info ] [MainThread]: Found 5 models, 2 snapshots, 28 data tests, 2 sources, 459 macros
[0m12:09:20.097527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7a69ee8-b4b5-4284-8d2b-4ecd59b199ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5ef950>]}
[0m12:09:20.098564 [info ] [MainThread]: 
[0m12:09:20.098827 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:09:20.100927 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m12:09:20.106873 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m12:09:20.107019 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m12:09:20.107133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:09:20.671716 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.564 seconds
[0m12:09:20.674106 [debug] [ThreadPool]: On list_dev: Close
[0m12:09:20.804373 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m12:09:20.816411 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m12:09:20.816774 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m12:09:20.817035 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:09:21.257717 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.440 seconds
[0m12:09:21.261737 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m12:09:21.389273 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m12:09:21.393519 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m12:09:21.395149 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m12:09:21.395458 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:09:21.873723 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.478 seconds
[0m12:09:21.877254 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m12:09:22.020501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7a69ee8-b4b5-4284-8d2b-4ecd59b199ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c48c730>]}
[0m12:09:22.020876 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:09:22.021176 [info ] [MainThread]: 
[0m12:09:22.024082 [debug] [Thread-1 (]: Began running node model.stock_prediction.stock_prices
[0m12:09:22.024765 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stock_prices ............................. [RUN]
[0m12:09:22.025284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now model.stock_prediction.stock_prices)
[0m12:09:22.025663 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.stock_prices
[0m12:09:22.035256 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.stock_prices"
[0m12:09:22.036707 [debug] [Thread-1 (]: Began executing node model.stock_prediction.stock_prices
[0m12:09:22.058986 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.stock_prices"
[0m12:09:22.059969 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.stock_prices"
[0m12:09:22.060195 [debug] [Thread-1 (]: On model.stock_prediction.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.stock_prices"} */
create or replace   view dev.analytics.stock_prices
  
   as (
    SELECT
    symbol,
    date,
    open,
    high,
    low,
    close,
    volume
FROM dev.raw_data.stock_prices
  );
[0m12:09:22.060384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:22.827416 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.766 seconds
[0m12:09:22.853635 [debug] [Thread-1 (]: On model.stock_prediction.stock_prices: Close
[0m12:09:22.968831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7a69ee8-b4b5-4284-8d2b-4ecd59b199ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081b13b0>]}
[0m12:09:22.969937 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stock_prices ........................ [[32mSUCCESS 1[0m in 0.94s]
[0m12:09:22.970596 [debug] [Thread-1 (]: Finished running node model.stock_prediction.stock_prices
[0m12:09:22.971588 [debug] [Thread-1 (]: Began running node model.stock_prediction.bollinger
[0m12:09:22.972181 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.bollinger ............................... [RUN]
[0m12:09:22.972767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.stock_prices, now model.stock_prediction.bollinger)
[0m12:09:22.973143 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.bollinger
[0m12:09:22.976544 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.bollinger"
[0m12:09:22.977719 [debug] [Thread-1 (]: Began executing node model.stock_prediction.bollinger
[0m12:09:22.996530 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.bollinger"
[0m12:09:22.997714 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.bollinger"
[0m12:09:22.997991 [debug] [Thread-1 (]: On model.stock_prediction.bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.bollinger"} */
create or replace transient table dev.analytics.bollinger
         as
        (WITH bollinger AS (
    SELECT
        symbol,
        date,
        close,
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) AS sma_20d,
        STDDEV(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) AS stddev_20d
    FROM dev.analytics.stock_prices
)

SELECT
    symbol,
    date,
    close,
    COALESCE(sma_20d, 0) AS sma_20d,
    COALESCE(sma_20d + (2 * stddev_20d), 0) AS upper_band,
    COALESCE(sma_20d - (2 * stddev_20d), 0) AS lower_band
FROM bollinger
ORDER BY symbol, date
        );
[0m12:09:22.998212 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:24.054516 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.056 seconds
[0m12:09:24.057988 [debug] [Thread-1 (]: On model.stock_prediction.bollinger: Close
[0m12:09:24.175424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7a69ee8-b4b5-4284-8d2b-4ecd59b199ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c095550>]}
[0m12:09:24.176466 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.bollinger .......................... [[32mSUCCESS 1[0m in 1.20s]
[0m12:09:24.177252 [debug] [Thread-1 (]: Finished running node model.stock_prediction.bollinger
[0m12:09:24.177790 [debug] [Thread-1 (]: Began running node model.stock_prediction.moving_average
[0m12:09:24.178492 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.moving_average .......................... [RUN]
[0m12:09:24.179135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.bollinger, now model.stock_prediction.moving_average)
[0m12:09:24.179588 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.moving_average
[0m12:09:24.183390 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.moving_average"
[0m12:09:24.184473 [debug] [Thread-1 (]: Began executing node model.stock_prediction.moving_average
[0m12:09:24.187697 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.moving_average"
[0m12:09:24.188964 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.moving_average"
[0m12:09:24.189314 [debug] [Thread-1 (]: On model.stock_prediction.moving_average: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.moving_average"} */
create or replace transient table dev.analytics.moving_average
         as
        (WITH stock_data AS (
    SELECT
        symbol,
        date,
        close
    FROM dev.analytics.stock_prices -- assuming 'stock_prices' is the name of the raw table model in dbt
)

SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
    ) AS moving_avg_5d,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
    ) AS moving_avg_20d
FROM stock_data
ORDER BY symbol, date
        );
[0m12:09:24.189634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:25.199292 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.009 seconds
[0m12:09:25.203146 [debug] [Thread-1 (]: On model.stock_prediction.moving_average: Close
[0m12:09:25.318168 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7a69ee8-b4b5-4284-8d2b-4ecd59b199ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d4ba80>]}
[0m12:09:25.319185 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.moving_average ..................... [[32mSUCCESS 1[0m in 1.14s]
[0m12:09:25.319927 [debug] [Thread-1 (]: Finished running node model.stock_prediction.moving_average
[0m12:09:25.320359 [debug] [Thread-1 (]: Began running node model.stock_prediction.price_momentum
[0m12:09:25.320928 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.price_momentum .......................... [RUN]
[0m12:09:25.321469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.moving_average, now model.stock_prediction.price_momentum)
[0m12:09:25.321852 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.price_momentum
[0m12:09:25.325220 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.price_momentum"
[0m12:09:25.326250 [debug] [Thread-1 (]: Began executing node model.stock_prediction.price_momentum
[0m12:09:25.328458 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.price_momentum"
[0m12:09:25.329825 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.price_momentum"
[0m12:09:25.330400 [debug] [Thread-1 (]: On model.stock_prediction.price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.price_momentum"} */
create or replace transient table dev.analytics.price_momentum
         as
        (WITH momentum_calculation AS (
    SELECT
        symbol,
        date,
        close,
        LAG(close, 10) OVER (
            PARTITION BY symbol
            ORDER BY date
        ) AS close_10_days_ago
    FROM dev.analytics.stock_prices
)

SELECT
    symbol,
    date,
    close,
    COALESCE(close - close_10_days_ago, 0) AS momentum_10d
FROM momentum_calculation
ORDER BY symbol, date
        );
[0m12:09:25.330819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:26.304478 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.973 seconds
[0m12:09:26.310987 [debug] [Thread-1 (]: On model.stock_prediction.price_momentum: Close
[0m12:09:26.436844 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7a69ee8-b4b5-4284-8d2b-4ecd59b199ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c760dd0>]}
[0m12:09:26.437882 [info ] [Thread-1 (]: 4 of 5 OK created sql table model analytics.price_momentum ..................... [[32mSUCCESS 1[0m in 1.12s]
[0m12:09:26.438685 [debug] [Thread-1 (]: Finished running node model.stock_prediction.price_momentum
[0m12:09:26.439219 [debug] [Thread-1 (]: Began running node model.stock_prediction.rsi_calculation
[0m12:09:26.439878 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.rsi_calculation ......................... [RUN]
[0m12:09:26.440509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.price_momentum, now model.stock_prediction.rsi_calculation)
[0m12:09:26.440976 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.rsi_calculation
[0m12:09:26.444690 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.rsi_calculation"
[0m12:09:26.445791 [debug] [Thread-1 (]: Began executing node model.stock_prediction.rsi_calculation
[0m12:09:26.448192 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.rsi_calculation"
[0m12:09:26.450042 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.rsi_calculation"
[0m12:09:26.450450 [debug] [Thread-1 (]: On model.stock_prediction.rsi_calculation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.rsi_calculation"} */
create or replace transient table dev.analytics.rsi_calculation
         as
        (WITH stock_data AS (
    SELECT
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM dev.analytics.stock_prices
),

price_changes AS (
    SELECT
        symbol,
        date,
        close,
        CASE 
            WHEN close > prev_close THEN close - prev_close
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close < prev_close THEN prev_close - close
            ELSE 0 
        END AS loss
    FROM stock_data
),

average_gains_losses AS (
    SELECT
        symbol,
        date,
        close,
        -- Calculate the average gain over the last 14 days, including the current row
        AVG(gain) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain,
        -- Calculate the average loss over the last 14 days, including the current row
        AVG(loss) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss
    FROM price_changes
)

SELECT
    symbol,
    date,
    close,
    avg_gain,
    avg_loss,
    -- Calculate RSI, using COALESCE to set to 0 if result is NULL
    COALESCE(100 - (100 / (1 + (NULLIF(avg_gain, 0) / NULLIF(avg_loss, 0)))), 0) AS rsi_14d
FROM average_gains_losses
ORDER BY symbol, date
        );
[0m12:09:26.450813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:27.431331 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.980 seconds
[0m12:09:27.437612 [debug] [Thread-1 (]: On model.stock_prediction.rsi_calculation: Close
[0m12:09:27.567679 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7a69ee8-b4b5-4284-8d2b-4ecd59b199ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c762450>]}
[0m12:09:27.568734 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.rsi_calculation .................... [[32mSUCCESS 1[0m in 1.13s]
[0m12:09:27.569516 [debug] [Thread-1 (]: Finished running node model.stock_prediction.rsi_calculation
[0m12:09:27.571024 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:09:27.571380 [debug] [MainThread]: Connection 'model.stock_prediction.rsi_calculation' was properly closed.
[0m12:09:27.571774 [info ] [MainThread]: 
[0m12:09:27.572094 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 7.47 seconds (7.47s).
[0m12:09:27.573297 [debug] [MainThread]: Command end result
[0m12:09:27.604450 [info ] [MainThread]: 
[0m12:09:27.604731 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:09:27.604922 [info ] [MainThread]: 
[0m12:09:27.605101 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:09:27.606238 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.484697, "process_user_time": 2.112553, "process_kernel_time": 0.202108, "process_mem_max_rss": "144244736", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:09:27.606610 [debug] [MainThread]: Command `dbt run` succeeded at 12:09:27.606549 after 8.49 seconds
[0m12:09:27.606844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6ed8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c762570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c763fb0>]}
[0m12:09:27.607054 [debug] [MainThread]: Flushing usage events
[0m12:09:33.959597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a4e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1efed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1efd90>]}


============================== 12:09:33.961735 | ea1462d3-0055-4650-8e4e-81706314d06b ==============================
[0m12:09:33.961735 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:09:33.962025 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:09:34.116436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea1462d3-0055-4650-8e4e-81706314d06b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b175a70>]}
[0m12:09:34.139181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea1462d3-0055-4650-8e4e-81706314d06b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b140490>]}
[0m12:09:34.139552 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:09:34.147913 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:09:34.211594 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:09:34.211820 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:09:34.236047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea1462d3-0055-4650-8e4e-81706314d06b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0a0b50>]}
[0m12:09:34.296403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea1462d3-0055-4650-8e4e-81706314d06b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b879c70>]}
[0m12:09:34.296674 [info ] [MainThread]: Found 5 models, 2 snapshots, 28 data tests, 2 sources, 459 macros
[0m12:09:34.296822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea1462d3-0055-4650-8e4e-81706314d06b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b727150>]}
[0m12:09:34.298258 [info ] [MainThread]: 
[0m12:09:34.298532 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:09:34.300706 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_analytics'
[0m12:09:34.308719 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m12:09:34.308874 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m12:09:34.308994 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:09:34.883583 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.574 seconds
[0m12:09:34.886684 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m12:09:35.002987 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m12:09:35.007259 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m12:09:35.007700 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m12:09:35.008059 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:09:35.435083 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.427 seconds
[0m12:09:35.438687 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m12:09:35.564571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea1462d3-0055-4650-8e4e-81706314d06b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c308390>]}
[0m12:09:35.565300 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:09:35.565640 [info ] [MainThread]: 
[0m12:09:35.568604 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_close.4ccb16a429
[0m12:09:35.569094 [info ] [Thread-1 (]: 1 of 28 START test not_null_bollinger_close .................................... [RUN]
[0m12:09:35.569562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now test.stock_prediction.not_null_bollinger_close.4ccb16a429)
[0m12:09:35.569914 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_close.4ccb16a429
[0m12:09:35.586469 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_close.4ccb16a429"
[0m12:09:35.587580 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_close.4ccb16a429
[0m12:09:35.601481 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_bollinger_close.4ccb16a429"
[0m12:09:35.602203 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_bollinger_close.4ccb16a429"
[0m12:09:35.602415 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_close.4ccb16a429: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_bollinger_close.4ccb16a429"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.bollinger
where close is null



      
    ) dbt_internal_test
[0m12:09:35.602599 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:36.193164 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.590 seconds
[0m12:09:36.204657 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_close.4ccb16a429: Close
[0m12:09:36.362548 [info ] [Thread-1 (]: 1 of 28 PASS not_null_bollinger_close .......................................... [[32mPASS[0m in 0.79s]
[0m12:09:36.363436 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_close.4ccb16a429
[0m12:09:36.364000 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_date.9d77bdd20c
[0m12:09:36.364594 [info ] [Thread-1 (]: 2 of 28 START test not_null_bollinger_date ..................................... [RUN]
[0m12:09:36.365196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_close.4ccb16a429, now test.stock_prediction.not_null_bollinger_date.9d77bdd20c)
[0m12:09:36.365640 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_date.9d77bdd20c
[0m12:09:36.370409 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_date.9d77bdd20c"
[0m12:09:36.371500 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_date.9d77bdd20c
[0m12:09:36.374312 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_bollinger_date.9d77bdd20c"
[0m12:09:36.375264 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_bollinger_date.9d77bdd20c"
[0m12:09:36.375599 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_date.9d77bdd20c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_bollinger_date.9d77bdd20c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.bollinger
where date is null



      
    ) dbt_internal_test
[0m12:09:36.375894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:36.777691 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.401 seconds
[0m12:09:36.781763 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_date.9d77bdd20c: Close
[0m12:09:36.907141 [info ] [Thread-1 (]: 2 of 28 PASS not_null_bollinger_date ........................................... [[32mPASS[0m in 0.54s]
[0m12:09:36.908257 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_date.9d77bdd20c
[0m12:09:36.908822 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e
[0m12:09:36.909331 [info ] [Thread-1 (]: 3 of 28 START test not_null_bollinger_lower_band ............................... [RUN]
[0m12:09:36.909886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_date.9d77bdd20c, now test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e)
[0m12:09:36.910283 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e
[0m12:09:36.915384 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e"
[0m12:09:36.916527 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e
[0m12:09:36.919309 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e"
[0m12:09:36.920247 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e"
[0m12:09:36.920582 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select lower_band
from dev.analytics.bollinger
where lower_band is null



      
    ) dbt_internal_test
[0m12:09:36.920886 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:37.329831 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.408 seconds
[0m12:09:37.333957 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e: Close
[0m12:09:37.452523 [info ] [Thread-1 (]: 3 of 28 PASS not_null_bollinger_lower_band ..................................... [[32mPASS[0m in 0.54s]
[0m12:09:37.453867 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e
[0m12:09:37.454444 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3
[0m12:09:37.455029 [info ] [Thread-1 (]: 4 of 28 START test not_null_bollinger_sma_20d .................................. [RUN]
[0m12:09:37.455615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e, now test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3)
[0m12:09:37.456005 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3
[0m12:09:37.460941 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3"
[0m12:09:37.462054 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3
[0m12:09:37.464163 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3"
[0m12:09:37.465101 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3"
[0m12:09:37.465428 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sma_20d
from dev.analytics.bollinger
where sma_20d is null



      
    ) dbt_internal_test
[0m12:09:37.465725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:37.964045 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.498 seconds
[0m12:09:37.969335 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3: Close
[0m12:09:38.114520 [info ] [Thread-1 (]: 4 of 28 PASS not_null_bollinger_sma_20d ........................................ [[32mPASS[0m in 0.66s]
[0m12:09:38.115591 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3
[0m12:09:38.116150 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_symbol.a932e30f82
[0m12:09:38.116727 [info ] [Thread-1 (]: 5 of 28 START test not_null_bollinger_symbol ................................... [RUN]
[0m12:09:38.117354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3, now test.stock_prediction.not_null_bollinger_symbol.a932e30f82)
[0m12:09:38.117806 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_symbol.a932e30f82
[0m12:09:38.122964 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_symbol.a932e30f82"
[0m12:09:38.124085 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_symbol.a932e30f82
[0m12:09:38.126256 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_bollinger_symbol.a932e30f82"
[0m12:09:38.127201 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_bollinger_symbol.a932e30f82"
[0m12:09:38.127521 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_symbol.a932e30f82: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_bollinger_symbol.a932e30f82"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.bollinger
where symbol is null



      
    ) dbt_internal_test
[0m12:09:38.127812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:38.530157 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.402 seconds
[0m12:09:38.534470 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_symbol.a932e30f82: Close
[0m12:09:38.685733 [info ] [Thread-1 (]: 5 of 28 PASS not_null_bollinger_symbol ......................................... [[32mPASS[0m in 0.57s]
[0m12:09:38.686551 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_symbol.a932e30f82
[0m12:09:38.687010 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_upper_band.e4db87564c
[0m12:09:38.687476 [info ] [Thread-1 (]: 6 of 28 START test not_null_bollinger_upper_band ............................... [RUN]
[0m12:09:38.687981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_symbol.a932e30f82, now test.stock_prediction.not_null_bollinger_upper_band.e4db87564c)
[0m12:09:38.688356 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_upper_band.e4db87564c
[0m12:09:38.693084 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_upper_band.e4db87564c"
[0m12:09:38.694123 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_upper_band.e4db87564c
[0m12:09:38.696106 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_bollinger_upper_band.e4db87564c"
[0m12:09:38.697023 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_bollinger_upper_band.e4db87564c"
[0m12:09:38.697352 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_upper_band.e4db87564c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_bollinger_upper_band.e4db87564c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select upper_band
from dev.analytics.bollinger
where upper_band is null



      
    ) dbt_internal_test
[0m12:09:38.697652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:39.168966 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.471 seconds
[0m12:09:39.173819 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_upper_band.e4db87564c: Close
[0m12:09:39.298722 [info ] [Thread-1 (]: 6 of 28 PASS not_null_bollinger_upper_band ..................................... [[32mPASS[0m in 0.61s]
[0m12:09:39.299608 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_upper_band.e4db87564c
[0m12:09:39.300145 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m12:09:39.300704 [info ] [Thread-1 (]: 7 of 28 START test not_null_moving_average_close ............................... [RUN]
[0m12:09:39.301352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_upper_band.e4db87564c, now test.stock_prediction.not_null_moving_average_close.6d037dd588)
[0m12:09:39.301838 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m12:09:39.307039 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_close.6d037dd588"
[0m12:09:39.308162 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m12:09:39.310328 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_close.6d037dd588"
[0m12:09:39.311262 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_close.6d037dd588"
[0m12:09:39.311585 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_close.6d037dd588: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_close.6d037dd588"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.moving_average
where close is null



      
    ) dbt_internal_test
[0m12:09:39.311878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:39.772213 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.460 seconds
[0m12:09:39.777595 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_close.6d037dd588: Close
[0m12:09:39.893899 [info ] [Thread-1 (]: 7 of 28 PASS not_null_moving_average_close ..................................... [[32mPASS[0m in 0.59s]
[0m12:09:39.895224 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m12:09:39.895886 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m12:09:39.896484 [info ] [Thread-1 (]: 8 of 28 START test not_null_moving_average_date ................................ [RUN]
[0m12:09:39.897184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_close.6d037dd588, now test.stock_prediction.not_null_moving_average_date.3ad00158b5)
[0m12:09:39.897651 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m12:09:39.902793 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_date.3ad00158b5"
[0m12:09:39.903872 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m12:09:39.905905 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_date.3ad00158b5"
[0m12:09:39.906811 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_date.3ad00158b5"
[0m12:09:39.907140 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_date.3ad00158b5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_date.3ad00158b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.moving_average
where date is null



      
    ) dbt_internal_test
[0m12:09:39.907436 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:40.318971 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.411 seconds
[0m12:09:40.321827 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_date.3ad00158b5: Close
[0m12:09:40.439541 [info ] [Thread-1 (]: 8 of 28 PASS not_null_moving_average_date ...................................... [[32mPASS[0m in 0.54s]
[0m12:09:40.440551 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m12:09:40.441238 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m12:09:40.441784 [info ] [Thread-1 (]: 9 of 28 START test not_null_moving_average_moving_avg_20d ...................... [RUN]
[0m12:09:40.442056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_date.3ad00158b5, now test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22)
[0m12:09:40.442232 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m12:09:40.444211 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m12:09:40.444652 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m12:09:40.445550 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m12:09:40.445995 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m12:09:40.446151 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg_20d
from dev.analytics.moving_average
where moving_avg_20d is null



      
    ) dbt_internal_test
[0m12:09:40.446292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:40.945527 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.499 seconds
[0m12:09:40.948779 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22: Close
[0m12:09:41.080457 [info ] [Thread-1 (]: 9 of 28 PASS not_null_moving_average_moving_avg_20d ............................ [[32mPASS[0m in 0.64s]
[0m12:09:41.081856 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m12:09:41.082343 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m12:09:41.082770 [info ] [Thread-1 (]: 10 of 28 START test not_null_moving_average_moving_avg_5d ...................... [RUN]
[0m12:09:41.083263 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22, now test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca)
[0m12:09:41.083614 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m12:09:41.087350 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m12:09:41.088032 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m12:09:41.089691 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m12:09:41.090475 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m12:09:41.090782 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg_5d
from dev.analytics.moving_average
where moving_avg_5d is null



      
    ) dbt_internal_test
[0m12:09:41.091047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:41.502637 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.411 seconds
[0m12:09:41.506128 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca: Close
[0m12:09:41.664857 [info ] [Thread-1 (]: 10 of 28 PASS not_null_moving_average_moving_avg_5d ............................ [[32mPASS[0m in 0.58s]
[0m12:09:41.666032 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m12:09:41.666663 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m12:09:41.667214 [info ] [Thread-1 (]: 11 of 28 START test not_null_moving_average_symbol ............................. [RUN]
[0m12:09:41.667801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca, now test.stock_prediction.not_null_moving_average_symbol.75a6f7473c)
[0m12:09:41.668249 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m12:09:41.673435 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"
[0m12:09:41.674661 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m12:09:41.676731 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"
[0m12:09:41.677674 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"
[0m12:09:41.678002 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_symbol.75a6f7473c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.moving_average
where symbol is null



      
    ) dbt_internal_test
[0m12:09:41.678295 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:42.070470 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.384 seconds
[0m12:09:42.073474 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_symbol.75a6f7473c: Close
[0m12:09:42.197645 [info ] [Thread-1 (]: 11 of 28 PASS not_null_moving_average_symbol ................................... [[32mPASS[0m in 0.53s]
[0m12:09:42.199205 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m12:09:42.200651 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_price_momentum_close.1bd03322c7
[0m12:09:42.201481 [info ] [Thread-1 (]: 12 of 28 START test not_null_price_momentum_close .............................. [RUN]
[0m12:09:42.205426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_symbol.75a6f7473c, now test.stock_prediction.not_null_price_momentum_close.1bd03322c7)
[0m12:09:42.206252 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_price_momentum_close.1bd03322c7
[0m12:09:42.217447 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_price_momentum_close.1bd03322c7"
[0m12:09:42.218007 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_price_momentum_close.1bd03322c7
[0m12:09:42.220349 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_price_momentum_close.1bd03322c7"
[0m12:09:42.221527 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_price_momentum_close.1bd03322c7"
[0m12:09:42.221738 [debug] [Thread-1 (]: On test.stock_prediction.not_null_price_momentum_close.1bd03322c7: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_price_momentum_close.1bd03322c7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.price_momentum
where close is null



      
    ) dbt_internal_test
[0m12:09:42.221904 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:42.776860 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.547 seconds
[0m12:09:42.779770 [debug] [Thread-1 (]: On test.stock_prediction.not_null_price_momentum_close.1bd03322c7: Close
[0m12:09:42.948422 [info ] [Thread-1 (]: 12 of 28 PASS not_null_price_momentum_close .................................... [[32mPASS[0m in 0.74s]
[0m12:09:42.950202 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_price_momentum_close.1bd03322c7
[0m12:09:42.950840 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_price_momentum_date.d7330e89cb
[0m12:09:42.951436 [info ] [Thread-1 (]: 13 of 28 START test not_null_price_momentum_date ............................... [RUN]
[0m12:09:42.952820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_price_momentum_close.1bd03322c7, now test.stock_prediction.not_null_price_momentum_date.d7330e89cb)
[0m12:09:42.953381 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_price_momentum_date.d7330e89cb
[0m12:09:42.964695 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_price_momentum_date.d7330e89cb"
[0m12:09:42.966143 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_price_momentum_date.d7330e89cb
[0m12:09:42.968846 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_price_momentum_date.d7330e89cb"
[0m12:09:42.969959 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_price_momentum_date.d7330e89cb"
[0m12:09:42.970353 [debug] [Thread-1 (]: On test.stock_prediction.not_null_price_momentum_date.d7330e89cb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_price_momentum_date.d7330e89cb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.price_momentum
where date is null



      
    ) dbt_internal_test
[0m12:09:42.970701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:43.398559 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.427 seconds
[0m12:09:43.408278 [debug] [Thread-1 (]: On test.stock_prediction.not_null_price_momentum_date.d7330e89cb: Close
[0m12:09:43.554165 [info ] [Thread-1 (]: 13 of 28 PASS not_null_price_momentum_date ..................................... [[32mPASS[0m in 0.60s]
[0m12:09:43.556752 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_price_momentum_date.d7330e89cb
[0m12:09:43.557407 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_price_momentum_momentum_10d.3ed05a427e
[0m12:09:43.557973 [info ] [Thread-1 (]: 14 of 28 START test not_null_price_momentum_momentum_10d ....................... [RUN]
[0m12:09:43.558615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_price_momentum_date.d7330e89cb, now test.stock_prediction.not_null_price_momentum_momentum_10d.3ed05a427e)
[0m12:09:43.559060 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_price_momentum_momentum_10d.3ed05a427e
[0m12:09:43.572159 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_price_momentum_momentum_10d.3ed05a427e"
[0m12:09:43.573603 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_price_momentum_momentum_10d.3ed05a427e
[0m12:09:43.576635 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_price_momentum_momentum_10d.3ed05a427e"
[0m12:09:43.577841 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_price_momentum_momentum_10d.3ed05a427e"
[0m12:09:43.578300 [debug] [Thread-1 (]: On test.stock_prediction.not_null_price_momentum_momentum_10d.3ed05a427e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_price_momentum_momentum_10d.3ed05a427e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select momentum_10d
from dev.analytics.price_momentum
where momentum_10d is null



      
    ) dbt_internal_test
[0m12:09:43.579205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:44.096494 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.516 seconds
[0m12:09:44.103058 [debug] [Thread-1 (]: On test.stock_prediction.not_null_price_momentum_momentum_10d.3ed05a427e: Close
[0m12:09:44.242221 [info ] [Thread-1 (]: 14 of 28 PASS not_null_price_momentum_momentum_10d ............................. [[32mPASS[0m in 0.68s]
[0m12:09:44.244439 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_price_momentum_momentum_10d.3ed05a427e
[0m12:09:44.245336 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_price_momentum_symbol.2b4dd3b3ec
[0m12:09:44.246734 [info ] [Thread-1 (]: 15 of 28 START test not_null_price_momentum_symbol ............................. [RUN]
[0m12:09:44.248052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_price_momentum_momentum_10d.3ed05a427e, now test.stock_prediction.not_null_price_momentum_symbol.2b4dd3b3ec)
[0m12:09:44.248722 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_price_momentum_symbol.2b4dd3b3ec
[0m12:09:44.259298 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_price_momentum_symbol.2b4dd3b3ec"
[0m12:09:44.260801 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_price_momentum_symbol.2b4dd3b3ec
[0m12:09:44.263767 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_price_momentum_symbol.2b4dd3b3ec"
[0m12:09:44.265072 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_price_momentum_symbol.2b4dd3b3ec"
[0m12:09:44.265556 [debug] [Thread-1 (]: On test.stock_prediction.not_null_price_momentum_symbol.2b4dd3b3ec: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_price_momentum_symbol.2b4dd3b3ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.price_momentum
where symbol is null



      
    ) dbt_internal_test
[0m12:09:44.265924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:44.754173 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.488 seconds
[0m12:09:44.765992 [debug] [Thread-1 (]: On test.stock_prediction.not_null_price_momentum_symbol.2b4dd3b3ec: Close
[0m12:09:44.907490 [info ] [Thread-1 (]: 15 of 28 PASS not_null_price_momentum_symbol ................................... [[32mPASS[0m in 0.66s]
[0m12:09:44.909758 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_price_momentum_symbol.2b4dd3b3ec
[0m12:09:44.910645 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m12:09:44.911484 [info ] [Thread-1 (]: 16 of 28 START test not_null_rsi_calculation_avg_gain .......................... [RUN]
[0m12:09:44.912411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_price_momentum_symbol.2b4dd3b3ec, now test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42)
[0m12:09:44.913067 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m12:09:44.922344 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m12:09:44.923574 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m12:09:44.926692 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m12:09:44.927986 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m12:09:44.928489 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_gain
from dev.analytics.rsi_calculation
where avg_gain is null



      
    ) dbt_internal_test
[0m12:09:44.928925 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:45.478177 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.549 seconds
[0m12:09:45.487279 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42: Close
[0m12:09:45.626461 [info ] [Thread-1 (]: 16 of 28 PASS not_null_rsi_calculation_avg_gain ................................ [[32mPASS[0m in 0.71s]
[0m12:09:45.629026 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m12:09:45.638976 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m12:09:45.640189 [info ] [Thread-1 (]: 17 of 28 START test not_null_rsi_calculation_avg_loss .......................... [RUN]
[0m12:09:45.640546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42, now test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19)
[0m12:09:45.640782 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m12:09:45.645493 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m12:09:45.647023 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m12:09:45.649690 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m12:09:45.650654 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m12:09:45.650883 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_loss
from dev.analytics.rsi_calculation
where avg_loss is null



      
    ) dbt_internal_test
[0m12:09:45.651084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:46.157716 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.506 seconds
[0m12:09:46.167224 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19: Close
[0m12:09:46.301371 [info ] [Thread-1 (]: 17 of 28 PASS not_null_rsi_calculation_avg_loss ................................ [[32mPASS[0m in 0.66s]
[0m12:09:46.303636 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m12:09:46.304673 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m12:09:46.305369 [info ] [Thread-1 (]: 18 of 28 START test not_null_rsi_calculation_close ............................. [RUN]
[0m12:09:46.306626 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19, now test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d)
[0m12:09:46.307338 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m12:09:46.318463 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"
[0m12:09:46.320053 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m12:09:46.322521 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"
[0m12:09:46.323568 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"
[0m12:09:46.323958 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.rsi_calculation
where close is null



      
    ) dbt_internal_test
[0m12:09:46.324301 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:46.862559 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.538 seconds
[0m12:09:46.868626 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d: Close
[0m12:09:46.988417 [info ] [Thread-1 (]: 18 of 28 PASS not_null_rsi_calculation_close ................................... [[32mPASS[0m in 0.68s]
[0m12:09:46.989905 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m12:09:46.990533 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m12:09:46.991008 [info ] [Thread-1 (]: 19 of 28 START test not_null_rsi_calculation_date .............................. [RUN]
[0m12:09:46.991700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d, now test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76)
[0m12:09:46.992449 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m12:09:47.010898 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"
[0m12:09:47.012417 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m12:09:47.015217 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"
[0m12:09:47.016468 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"
[0m12:09:47.017048 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.rsi_calculation
where date is null



      
    ) dbt_internal_test
[0m12:09:47.017493 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:47.444464 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.426 seconds
[0m12:09:47.453706 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76: Close
[0m12:09:47.612759 [info ] [Thread-1 (]: 19 of 28 PASS not_null_rsi_calculation_date .................................... [[32mPASS[0m in 0.62s]
[0m12:09:47.614500 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m12:09:47.615318 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m12:09:47.615848 [info ] [Thread-1 (]: 20 of 28 START test not_null_rsi_calculation_rsi_14d ........................... [RUN]
[0m12:09:47.617322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76, now test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8)
[0m12:09:47.619659 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m12:09:47.629058 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m12:09:47.630407 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m12:09:47.633185 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m12:09:47.634256 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m12:09:47.634647 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from dev.analytics.rsi_calculation
where rsi_14d is null



      
    ) dbt_internal_test
[0m12:09:47.635004 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:48.107355 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.471 seconds
[0m12:09:48.115215 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8: Close
[0m12:09:48.273697 [info ] [Thread-1 (]: 20 of 28 PASS not_null_rsi_calculation_rsi_14d ................................. [[32mPASS[0m in 0.66s]
[0m12:09:48.276170 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m12:09:48.277152 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m12:09:48.277945 [info ] [Thread-1 (]: 21 of 28 START test not_null_rsi_calculation_symbol ............................ [RUN]
[0m12:09:48.279426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8, now test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84)
[0m12:09:48.280208 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m12:09:48.291593 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m12:09:48.293719 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m12:09:48.297205 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m12:09:48.298938 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m12:09:48.299441 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.rsi_calculation
where symbol is null



      
    ) dbt_internal_test
[0m12:09:48.299883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:48.793001 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.492 seconds
[0m12:09:48.800958 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84: Close
[0m12:09:48.941136 [info ] [Thread-1 (]: 21 of 28 PASS not_null_rsi_calculation_symbol .................................. [[32mPASS[0m in 0.66s]
[0m12:09:48.942064 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m12:09:48.942518 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m12:09:48.942981 [info ] [Thread-1 (]: 22 of 28 START test not_null_stock_prices_close ................................ [RUN]
[0m12:09:48.943519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84, now test.stock_prediction.not_null_stock_prices_close.d7e232e1ba)
[0m12:09:48.944152 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m12:09:48.949366 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"
[0m12:09:48.950611 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m12:09:48.953488 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"
[0m12:09:48.955967 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"
[0m12:09:48.956423 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_close.d7e232e1ba: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.stock_prices
where close is null



      
    ) dbt_internal_test
[0m12:09:48.956740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:49.420008 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.463 seconds
[0m12:09:49.426974 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_close.d7e232e1ba: Close
[0m12:09:49.547060 [info ] [Thread-1 (]: 22 of 28 PASS not_null_stock_prices_close ...................................... [[32mPASS[0m in 0.60s]
[0m12:09:49.548644 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m12:09:49.549477 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m12:09:49.550278 [info ] [Thread-1 (]: 23 of 28 START test not_null_stock_prices_date ................................. [RUN]
[0m12:09:49.551004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_close.d7e232e1ba, now test.stock_prediction.not_null_stock_prices_date.98a7527501)
[0m12:09:49.551544 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m12:09:49.560843 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_date.98a7527501"
[0m12:09:49.562365 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m12:09:49.565402 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_date.98a7527501"
[0m12:09:49.566604 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_date.98a7527501"
[0m12:09:49.566987 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_date.98a7527501: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_date.98a7527501"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.stock_prices
where date is null



      
    ) dbt_internal_test
[0m12:09:49.567337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:50.032995 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.465 seconds
[0m12:09:50.039845 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_date.98a7527501: Close
[0m12:09:50.169279 [info ] [Thread-1 (]: 23 of 28 PASS not_null_stock_prices_date ....................................... [[32mPASS[0m in 0.62s]
[0m12:09:50.171374 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m12:09:50.172563 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m12:09:50.173628 [info ] [Thread-1 (]: 24 of 28 START test not_null_stock_prices_high ................................. [RUN]
[0m12:09:50.174665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_date.98a7527501, now test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc)
[0m12:09:50.175300 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m12:09:50.193869 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"
[0m12:09:50.195840 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m12:09:50.199472 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"
[0m12:09:50.201110 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"
[0m12:09:50.201528 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select high
from dev.analytics.stock_prices
where high is null



      
    ) dbt_internal_test
[0m12:09:50.201888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:50.690601 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.488 seconds
[0m12:09:50.697617 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc: Close
[0m12:09:50.829102 [info ] [Thread-1 (]: 24 of 28 PASS not_null_stock_prices_high ....................................... [[32mPASS[0m in 0.65s]
[0m12:09:50.831280 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m12:09:50.832251 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m12:09:50.833341 [info ] [Thread-1 (]: 25 of 28 START test not_null_stock_prices_low .................................. [RUN]
[0m12:09:50.834269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc, now test.stock_prediction.not_null_stock_prices_low.e65294ca15)
[0m12:09:50.835135 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m12:09:50.843522 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_low.e65294ca15"
[0m12:09:50.844949 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m12:09:50.847544 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_low.e65294ca15"
[0m12:09:50.848542 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_low.e65294ca15"
[0m12:09:50.848884 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_low.e65294ca15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_low.e65294ca15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select low
from dev.analytics.stock_prices
where low is null



      
    ) dbt_internal_test
[0m12:09:50.849186 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:51.445452 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.596 seconds
[0m12:09:51.452045 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_low.e65294ca15: Close
[0m12:09:51.609840 [info ] [Thread-1 (]: 25 of 28 PASS not_null_stock_prices_low ........................................ [[32mPASS[0m in 0.77s]
[0m12:09:51.612316 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m12:09:51.613487 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m12:09:51.614530 [info ] [Thread-1 (]: 26 of 28 START test not_null_stock_prices_open ................................. [RUN]
[0m12:09:51.615589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_low.e65294ca15, now test.stock_prediction.not_null_stock_prices_open.e09b13f215)
[0m12:09:51.616223 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m12:09:51.625534 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_open.e09b13f215"
[0m12:09:51.627840 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m12:09:51.631241 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_open.e09b13f215"
[0m12:09:51.632710 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_open.e09b13f215"
[0m12:09:51.633214 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_open.e09b13f215: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_open.e09b13f215"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from dev.analytics.stock_prices
where open is null



      
    ) dbt_internal_test
[0m12:09:51.633664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:52.119307 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.485 seconds
[0m12:09:52.125961 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_open.e09b13f215: Close
[0m12:09:52.272175 [info ] [Thread-1 (]: 26 of 28 PASS not_null_stock_prices_open ....................................... [[32mPASS[0m in 0.66s]
[0m12:09:52.273471 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m12:09:52.274084 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m12:09:52.274628 [info ] [Thread-1 (]: 27 of 28 START test not_null_stock_prices_symbol ............................... [RUN]
[0m12:09:52.275918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_open.e09b13f215, now test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8)
[0m12:09:52.276424 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m12:09:52.285570 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"
[0m12:09:52.288036 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m12:09:52.291401 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"
[0m12:09:52.292858 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"
[0m12:09:52.293356 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.stock_prices
where symbol is null



      
    ) dbt_internal_test
[0m12:09:52.293792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:52.812072 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.518 seconds
[0m12:09:52.823214 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8: Close
[0m12:09:52.946777 [info ] [Thread-1 (]: 27 of 28 PASS not_null_stock_prices_symbol ..................................... [[32mPASS[0m in 0.67s]
[0m12:09:52.949110 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m12:09:52.950405 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m12:09:52.951493 [info ] [Thread-1 (]: 28 of 28 START test not_null_stock_prices_volume ............................... [RUN]
[0m12:09:52.952441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8, now test.stock_prediction.not_null_stock_prices_volume.71420bc956)
[0m12:09:52.953084 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m12:09:52.962077 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_volume.71420bc956"
[0m12:09:52.964288 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m12:09:52.967417 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_volume.71420bc956"
[0m12:09:52.968960 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_volume.71420bc956"
[0m12:09:52.969435 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_volume.71420bc956: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_volume.71420bc956"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume
from dev.analytics.stock_prices
where volume is null



      
    ) dbt_internal_test
[0m12:09:52.969864 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:53.495440 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.525 seconds
[0m12:09:53.501437 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_volume.71420bc956: Close
[0m12:09:53.642472 [info ] [Thread-1 (]: 28 of 28 PASS not_null_stock_prices_volume ..................................... [[32mPASS[0m in 0.69s]
[0m12:09:53.644366 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m12:09:53.647681 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:09:53.648274 [debug] [MainThread]: Connection 'test.stock_prediction.not_null_stock_prices_volume.71420bc956' was properly closed.
[0m12:09:53.648916 [info ] [MainThread]: 
[0m12:09:53.649524 [info ] [MainThread]: Finished running 28 data tests in 0 hours 0 minutes and 19.35 seconds (19.35s).
[0m12:09:53.657179 [debug] [MainThread]: Command end result
[0m12:09:53.695766 [info ] [MainThread]: 
[0m12:09:53.696105 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:09:53.696254 [info ] [MainThread]: 
[0m12:09:53.696394 [info ] [MainThread]: Done. PASS=28 WARN=0 ERROR=0 SKIP=0 TOTAL=28
[0m12:09:53.697895 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 19.770212, "process_user_time": 3.663383, "process_kernel_time": 0.444824, "process_mem_max_rss": "140328960", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:09:53.698182 [debug] [MainThread]: Command `dbt test` succeeded at 12:09:53.698135 after 19.77 seconds
[0m12:09:53.698377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a053050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c532570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5322b0>]}
[0m12:09:53.698552 [debug] [MainThread]: Flushing usage events
[0m12:11:19.500568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e3e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10478fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10478fd90>]}


============================== 12:11:19.502664 | 4818119a-0a0a-4947-8b2e-68c6b27bacf5 ==============================
[0m12:11:19.502664 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:11:19.502959 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'version_check': 'True', 'profiles_dir': '/Users/adi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m12:11:19.660459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4818119a-0a0a-4947-8b2e-68c6b27bacf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053f9a70>]}
[0m12:11:19.685394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4818119a-0a0a-4947-8b2e-68c6b27bacf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052e4490>]}
[0m12:11:19.685872 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:11:19.695156 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:11:19.764818 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m12:11:19.765172 [debug] [MainThread]: Partial parsing: added file: stock_prediction://snapshots/snapshot_price_momentum.sql
[0m12:11:19.765319 [debug] [MainThread]: Partial parsing: added file: stock_prediction://snapshots/snapshot_bollinger.sql
[0m12:11:19.891658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4818119a-0a0a-4947-8b2e-68c6b27bacf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105679250>]}
[0m12:11:19.983025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4818119a-0a0a-4947-8b2e-68c6b27bacf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047ecb90>]}
[0m12:11:19.983285 [info ] [MainThread]: Found 5 models, 4 snapshots, 28 data tests, 2 sources, 459 macros
[0m12:11:19.983436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4818119a-0a0a-4947-8b2e-68c6b27bacf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105300750>]}
[0m12:11:19.984517 [info ] [MainThread]: 
[0m12:11:19.984773 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:11:19.986796 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m12:11:19.992875 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m12:11:19.993028 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m12:11:19.993145 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:11:20.680848 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.687 seconds
[0m12:11:20.684813 [debug] [ThreadPool]: On list_dev: Close
[0m12:11:20.825079 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m12:11:20.835163 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m12:11:20.835584 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m12:11:20.835851 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:11:21.322340 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.486 seconds
[0m12:11:21.325445 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m12:11:21.440665 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m12:11:21.444458 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m12:11:21.444797 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m12:11:21.445076 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:11:22.145238 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.700 seconds
[0m12:11:22.148739 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m12:11:22.267066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4818119a-0a0a-4947-8b2e-68c6b27bacf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058e32b0>]}
[0m12:11:22.267931 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:11:22.268382 [info ] [MainThread]: 
[0m12:11:22.271514 [debug] [Thread-1 (]: Began running node snapshot.stock_prediction.snapshot_bollinger
[0m12:11:22.272118 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshot.snapshot_bollinger .............................. [RUN]
[0m12:11:22.272573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now snapshot.stock_prediction.snapshot_bollinger)
[0m12:11:22.272926 [debug] [Thread-1 (]: Began compiling node snapshot.stock_prediction.snapshot_bollinger
[0m12:11:22.282462 [debug] [Thread-1 (]: Began executing node snapshot.stock_prediction.snapshot_bollinger
[0m12:11:22.332368 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_bollinger"
[0m12:11:22.332667 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id,
        date as dbt_updated_at,
        date as dbt_valid_from,
        
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to

    from (
        



SELECT * FROM dev.analytics.bollinger

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m12:11:22.332849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:22.793280 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.460 seconds
[0m12:11:22.803741 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_bollinger"
[0m12:11:22.804325 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m12:11:22.889659 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.085 seconds
[0m12:11:22.891262 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_prediction.snapshot_bollinger"
[0m12:11:22.893088 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_bollinger"
[0m12:11:22.893447 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
create or replace transient table dev.snapshot.snapshot_bollinger
         as
        (
    

    select *,
        md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id,
        date as dbt_updated_at,
        date as dbt_valid_from,
        
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to

    from (
        



SELECT * FROM dev.analytics.bollinger

    ) sbq



        );
[0m12:11:23.556659 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.662 seconds
[0m12:11:23.580934 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_bollinger: Close
[0m12:11:23.697858 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4818119a-0a0a-4947-8b2e-68c6b27bacf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058a7350>]}
[0m12:11:23.699734 [info ] [Thread-1 (]: 1 of 4 OK snapshotted snapshot.snapshot_bollinger .............................. [[32mSUCCESS 1[0m in 1.42s]
[0m12:11:23.700777 [debug] [Thread-1 (]: Finished running node snapshot.stock_prediction.snapshot_bollinger
[0m12:11:23.701346 [debug] [Thread-1 (]: Began running node snapshot.stock_prediction.snapshot_moving_avg
[0m12:11:23.702035 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshot.snapshot_moving_avg ............................. [RUN]
[0m12:11:23.702587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_prediction.snapshot_bollinger, now snapshot.stock_prediction.snapshot_moving_avg)
[0m12:11:23.702965 [debug] [Thread-1 (]: Began compiling node snapshot.stock_prediction.snapshot_moving_avg
[0m12:11:23.707032 [debug] [Thread-1 (]: Began executing node snapshot.stock_prediction.snapshot_moving_avg
[0m12:11:23.715864 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:11:23.716216 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
[0m12:11:23.716494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:24.124640 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.408 seconds
[0m12:11:24.153040 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:11:24.153536 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.moving_average


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m12:11:24.886494 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.732 seconds
[0m12:11:24.890593 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:11:24.891037 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
[0m12:11:24.990206 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.098 seconds
[0m12:11:24.995871 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:11:24.996307 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
[0m12:11:25.111564 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.115 seconds
[0m12:11:25.117646 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:11:25.117995 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
[0m12:11:25.222704 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.104 seconds
[0m12:11:25.228526 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:11:25.228996 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
[0m12:11:25.320936 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.091 seconds
[0m12:11:25.332579 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:11:25.333010 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
[0m12:11:25.412632 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.079 seconds
[0m12:11:25.428701 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:11:25.429218 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.moving_average


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m12:11:25.580735 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.151 seconds
[0m12:11:25.584348 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:11:25.584839 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m12:11:25.657725 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.072 seconds
[0m12:11:25.659313 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:11:25.662355 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:11:25.662857 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
BEGIN
[0m12:11:25.762790 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.099 seconds
[0m12:11:25.764224 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:11:25.764860 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "MOVING_AVG_5D", "MOVING_AVG_20D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "MOVING_AVG_5D", "MOVING_AVG_20D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m12:11:26.222427 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.456 seconds
[0m12:11:26.224368 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:11:26.225252 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
COMMIT
[0m12:11:26.630132 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.402 seconds
[0m12:11:26.636107 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: Close
[0m12:11:26.771629 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4818119a-0a0a-4947-8b2e-68c6b27bacf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b6aba0>]}
[0m12:11:26.773685 [info ] [Thread-1 (]: 2 of 4 OK snapshotted snapshot.snapshot_moving_avg ............................. [[32mSUCCESS 0[0m in 3.07s]
[0m12:11:26.774464 [debug] [Thread-1 (]: Finished running node snapshot.stock_prediction.snapshot_moving_avg
[0m12:11:26.774954 [debug] [Thread-1 (]: Began running node snapshot.stock_prediction.snapshot_price_momentum
[0m12:11:26.775605 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshot.snapshot_price_momentum ......................... [RUN]
[0m12:11:26.776200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_prediction.snapshot_moving_avg, now snapshot.stock_prediction.snapshot_price_momentum)
[0m12:11:26.776607 [debug] [Thread-1 (]: Began compiling node snapshot.stock_prediction.snapshot_price_momentum
[0m12:11:26.780389 [debug] [Thread-1 (]: Began executing node snapshot.stock_prediction.snapshot_price_momentum
[0m12:11:26.784680 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_price_momentum"
[0m12:11:26.785055 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_price_momentum"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_price_momentum"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id,
        date as dbt_updated_at,
        date as dbt_valid_from,
        
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to

    from (
        



SELECT * FROM dev.analytics.price_momentum

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m12:11:26.785396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:27.367126 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.581 seconds
[0m12:11:27.371372 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_price_momentum"
[0m12:11:27.372355 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_price_momentum"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_price_momentum"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m12:11:27.457757 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.085 seconds
[0m12:11:27.459428 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_prediction.snapshot_price_momentum"
[0m12:11:27.462145 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_price_momentum"
[0m12:11:27.462866 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_price_momentum"} */
create or replace transient table dev.snapshot.snapshot_price_momentum
         as
        (
    

    select *,
        md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id,
        date as dbt_updated_at,
        date as dbt_valid_from,
        
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to

    from (
        



SELECT * FROM dev.analytics.price_momentum

    ) sbq



        );
[0m12:11:28.160230 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.696 seconds
[0m12:11:28.164721 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_price_momentum: Close
[0m12:11:28.291533 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4818119a-0a0a-4947-8b2e-68c6b27bacf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102dd20d0>]}
[0m12:11:28.293325 [info ] [Thread-1 (]: 3 of 4 OK snapshotted snapshot.snapshot_price_momentum ......................... [[32mSUCCESS 1[0m in 1.52s]
[0m12:11:28.294267 [debug] [Thread-1 (]: Finished running node snapshot.stock_prediction.snapshot_price_momentum
[0m12:11:28.294833 [debug] [Thread-1 (]: Began running node snapshot.stock_prediction.snapshot_rsi
[0m12:11:28.295450 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshot.snapshot_rsi .................................... [RUN]
[0m12:11:28.295992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_prediction.snapshot_price_momentum, now snapshot.stock_prediction.snapshot_rsi)
[0m12:11:28.296360 [debug] [Thread-1 (]: Began compiling node snapshot.stock_prediction.snapshot_rsi
[0m12:11:28.300204 [debug] [Thread-1 (]: Began executing node snapshot.stock_prediction.snapshot_rsi
[0m12:11:28.304762 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:11:28.305060 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m12:11:28.305323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:28.736359 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.430 seconds
[0m12:11:28.746949 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:11:28.747669 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.rsi_calculation


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m12:11:29.700300 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.952 seconds
[0m12:11:29.705241 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:11:29.705700 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m12:11:29.782914 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.077 seconds
[0m12:11:29.789107 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:11:29.789685 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m12:11:29.872405 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.082 seconds
[0m12:11:29.878708 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:11:29.879521 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m12:11:29.963047 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.083 seconds
[0m12:11:29.968505 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:11:29.968986 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m12:11:30.049794 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.080 seconds
[0m12:11:30.056519 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:11:30.056963 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m12:11:30.133488 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.076 seconds
[0m12:11:30.140546 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:11:30.141122 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.rsi_calculation


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m12:11:30.356879 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.215 seconds
[0m12:11:30.360642 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:11:30.361443 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m12:11:30.439858 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.078 seconds
[0m12:11:30.441587 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_prediction.snapshot_rsi"
[0m12:11:30.444097 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:11:30.444590 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
BEGIN
[0m12:11:30.570896 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.126 seconds
[0m12:11:30.572277 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:11:30.572744 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_RSI" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "AVG_GAIN", "AVG_LOSS", "RSI_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "AVG_GAIN", "AVG_LOSS", "RSI_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m12:11:31.215311 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.642 seconds
[0m12:11:31.216877 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:11:31.217393 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
COMMIT
[0m12:11:31.539632 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.321 seconds
[0m12:11:31.544530 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: Close
[0m12:11:31.670697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4818119a-0a0a-4947-8b2e-68c6b27bacf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104777b50>]}
[0m12:11:31.671810 [info ] [Thread-1 (]: 4 of 4 OK snapshotted snapshot.snapshot_rsi .................................... [[32mSUCCESS 0[0m in 3.37s]
[0m12:11:31.672600 [debug] [Thread-1 (]: Finished running node snapshot.stock_prediction.snapshot_rsi
[0m12:11:31.674412 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:11:31.674780 [debug] [MainThread]: Connection 'snapshot.stock_prediction.snapshot_rsi' was properly closed.
[0m12:11:31.675157 [info ] [MainThread]: 
[0m12:11:31.675491 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 11.69 seconds (11.69s).
[0m12:11:31.676586 [debug] [MainThread]: Command end result
[0m12:11:31.707828 [info ] [MainThread]: 
[0m12:11:31.708119 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:11:31.708387 [info ] [MainThread]: 
[0m12:11:31.708763 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m12:11:31.710062 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 12.242454, "process_user_time": 1.90959, "process_kernel_time": 0.222387, "process_mem_max_rss": "139231232", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:11:31.710407 [debug] [MainThread]: Command `dbt snapshot` succeeded at 12:11:31.710347 after 12.24 seconds
[0m12:11:31.710640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047c9630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100d50210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103167ad0>]}
[0m12:11:31.710847 [debug] [MainThread]: Flushing usage events
[0m12:17:36.276262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e4e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10679fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10679fd90>]}


============================== 12:17:36.278893 | c3b188b0-2680-481c-a5ec-56c14a4159d3 ==============================
[0m12:17:36.278893 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:17:36.279192 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:17:36.328599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3b188b0-2680-481c-a5ec-56c14a4159d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10563e8b0>]}
[0m12:17:36.341985 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.100549415, "process_user_time": 0.596336, "process_kernel_time": 0.116761, "process_mem_max_rss": "98140160", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:17:36.342258 [debug] [MainThread]: Command `dbt clean` succeeded at 12:17:36.342207 after 0.10 seconds
[0m12:17:36.342419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068e2470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068e2580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10654e150>]}
[0m12:17:36.342564 [debug] [MainThread]: Flushing usage events
[0m12:17:40.997685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10494e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070efed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070efd90>]}


============================== 12:17:40.999820 | 8e8e42c4-9d0b-43c0-996d-ee41bfa76d59 ==============================
[0m12:17:40.999820 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:17:41.000110 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'debug': 'False', 'profiles_dir': '/Users/adi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:17:41.215847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e8e42c4-9d0b-43c0-996d-ee41bfa76d59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080e5a70>]}
[0m12:17:41.238993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e8e42c4-9d0b-43c0-996d-ee41bfa76d59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd0490>]}
[0m12:17:41.239691 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:17:41.249561 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:17:41.250106 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:17:41.250280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8e8e42c4-9d0b-43c0-996d-ee41bfa76d59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f30050>]}
[0m12:17:41.820702 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:17:41.820988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8e8e42c4-9d0b-43c0-996d-ee41bfa76d59', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082006e0>]}
[0m12:17:41.828698 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'price_momentum' in the 'models' section of file 'models/schema.yml'
[0m12:17:41.921922 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.stock_prediction.snapshot_price_momentum' (snapshots/snapshot_avgTrueRange.sql) depends on a node named 'price_momentum' which was not found
[0m12:17:41.923047 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.95681685, "process_user_time": 1.351635, "process_kernel_time": 0.141215, "process_mem_max_rss": "128630784", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:17:41.923302 [debug] [MainThread]: Command `dbt run` failed at 12:17:41.923256 after 0.96 seconds
[0m12:17:41.923470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107013e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085c9630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108244a10>]}
[0m12:17:41.923613 [debug] [MainThread]: Flushing usage events
[0m12:18:23.747047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ea6120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067f7ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067f7d90>]}


============================== 12:18:23.749093 | d3fda826-6155-4c43-bb2c-6663ebf23619 ==============================
[0m12:18:23.749093 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:18:23.749381 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'debug': 'False', 'profiles_dir': '/Users/adi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:18:23.942803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3fda826-6155-4c43-bb2c-6663ebf23619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107461a70>]}
[0m12:18:23.965467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3fda826-6155-4c43-bb2c-6663ebf23619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10734c490>]}
[0m12:18:23.966808 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:18:23.975216 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:18:23.975745 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:18:23.975959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd3fda826-6155-4c43-bb2c-6663ebf23619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072ac050>]}
[0m12:18:24.542457 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:18:24.542738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd3fda826-6155-4c43-bb2c-6663ebf23619', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075706e0>]}
[0m12:18:24.644587 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.stock_prediction.snapshot_price_momentum' (snapshots/snapshot_avgTrueRange.sql) depends on a node named 'price_momentum' which was not found
[0m12:18:24.646730 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.9327702, "process_user_time": 1.346776, "process_kernel_time": 0.138994, "process_mem_max_rss": "129089536", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:18:24.646995 [debug] [MainThread]: Command `dbt run` failed at 12:18:24.646946 after 0.93 seconds
[0m12:18:24.647168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065dfe70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107941630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072b6b60>]}
[0m12:18:24.647318 [debug] [MainThread]: Flushing usage events
[0m12:18:46.075769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102bf2120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104543ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104543d90>]}


============================== 12:18:46.077941 | 007b7075-4e6b-402c-848f-2b547b8a1459 ==============================
[0m12:18:46.077941 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:18:46.078240 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:18:46.236131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '007b7075-4e6b-402c-848f-2b547b8a1459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051ada70>]}
[0m12:18:46.258905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '007b7075-4e6b-402c-848f-2b547b8a1459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105098490>]}
[0m12:18:46.259283 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:18:46.267224 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:18:46.267756 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:18:46.267934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '007b7075-4e6b-402c-848f-2b547b8a1459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ff8050>]}
[0m12:18:46.818498 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:18:46.818799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '007b7075-4e6b-402c-848f-2b547b8a1459', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052bc6e0>]}
[0m12:18:46.966649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '007b7075-4e6b-402c-848f-2b547b8a1459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105565c50>]}
[0m12:18:47.026133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '007b7075-4e6b-402c-848f-2b547b8a1459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052b6340>]}
[0m12:18:47.026420 [info ] [MainThread]: Found 5 models, 3 snapshots, 28 data tests, 2 sources, 459 macros
[0m12:18:47.026577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '007b7075-4e6b-402c-848f-2b547b8a1459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055cf890>]}
[0m12:18:47.027662 [info ] [MainThread]: 
[0m12:18:47.027932 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:18:47.030147 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m12:18:47.036181 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m12:18:47.036331 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m12:18:47.036458 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:47.672702 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.636 seconds
[0m12:18:47.676754 [debug] [ThreadPool]: On list_dev: Close
[0m12:18:47.817038 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_snapshot)
[0m12:18:47.828695 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m12:18:47.829061 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m12:18:47.829332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:18:48.346391 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.517 seconds
[0m12:18:48.349453 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m12:18:48.473648 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m12:18:48.477541 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m12:18:48.477914 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m12:18:48.478198 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:18:48.986767 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.508 seconds
[0m12:18:48.989659 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m12:18:49.133066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '007b7075-4e6b-402c-848f-2b547b8a1459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10592c470>]}
[0m12:18:49.134107 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:18:49.134509 [info ] [MainThread]: 
[0m12:18:49.139179 [debug] [Thread-1 (]: Began running node model.stock_prediction.stock_prices
[0m12:18:49.139835 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stock_prices ............................. [RUN]
[0m12:18:49.140297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.stock_prediction.stock_prices)
[0m12:18:49.140598 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.stock_prices
[0m12:18:49.149194 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.stock_prices"
[0m12:18:49.150424 [debug] [Thread-1 (]: Began executing node model.stock_prediction.stock_prices
[0m12:18:49.171184 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.stock_prices"
[0m12:18:49.172220 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.stock_prices"
[0m12:18:49.172465 [debug] [Thread-1 (]: On model.stock_prediction.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.stock_prices"} */
create or replace   view dev.analytics.stock_prices
  
   as (
    SELECT
    symbol,
    date,
    open,
    high,
    low,
    close,
    volume
FROM dev.raw_data.stock_prices
  );
[0m12:18:49.172663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:18:49.897738 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.725 seconds
[0m12:18:49.923819 [debug] [Thread-1 (]: On model.stock_prediction.stock_prices: Close
[0m12:18:50.038165 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '007b7075-4e6b-402c-848f-2b547b8a1459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b053b0>]}
[0m12:18:50.039147 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stock_prices ........................ [[32mSUCCESS 1[0m in 0.90s]
[0m12:18:50.039966 [debug] [Thread-1 (]: Finished running node model.stock_prediction.stock_prices
[0m12:18:50.041199 [debug] [Thread-1 (]: Began running node model.stock_prediction.avg_true_range
[0m12:18:50.041747 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.avg_true_range .......................... [RUN]
[0m12:18:50.042186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.stock_prices, now model.stock_prediction.avg_true_range)
[0m12:18:50.042535 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.avg_true_range
[0m12:18:50.045647 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.avg_true_range"
[0m12:18:50.046773 [debug] [Thread-1 (]: Began executing node model.stock_prediction.avg_true_range
[0m12:18:50.065888 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.avg_true_range"
[0m12:18:50.067073 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.avg_true_range"
[0m12:18:50.067439 [debug] [Thread-1 (]: On model.stock_prediction.avg_true_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.avg_true_range"} */
create or replace transient table dev.analytics.avg_true_range
         as
        (WITH averageTrueRanges AS (
    SELECT
        date,
        symbol,
        close,
        ABS(close - LAG(close) OVER (PARTITION BY symbol ORDER BY date)) AS true_range
    FROM dev.analytics.stock_prices
),
atr AS (
    SELECT
        date,
        symbol,
        AVG(true_range) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS atr_14d
    FROM ranges
)
SELECT date, symbol, COALESCE(atr_14d, 0) AS atr_14d
FROM atr
        );
[0m12:18:50.067736 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:18:50.540527 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b82182-0004-1d17-0001-97d30005012e
[0m12:18:50.541168 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'RANGES' does not exist or not authorized.
[0m12:18:50.541685 [debug] [Thread-1 (]: On model.stock_prediction.avg_true_range: Close
[0m12:18:50.687516 [debug] [Thread-1 (]: Database Error in model avg_true_range (models/tranformations/avg_true_range.sql)
  002003 (42S02): SQL compilation error:
  Object 'RANGES' does not exist or not authorized.
  compiled code at target/run/stock_prediction/models/tranformations/avg_true_range.sql
[0m12:18:50.688082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '007b7075-4e6b-402c-848f-2b547b8a1459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059ba3d0>]}
[0m12:18:50.688759 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model analytics.avg_true_range ................. [[31mERROR[0m in 0.65s]
[0m12:18:50.689330 [debug] [Thread-1 (]: Finished running node model.stock_prediction.avg_true_range
[0m12:18:50.689722 [debug] [Thread-1 (]: Began running node model.stock_prediction.bollinger
[0m12:18:50.690926 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.bollinger ............................... [RUN]
[0m12:18:50.691355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.avg_true_range, now model.stock_prediction.bollinger)
[0m12:18:50.691668 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.bollinger
[0m12:18:50.694598 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.bollinger"
[0m12:18:50.695312 [debug] [Thread-1 (]: Began executing node model.stock_prediction.bollinger
[0m12:18:50.698002 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.bollinger"
[0m12:18:50.699222 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.bollinger"
[0m12:18:50.699496 [debug] [Thread-1 (]: On model.stock_prediction.bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.bollinger"} */
create or replace transient table dev.analytics.bollinger
         as
        (WITH bollinger AS (
    SELECT
        symbol,
        date,
        close,
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) AS sma_20d,
        STDDEV(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) AS stddev_20d
    FROM dev.analytics.stock_prices
)

SELECT
    symbol,
    date,
    close,
    COALESCE(sma_20d, 0) AS sma_20d,
    COALESCE(sma_20d + (2 * stddev_20d), 0) AS upper_band,
    COALESCE(sma_20d - (2 * stddev_20d), 0) AS lower_band
FROM bollinger
ORDER BY symbol, date
        );
[0m12:18:50.699751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:18:51.856170 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.156 seconds
[0m12:18:51.859828 [debug] [Thread-1 (]: On model.stock_prediction.bollinger: Close
[0m12:18:51.976077 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '007b7075-4e6b-402c-848f-2b547b8a1459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ac0130>]}
[0m12:18:51.976986 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.bollinger .......................... [[32mSUCCESS 1[0m in 1.28s]
[0m12:18:51.977777 [debug] [Thread-1 (]: Finished running node model.stock_prediction.bollinger
[0m12:18:51.978331 [debug] [Thread-1 (]: Began running node model.stock_prediction.moving_average
[0m12:18:51.979031 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.moving_average .......................... [RUN]
[0m12:18:51.979690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.bollinger, now model.stock_prediction.moving_average)
[0m12:18:51.980157 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.moving_average
[0m12:18:51.983799 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.moving_average"
[0m12:18:51.984809 [debug] [Thread-1 (]: Began executing node model.stock_prediction.moving_average
[0m12:18:51.987262 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.moving_average"
[0m12:18:51.988456 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.moving_average"
[0m12:18:51.988799 [debug] [Thread-1 (]: On model.stock_prediction.moving_average: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.moving_average"} */
create or replace transient table dev.analytics.moving_average
         as
        (WITH stock_data AS (
    SELECT
        symbol,
        date,
        close
    FROM dev.analytics.stock_prices -- assuming 'stock_prices' is the name of the raw table model in dbt
)

SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
    ) AS moving_avg_5d,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
    ) AS moving_avg_20d
FROM stock_data
ORDER BY symbol, date
        );
[0m12:18:51.989110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:18:52.941049 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.951 seconds
[0m12:18:52.944991 [debug] [Thread-1 (]: On model.stock_prediction.moving_average: Close
[0m12:18:53.083490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '007b7075-4e6b-402c-848f-2b547b8a1459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106486e10>]}
[0m12:18:53.084425 [info ] [Thread-1 (]: 4 of 5 OK created sql table model analytics.moving_average ..................... [[32mSUCCESS 1[0m in 1.10s]
[0m12:18:53.085198 [debug] [Thread-1 (]: Finished running node model.stock_prediction.moving_average
[0m12:18:53.085742 [debug] [Thread-1 (]: Began running node model.stock_prediction.rsi_calculation
[0m12:18:53.086408 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.rsi_calculation ......................... [RUN]
[0m12:18:53.087019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.moving_average, now model.stock_prediction.rsi_calculation)
[0m12:18:53.087435 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.rsi_calculation
[0m12:18:53.091101 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.rsi_calculation"
[0m12:18:53.092144 [debug] [Thread-1 (]: Began executing node model.stock_prediction.rsi_calculation
[0m12:18:53.094420 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.rsi_calculation"
[0m12:18:53.096246 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.rsi_calculation"
[0m12:18:53.096632 [debug] [Thread-1 (]: On model.stock_prediction.rsi_calculation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.rsi_calculation"} */
create or replace transient table dev.analytics.rsi_calculation
         as
        (WITH stock_data AS (
    SELECT
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM dev.analytics.stock_prices
),

price_changes AS (
    SELECT
        symbol,
        date,
        close,
        CASE 
            WHEN close > prev_close THEN close - prev_close
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close < prev_close THEN prev_close - close
            ELSE 0 
        END AS loss
    FROM stock_data
),

average_gains_losses AS (
    SELECT
        symbol,
        date,
        close,
        -- Calculate the average gain over the last 14 days, including the current row
        AVG(gain) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain,
        -- Calculate the average loss over the last 14 days, including the current row
        AVG(loss) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss
    FROM price_changes
)

SELECT
    symbol,
    date,
    close,
    avg_gain,
    avg_loss,
    -- Calculate RSI, using COALESCE to set to 0 if result is NULL
    COALESCE(100 - (100 / (1 + (NULLIF(avg_gain, 0) / NULLIF(avg_loss, 0)))), 0) AS rsi_14d
FROM average_gains_losses
ORDER BY symbol, date
        );
[0m12:18:53.096995 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:18:54.149940 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.053 seconds
[0m12:18:54.151858 [debug] [Thread-1 (]: On model.stock_prediction.rsi_calculation: Close
[0m12:18:54.268825 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '007b7075-4e6b-402c-848f-2b547b8a1459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101c46db0>]}
[0m12:18:54.269891 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.rsi_calculation .................... [[32mSUCCESS 1[0m in 1.18s]
[0m12:18:54.270675 [debug] [Thread-1 (]: Finished running node model.stock_prediction.rsi_calculation
[0m12:18:54.272239 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:18:54.272570 [debug] [MainThread]: Connection 'model.stock_prediction.rsi_calculation' was properly closed.
[0m12:18:54.272963 [info ] [MainThread]: 
[0m12:18:54.273273 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 7.24 seconds (7.24s).
[0m12:18:54.274487 [debug] [MainThread]: Command end result
[0m12:18:54.308330 [info ] [MainThread]: 
[0m12:18:54.308631 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:18:54.308790 [info ] [MainThread]: 
[0m12:18:54.309003 [error] [MainThread]:   Database Error in model avg_true_range (models/tranformations/avg_true_range.sql)
  002003 (42S02): SQL compilation error:
  Object 'RANGES' does not exist or not authorized.
  compiled code at target/run/stock_prediction/models/tranformations/avg_true_range.sql
[0m12:18:54.309159 [info ] [MainThread]: 
[0m12:18:54.309315 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m12:18:54.310357 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 8.267786, "process_user_time": 2.10905, "process_kernel_time": 0.203584, "process_mem_max_rss": "142147584", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:18:54.310652 [debug] [MainThread]: Command `dbt run` failed at 12:18:54.310598 after 8.27 seconds
[0m12:18:54.310856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042ff170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064ebef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064ebd10>]}
[0m12:18:54.311053 [debug] [MainThread]: Flushing usage events
[0m12:19:08.665901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10674e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110b3ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110b3d90>]}


============================== 12:19:08.668057 | 3589dea8-6094-4d47-8dce-c44c4a007acb ==============================
[0m12:19:08.668057 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:19:08.668344 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:19:08.713860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3589dea8-6094-4d47-8dce-c44c4a007acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10718e8b0>]}
[0m12:19:08.721808 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.08710429, "process_user_time": 0.591278, "process_kernel_time": 0.089909, "process_mem_max_rss": "97861632", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:19:08.722081 [debug] [MainThread]: Command `dbt clean` succeeded at 12:19:08.722027 after 0.09 seconds
[0m12:19:08.722237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111f2470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111f2580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c9e150>]}
[0m12:19:08.722371 [debug] [MainThread]: Flushing usage events
[0m12:21:04.500566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071b2120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121b3ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121b3d90>]}


============================== 12:21:04.502871 | 1b9acce9-88ec-47b8-ad34-0286635af175 ==============================
[0m12:21:04.502871 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:21:04.503163 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/adi/.dbt', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:21:04.659705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b9acce9-88ec-47b8-ad34-0286635af175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113005a70>]}
[0m12:21:04.682051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b9acce9-88ec-47b8-ad34-0286635af175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ed0490>]}
[0m12:21:04.682426 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:21:04.690638 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:21:04.691169 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:21:04.691358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1b9acce9-88ec-47b8-ad34-0286635af175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e30050>]}
[0m12:21:05.237439 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:21:05.237715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1b9acce9-88ec-47b8-ad34-0286635af175', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131206e0>]}
[0m12:21:05.382828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b9acce9-88ec-47b8-ad34-0286635af175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135bd7f0>]}
[0m12:21:05.439758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b9acce9-88ec-47b8-ad34-0286635af175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112244d50>]}
[0m12:21:05.440038 [info ] [MainThread]: Found 5 models, 3 snapshots, 24 data tests, 2 sources, 459 macros
[0m12:21:05.440195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b9acce9-88ec-47b8-ad34-0286635af175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113627890>]}
[0m12:21:05.441361 [info ] [MainThread]: 
[0m12:21:05.441638 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:21:05.443789 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m12:21:05.449782 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m12:21:05.449929 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m12:21:05.450044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:21:06.059764 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.609 seconds
[0m12:21:06.063057 [debug] [ThreadPool]: On list_dev: Close
[0m12:21:06.195296 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_snapshot)
[0m12:21:06.207060 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m12:21:06.207425 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m12:21:06.207687 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:21:06.715257 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.507 seconds
[0m12:21:06.720137 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m12:21:06.840009 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m12:21:06.843811 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m12:21:06.844166 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m12:21:06.844446 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:21:07.334757 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.490 seconds
[0m12:21:07.338100 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m12:21:07.460018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b9acce9-88ec-47b8-ad34-0286635af175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11447c470>]}
[0m12:21:07.460898 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:21:07.461317 [info ] [MainThread]: 
[0m12:21:07.465463 [debug] [Thread-1 (]: Began running node model.stock_prediction.stock_prices
[0m12:21:07.466158 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stock_prices ............................. [RUN]
[0m12:21:07.466655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.stock_prediction.stock_prices)
[0m12:21:07.467009 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.stock_prices
[0m12:21:07.475688 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.stock_prices"
[0m12:21:07.476984 [debug] [Thread-1 (]: Began executing node model.stock_prediction.stock_prices
[0m12:21:07.498208 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.stock_prices"
[0m12:21:07.499251 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.stock_prices"
[0m12:21:07.499487 [debug] [Thread-1 (]: On model.stock_prediction.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.stock_prices"} */
create or replace   view dev.analytics.stock_prices
  
   as (
    SELECT
    symbol,
    date,
    open,
    high,
    low,
    close,
    volume
FROM dev.raw_data.stock_prices
  );
[0m12:21:07.499691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:21:08.291576 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.791 seconds
[0m12:21:08.317335 [debug] [Thread-1 (]: On model.stock_prediction.stock_prices: Close
[0m12:21:08.439615 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b9acce9-88ec-47b8-ad34-0286635af175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114b13b0>]}
[0m12:21:08.440865 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stock_prices ........................ [[32mSUCCESS 1[0m in 0.97s]
[0m12:21:08.441699 [debug] [Thread-1 (]: Finished running node model.stock_prediction.stock_prices
[0m12:21:08.442857 [debug] [Thread-1 (]: Began running node model.stock_prediction.avg_true_range
[0m12:21:08.443346 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.avg_true_range .......................... [RUN]
[0m12:21:08.443791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.stock_prices, now model.stock_prediction.avg_true_range)
[0m12:21:08.444133 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.avg_true_range
[0m12:21:08.447398 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.avg_true_range"
[0m12:21:08.448483 [debug] [Thread-1 (]: Began executing node model.stock_prediction.avg_true_range
[0m12:21:08.466829 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.avg_true_range"
[0m12:21:08.467910 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.avg_true_range"
[0m12:21:08.468175 [debug] [Thread-1 (]: On model.stock_prediction.avg_true_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.avg_true_range"} */
create or replace transient table dev.analytics.avg_true_range
         as
        (WITH averageTrueRanges AS (
    SELECT
        date,
        symbol,
        close,
        ABS(close - LAG(close) OVER (PARTITION BY symbol ORDER BY date)) AS true_range
    FROM dev.analytics.stock_prices
),
atr AS (
    SELECT
        date,
        symbol,
        AVG(true_range) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS atr_14d
    FROM averageTrueRanges
)
SELECT 
    date, 
    symbol, 
    COALESCE(atr_14d, 0) AS atr_14d
FROM atr
ORDER BY date, symbol
        );
[0m12:21:08.468413 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:21:09.438819 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.970 seconds
[0m12:21:09.443029 [debug] [Thread-1 (]: On model.stock_prediction.avg_true_range: Close
[0m12:21:09.567226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b9acce9-88ec-47b8-ad34-0286635af175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11320fcd0>]}
[0m12:21:09.568320 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.avg_true_range ..................... [[32mSUCCESS 1[0m in 1.12s]
[0m12:21:09.569124 [debug] [Thread-1 (]: Finished running node model.stock_prediction.avg_true_range
[0m12:21:09.569672 [debug] [Thread-1 (]: Began running node model.stock_prediction.bollinger
[0m12:21:09.570431 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.bollinger ............................... [RUN]
[0m12:21:09.571082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.avg_true_range, now model.stock_prediction.bollinger)
[0m12:21:09.571458 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.bollinger
[0m12:21:09.574868 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.bollinger"
[0m12:21:09.575951 [debug] [Thread-1 (]: Began executing node model.stock_prediction.bollinger
[0m12:21:09.578961 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.bollinger"
[0m12:21:09.580406 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.bollinger"
[0m12:21:09.580753 [debug] [Thread-1 (]: On model.stock_prediction.bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.bollinger"} */
create or replace transient table dev.analytics.bollinger
         as
        (WITH bollinger AS (
    SELECT
        symbol,
        date,
        close,
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) AS sma_20d,
        STDDEV(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) AS stddev_20d
    FROM dev.analytics.stock_prices
)

SELECT
    symbol,
    date,
    close,
    COALESCE(sma_20d, 0) AS sma_20d,
    COALESCE(sma_20d + (2 * stddev_20d), 0) AS upper_band,
    COALESCE(sma_20d - (2 * stddev_20d), 0) AS lower_band
FROM bollinger
ORDER BY symbol, date
        );
[0m12:21:09.581076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:21:10.712357 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.131 seconds
[0m12:21:10.715862 [debug] [Thread-1 (]: On model.stock_prediction.bollinger: Close
[0m12:21:10.832814 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b9acce9-88ec-47b8-ad34-0286635af175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113677850>]}
[0m12:21:10.834364 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.bollinger .......................... [[32mSUCCESS 1[0m in 1.26s]
[0m12:21:10.835221 [debug] [Thread-1 (]: Finished running node model.stock_prediction.bollinger
[0m12:21:10.835729 [debug] [Thread-1 (]: Began running node model.stock_prediction.moving_average
[0m12:21:10.836310 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.moving_average .......................... [RUN]
[0m12:21:10.836859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.bollinger, now model.stock_prediction.moving_average)
[0m12:21:10.837236 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.moving_average
[0m12:21:10.840630 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.moving_average"
[0m12:21:10.841561 [debug] [Thread-1 (]: Began executing node model.stock_prediction.moving_average
[0m12:21:10.843741 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.moving_average"
[0m12:21:10.845012 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.moving_average"
[0m12:21:10.845346 [debug] [Thread-1 (]: On model.stock_prediction.moving_average: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.moving_average"} */
create or replace transient table dev.analytics.moving_average
         as
        (WITH stock_data AS (
    SELECT
        symbol,
        date,
        close
    FROM dev.analytics.stock_prices -- assuming 'stock_prices' is the name of the raw table model in dbt
)

SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
    ) AS moving_avg_5d,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
    ) AS moving_avg_20d
FROM stock_data
ORDER BY symbol, date
        );
[0m12:21:10.845671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:21:11.873610 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.027 seconds
[0m12:21:11.877090 [debug] [Thread-1 (]: On model.stock_prediction.moving_average: Close
[0m12:21:11.998995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b9acce9-88ec-47b8-ad34-0286635af175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11474d730>]}
[0m12:21:12.000694 [info ] [Thread-1 (]: 4 of 5 OK created sql table model analytics.moving_average ..................... [[32mSUCCESS 1[0m in 1.16s]
[0m12:21:12.001588 [debug] [Thread-1 (]: Finished running node model.stock_prediction.moving_average
[0m12:21:12.002122 [debug] [Thread-1 (]: Began running node model.stock_prediction.rsi_calculation
[0m12:21:12.002830 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.rsi_calculation ......................... [RUN]
[0m12:21:12.003473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.moving_average, now model.stock_prediction.rsi_calculation)
[0m12:21:12.003923 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.rsi_calculation
[0m12:21:12.007517 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.rsi_calculation"
[0m12:21:12.008628 [debug] [Thread-1 (]: Began executing node model.stock_prediction.rsi_calculation
[0m12:21:12.011029 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.rsi_calculation"
[0m12:21:12.012930 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.rsi_calculation"
[0m12:21:12.013321 [debug] [Thread-1 (]: On model.stock_prediction.rsi_calculation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.rsi_calculation"} */
create or replace transient table dev.analytics.rsi_calculation
         as
        (WITH stock_data AS (
    SELECT
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM dev.analytics.stock_prices
),

price_changes AS (
    SELECT
        symbol,
        date,
        close,
        CASE 
            WHEN close > prev_close THEN close - prev_close
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close < prev_close THEN prev_close - close
            ELSE 0 
        END AS loss
    FROM stock_data
),

average_gains_losses AS (
    SELECT
        symbol,
        date,
        close,
        -- Calculate the average gain over the last 14 days, including the current row
        AVG(gain) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain,
        -- Calculate the average loss over the last 14 days, including the current row
        AVG(loss) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss
    FROM price_changes
)

SELECT
    symbol,
    date,
    close,
    avg_gain,
    avg_loss,
    -- Calculate RSI, using COALESCE to set to 0 if result is NULL
    COALESCE(100 - (100 / (1 + (NULLIF(avg_gain, 0) / NULLIF(avg_loss, 0)))), 0) AS rsi_14d
FROM average_gains_losses
ORDER BY symbol, date
        );
[0m12:21:12.013692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:21:13.000822 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.987 seconds
[0m12:21:13.004587 [debug] [Thread-1 (]: On model.stock_prediction.rsi_calculation: Close
[0m12:21:13.152357 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b9acce9-88ec-47b8-ad34-0286635af175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11474e150>]}
[0m12:21:13.153275 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.rsi_calculation .................... [[32mSUCCESS 1[0m in 1.15s]
[0m12:21:13.153920 [debug] [Thread-1 (]: Finished running node model.stock_prediction.rsi_calculation
[0m12:21:13.155484 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:21:13.155852 [debug] [MainThread]: Connection 'model.stock_prediction.rsi_calculation' was properly closed.
[0m12:21:13.156258 [info ] [MainThread]: 
[0m12:21:13.156579 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 7.71 seconds (7.71s).
[0m12:21:13.157809 [debug] [MainThread]: Command end result
[0m12:21:13.187288 [info ] [MainThread]: 
[0m12:21:13.187553 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:21:13.187732 [info ] [MainThread]: 
[0m12:21:13.187910 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:21:13.189220 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.72027, "process_user_time": 2.107098, "process_kernel_time": 0.20144, "process_mem_max_rss": "143441920", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:21:13.189519 [debug] [MainThread]: Command `dbt run` succeeded at 12:21:13.189468 after 8.72 seconds
[0m12:21:13.189710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136a3290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11474ebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11474e930>]}
[0m12:21:13.189889 [debug] [MainThread]: Flushing usage events
[0m12:22:46.970130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b32120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106483ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106483d90>]}


============================== 12:22:46.972214 | 31f70629-dad3-4b17-a9e8-fbde77f4a608 ==============================
[0m12:22:46.972214 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:22:46.972523 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'profiles_dir': '/Users/adi/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:22:47.132725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31f70629-dad3-4b17-a9e8-fbde77f4a608', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070eda70>]}
[0m12:22:47.155314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31f70629-dad3-4b17-a9e8-fbde77f4a608', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070b8490>]}
[0m12:22:47.155692 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:22:47.165632 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:22:47.234578 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:22:47.234998 [debug] [MainThread]: Partial parsing: updated file: stock_prediction://models/schema.yml
[0m12:22:47.259092 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:22:47.259324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '31f70629-dad3-4b17-a9e8-fbde77f4a608', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10701bd50>]}
[0m12:22:47.352100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31f70629-dad3-4b17-a9e8-fbde77f4a608', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107177890>]}
[0m12:22:47.446061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31f70629-dad3-4b17-a9e8-fbde77f4a608', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10626b3f0>]}
[0m12:22:47.446321 [info ] [MainThread]: Found 5 models, 3 snapshots, 28 data tests, 2 sources, 459 macros
[0m12:22:47.446469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31f70629-dad3-4b17-a9e8-fbde77f4a608', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10761ab60>]}
[0m12:22:47.447809 [info ] [MainThread]: 
[0m12:22:47.448068 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:22:47.450190 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_analytics'
[0m12:22:47.457334 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m12:22:47.457482 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m12:22:47.457596 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:22:48.205317 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.747 seconds
[0m12:22:48.208827 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m12:22:48.355934 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m12:22:48.360615 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m12:22:48.360965 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m12:22:48.361254 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:22:48.882917 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.521 seconds
[0m12:22:48.887563 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m12:22:49.017115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31f70629-dad3-4b17-a9e8-fbde77f4a608', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107742390>]}
[0m12:22:49.017659 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:22:49.017875 [info ] [MainThread]: 
[0m12:22:49.022245 [debug] [Thread-1 (]: Began running node test.stock_prediction.dbt_utils_not_negative_avg_true_range_atr_14d.62a0c9e596
[0m12:22:49.022826 [info ] [Thread-1 (]: 1 of 28 START test dbt_utils_not_negative_avg_true_range_atr_14d ............... [RUN]
[0m12:22:49.023379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now test.stock_prediction.dbt_utils_not_negative_avg_true_range_atr_14d.62a0c9e596)
[0m12:22:49.023782 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.dbt_utils_not_negative_avg_true_range_atr_14d.62a0c9e596
[0m12:22:49.040094 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_not_negative_avg_true_range_atr_14d (models/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:22:49.040638 [error] [Thread-1 (]: 1 of 28 ERROR dbt_utils_not_negative_avg_true_range_atr_14d .................... [[31mERROR[0m in 0.02s]
[0m12:22:49.041041 [debug] [Thread-1 (]: Finished running node test.stock_prediction.dbt_utils_not_negative_avg_true_range_atr_14d.62a0c9e596
[0m12:22:49.041347 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m12:22:49.042243 [info ] [Thread-1 (]: 2 of 28 START test not_null_avg_true_range_atr_14d ............................. [RUN]
[0m12:22:49.042610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.dbt_utils_not_negative_avg_true_range_atr_14d.62a0c9e596, now test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad)
[0m12:22:49.042894 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m12:22:49.049987 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad"
[0m12:22:49.050682 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m12:22:49.063706 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad"
[0m12:22:49.064618 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad"
[0m12:22:49.064902 [debug] [Thread-1 (]: On test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select atr_14d
from dev.analytics.avg_true_range
where atr_14d is null



      
    ) dbt_internal_test
[0m12:22:49.065103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:49.527871 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.462 seconds
[0m12:22:49.541429 [debug] [Thread-1 (]: On test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad: Close
[0m12:22:49.753377 [info ] [Thread-1 (]: 2 of 28 PASS not_null_avg_true_range_atr_14d ................................... [[32mPASS[0m in 0.71s]
[0m12:22:49.754740 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m12:22:49.755152 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_avg_true_range_date.4e418b835d
[0m12:22:49.755551 [info ] [Thread-1 (]: 3 of 28 START test not_null_avg_true_range_date ................................ [RUN]
[0m12:22:49.755944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad, now test.stock_prediction.not_null_avg_true_range_date.4e418b835d)
[0m12:22:49.756231 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_avg_true_range_date.4e418b835d
[0m12:22:49.759543 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_avg_true_range_date.4e418b835d"
[0m12:22:49.760358 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_avg_true_range_date.4e418b835d
[0m12:22:49.761917 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_avg_true_range_date.4e418b835d"
[0m12:22:49.762652 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_avg_true_range_date.4e418b835d"
[0m12:22:49.762897 [debug] [Thread-1 (]: On test.stock_prediction.not_null_avg_true_range_date.4e418b835d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_avg_true_range_date.4e418b835d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.avg_true_range
where date is null



      
    ) dbt_internal_test
[0m12:22:49.763123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:50.421763 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.658 seconds
[0m12:22:50.426590 [debug] [Thread-1 (]: On test.stock_prediction.not_null_avg_true_range_date.4e418b835d: Close
[0m12:22:50.612619 [info ] [Thread-1 (]: 3 of 28 PASS not_null_avg_true_range_date ...................................... [[32mPASS[0m in 0.86s]
[0m12:22:50.613725 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_avg_true_range_date.4e418b835d
[0m12:22:50.614295 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1
[0m12:22:50.614897 [info ] [Thread-1 (]: 4 of 28 START test not_null_avg_true_range_symbol .............................. [RUN]
[0m12:22:50.615592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_avg_true_range_date.4e418b835d, now test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1)
[0m12:22:50.616080 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1
[0m12:22:50.621166 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1"
[0m12:22:50.622295 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1
[0m12:22:50.624330 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1"
[0m12:22:50.625283 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1"
[0m12:22:50.625613 [debug] [Thread-1 (]: On test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.avg_true_range
where symbol is null



      
    ) dbt_internal_test
[0m12:22:50.625915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:51.079373 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.453 seconds
[0m12:22:51.083652 [debug] [Thread-1 (]: On test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1: Close
[0m12:22:51.223138 [info ] [Thread-1 (]: 4 of 28 PASS not_null_avg_true_range_symbol .................................... [[32mPASS[0m in 0.61s]
[0m12:22:51.224017 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1
[0m12:22:51.224572 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_close.4ccb16a429
[0m12:22:51.225135 [info ] [Thread-1 (]: 5 of 28 START test not_null_bollinger_close .................................... [RUN]
[0m12:22:51.225768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1, now test.stock_prediction.not_null_bollinger_close.4ccb16a429)
[0m12:22:51.226200 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_close.4ccb16a429
[0m12:22:51.231052 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_close.4ccb16a429"
[0m12:22:51.232154 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_close.4ccb16a429
[0m12:22:51.234086 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_bollinger_close.4ccb16a429"
[0m12:22:51.234973 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_bollinger_close.4ccb16a429"
[0m12:22:51.235283 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_close.4ccb16a429: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_bollinger_close.4ccb16a429"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.bollinger
where close is null



      
    ) dbt_internal_test
[0m12:22:51.235570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:51.701256 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.465 seconds
[0m12:22:51.705095 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_close.4ccb16a429: Close
[0m12:22:51.843047 [info ] [Thread-1 (]: 5 of 28 PASS not_null_bollinger_close .......................................... [[32mPASS[0m in 0.62s]
[0m12:22:51.844536 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_close.4ccb16a429
[0m12:22:51.844880 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_date.9d77bdd20c
[0m12:22:51.845218 [info ] [Thread-1 (]: 6 of 28 START test not_null_bollinger_date ..................................... [RUN]
[0m12:22:51.845588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_close.4ccb16a429, now test.stock_prediction.not_null_bollinger_date.9d77bdd20c)
[0m12:22:51.845834 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_date.9d77bdd20c
[0m12:22:51.849272 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_date.9d77bdd20c"
[0m12:22:51.850220 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_date.9d77bdd20c
[0m12:22:51.851767 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_bollinger_date.9d77bdd20c"
[0m12:22:51.852447 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_bollinger_date.9d77bdd20c"
[0m12:22:51.852680 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_date.9d77bdd20c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_bollinger_date.9d77bdd20c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.bollinger
where date is null



      
    ) dbt_internal_test
[0m12:22:51.852890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:52.350319 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.497 seconds
[0m12:22:52.354310 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_date.9d77bdd20c: Close
[0m12:22:52.500000 [info ] [Thread-1 (]: 6 of 28 PASS not_null_bollinger_date ........................................... [[32mPASS[0m in 0.65s]
[0m12:22:52.501533 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_date.9d77bdd20c
[0m12:22:52.502170 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e
[0m12:22:52.502701 [info ] [Thread-1 (]: 7 of 28 START test not_null_bollinger_lower_band ............................... [RUN]
[0m12:22:52.503333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_date.9d77bdd20c, now test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e)
[0m12:22:52.503760 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e
[0m12:22:52.508395 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e"
[0m12:22:52.509402 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e
[0m12:22:52.511381 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e"
[0m12:22:52.512217 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e"
[0m12:22:52.512511 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select lower_band
from dev.analytics.bollinger
where lower_band is null



      
    ) dbt_internal_test
[0m12:22:52.512765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:52.935729 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.422 seconds
[0m12:22:52.940773 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e: Close
[0m12:22:53.068165 [info ] [Thread-1 (]: 7 of 28 PASS not_null_bollinger_lower_band ..................................... [[32mPASS[0m in 0.56s]
[0m12:22:53.069309 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e
[0m12:22:53.069866 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3
[0m12:22:53.070434 [info ] [Thread-1 (]: 8 of 28 START test not_null_bollinger_sma_20d .................................. [RUN]
[0m12:22:53.071094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e, now test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3)
[0m12:22:53.071568 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3
[0m12:22:53.076758 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3"
[0m12:22:53.077874 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3
[0m12:22:53.080043 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3"
[0m12:22:53.080964 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3"
[0m12:22:53.081289 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sma_20d
from dev.analytics.bollinger
where sma_20d is null



      
    ) dbt_internal_test
[0m12:22:53.081584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:53.522195 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.440 seconds
[0m12:22:53.526689 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3: Close
[0m12:22:53.663947 [info ] [Thread-1 (]: 8 of 28 PASS not_null_bollinger_sma_20d ........................................ [[32mPASS[0m in 0.59s]
[0m12:22:53.665267 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3
[0m12:22:53.665810 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_symbol.a932e30f82
[0m12:22:53.666324 [info ] [Thread-1 (]: 9 of 28 START test not_null_bollinger_symbol ................................... [RUN]
[0m12:22:53.666873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3, now test.stock_prediction.not_null_bollinger_symbol.a932e30f82)
[0m12:22:53.667265 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_symbol.a932e30f82
[0m12:22:53.672219 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_symbol.a932e30f82"
[0m12:22:53.673263 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_symbol.a932e30f82
[0m12:22:53.675208 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_bollinger_symbol.a932e30f82"
[0m12:22:53.676154 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_bollinger_symbol.a932e30f82"
[0m12:22:53.676487 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_symbol.a932e30f82: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_bollinger_symbol.a932e30f82"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.bollinger
where symbol is null



      
    ) dbt_internal_test
[0m12:22:53.676786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:54.181541 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.504 seconds
[0m12:22:54.186257 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_symbol.a932e30f82: Close
[0m12:22:54.324644 [info ] [Thread-1 (]: 9 of 28 PASS not_null_bollinger_symbol ......................................... [[32mPASS[0m in 0.66s]
[0m12:22:54.326088 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_symbol.a932e30f82
[0m12:22:54.326739 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_upper_band.e4db87564c
[0m12:22:54.327312 [info ] [Thread-1 (]: 10 of 28 START test not_null_bollinger_upper_band .............................. [RUN]
[0m12:22:54.327892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_symbol.a932e30f82, now test.stock_prediction.not_null_bollinger_upper_band.e4db87564c)
[0m12:22:54.328283 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_upper_band.e4db87564c
[0m12:22:54.333241 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_upper_band.e4db87564c"
[0m12:22:54.334372 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_upper_band.e4db87564c
[0m12:22:54.336425 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_bollinger_upper_band.e4db87564c"
[0m12:22:54.337356 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_bollinger_upper_band.e4db87564c"
[0m12:22:54.337685 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_upper_band.e4db87564c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_bollinger_upper_band.e4db87564c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select upper_band
from dev.analytics.bollinger
where upper_band is null



      
    ) dbt_internal_test
[0m12:22:54.337978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:54.794452 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.456 seconds
[0m12:22:54.799321 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_upper_band.e4db87564c: Close
[0m12:22:54.943893 [info ] [Thread-1 (]: 10 of 28 PASS not_null_bollinger_upper_band .................................... [[32mPASS[0m in 0.62s]
[0m12:22:54.944601 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_upper_band.e4db87564c
[0m12:22:54.945064 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m12:22:54.945555 [info ] [Thread-1 (]: 11 of 28 START test not_null_moving_average_close .............................. [RUN]
[0m12:22:54.946092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_upper_band.e4db87564c, now test.stock_prediction.not_null_moving_average_close.6d037dd588)
[0m12:22:54.946479 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m12:22:54.950897 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_close.6d037dd588"
[0m12:22:54.951967 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m12:22:54.953848 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_close.6d037dd588"
[0m12:22:54.954638 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_close.6d037dd588"
[0m12:22:54.954924 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_close.6d037dd588: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_close.6d037dd588"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.moving_average
where close is null



      
    ) dbt_internal_test
[0m12:22:54.955182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:55.406161 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.450 seconds
[0m12:22:55.411716 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_close.6d037dd588: Close
[0m12:22:55.566489 [info ] [Thread-1 (]: 11 of 28 PASS not_null_moving_average_close .................................... [[32mPASS[0m in 0.62s]
[0m12:22:55.567358 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m12:22:55.567887 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m12:22:55.568442 [info ] [Thread-1 (]: 12 of 28 START test not_null_moving_average_date ............................... [RUN]
[0m12:22:55.569035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_close.6d037dd588, now test.stock_prediction.not_null_moving_average_date.3ad00158b5)
[0m12:22:55.569477 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m12:22:55.574522 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_date.3ad00158b5"
[0m12:22:55.575584 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m12:22:55.577745 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_date.3ad00158b5"
[0m12:22:55.578638 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_date.3ad00158b5"
[0m12:22:55.578961 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_date.3ad00158b5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_date.3ad00158b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.moving_average
where date is null



      
    ) dbt_internal_test
[0m12:22:55.579251 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:56.016205 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.436 seconds
[0m12:22:56.020259 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_date.3ad00158b5: Close
[0m12:22:56.138762 [info ] [Thread-1 (]: 12 of 28 PASS not_null_moving_average_date ..................................... [[32mPASS[0m in 0.57s]
[0m12:22:56.139624 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m12:22:56.140146 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m12:22:56.140701 [info ] [Thread-1 (]: 13 of 28 START test not_null_moving_average_moving_avg_20d ..................... [RUN]
[0m12:22:56.141212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_date.3ad00158b5, now test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22)
[0m12:22:56.141582 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m12:22:56.146419 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m12:22:56.147542 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m12:22:56.149624 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m12:22:56.150564 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m12:22:56.150888 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg_20d
from dev.analytics.moving_average
where moving_avg_20d is null



      
    ) dbt_internal_test
[0m12:22:56.151182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:56.602896 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.451 seconds
[0m12:22:56.606920 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22: Close
[0m12:22:56.727217 [info ] [Thread-1 (]: 13 of 28 PASS not_null_moving_average_moving_avg_20d ........................... [[32mPASS[0m in 0.59s]
[0m12:22:56.728091 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m12:22:56.728638 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m12:22:56.729213 [info ] [Thread-1 (]: 14 of 28 START test not_null_moving_average_moving_avg_5d ...................... [RUN]
[0m12:22:56.729855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22, now test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca)
[0m12:22:56.730324 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m12:22:56.735438 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m12:22:56.737837 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m12:22:56.739813 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m12:22:56.740786 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m12:22:56.741113 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg_5d
from dev.analytics.moving_average
where moving_avg_5d is null



      
    ) dbt_internal_test
[0m12:22:56.741414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:57.168266 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.426 seconds
[0m12:22:57.172117 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca: Close
[0m12:22:57.312509 [info ] [Thread-1 (]: 14 of 28 PASS not_null_moving_average_moving_avg_5d ............................ [[32mPASS[0m in 0.58s]
[0m12:22:57.313354 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m12:22:57.313890 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m12:22:57.314454 [info ] [Thread-1 (]: 15 of 28 START test not_null_moving_average_symbol ............................. [RUN]
[0m12:22:57.315066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca, now test.stock_prediction.not_null_moving_average_symbol.75a6f7473c)
[0m12:22:57.315518 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m12:22:57.320874 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"
[0m12:22:57.322037 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m12:22:57.324249 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"
[0m12:22:57.325184 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"
[0m12:22:57.325555 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_symbol.75a6f7473c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.moving_average
where symbol is null



      
    ) dbt_internal_test
[0m12:22:57.325881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:57.734341 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.408 seconds
[0m12:22:57.740144 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_symbol.75a6f7473c: Close
[0m12:22:57.850028 [info ] [Thread-1 (]: 15 of 28 PASS not_null_moving_average_symbol ................................... [[32mPASS[0m in 0.53s]
[0m12:22:57.850811 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m12:22:57.851233 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m12:22:57.851634 [info ] [Thread-1 (]: 16 of 28 START test not_null_rsi_calculation_avg_gain .......................... [RUN]
[0m12:22:57.852061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_symbol.75a6f7473c, now test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42)
[0m12:22:57.852346 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m12:22:57.856184 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m12:22:57.857123 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m12:22:57.858816 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m12:22:57.859617 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m12:22:57.859874 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_gain
from dev.analytics.rsi_calculation
where avg_gain is null



      
    ) dbt_internal_test
[0m12:22:57.860107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:58.405050 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.544 seconds
[0m12:22:58.409716 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42: Close
[0m12:22:58.543980 [info ] [Thread-1 (]: 16 of 28 PASS not_null_rsi_calculation_avg_gain ................................ [[32mPASS[0m in 0.69s]
[0m12:22:58.545670 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m12:22:58.546315 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m12:22:58.546855 [info ] [Thread-1 (]: 17 of 28 START test not_null_rsi_calculation_avg_loss .......................... [RUN]
[0m12:22:58.547488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42, now test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19)
[0m12:22:58.547855 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m12:22:58.552398 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m12:22:58.553369 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m12:22:58.555317 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m12:22:58.556149 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m12:22:58.556436 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_loss
from dev.analytics.rsi_calculation
where avg_loss is null



      
    ) dbt_internal_test
[0m12:22:58.556697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:58.951982 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.395 seconds
[0m12:22:58.957084 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19: Close
[0m12:22:59.074912 [info ] [Thread-1 (]: 17 of 28 PASS not_null_rsi_calculation_avg_loss ................................ [[32mPASS[0m in 0.53s]
[0m12:22:59.075967 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m12:22:59.076529 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m12:22:59.077073 [info ] [Thread-1 (]: 18 of 28 START test not_null_rsi_calculation_close ............................. [RUN]
[0m12:22:59.077676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19, now test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d)
[0m12:22:59.078120 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m12:22:59.083287 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"
[0m12:22:59.084390 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m12:22:59.086440 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"
[0m12:22:59.087384 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"
[0m12:22:59.087707 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.rsi_calculation
where close is null



      
    ) dbt_internal_test
[0m12:22:59.088007 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:59.640914 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.552 seconds
[0m12:22:59.647604 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d: Close
[0m12:22:59.760218 [info ] [Thread-1 (]: 18 of 28 PASS not_null_rsi_calculation_close ................................... [[32mPASS[0m in 0.68s]
[0m12:22:59.761091 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m12:22:59.761640 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m12:22:59.762196 [info ] [Thread-1 (]: 19 of 28 START test not_null_rsi_calculation_date .............................. [RUN]
[0m12:22:59.762761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d, now test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76)
[0m12:22:59.763205 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m12:22:59.768338 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"
[0m12:22:59.769421 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m12:22:59.771661 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"
[0m12:22:59.772610 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"
[0m12:22:59.772944 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.rsi_calculation
where date is null



      
    ) dbt_internal_test
[0m12:22:59.773237 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:00.191792 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.417 seconds
[0m12:23:00.196542 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76: Close
[0m12:23:00.338388 [info ] [Thread-1 (]: 19 of 28 PASS not_null_rsi_calculation_date .................................... [[32mPASS[0m in 0.58s]
[0m12:23:00.339490 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m12:23:00.340064 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m12:23:00.340636 [info ] [Thread-1 (]: 20 of 28 START test not_null_rsi_calculation_rsi_14d ........................... [RUN]
[0m12:23:00.341186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76, now test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8)
[0m12:23:00.341554 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m12:23:00.346486 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m12:23:00.347494 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m12:23:00.349463 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m12:23:00.350387 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m12:23:00.350724 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from dev.analytics.rsi_calculation
where rsi_14d is null



      
    ) dbt_internal_test
[0m12:23:00.351016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:00.751332 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.400 seconds
[0m12:23:00.755592 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8: Close
[0m12:23:00.887253 [info ] [Thread-1 (]: 20 of 28 PASS not_null_rsi_calculation_rsi_14d ................................. [[32mPASS[0m in 0.55s]
[0m12:23:00.888156 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m12:23:00.888708 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m12:23:00.889306 [info ] [Thread-1 (]: 21 of 28 START test not_null_rsi_calculation_symbol ............................ [RUN]
[0m12:23:00.889870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8, now test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84)
[0m12:23:00.890276 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m12:23:00.895178 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m12:23:00.896273 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m12:23:00.898372 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m12:23:00.899333 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m12:23:00.899650 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.rsi_calculation
where symbol is null



      
    ) dbt_internal_test
[0m12:23:00.899947 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:01.418381 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.518 seconds
[0m12:23:01.422484 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84: Close
[0m12:23:01.540640 [info ] [Thread-1 (]: 21 of 28 PASS not_null_rsi_calculation_symbol .................................. [[32mPASS[0m in 0.65s]
[0m12:23:01.542001 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m12:23:01.542581 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m12:23:01.543089 [info ] [Thread-1 (]: 22 of 28 START test not_null_stock_prices_close ................................ [RUN]
[0m12:23:01.543640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84, now test.stock_prediction.not_null_stock_prices_close.d7e232e1ba)
[0m12:23:01.544039 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m12:23:01.548888 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"
[0m12:23:01.549806 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m12:23:01.551741 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"
[0m12:23:01.552647 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"
[0m12:23:01.553008 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_close.d7e232e1ba: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.stock_prices
where close is null



      
    ) dbt_internal_test
[0m12:23:01.553312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:02.098533 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.545 seconds
[0m12:23:02.102440 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_close.d7e232e1ba: Close
[0m12:23:02.234856 [info ] [Thread-1 (]: 22 of 28 PASS not_null_stock_prices_close ...................................... [[32mPASS[0m in 0.69s]
[0m12:23:02.236228 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m12:23:02.236845 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m12:23:02.237457 [info ] [Thread-1 (]: 23 of 28 START test not_null_stock_prices_date ................................. [RUN]
[0m12:23:02.238119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_close.d7e232e1ba, now test.stock_prediction.not_null_stock_prices_date.98a7527501)
[0m12:23:02.238580 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m12:23:02.243555 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_date.98a7527501"
[0m12:23:02.244638 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m12:23:02.246620 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_date.98a7527501"
[0m12:23:02.247500 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_date.98a7527501"
[0m12:23:02.247837 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_date.98a7527501: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_date.98a7527501"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.stock_prices
where date is null



      
    ) dbt_internal_test
[0m12:23:02.248133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:02.674066 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.425 seconds
[0m12:23:02.679679 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_date.98a7527501: Close
[0m12:23:02.915921 [info ] [Thread-1 (]: 23 of 28 PASS not_null_stock_prices_date ....................................... [[32mPASS[0m in 0.68s]
[0m12:23:02.916928 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m12:23:02.917505 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m12:23:02.918090 [info ] [Thread-1 (]: 24 of 28 START test not_null_stock_prices_high ................................. [RUN]
[0m12:23:02.918796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_date.98a7527501, now test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc)
[0m12:23:02.919270 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m12:23:02.924297 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"
[0m12:23:02.925436 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m12:23:02.927390 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"
[0m12:23:02.928308 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"
[0m12:23:02.928634 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select high
from dev.analytics.stock_prices
where high is null



      
    ) dbt_internal_test
[0m12:23:02.928931 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:03.357847 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.428 seconds
[0m12:23:03.361942 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc: Close
[0m12:23:03.494361 [info ] [Thread-1 (]: 24 of 28 PASS not_null_stock_prices_high ....................................... [[32mPASS[0m in 0.58s]
[0m12:23:03.495227 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m12:23:03.495773 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m12:23:03.496342 [info ] [Thread-1 (]: 25 of 28 START test not_null_stock_prices_low .................................. [RUN]
[0m12:23:03.496935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc, now test.stock_prediction.not_null_stock_prices_low.e65294ca15)
[0m12:23:03.497375 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m12:23:03.502257 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_low.e65294ca15"
[0m12:23:03.503326 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m12:23:03.505574 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_low.e65294ca15"
[0m12:23:03.506446 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_low.e65294ca15"
[0m12:23:03.506772 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_low.e65294ca15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_low.e65294ca15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select low
from dev.analytics.stock_prices
where low is null



      
    ) dbt_internal_test
[0m12:23:03.507069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:03.945327 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.438 seconds
[0m12:23:03.949593 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_low.e65294ca15: Close
[0m12:23:04.109095 [info ] [Thread-1 (]: 25 of 28 PASS not_null_stock_prices_low ........................................ [[32mPASS[0m in 0.61s]
[0m12:23:04.109965 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m12:23:04.110451 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m12:23:04.110912 [info ] [Thread-1 (]: 26 of 28 START test not_null_stock_prices_open ................................. [RUN]
[0m12:23:04.111413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_low.e65294ca15, now test.stock_prediction.not_null_stock_prices_open.e09b13f215)
[0m12:23:04.111780 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m12:23:04.116286 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_open.e09b13f215"
[0m12:23:04.117286 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m12:23:04.119267 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_open.e09b13f215"
[0m12:23:04.120087 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_open.e09b13f215"
[0m12:23:04.120370 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_open.e09b13f215: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_open.e09b13f215"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from dev.analytics.stock_prices
where open is null



      
    ) dbt_internal_test
[0m12:23:04.120648 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:04.575330 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.454 seconds
[0m12:23:04.579336 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_open.e09b13f215: Close
[0m12:23:04.688389 [info ] [Thread-1 (]: 26 of 28 PASS not_null_stock_prices_open ....................................... [[32mPASS[0m in 0.58s]
[0m12:23:04.689537 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m12:23:04.690119 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m12:23:04.690731 [info ] [Thread-1 (]: 27 of 28 START test not_null_stock_prices_symbol ............................... [RUN]
[0m12:23:04.691281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_open.e09b13f215, now test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8)
[0m12:23:04.691766 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m12:23:04.696830 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"
[0m12:23:04.697948 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m12:23:04.699994 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"
[0m12:23:04.700935 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"
[0m12:23:04.701262 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.stock_prices
where symbol is null



      
    ) dbt_internal_test
[0m12:23:04.701563 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:05.115678 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.414 seconds
[0m12:23:05.119594 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8: Close
[0m12:23:05.261502 [info ] [Thread-1 (]: 27 of 28 PASS not_null_stock_prices_symbol ..................................... [[32mPASS[0m in 0.57s]
[0m12:23:05.262632 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m12:23:05.263219 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m12:23:05.263802 [info ] [Thread-1 (]: 28 of 28 START test not_null_stock_prices_volume ............................... [RUN]
[0m12:23:05.264398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8, now test.stock_prediction.not_null_stock_prices_volume.71420bc956)
[0m12:23:05.264783 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m12:23:05.269819 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_volume.71420bc956"
[0m12:23:05.270869 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m12:23:05.272866 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_volume.71420bc956"
[0m12:23:05.273801 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_volume.71420bc956"
[0m12:23:05.274133 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_volume.71420bc956: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_volume.71420bc956"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume
from dev.analytics.stock_prices
where volume is null



      
    ) dbt_internal_test
[0m12:23:05.274444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:05.714127 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.439 seconds
[0m12:23:05.718095 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_volume.71420bc956: Close
[0m12:23:05.822607 [info ] [Thread-1 (]: 28 of 28 PASS not_null_stock_prices_volume ..................................... [[32mPASS[0m in 0.56s]
[0m12:23:05.823415 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m12:23:05.825074 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:23:05.825418 [debug] [MainThread]: Connection 'test.stock_prediction.not_null_stock_prices_volume.71420bc956' was properly closed.
[0m12:23:05.825773 [info ] [MainThread]: 
[0m12:23:05.826084 [info ] [MainThread]: Finished running 28 data tests in 0 hours 0 minutes and 18.38 seconds (18.38s).
[0m12:23:05.829961 [debug] [MainThread]: Command end result
[0m12:23:05.857590 [info ] [MainThread]: 
[0m12:23:05.857857 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:23:05.858029 [info ] [MainThread]: 
[0m12:23:05.858247 [error] [MainThread]:   Compilation Error in test dbt_utils_not_negative_avg_true_range_atr_14d (models/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:23:05.858426 [info ] [MainThread]: 
[0m12:23:05.858599 [info ] [MainThread]: Done. PASS=27 WARN=0 ERROR=1 SKIP=0 TOTAL=28
[0m12:23:05.860026 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 18.92297, "process_user_time": 3.201083, "process_kernel_time": 0.387723, "process_mem_max_rss": "139788288", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:23:05.860392 [debug] [MainThread]: Command `dbt test` failed at 12:23:05.860327 after 18.92 seconds
[0m12:23:05.860611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079ef800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108471ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108473750>]}
[0m12:23:05.860806 [debug] [MainThread]: Flushing usage events
[0m12:23:17.379449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049da120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10632fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10632fd90>]}


============================== 12:23:17.381672 | daa218ac-3480-4672-b3a5-fa392bedbd37 ==============================
[0m12:23:17.381672 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:23:17.382010 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:23:17.428041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'daa218ac-3480-4672-b3a5-fa392bedbd37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051ca8b0>]}
[0m12:23:17.438091 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.09247233, "process_user_time": 0.596996, "process_kernel_time": 0.096939, "process_mem_max_rss": "96092160", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:23:17.438349 [debug] [MainThread]: Command `dbt clean` succeeded at 12:23:17.438300 after 0.09 seconds
[0m12:23:17.438516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10646e470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10646e580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060de150>]}
[0m12:23:17.438654 [debug] [MainThread]: Flushing usage events
[0m12:23:53.602827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c4e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107defed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107defd90>]}


============================== 12:23:53.605046 | 439362a2-53b0-4ebb-80b1-fc22c294e43e ==============================
[0m12:23:53.605046 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:23:53.605342 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:23:53.762567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '439362a2-53b0-4ebb-80b1-fc22c294e43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111675a70>]}
[0m12:23:53.785075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '439362a2-53b0-4ebb-80b1-fc22c294e43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115d0490>]}
[0m12:23:53.785440 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:23:53.794219 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:23:53.794735 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:23:53.794923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '439362a2-53b0-4ebb-80b1-fc22c294e43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111530050>]}
[0m12:23:54.345279 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:23:54.345561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '439362a2-53b0-4ebb-80b1-fc22c294e43e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117906e0>]}
[0m12:23:54.493799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '439362a2-53b0-4ebb-80b1-fc22c294e43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cbe270>]}
[0m12:23:54.549622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '439362a2-53b0-4ebb-80b1-fc22c294e43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111803ba0>]}
[0m12:23:54.549893 [info ] [MainThread]: Found 5 models, 3 snapshots, 28 data tests, 2 sources, 459 macros
[0m12:23:54.550050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '439362a2-53b0-4ebb-80b1-fc22c294e43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e27890>]}
[0m12:23:54.551125 [info ] [MainThread]: 
[0m12:23:54.551386 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:23:54.553495 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m12:23:54.559466 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m12:23:54.559625 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m12:23:54.559747 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:23:55.156877 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.597 seconds
[0m12:23:55.159334 [debug] [ThreadPool]: On list_dev: Close
[0m12:23:55.302569 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m12:23:55.314397 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m12:23:55.314749 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m12:23:55.315009 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:23:55.839237 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.524 seconds
[0m12:23:55.844078 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m12:23:55.989307 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m12:23:55.992906 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m12:23:55.993352 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m12:23:55.993691 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:23:56.473542 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.479 seconds
[0m12:23:56.479068 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m12:23:56.614921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '439362a2-53b0-4ebb-80b1-fc22c294e43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b84680>]}
[0m12:23:56.615715 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:23:56.616058 [info ] [MainThread]: 
[0m12:23:56.619947 [debug] [Thread-1 (]: Began running node model.stock_prediction.stock_prices
[0m12:23:56.620512 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stock_prices ............................. [RUN]
[0m12:23:56.620939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now model.stock_prediction.stock_prices)
[0m12:23:56.621249 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.stock_prices
[0m12:23:56.629542 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.stock_prices"
[0m12:23:56.630788 [debug] [Thread-1 (]: Began executing node model.stock_prediction.stock_prices
[0m12:23:56.650356 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.stock_prices"
[0m12:23:56.651215 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.stock_prices"
[0m12:23:56.651471 [debug] [Thread-1 (]: On model.stock_prediction.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.stock_prices"} */
create or replace   view dev.analytics.stock_prices
  
   as (
    SELECT
    symbol,
    date,
    open,
    high,
    low,
    close,
    volume
FROM dev.raw_data.stock_prices
  );
[0m12:23:56.651666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:57.355545 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.703 seconds
[0m12:23:57.381128 [debug] [Thread-1 (]: On model.stock_prediction.stock_prices: Close
[0m12:23:57.550436 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '439362a2-53b0-4ebb-80b1-fc22c294e43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060ad3b0>]}
[0m12:23:57.551317 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stock_prices ........................ [[32mSUCCESS 1[0m in 0.93s]
[0m12:23:57.552000 [debug] [Thread-1 (]: Finished running node model.stock_prediction.stock_prices
[0m12:23:57.553108 [debug] [Thread-1 (]: Began running node model.stock_prediction.avg_true_range
[0m12:23:57.553581 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.avg_true_range .......................... [RUN]
[0m12:23:57.554050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.stock_prices, now model.stock_prediction.avg_true_range)
[0m12:23:57.554387 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.avg_true_range
[0m12:23:57.557364 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.avg_true_range"
[0m12:23:57.558491 [debug] [Thread-1 (]: Began executing node model.stock_prediction.avg_true_range
[0m12:23:57.576494 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.avg_true_range"
[0m12:23:57.577563 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.avg_true_range"
[0m12:23:57.577812 [debug] [Thread-1 (]: On model.stock_prediction.avg_true_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.avg_true_range"} */
create or replace transient table dev.analytics.avg_true_range
         as
        (WITH averageTrueRanges AS (
    SELECT
        date,
        symbol,
        close,
        ABS(close - LAG(close) OVER (PARTITION BY symbol ORDER BY date)) AS true_range
    FROM dev.analytics.stock_prices
),
atr AS (
    SELECT
        date,
        symbol,
        AVG(true_range) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS atr_14d
    FROM averageTrueRanges
)
SELECT 
    date, 
    symbol, 
    COALESCE(atr_14d, 0) AS atr_14d
FROM atr
ORDER BY date, symbol
        );
[0m12:23:57.578029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:58.891930 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.313 seconds
[0m12:23:58.896454 [debug] [Thread-1 (]: On model.stock_prediction.avg_true_range: Close
[0m12:23:59.014263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '439362a2-53b0-4ebb-80b1-fc22c294e43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ccb3d0>]}
[0m12:23:59.015459 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.avg_true_range ..................... [[32mSUCCESS 1[0m in 1.46s]
[0m12:23:59.016288 [debug] [Thread-1 (]: Finished running node model.stock_prediction.avg_true_range
[0m12:23:59.016859 [debug] [Thread-1 (]: Began running node model.stock_prediction.bollinger
[0m12:23:59.017716 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.bollinger ............................... [RUN]
[0m12:23:59.018446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.avg_true_range, now model.stock_prediction.bollinger)
[0m12:23:59.018904 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.bollinger
[0m12:23:59.022579 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.bollinger"
[0m12:23:59.023751 [debug] [Thread-1 (]: Began executing node model.stock_prediction.bollinger
[0m12:23:59.026801 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.bollinger"
[0m12:23:59.028213 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.bollinger"
[0m12:23:59.028559 [debug] [Thread-1 (]: On model.stock_prediction.bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.bollinger"} */
create or replace transient table dev.analytics.bollinger
         as
        (WITH bollinger AS (
    SELECT
        symbol,
        date,
        close,
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) AS sma_20d,
        STDDEV(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) AS stddev_20d
    FROM dev.analytics.stock_prices
)

SELECT
    symbol,
    date,
    close,
    COALESCE(sma_20d, 0) AS sma_20d,
    COALESCE(sma_20d + (2 * stddev_20d), 0) AS upper_band,
    COALESCE(sma_20d - (2 * stddev_20d), 0) AS lower_band
FROM bollinger
ORDER BY symbol, date
        );
[0m12:23:59.028894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:00.429781 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.400 seconds
[0m12:24:00.433717 [debug] [Thread-1 (]: On model.stock_prediction.bollinger: Close
[0m12:24:00.550548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '439362a2-53b0-4ebb-80b1-fc22c294e43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b4ba80>]}
[0m12:24:00.551426 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.bollinger .......................... [[32mSUCCESS 1[0m in 1.53s]
[0m12:24:00.552070 [debug] [Thread-1 (]: Finished running node model.stock_prediction.bollinger
[0m12:24:00.552504 [debug] [Thread-1 (]: Began running node model.stock_prediction.moving_average
[0m12:24:00.553088 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.moving_average .......................... [RUN]
[0m12:24:00.553628 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.bollinger, now model.stock_prediction.moving_average)
[0m12:24:00.554011 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.moving_average
[0m12:24:00.557449 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.moving_average"
[0m12:24:00.558467 [debug] [Thread-1 (]: Began executing node model.stock_prediction.moving_average
[0m12:24:00.560607 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.moving_average"
[0m12:24:00.561874 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.moving_average"
[0m12:24:00.562220 [debug] [Thread-1 (]: On model.stock_prediction.moving_average: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.moving_average"} */
create or replace transient table dev.analytics.moving_average
         as
        (WITH stock_data AS (
    SELECT
        symbol,
        date,
        close
    FROM dev.analytics.stock_prices -- assuming 'stock_prices' is the name of the raw table model in dbt
)

SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
    ) AS moving_avg_5d,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
    ) AS moving_avg_20d
FROM stock_data
ORDER BY symbol, date
        );
[0m12:24:00.562535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:01.596372 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.033 seconds
[0m12:24:01.601714 [debug] [Thread-1 (]: On model.stock_prediction.moving_average: Close
[0m12:24:01.764077 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '439362a2-53b0-4ebb-80b1-fc22c294e43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e59310>]}
[0m12:24:01.765185 [info ] [Thread-1 (]: 4 of 5 OK created sql table model analytics.moving_average ..................... [[32mSUCCESS 1[0m in 1.21s]
[0m12:24:01.765960 [debug] [Thread-1 (]: Finished running node model.stock_prediction.moving_average
[0m12:24:01.766495 [debug] [Thread-1 (]: Began running node model.stock_prediction.rsi_calculation
[0m12:24:01.767171 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.rsi_calculation ......................... [RUN]
[0m12:24:01.767809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.moving_average, now model.stock_prediction.rsi_calculation)
[0m12:24:01.768256 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.rsi_calculation
[0m12:24:01.771597 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.rsi_calculation"
[0m12:24:01.772436 [debug] [Thread-1 (]: Began executing node model.stock_prediction.rsi_calculation
[0m12:24:01.774866 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.rsi_calculation"
[0m12:24:01.776633 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.rsi_calculation"
[0m12:24:01.777022 [debug] [Thread-1 (]: On model.stock_prediction.rsi_calculation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.rsi_calculation"} */
create or replace transient table dev.analytics.rsi_calculation
         as
        (WITH stock_data AS (
    SELECT
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM dev.analytics.stock_prices
),

price_changes AS (
    SELECT
        symbol,
        date,
        close,
        CASE 
            WHEN close > prev_close THEN close - prev_close
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close < prev_close THEN prev_close - close
            ELSE 0 
        END AS loss
    FROM stock_data
),

average_gains_losses AS (
    SELECT
        symbol,
        date,
        close,
        -- Calculate the average gain over the last 14 days, including the current row
        AVG(gain) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain,
        -- Calculate the average loss over the last 14 days, including the current row
        AVG(loss) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss
    FROM price_changes
)

SELECT
    symbol,
    date,
    close,
    avg_gain,
    avg_loss,
    -- Calculate RSI, using COALESCE to set to 0 if result is NULL
    COALESCE(100 - (100 / (1 + (NULLIF(avg_gain, 0) / NULLIF(avg_loss, 0)))), 0) AS rsi_14d
FROM average_gains_losses
ORDER BY symbol, date
        );
[0m12:24:01.777378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:03.092883 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.315 seconds
[0m12:24:03.097316 [debug] [Thread-1 (]: On model.stock_prediction.rsi_calculation: Close
[0m12:24:03.220598 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '439362a2-53b0-4ebb-80b1-fc22c294e43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e5af90>]}
[0m12:24:03.221484 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.rsi_calculation .................... [[32mSUCCESS 1[0m in 1.45s]
[0m12:24:03.222129 [debug] [Thread-1 (]: Finished running node model.stock_prediction.rsi_calculation
[0m12:24:03.223573 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:24:03.223862 [debug] [MainThread]: Connection 'model.stock_prediction.rsi_calculation' was properly closed.
[0m12:24:03.224231 [info ] [MainThread]: 
[0m12:24:03.224542 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 8.67 seconds (8.67s).
[0m12:24:03.225732 [debug] [MainThread]: Command end result
[0m12:24:03.256837 [info ] [MainThread]: 
[0m12:24:03.257110 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:24:03.257294 [info ] [MainThread]: 
[0m12:24:03.257475 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:24:03.258647 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.690442, "process_user_time": 2.133127, "process_kernel_time": 0.199251, "process_mem_max_rss": "142819328", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:24:03.258990 [debug] [MainThread]: Command `dbt run` succeeded at 12:24:03.258931 after 9.69 seconds
[0m12:24:03.259201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11175de50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e5be30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e5bdd0>]}
[0m12:24:03.259410 [debug] [MainThread]: Flushing usage events
[0m12:24:09.311339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10664a120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f9bed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f9bd90>]}


============================== 12:24:09.313582 | 0ceb808e-25d0-4c3f-8a4e-479b13017ba0 ==============================
[0m12:24:09.313582 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:24:09.313880 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'debug': 'False', 'profiles_dir': '/Users/adi/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:24:09.474213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ceb808e-25d0-4c3f-8a4e-479b13017ba0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e01a70>]}
[0m12:24:09.496711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ceb808e-25d0-4c3f-8a4e-479b13017ba0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dd0490>]}
[0m12:24:09.497104 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:24:09.505264 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:24:09.571326 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:24:09.571554 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:24:09.595919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ceb808e-25d0-4c3f-8a4e-479b13017ba0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d30b50>]}
[0m12:24:09.657549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ceb808e-25d0-4c3f-8a4e-479b13017ba0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109375d60>]}
[0m12:24:09.657815 [info ] [MainThread]: Found 5 models, 3 snapshots, 28 data tests, 2 sources, 459 macros
[0m12:24:09.657970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ceb808e-25d0-4c3f-8a4e-479b13017ba0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109243150>]}
[0m12:24:09.659372 [info ] [MainThread]: 
[0m12:24:09.659642 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:24:09.661794 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_analytics'
[0m12:24:09.669733 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m12:24:09.669895 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m12:24:09.670012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:24:10.217327 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.547 seconds
[0m12:24:10.222894 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m12:24:10.360180 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m12:24:10.364705 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m12:24:10.365064 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m12:24:10.365351 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:24:10.869794 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.504 seconds
[0m12:24:10.872278 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m12:24:10.996922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ceb808e-25d0-4c3f-8a4e-479b13017ba0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094242c0>]}
[0m12:24:10.997363 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:24:10.997516 [info ] [MainThread]: 
[0m12:24:10.998771 [debug] [Thread-1 (]: Began running node test.stock_prediction.dbt_utils_not_negative_avg_true_range_atr_14d.62a0c9e596
[0m12:24:10.998959 [info ] [Thread-1 (]: 1 of 28 START test dbt_utils_not_negative_avg_true_range_atr_14d ............... [RUN]
[0m12:24:10.999148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now test.stock_prediction.dbt_utils_not_negative_avg_true_range_atr_14d.62a0c9e596)
[0m12:24:10.999293 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.dbt_utils_not_negative_avg_true_range_atr_14d.62a0c9e596
[0m12:24:11.011498 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_not_negative_avg_true_range_atr_14d (models/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:24:11.011901 [error] [Thread-1 (]: 1 of 28 ERROR dbt_utils_not_negative_avg_true_range_atr_14d .................... [[31mERROR[0m in 0.01s]
[0m12:24:11.012210 [debug] [Thread-1 (]: Finished running node test.stock_prediction.dbt_utils_not_negative_avg_true_range_atr_14d.62a0c9e596
[0m12:24:11.012398 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m12:24:11.012957 [info ] [Thread-1 (]: 2 of 28 START test not_null_avg_true_range_atr_14d ............................. [RUN]
[0m12:24:11.013249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.dbt_utils_not_negative_avg_true_range_atr_14d.62a0c9e596, now test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad)
[0m12:24:11.013410 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m12:24:11.017930 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad"
[0m12:24:11.018511 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m12:24:11.028378 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad"
[0m12:24:11.029164 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad"
[0m12:24:11.029352 [debug] [Thread-1 (]: On test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select atr_14d
from dev.analytics.avg_true_range
where atr_14d is null



      
    ) dbt_internal_test
[0m12:24:11.029506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:11.536452 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.505 seconds
[0m12:24:11.548418 [debug] [Thread-1 (]: On test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad: Close
[0m12:24:11.682393 [info ] [Thread-1 (]: 2 of 28 PASS not_null_avg_true_range_atr_14d ................................... [[32mPASS[0m in 0.67s]
[0m12:24:11.683323 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m12:24:11.683910 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_avg_true_range_date.4e418b835d
[0m12:24:11.684549 [info ] [Thread-1 (]: 3 of 28 START test not_null_avg_true_range_date ................................ [RUN]
[0m12:24:11.685257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad, now test.stock_prediction.not_null_avg_true_range_date.4e418b835d)
[0m12:24:11.685763 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_avg_true_range_date.4e418b835d
[0m12:24:11.690427 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_avg_true_range_date.4e418b835d"
[0m12:24:11.691584 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_avg_true_range_date.4e418b835d
[0m12:24:11.693604 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_avg_true_range_date.4e418b835d"
[0m12:24:11.694550 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_avg_true_range_date.4e418b835d"
[0m12:24:11.694873 [debug] [Thread-1 (]: On test.stock_prediction.not_null_avg_true_range_date.4e418b835d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_avg_true_range_date.4e418b835d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.avg_true_range
where date is null



      
    ) dbt_internal_test
[0m12:24:11.695175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:12.267482 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.572 seconds
[0m12:24:12.270232 [debug] [Thread-1 (]: On test.stock_prediction.not_null_avg_true_range_date.4e418b835d: Close
[0m12:24:12.383370 [info ] [Thread-1 (]: 3 of 28 PASS not_null_avg_true_range_date ...................................... [[32mPASS[0m in 0.70s]
[0m12:24:12.384065 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_avg_true_range_date.4e418b835d
[0m12:24:12.384305 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1
[0m12:24:12.384468 [info ] [Thread-1 (]: 4 of 28 START test not_null_avg_true_range_symbol .............................. [RUN]
[0m12:24:12.384708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_avg_true_range_date.4e418b835d, now test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1)
[0m12:24:12.384869 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1
[0m12:24:12.386895 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1"
[0m12:24:12.387431 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1
[0m12:24:12.388529 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1"
[0m12:24:12.389031 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1"
[0m12:24:12.389206 [debug] [Thread-1 (]: On test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.avg_true_range
where symbol is null



      
    ) dbt_internal_test
[0m12:24:12.389363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:13.111655 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.722 seconds
[0m12:24:13.115494 [debug] [Thread-1 (]: On test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1: Close
[0m12:24:13.235259 [info ] [Thread-1 (]: 4 of 28 PASS not_null_avg_true_range_symbol .................................... [[32mPASS[0m in 0.85s]
[0m12:24:13.236162 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1
[0m12:24:13.236701 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_close.4ccb16a429
[0m12:24:13.237269 [info ] [Thread-1 (]: 5 of 28 START test not_null_bollinger_close .................................... [RUN]
[0m12:24:13.237915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1, now test.stock_prediction.not_null_bollinger_close.4ccb16a429)
[0m12:24:13.238388 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_close.4ccb16a429
[0m12:24:13.243440 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_close.4ccb16a429"
[0m12:24:13.244536 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_close.4ccb16a429
[0m12:24:13.246627 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_bollinger_close.4ccb16a429"
[0m12:24:13.247543 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_bollinger_close.4ccb16a429"
[0m12:24:13.247860 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_close.4ccb16a429: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_bollinger_close.4ccb16a429"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.bollinger
where close is null



      
    ) dbt_internal_test
[0m12:24:13.248164 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:13.733760 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.485 seconds
[0m12:24:13.738793 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_close.4ccb16a429: Close
[0m12:24:13.903319 [info ] [Thread-1 (]: 5 of 28 PASS not_null_bollinger_close .......................................... [[32mPASS[0m in 0.67s]
[0m12:24:13.904239 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_close.4ccb16a429
[0m12:24:13.904722 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_date.9d77bdd20c
[0m12:24:13.905215 [info ] [Thread-1 (]: 6 of 28 START test not_null_bollinger_date ..................................... [RUN]
[0m12:24:13.905785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_close.4ccb16a429, now test.stock_prediction.not_null_bollinger_date.9d77bdd20c)
[0m12:24:13.906183 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_date.9d77bdd20c
[0m12:24:13.910735 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_date.9d77bdd20c"
[0m12:24:13.911761 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_date.9d77bdd20c
[0m12:24:13.913735 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_bollinger_date.9d77bdd20c"
[0m12:24:13.914699 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_bollinger_date.9d77bdd20c"
[0m12:24:13.915020 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_date.9d77bdd20c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_bollinger_date.9d77bdd20c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.bollinger
where date is null



      
    ) dbt_internal_test
[0m12:24:13.915311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:14.414979 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.499 seconds
[0m12:24:14.419227 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_date.9d77bdd20c: Close
[0m12:24:14.537408 [info ] [Thread-1 (]: 6 of 28 PASS not_null_bollinger_date ........................................... [[32mPASS[0m in 0.63s]
[0m12:24:14.538376 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_date.9d77bdd20c
[0m12:24:14.539088 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e
[0m12:24:14.539623 [info ] [Thread-1 (]: 7 of 28 START test not_null_bollinger_lower_band ............................... [RUN]
[0m12:24:14.540274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_date.9d77bdd20c, now test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e)
[0m12:24:14.540737 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e
[0m12:24:14.545359 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e"
[0m12:24:14.546048 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e
[0m12:24:14.547985 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e"
[0m12:24:14.548955 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e"
[0m12:24:14.549281 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select lower_band
from dev.analytics.bollinger
where lower_band is null



      
    ) dbt_internal_test
[0m12:24:14.549751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:14.994523 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.445 seconds
[0m12:24:14.997178 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e: Close
[0m12:24:15.123464 [info ] [Thread-1 (]: 7 of 28 PASS not_null_bollinger_lower_band ..................................... [[32mPASS[0m in 0.58s]
[0m12:24:15.124089 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e
[0m12:24:15.124430 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3
[0m12:24:15.124764 [info ] [Thread-1 (]: 8 of 28 START test not_null_bollinger_sma_20d .................................. [RUN]
[0m12:24:15.125174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e, now test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3)
[0m12:24:15.125441 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3
[0m12:24:15.128850 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3"
[0m12:24:15.129592 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3
[0m12:24:15.131154 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3"
[0m12:24:15.131856 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3"
[0m12:24:15.132112 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sma_20d
from dev.analytics.bollinger
where sma_20d is null



      
    ) dbt_internal_test
[0m12:24:15.132336 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:15.573035 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.440 seconds
[0m12:24:15.578304 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3: Close
[0m12:24:15.723040 [info ] [Thread-1 (]: 8 of 28 PASS not_null_bollinger_sma_20d ........................................ [[32mPASS[0m in 0.60s]
[0m12:24:15.724019 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3
[0m12:24:15.724562 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_symbol.a932e30f82
[0m12:24:15.725136 [info ] [Thread-1 (]: 9 of 28 START test not_null_bollinger_symbol ................................... [RUN]
[0m12:24:15.725789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3, now test.stock_prediction.not_null_bollinger_symbol.a932e30f82)
[0m12:24:15.726263 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_symbol.a932e30f82
[0m12:24:15.731315 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_symbol.a932e30f82"
[0m12:24:15.732446 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_symbol.a932e30f82
[0m12:24:15.734403 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_bollinger_symbol.a932e30f82"
[0m12:24:15.735428 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_bollinger_symbol.a932e30f82"
[0m12:24:15.735756 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_symbol.a932e30f82: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_bollinger_symbol.a932e30f82"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.bollinger
where symbol is null



      
    ) dbt_internal_test
[0m12:24:15.736048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:16.157477 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.421 seconds
[0m12:24:16.161534 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_symbol.a932e30f82: Close
[0m12:24:16.289767 [info ] [Thread-1 (]: 9 of 28 PASS not_null_bollinger_symbol ......................................... [[32mPASS[0m in 0.56s]
[0m12:24:16.290621 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_symbol.a932e30f82
[0m12:24:16.291168 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_upper_band.e4db87564c
[0m12:24:16.291737 [info ] [Thread-1 (]: 10 of 28 START test not_null_bollinger_upper_band .............................. [RUN]
[0m12:24:16.292387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_symbol.a932e30f82, now test.stock_prediction.not_null_bollinger_upper_band.e4db87564c)
[0m12:24:16.292867 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_upper_band.e4db87564c
[0m12:24:16.298050 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_upper_band.e4db87564c"
[0m12:24:16.299094 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_upper_band.e4db87564c
[0m12:24:16.301196 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_bollinger_upper_band.e4db87564c"
[0m12:24:16.302158 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_bollinger_upper_band.e4db87564c"
[0m12:24:16.302475 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_upper_band.e4db87564c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_bollinger_upper_band.e4db87564c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select upper_band
from dev.analytics.bollinger
where upper_band is null



      
    ) dbt_internal_test
[0m12:24:16.302809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:16.797896 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.495 seconds
[0m12:24:16.801959 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_upper_band.e4db87564c: Close
[0m12:24:16.941363 [info ] [Thread-1 (]: 10 of 28 PASS not_null_bollinger_upper_band .................................... [[32mPASS[0m in 0.65s]
[0m12:24:16.942403 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_upper_band.e4db87564c
[0m12:24:16.943012 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m12:24:16.943481 [info ] [Thread-1 (]: 11 of 28 START test not_null_moving_average_close .............................. [RUN]
[0m12:24:16.943974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_upper_band.e4db87564c, now test.stock_prediction.not_null_moving_average_close.6d037dd588)
[0m12:24:16.944383 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m12:24:16.951976 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_close.6d037dd588"
[0m12:24:16.953331 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m12:24:16.955915 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_close.6d037dd588"
[0m12:24:16.957036 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_close.6d037dd588"
[0m12:24:16.957310 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_close.6d037dd588: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_close.6d037dd588"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.moving_average
where close is null



      
    ) dbt_internal_test
[0m12:24:16.957525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:17.431422 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.473 seconds
[0m12:24:17.437531 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_close.6d037dd588: Close
[0m12:24:17.580614 [info ] [Thread-1 (]: 11 of 28 PASS not_null_moving_average_close .................................... [[32mPASS[0m in 0.64s]
[0m12:24:17.586265 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m12:24:17.587560 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m12:24:17.588396 [info ] [Thread-1 (]: 12 of 28 START test not_null_moving_average_date ............................... [RUN]
[0m12:24:17.589486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_close.6d037dd588, now test.stock_prediction.not_null_moving_average_date.3ad00158b5)
[0m12:24:17.590229 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m12:24:17.600555 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_date.3ad00158b5"
[0m12:24:17.602482 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m12:24:17.605881 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_date.3ad00158b5"
[0m12:24:17.607295 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_date.3ad00158b5"
[0m12:24:17.607794 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_date.3ad00158b5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_date.3ad00158b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.moving_average
where date is null



      
    ) dbt_internal_test
[0m12:24:17.608248 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:18.032927 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.424 seconds
[0m12:24:18.038210 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_date.3ad00158b5: Close
[0m12:24:18.191768 [info ] [Thread-1 (]: 12 of 28 PASS not_null_moving_average_date ..................................... [[32mPASS[0m in 0.60s]
[0m12:24:18.192671 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m12:24:18.193389 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m12:24:18.193875 [info ] [Thread-1 (]: 13 of 28 START test not_null_moving_average_moving_avg_20d ..................... [RUN]
[0m12:24:18.194427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_date.3ad00158b5, now test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22)
[0m12:24:18.194852 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m12:24:18.200849 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m12:24:18.202274 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m12:24:18.206108 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m12:24:18.207751 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m12:24:18.208202 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg_20d
from dev.analytics.moving_average
where moving_avg_20d is null



      
    ) dbt_internal_test
[0m12:24:18.208623 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:18.787248 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.578 seconds
[0m12:24:18.796725 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22: Close
[0m12:24:18.938354 [info ] [Thread-1 (]: 13 of 28 PASS not_null_moving_average_moving_avg_20d ........................... [[32mPASS[0m in 0.74s]
[0m12:24:18.940455 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m12:24:18.941950 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m12:24:18.943611 [info ] [Thread-1 (]: 14 of 28 START test not_null_moving_average_moving_avg_5d ...................... [RUN]
[0m12:24:18.946178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22, now test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca)
[0m12:24:18.946865 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m12:24:18.959068 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m12:24:18.960464 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m12:24:18.963402 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m12:24:18.964751 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m12:24:18.965229 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg_5d
from dev.analytics.moving_average
where moving_avg_5d is null



      
    ) dbt_internal_test
[0m12:24:18.965665 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:19.531619 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.565 seconds
[0m12:24:19.538978 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca: Close
[0m12:24:19.671860 [info ] [Thread-1 (]: 14 of 28 PASS not_null_moving_average_moving_avg_5d ............................ [[32mPASS[0m in 0.73s]
[0m12:24:19.673961 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m12:24:19.675272 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m12:24:19.676032 [info ] [Thread-1 (]: 15 of 28 START test not_null_moving_average_symbol ............................. [RUN]
[0m12:24:19.676866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca, now test.stock_prediction.not_null_moving_average_symbol.75a6f7473c)
[0m12:24:19.677476 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m12:24:19.695226 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"
[0m12:24:19.696738 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m12:24:19.699626 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"
[0m12:24:19.700763 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"
[0m12:24:19.701171 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_symbol.75a6f7473c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.moving_average
where symbol is null



      
    ) dbt_internal_test
[0m12:24:19.701529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:20.206163 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.504 seconds
[0m12:24:20.213202 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_symbol.75a6f7473c: Close
[0m12:24:20.384347 [info ] [Thread-1 (]: 15 of 28 PASS not_null_moving_average_symbol ................................... [[32mPASS[0m in 0.71s]
[0m12:24:20.386363 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m12:24:20.387250 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m12:24:20.388078 [info ] [Thread-1 (]: 16 of 28 START test not_null_rsi_calculation_avg_gain .......................... [RUN]
[0m12:24:20.388951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_symbol.75a6f7473c, now test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42)
[0m12:24:20.389596 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m12:24:20.398325 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m12:24:20.400296 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m12:24:20.403845 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m12:24:20.405654 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m12:24:20.406208 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_gain
from dev.analytics.rsi_calculation
where avg_gain is null



      
    ) dbt_internal_test
[0m12:24:20.406682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:21.091601 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.684 seconds
[0m12:24:21.098169 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42: Close
[0m12:24:21.235875 [info ] [Thread-1 (]: 16 of 28 PASS not_null_rsi_calculation_avg_gain ................................ [[32mPASS[0m in 0.85s]
[0m12:24:21.238484 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m12:24:21.239605 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m12:24:21.240670 [info ] [Thread-1 (]: 17 of 28 START test not_null_rsi_calculation_avg_loss .......................... [RUN]
[0m12:24:21.241827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42, now test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19)
[0m12:24:21.242727 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m12:24:21.252832 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m12:24:21.254902 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m12:24:21.258904 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m12:24:21.260703 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m12:24:21.261235 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_loss
from dev.analytics.rsi_calculation
where avg_loss is null



      
    ) dbt_internal_test
[0m12:24:21.261673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:21.696078 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.434 seconds
[0m12:24:21.705611 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19: Close
[0m12:24:21.859719 [info ] [Thread-1 (]: 17 of 28 PASS not_null_rsi_calculation_avg_loss ................................ [[32mPASS[0m in 0.62s]
[0m12:24:21.861699 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m12:24:21.862573 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m12:24:21.863374 [info ] [Thread-1 (]: 18 of 28 START test not_null_rsi_calculation_close ............................. [RUN]
[0m12:24:21.864261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19, now test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d)
[0m12:24:21.864866 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m12:24:21.874574 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"
[0m12:24:21.876155 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m12:24:21.879161 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"
[0m12:24:21.880455 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"
[0m12:24:21.880932 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.rsi_calculation
where close is null



      
    ) dbt_internal_test
[0m12:24:21.881364 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:22.409290 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.527 seconds
[0m12:24:22.418155 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d: Close
[0m12:24:22.550587 [info ] [Thread-1 (]: 18 of 28 PASS not_null_rsi_calculation_close ................................... [[32mPASS[0m in 0.69s]
[0m12:24:22.552329 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m12:24:22.553181 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m12:24:22.553787 [info ] [Thread-1 (]: 19 of 28 START test not_null_rsi_calculation_date .............................. [RUN]
[0m12:24:22.554648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d, now test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76)
[0m12:24:22.555214 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m12:24:22.565595 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"
[0m12:24:22.567168 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m12:24:22.570269 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"
[0m12:24:22.571594 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"
[0m12:24:22.572075 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.rsi_calculation
where date is null



      
    ) dbt_internal_test
[0m12:24:22.572513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:23.085239 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.512 seconds
[0m12:24:23.092076 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76: Close
[0m12:24:23.222770 [info ] [Thread-1 (]: 19 of 28 PASS not_null_rsi_calculation_date .................................... [[32mPASS[0m in 0.67s]
[0m12:24:23.224778 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m12:24:23.225653 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m12:24:23.226505 [info ] [Thread-1 (]: 20 of 28 START test not_null_rsi_calculation_rsi_14d ........................... [RUN]
[0m12:24:23.227378 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76, now test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8)
[0m12:24:23.228063 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m12:24:23.236353 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m12:24:23.237971 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m12:24:23.240932 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m12:24:23.242232 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m12:24:23.242698 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from dev.analytics.rsi_calculation
where rsi_14d is null



      
    ) dbt_internal_test
[0m12:24:23.243119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:23.730055 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.487 seconds
[0m12:24:23.739132 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8: Close
[0m12:24:23.879330 [info ] [Thread-1 (]: 20 of 28 PASS not_null_rsi_calculation_rsi_14d ................................. [[32mPASS[0m in 0.65s]
[0m12:24:23.880267 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m12:24:23.880729 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m12:24:23.881272 [info ] [Thread-1 (]: 21 of 28 START test not_null_rsi_calculation_symbol ............................ [RUN]
[0m12:24:23.882196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8, now test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84)
[0m12:24:23.882695 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m12:24:23.887637 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m12:24:23.888794 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m12:24:23.891292 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m12:24:23.892490 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m12:24:23.892842 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.rsi_calculation
where symbol is null



      
    ) dbt_internal_test
[0m12:24:23.893140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:24.325850 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.432 seconds
[0m12:24:24.329280 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84: Close
[0m12:24:24.468238 [info ] [Thread-1 (]: 21 of 28 PASS not_null_rsi_calculation_symbol .................................. [[32mPASS[0m in 0.59s]
[0m12:24:24.469227 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m12:24:24.469869 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m12:24:24.470412 [info ] [Thread-1 (]: 22 of 28 START test not_null_stock_prices_close ................................ [RUN]
[0m12:24:24.470944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84, now test.stock_prediction.not_null_stock_prices_close.d7e232e1ba)
[0m12:24:24.471363 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m12:24:24.476308 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"
[0m12:24:24.477385 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m12:24:24.479640 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"
[0m12:24:24.480579 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"
[0m12:24:24.480910 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_close.d7e232e1ba: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.stock_prices
where close is null



      
    ) dbt_internal_test
[0m12:24:24.481200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:25.083361 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.601 seconds
[0m12:24:25.087056 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_close.d7e232e1ba: Close
[0m12:24:25.202886 [info ] [Thread-1 (]: 22 of 28 PASS not_null_stock_prices_close ...................................... [[32mPASS[0m in 0.73s]
[0m12:24:25.204258 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m12:24:25.204905 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m12:24:25.205584 [info ] [Thread-1 (]: 23 of 28 START test not_null_stock_prices_date ................................. [RUN]
[0m12:24:25.206303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_close.d7e232e1ba, now test.stock_prediction.not_null_stock_prices_date.98a7527501)
[0m12:24:25.206772 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m12:24:25.212220 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_date.98a7527501"
[0m12:24:25.213384 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m12:24:25.215482 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_date.98a7527501"
[0m12:24:25.216434 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_date.98a7527501"
[0m12:24:25.216766 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_date.98a7527501: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_date.98a7527501"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.stock_prices
where date is null



      
    ) dbt_internal_test
[0m12:24:25.217100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:25.694347 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.477 seconds
[0m12:24:25.698277 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_date.98a7527501: Close
[0m12:24:25.830898 [info ] [Thread-1 (]: 23 of 28 PASS not_null_stock_prices_date ....................................... [[32mPASS[0m in 0.62s]
[0m12:24:25.831819 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m12:24:25.832355 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m12:24:25.832805 [info ] [Thread-1 (]: 24 of 28 START test not_null_stock_prices_high ................................. [RUN]
[0m12:24:25.833537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_date.98a7527501, now test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc)
[0m12:24:25.834050 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m12:24:25.839524 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"
[0m12:24:25.840796 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m12:24:25.842848 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"
[0m12:24:25.844039 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"
[0m12:24:25.844429 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select high
from dev.analytics.stock_prices
where high is null



      
    ) dbt_internal_test
[0m12:24:25.844733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:26.310011 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.465 seconds
[0m12:24:26.314186 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc: Close
[0m12:24:26.453248 [info ] [Thread-1 (]: 24 of 28 PASS not_null_stock_prices_high ....................................... [[32mPASS[0m in 0.62s]
[0m12:24:26.454195 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m12:24:26.454750 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m12:24:26.455301 [info ] [Thread-1 (]: 25 of 28 START test not_null_stock_prices_low .................................. [RUN]
[0m12:24:26.455863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc, now test.stock_prediction.not_null_stock_prices_low.e65294ca15)
[0m12:24:26.456313 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m12:24:26.461484 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_low.e65294ca15"
[0m12:24:26.462618 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m12:24:26.464801 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_low.e65294ca15"
[0m12:24:26.465734 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_low.e65294ca15"
[0m12:24:26.466052 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_low.e65294ca15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_low.e65294ca15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select low
from dev.analytics.stock_prices
where low is null



      
    ) dbt_internal_test
[0m12:24:26.466346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:26.960734 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.494 seconds
[0m12:24:26.964755 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_low.e65294ca15: Close
[0m12:24:27.086940 [info ] [Thread-1 (]: 25 of 28 PASS not_null_stock_prices_low ........................................ [[32mPASS[0m in 0.63s]
[0m12:24:27.088020 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m12:24:27.088607 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m12:24:27.089231 [info ] [Thread-1 (]: 26 of 28 START test not_null_stock_prices_open ................................. [RUN]
[0m12:24:27.089865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_low.e65294ca15, now test.stock_prediction.not_null_stock_prices_open.e09b13f215)
[0m12:24:27.090323 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m12:24:27.095372 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_open.e09b13f215"
[0m12:24:27.096514 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m12:24:27.098549 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_open.e09b13f215"
[0m12:24:27.099468 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_open.e09b13f215"
[0m12:24:27.099787 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_open.e09b13f215: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_open.e09b13f215"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from dev.analytics.stock_prices
where open is null



      
    ) dbt_internal_test
[0m12:24:27.100091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:27.565331 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.465 seconds
[0m12:24:27.569175 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_open.e09b13f215: Close
[0m12:24:27.690379 [info ] [Thread-1 (]: 26 of 28 PASS not_null_stock_prices_open ....................................... [[32mPASS[0m in 0.60s]
[0m12:24:27.691250 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m12:24:27.691798 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m12:24:27.692353 [info ] [Thread-1 (]: 27 of 28 START test not_null_stock_prices_symbol ............................... [RUN]
[0m12:24:27.692951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_open.e09b13f215, now test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8)
[0m12:24:27.693327 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m12:24:27.698200 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"
[0m12:24:27.699235 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m12:24:27.701190 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"
[0m12:24:27.702156 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"
[0m12:24:27.702478 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.stock_prices
where symbol is null



      
    ) dbt_internal_test
[0m12:24:27.702778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:28.170271 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.467 seconds
[0m12:24:28.173792 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8: Close
[0m12:24:28.312613 [info ] [Thread-1 (]: 27 of 28 PASS not_null_stock_prices_symbol ..................................... [[32mPASS[0m in 0.62s]
[0m12:24:28.313712 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m12:24:28.314589 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m12:24:28.315222 [info ] [Thread-1 (]: 28 of 28 START test not_null_stock_prices_volume ............................... [RUN]
[0m12:24:28.315843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8, now test.stock_prediction.not_null_stock_prices_volume.71420bc956)
[0m12:24:28.316249 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m12:24:28.321447 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_volume.71420bc956"
[0m12:24:28.322526 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m12:24:28.324507 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_volume.71420bc956"
[0m12:24:28.325459 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_volume.71420bc956"
[0m12:24:28.325783 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_volume.71420bc956: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_volume.71420bc956"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume
from dev.analytics.stock_prices
where volume is null



      
    ) dbt_internal_test
[0m12:24:28.326075 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:28.828155 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.502 seconds
[0m12:24:28.832115 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_volume.71420bc956: Close
[0m12:24:28.974962 [info ] [Thread-1 (]: 28 of 28 PASS not_null_stock_prices_volume ..................................... [[32mPASS[0m in 0.66s]
[0m12:24:28.975930 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m12:24:28.977679 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:24:28.978049 [debug] [MainThread]: Connection 'test.stock_prediction.not_null_stock_prices_volume.71420bc956' was properly closed.
[0m12:24:28.978456 [info ] [MainThread]: 
[0m12:24:28.978854 [info ] [MainThread]: Finished running 28 data tests in 0 hours 0 minutes and 19.32 seconds (19.32s).
[0m12:24:28.983109 [debug] [MainThread]: Command end result
[0m12:24:29.012205 [info ] [MainThread]: 
[0m12:24:29.012494 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:24:29.012743 [info ] [MainThread]: 
[0m12:24:29.012995 [error] [MainThread]:   Compilation Error in test dbt_utils_not_negative_avg_true_range_atr_14d (models/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:24:29.013183 [info ] [MainThread]: 
[0m12:24:29.013354 [info ] [MainThread]: Done. PASS=27 WARN=0 ERROR=1 SKIP=0 TOTAL=28
[0m12:24:29.014865 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 19.735542, "process_user_time": 3.277661, "process_kernel_time": 0.431438, "process_mem_max_rss": "142016512", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:24:29.015243 [debug] [MainThread]: Command `dbt test` failed at 12:24:29.015182 after 19.74 seconds
[0m12:24:29.015452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cc3050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f224c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f22780>]}
[0m12:24:29.015652 [debug] [MainThread]: Flushing usage events
[0m12:24:34.052153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045a6120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ef7ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ef7d90>]}


============================== 12:24:34.054637 | f819bd56-b3f6-4ae9-8645-372f8a63c180 ==============================
[0m12:24:34.054637 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:24:34.054961 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:24:34.219239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f819bd56-b3f6-4ae9-8645-372f8a63c180', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b61a70>]}
[0m12:24:34.242133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f819bd56-b3f6-4ae9-8645-372f8a63c180', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b2c490>]}
[0m12:24:34.242543 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:24:34.252203 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:24:34.320394 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:24:34.320935 [debug] [MainThread]: Partial parsing: updated file: stock_prediction://models/schema.yml
[0m12:24:34.419690 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:24:34.420042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f819bd56-b3f6-4ae9-8645-372f8a63c180', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de9150>]}
[0m12:24:34.535929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f819bd56-b3f6-4ae9-8645-372f8a63c180', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bc75c0>]}
[0m12:24:34.594089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f819bd56-b3f6-4ae9-8645-372f8a63c180', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cde7b0>]}
[0m12:24:34.594337 [info ] [MainThread]: Found 5 models, 3 snapshots, 27 data tests, 2 sources, 459 macros
[0m12:24:34.594487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f819bd56-b3f6-4ae9-8645-372f8a63c180', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107103c70>]}
[0m12:24:34.595897 [info ] [MainThread]: 
[0m12:24:34.596165 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:24:34.598350 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_analytics'
[0m12:24:34.605772 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m12:24:34.605929 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m12:24:34.606048 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:24:35.113977 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.508 seconds
[0m12:24:35.116989 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m12:24:35.234041 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m12:24:35.237869 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m12:24:35.238224 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m12:24:35.238512 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:24:35.755757 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.517 seconds
[0m12:24:35.759773 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m12:24:35.885276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f819bd56-b3f6-4ae9-8645-372f8a63c180', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10725e2d0>]}
[0m12:24:35.885966 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:24:35.886271 [info ] [MainThread]: 
[0m12:24:35.889100 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m12:24:35.889500 [info ] [Thread-1 (]: 1 of 27 START test not_null_avg_true_range_atr_14d ............................. [RUN]
[0m12:24:35.889898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad)
[0m12:24:35.890199 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m12:24:35.904336 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad"
[0m12:24:35.904914 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m12:24:35.918199 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad"
[0m12:24:35.918780 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad"
[0m12:24:35.918998 [debug] [Thread-1 (]: On test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select atr_14d
from dev.analytics.avg_true_range
where atr_14d is null



      
    ) dbt_internal_test
[0m12:24:35.919190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:36.396918 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.477 seconds
[0m12:24:36.405551 [debug] [Thread-1 (]: On test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad: Close
[0m12:24:36.602701 [info ] [Thread-1 (]: 1 of 27 PASS not_null_avg_true_range_atr_14d ................................... [[32mPASS[0m in 0.71s]
[0m12:24:36.603917 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m12:24:36.604459 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_avg_true_range_date.4e418b835d
[0m12:24:36.604952 [info ] [Thread-1 (]: 2 of 27 START test not_null_avg_true_range_date ................................ [RUN]
[0m12:24:36.605465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad, now test.stock_prediction.not_null_avg_true_range_date.4e418b835d)
[0m12:24:36.605803 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_avg_true_range_date.4e418b835d
[0m12:24:36.610450 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_avg_true_range_date.4e418b835d"
[0m12:24:36.611366 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_avg_true_range_date.4e418b835d
[0m12:24:36.613116 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_avg_true_range_date.4e418b835d"
[0m12:24:36.613838 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_avg_true_range_date.4e418b835d"
[0m12:24:36.614091 [debug] [Thread-1 (]: On test.stock_prediction.not_null_avg_true_range_date.4e418b835d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_avg_true_range_date.4e418b835d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.avg_true_range
where date is null



      
    ) dbt_internal_test
[0m12:24:36.614330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:37.094874 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.480 seconds
[0m12:24:37.100819 [debug] [Thread-1 (]: On test.stock_prediction.not_null_avg_true_range_date.4e418b835d: Close
[0m12:24:37.227816 [info ] [Thread-1 (]: 2 of 27 PASS not_null_avg_true_range_date ...................................... [[32mPASS[0m in 0.62s]
[0m12:24:37.229148 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_avg_true_range_date.4e418b835d
[0m12:24:37.229544 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1
[0m12:24:37.229931 [info ] [Thread-1 (]: 3 of 27 START test not_null_avg_true_range_symbol .............................. [RUN]
[0m12:24:37.230332 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_avg_true_range_date.4e418b835d, now test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1)
[0m12:24:37.230592 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1
[0m12:24:37.234188 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1"
[0m12:24:37.235021 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1
[0m12:24:37.237253 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1"
[0m12:24:37.237978 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1"
[0m12:24:37.238227 [debug] [Thread-1 (]: On test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.avg_true_range
where symbol is null



      
    ) dbt_internal_test
[0m12:24:37.238450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:37.650823 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.412 seconds
[0m12:24:37.654985 [debug] [Thread-1 (]: On test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1: Close
[0m12:24:37.872757 [info ] [Thread-1 (]: 3 of 27 PASS not_null_avg_true_range_symbol .................................... [[32mPASS[0m in 0.64s]
[0m12:24:37.873612 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1
[0m12:24:37.874156 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_close.4ccb16a429
[0m12:24:37.874685 [info ] [Thread-1 (]: 4 of 27 START test not_null_bollinger_close .................................... [RUN]
[0m12:24:37.875260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1, now test.stock_prediction.not_null_bollinger_close.4ccb16a429)
[0m12:24:37.875701 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_close.4ccb16a429
[0m12:24:37.880839 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_close.4ccb16a429"
[0m12:24:37.881836 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_close.4ccb16a429
[0m12:24:37.884706 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_bollinger_close.4ccb16a429"
[0m12:24:37.885582 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_bollinger_close.4ccb16a429"
[0m12:24:37.885906 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_close.4ccb16a429: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_bollinger_close.4ccb16a429"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.bollinger
where close is null



      
    ) dbt_internal_test
[0m12:24:37.886202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:38.357953 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.471 seconds
[0m12:24:38.362201 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_close.4ccb16a429: Close
[0m12:24:38.498517 [info ] [Thread-1 (]: 4 of 27 PASS not_null_bollinger_close .......................................... [[32mPASS[0m in 0.62s]
[0m12:24:38.499551 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_close.4ccb16a429
[0m12:24:38.500006 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_date.9d77bdd20c
[0m12:24:38.500463 [info ] [Thread-1 (]: 5 of 27 START test not_null_bollinger_date ..................................... [RUN]
[0m12:24:38.500990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_close.4ccb16a429, now test.stock_prediction.not_null_bollinger_date.9d77bdd20c)
[0m12:24:38.501362 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_date.9d77bdd20c
[0m12:24:38.506171 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_date.9d77bdd20c"
[0m12:24:38.507156 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_date.9d77bdd20c
[0m12:24:38.509146 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_bollinger_date.9d77bdd20c"
[0m12:24:38.510051 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_bollinger_date.9d77bdd20c"
[0m12:24:38.510393 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_date.9d77bdd20c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_bollinger_date.9d77bdd20c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.bollinger
where date is null



      
    ) dbt_internal_test
[0m12:24:38.510686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:38.954712 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.443 seconds
[0m12:24:38.959477 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_date.9d77bdd20c: Close
[0m12:24:39.086759 [info ] [Thread-1 (]: 5 of 27 PASS not_null_bollinger_date ........................................... [[32mPASS[0m in 0.59s]
[0m12:24:39.087535 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_date.9d77bdd20c
[0m12:24:39.087984 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e
[0m12:24:39.088473 [info ] [Thread-1 (]: 6 of 27 START test not_null_bollinger_lower_band ............................... [RUN]
[0m12:24:39.089029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_date.9d77bdd20c, now test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e)
[0m12:24:39.089424 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e
[0m12:24:39.095235 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e"
[0m12:24:39.096542 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e
[0m12:24:39.099013 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e"
[0m12:24:39.100274 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e"
[0m12:24:39.100648 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select lower_band
from dev.analytics.bollinger
where lower_band is null



      
    ) dbt_internal_test
[0m12:24:39.100955 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:39.487707 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.386 seconds
[0m12:24:39.491660 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e: Close
[0m12:24:39.621992 [info ] [Thread-1 (]: 6 of 27 PASS not_null_bollinger_lower_band ..................................... [[32mPASS[0m in 0.53s]
[0m12:24:39.622907 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e
[0m12:24:39.623436 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3
[0m12:24:39.623989 [info ] [Thread-1 (]: 7 of 27 START test not_null_bollinger_sma_20d .................................. [RUN]
[0m12:24:39.624633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e, now test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3)
[0m12:24:39.625090 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3
[0m12:24:39.630305 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3"
[0m12:24:39.631372 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3
[0m12:24:39.633620 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3"
[0m12:24:39.634518 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3"
[0m12:24:39.634854 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sma_20d
from dev.analytics.bollinger
where sma_20d is null



      
    ) dbt_internal_test
[0m12:24:39.635149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:40.018836 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.383 seconds
[0m12:24:40.022067 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3: Close
[0m12:24:40.161874 [info ] [Thread-1 (]: 7 of 27 PASS not_null_bollinger_sma_20d ........................................ [[32mPASS[0m in 0.54s]
[0m12:24:40.163001 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3
[0m12:24:40.163639 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_symbol.a932e30f82
[0m12:24:40.164181 [info ] [Thread-1 (]: 8 of 27 START test not_null_bollinger_symbol ................................... [RUN]
[0m12:24:40.164736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3, now test.stock_prediction.not_null_bollinger_symbol.a932e30f82)
[0m12:24:40.165120 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_symbol.a932e30f82
[0m12:24:40.170073 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_symbol.a932e30f82"
[0m12:24:40.171091 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_symbol.a932e30f82
[0m12:24:40.173167 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_bollinger_symbol.a932e30f82"
[0m12:24:40.174088 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_bollinger_symbol.a932e30f82"
[0m12:24:40.174552 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_symbol.a932e30f82: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_bollinger_symbol.a932e30f82"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.bollinger
where symbol is null



      
    ) dbt_internal_test
[0m12:24:40.174894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:40.633525 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.458 seconds
[0m12:24:40.636939 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_symbol.a932e30f82: Close
[0m12:24:40.793052 [info ] [Thread-1 (]: 8 of 27 PASS not_null_bollinger_symbol ......................................... [[32mPASS[0m in 0.63s]
[0m12:24:40.794195 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_symbol.a932e30f82
[0m12:24:40.794812 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_upper_band.e4db87564c
[0m12:24:40.795453 [info ] [Thread-1 (]: 9 of 27 START test not_null_bollinger_upper_band ............................... [RUN]
[0m12:24:40.796127 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_symbol.a932e30f82, now test.stock_prediction.not_null_bollinger_upper_band.e4db87564c)
[0m12:24:40.796513 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_upper_band.e4db87564c
[0m12:24:40.801631 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_upper_band.e4db87564c"
[0m12:24:40.802777 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_upper_band.e4db87564c
[0m12:24:40.804785 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_bollinger_upper_band.e4db87564c"
[0m12:24:40.805687 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_bollinger_upper_band.e4db87564c"
[0m12:24:40.806019 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_upper_band.e4db87564c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_bollinger_upper_band.e4db87564c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select upper_band
from dev.analytics.bollinger
where upper_band is null



      
    ) dbt_internal_test
[0m12:24:40.806323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:41.321791 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.515 seconds
[0m12:24:41.327906 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_upper_band.e4db87564c: Close
[0m12:24:41.446954 [info ] [Thread-1 (]: 9 of 27 PASS not_null_bollinger_upper_band ..................................... [[32mPASS[0m in 0.65s]
[0m12:24:41.448707 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_upper_band.e4db87564c
[0m12:24:41.449452 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m12:24:41.449982 [info ] [Thread-1 (]: 10 of 27 START test not_null_moving_average_close .............................. [RUN]
[0m12:24:41.450897 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_upper_band.e4db87564c, now test.stock_prediction.not_null_moving_average_close.6d037dd588)
[0m12:24:41.451575 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m12:24:41.461527 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_close.6d037dd588"
[0m12:24:41.462432 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m12:24:41.463959 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_close.6d037dd588"
[0m12:24:41.464635 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_close.6d037dd588"
[0m12:24:41.464843 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_close.6d037dd588: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_close.6d037dd588"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.moving_average
where close is null



      
    ) dbt_internal_test
[0m12:24:41.465027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:41.925669 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.460 seconds
[0m12:24:41.929330 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_close.6d037dd588: Close
[0m12:24:42.079647 [info ] [Thread-1 (]: 10 of 27 PASS not_null_moving_average_close .................................... [[32mPASS[0m in 0.63s]
[0m12:24:42.080630 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m12:24:42.081150 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m12:24:42.081599 [info ] [Thread-1 (]: 11 of 27 START test not_null_moving_average_date ............................... [RUN]
[0m12:24:42.082234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_close.6d037dd588, now test.stock_prediction.not_null_moving_average_date.3ad00158b5)
[0m12:24:42.083079 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m12:24:42.091206 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_date.3ad00158b5"
[0m12:24:42.092949 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m12:24:42.096513 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_date.3ad00158b5"
[0m12:24:42.097865 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_date.3ad00158b5"
[0m12:24:42.098378 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_date.3ad00158b5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_date.3ad00158b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.moving_average
where date is null



      
    ) dbt_internal_test
[0m12:24:42.098842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:42.506444 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.406 seconds
[0m12:24:42.512455 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_date.3ad00158b5: Close
[0m12:24:42.637117 [info ] [Thread-1 (]: 11 of 27 PASS not_null_moving_average_date ..................................... [[32mPASS[0m in 0.55s]
[0m12:24:42.642184 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m12:24:42.643019 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m12:24:42.643610 [info ] [Thread-1 (]: 12 of 27 START test not_null_moving_average_moving_avg_20d ..................... [RUN]
[0m12:24:42.644278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_date.3ad00158b5, now test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22)
[0m12:24:42.644744 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m12:24:42.653636 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m12:24:42.655169 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m12:24:42.658440 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m12:24:42.659776 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m12:24:42.660259 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg_20d
from dev.analytics.moving_average
where moving_avg_20d is null



      
    ) dbt_internal_test
[0m12:24:42.660700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:43.140461 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.479 seconds
[0m12:24:43.147967 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22: Close
[0m12:24:43.307388 [info ] [Thread-1 (]: 12 of 27 PASS not_null_moving_average_moving_avg_20d ........................... [[32mPASS[0m in 0.66s]
[0m12:24:43.308264 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m12:24:43.308743 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m12:24:43.309143 [info ] [Thread-1 (]: 13 of 27 START test not_null_moving_average_moving_avg_5d ...................... [RUN]
[0m12:24:43.309597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22, now test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca)
[0m12:24:43.310054 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m12:24:43.315103 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m12:24:43.316895 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m12:24:43.319600 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m12:24:43.320797 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m12:24:43.321225 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg_5d
from dev.analytics.moving_average
where moving_avg_5d is null



      
    ) dbt_internal_test
[0m12:24:43.321695 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:43.871506 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.544 seconds
[0m12:24:43.877653 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca: Close
[0m12:24:44.012978 [info ] [Thread-1 (]: 13 of 27 PASS not_null_moving_average_moving_avg_5d ............................ [[32mPASS[0m in 0.70s]
[0m12:24:44.014805 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m12:24:44.015402 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m12:24:44.016162 [info ] [Thread-1 (]: 14 of 27 START test not_null_moving_average_symbol ............................. [RUN]
[0m12:24:44.016915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca, now test.stock_prediction.not_null_moving_average_symbol.75a6f7473c)
[0m12:24:44.017477 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m12:24:44.027652 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"
[0m12:24:44.029123 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m12:24:44.032137 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"
[0m12:24:44.033460 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"
[0m12:24:44.033920 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_symbol.75a6f7473c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.moving_average
where symbol is null



      
    ) dbt_internal_test
[0m12:24:44.034316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:44.567289 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.533 seconds
[0m12:24:44.570851 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_symbol.75a6f7473c: Close
[0m12:24:44.728551 [info ] [Thread-1 (]: 14 of 27 PASS not_null_moving_average_symbol ................................... [[32mPASS[0m in 0.71s]
[0m12:24:44.733581 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m12:24:44.734630 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m12:24:44.735439 [info ] [Thread-1 (]: 15 of 27 START test not_null_rsi_calculation_avg_gain .......................... [RUN]
[0m12:24:44.736365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_symbol.75a6f7473c, now test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42)
[0m12:24:44.738120 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m12:24:44.751982 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m12:24:44.753401 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m12:24:44.756257 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m12:24:44.757354 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m12:24:44.757753 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_gain
from dev.analytics.rsi_calculation
where avg_gain is null



      
    ) dbt_internal_test
[0m12:24:44.758109 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:45.279584 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.521 seconds
[0m12:24:45.285646 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42: Close
[0m12:24:45.421489 [info ] [Thread-1 (]: 15 of 27 PASS not_null_rsi_calculation_avg_gain ................................ [[32mPASS[0m in 0.68s]
[0m12:24:45.429169 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m12:24:45.430130 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m12:24:45.430755 [info ] [Thread-1 (]: 16 of 27 START test not_null_rsi_calculation_avg_loss .......................... [RUN]
[0m12:24:45.431589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42, now test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19)
[0m12:24:45.432069 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m12:24:45.444567 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m12:24:45.445944 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m12:24:45.449492 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m12:24:45.450948 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m12:24:45.451461 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_loss
from dev.analytics.rsi_calculation
where avg_loss is null



      
    ) dbt_internal_test
[0m12:24:45.451902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:45.905759 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.453 seconds
[0m12:24:45.913664 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19: Close
[0m12:24:46.054623 [info ] [Thread-1 (]: 16 of 27 PASS not_null_rsi_calculation_avg_loss ................................ [[32mPASS[0m in 0.62s]
[0m12:24:46.056495 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m12:24:46.057681 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m12:24:46.058221 [info ] [Thread-1 (]: 17 of 27 START test not_null_rsi_calculation_close ............................. [RUN]
[0m12:24:46.061422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19, now test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d)
[0m12:24:46.062030 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m12:24:46.071353 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"
[0m12:24:46.072772 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m12:24:46.075596 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"
[0m12:24:46.077088 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"
[0m12:24:46.077516 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.rsi_calculation
where close is null



      
    ) dbt_internal_test
[0m12:24:46.077878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:46.566946 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.489 seconds
[0m12:24:46.572323 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d: Close
[0m12:24:46.708700 [info ] [Thread-1 (]: 17 of 27 PASS not_null_rsi_calculation_close ................................... [[32mPASS[0m in 0.64s]
[0m12:24:46.710726 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m12:24:46.711639 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m12:24:46.712518 [info ] [Thread-1 (]: 18 of 27 START test not_null_rsi_calculation_date .............................. [RUN]
[0m12:24:46.713566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d, now test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76)
[0m12:24:46.718645 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m12:24:46.731708 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"
[0m12:24:46.733619 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m12:24:46.736970 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"
[0m12:24:46.738645 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"
[0m12:24:46.739159 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.rsi_calculation
where date is null



      
    ) dbt_internal_test
[0m12:24:46.739600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:47.232466 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.492 seconds
[0m12:24:47.242887 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76: Close
[0m12:24:47.417274 [info ] [Thread-1 (]: 18 of 27 PASS not_null_rsi_calculation_date .................................... [[32mPASS[0m in 0.70s]
[0m12:24:47.419358 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m12:24:47.420382 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m12:24:47.421192 [info ] [Thread-1 (]: 19 of 27 START test not_null_rsi_calculation_rsi_14d ........................... [RUN]
[0m12:24:47.426899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76, now test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8)
[0m12:24:47.427928 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m12:24:47.439827 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m12:24:47.441253 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m12:24:47.444259 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m12:24:47.445521 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m12:24:47.446007 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from dev.analytics.rsi_calculation
where rsi_14d is null



      
    ) dbt_internal_test
[0m12:24:47.446448 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:47.966812 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.520 seconds
[0m12:24:47.975753 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8: Close
[0m12:24:48.091232 [info ] [Thread-1 (]: 19 of 27 PASS not_null_rsi_calculation_rsi_14d ................................. [[32mPASS[0m in 0.67s]
[0m12:24:48.092929 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m12:24:48.093444 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m12:24:48.093940 [info ] [Thread-1 (]: 20 of 27 START test not_null_rsi_calculation_symbol ............................ [RUN]
[0m12:24:48.094469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8, now test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84)
[0m12:24:48.094875 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m12:24:48.101477 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m12:24:48.103235 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m12:24:48.109605 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m12:24:48.111441 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m12:24:48.111987 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.rsi_calculation
where symbol is null



      
    ) dbt_internal_test
[0m12:24:48.112452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:48.634693 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.522 seconds
[0m12:24:48.637421 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84: Close
[0m12:24:48.779917 [info ] [Thread-1 (]: 20 of 27 PASS not_null_rsi_calculation_symbol .................................. [[32mPASS[0m in 0.68s]
[0m12:24:48.782096 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m12:24:48.783075 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m12:24:48.785242 [info ] [Thread-1 (]: 21 of 27 START test not_null_stock_prices_close ................................ [RUN]
[0m12:24:48.786181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84, now test.stock_prediction.not_null_stock_prices_close.d7e232e1ba)
[0m12:24:48.786856 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m12:24:48.795762 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"
[0m12:24:48.797254 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m12:24:48.799952 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"
[0m12:24:48.801019 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"
[0m12:24:48.801419 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_close.d7e232e1ba: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.stock_prices
where close is null



      
    ) dbt_internal_test
[0m12:24:48.801781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:49.255086 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.452 seconds
[0m12:24:49.262781 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_close.d7e232e1ba: Close
[0m12:24:49.412427 [info ] [Thread-1 (]: 21 of 27 PASS not_null_stock_prices_close ...................................... [[32mPASS[0m in 0.63s]
[0m12:24:49.414600 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m12:24:49.415536 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m12:24:49.416438 [info ] [Thread-1 (]: 22 of 27 START test not_null_stock_prices_date ................................. [RUN]
[0m12:24:49.417387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_close.d7e232e1ba, now test.stock_prediction.not_null_stock_prices_date.98a7527501)
[0m12:24:49.418203 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m12:24:49.427222 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_date.98a7527501"
[0m12:24:49.429177 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m12:24:49.432814 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_date.98a7527501"
[0m12:24:49.434439 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_date.98a7527501"
[0m12:24:49.434942 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_date.98a7527501: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_date.98a7527501"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.stock_prices
where date is null



      
    ) dbt_internal_test
[0m12:24:49.435378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:49.963191 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.527 seconds
[0m12:24:49.970582 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_date.98a7527501: Close
[0m12:24:50.133961 [info ] [Thread-1 (]: 22 of 27 PASS not_null_stock_prices_date ....................................... [[32mPASS[0m in 0.72s]
[0m12:24:50.136181 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m12:24:50.137068 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m12:24:50.137823 [info ] [Thread-1 (]: 23 of 27 START test not_null_stock_prices_high ................................. [RUN]
[0m12:24:50.138652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_date.98a7527501, now test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc)
[0m12:24:50.139220 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m12:24:50.148200 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"
[0m12:24:50.149662 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m12:24:50.152698 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"
[0m12:24:50.154049 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"
[0m12:24:50.154527 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select high
from dev.analytics.stock_prices
where high is null



      
    ) dbt_internal_test
[0m12:24:50.155122 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:50.682303 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.527 seconds
[0m12:24:50.689741 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc: Close
[0m12:24:50.834066 [info ] [Thread-1 (]: 23 of 27 PASS not_null_stock_prices_high ....................................... [[32mPASS[0m in 0.70s]
[0m12:24:50.835263 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m12:24:50.836400 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m12:24:50.836947 [info ] [Thread-1 (]: 24 of 27 START test not_null_stock_prices_low .................................. [RUN]
[0m12:24:50.838033 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc, now test.stock_prediction.not_null_stock_prices_low.e65294ca15)
[0m12:24:50.838807 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m12:24:50.848811 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_low.e65294ca15"
[0m12:24:50.850357 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m12:24:50.853549 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_low.e65294ca15"
[0m12:24:50.854849 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_low.e65294ca15"
[0m12:24:50.855344 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_low.e65294ca15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_low.e65294ca15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select low
from dev.analytics.stock_prices
where low is null



      
    ) dbt_internal_test
[0m12:24:50.855791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:51.382151 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.526 seconds
[0m12:24:51.389056 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_low.e65294ca15: Close
[0m12:24:51.509854 [info ] [Thread-1 (]: 24 of 27 PASS not_null_stock_prices_low ........................................ [[32mPASS[0m in 0.67s]
[0m12:24:51.511989 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m12:24:51.512920 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m12:24:51.513734 [info ] [Thread-1 (]: 25 of 27 START test not_null_stock_prices_open ................................. [RUN]
[0m12:24:51.514638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_low.e65294ca15, now test.stock_prediction.not_null_stock_prices_open.e09b13f215)
[0m12:24:51.515284 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m12:24:51.524435 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_open.e09b13f215"
[0m12:24:51.525931 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m12:24:51.528983 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_open.e09b13f215"
[0m12:24:51.530286 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_open.e09b13f215"
[0m12:24:51.530764 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_open.e09b13f215: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_open.e09b13f215"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from dev.analytics.stock_prices
where open is null



      
    ) dbt_internal_test
[0m12:24:51.531261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:51.994181 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.462 seconds
[0m12:24:52.001577 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_open.e09b13f215: Close
[0m12:24:52.144570 [info ] [Thread-1 (]: 25 of 27 PASS not_null_stock_prices_open ....................................... [[32mPASS[0m in 0.63s]
[0m12:24:52.146140 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m12:24:52.147378 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m12:24:52.148253 [info ] [Thread-1 (]: 26 of 27 START test not_null_stock_prices_symbol ............................... [RUN]
[0m12:24:52.149855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_open.e09b13f215, now test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8)
[0m12:24:52.151395 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m12:24:52.162394 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"
[0m12:24:52.163578 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m12:24:52.166121 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"
[0m12:24:52.167244 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"
[0m12:24:52.167623 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.stock_prices
where symbol is null



      
    ) dbt_internal_test
[0m12:24:52.167950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:52.631611 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.463 seconds
[0m12:24:52.644822 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8: Close
[0m12:24:52.770133 [info ] [Thread-1 (]: 26 of 27 PASS not_null_stock_prices_symbol ..................................... [[32mPASS[0m in 0.62s]
[0m12:24:52.771946 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m12:24:52.772542 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m12:24:52.773022 [info ] [Thread-1 (]: 27 of 27 START test not_null_stock_prices_volume ............................... [RUN]
[0m12:24:52.773658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8, now test.stock_prediction.not_null_stock_prices_volume.71420bc956)
[0m12:24:52.774052 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m12:24:52.781307 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_volume.71420bc956"
[0m12:24:52.782573 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m12:24:52.786551 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_volume.71420bc956"
[0m12:24:52.787630 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_volume.71420bc956"
[0m12:24:52.787909 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_volume.71420bc956: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_volume.71420bc956"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume
from dev.analytics.stock_prices
where volume is null



      
    ) dbt_internal_test
[0m12:24:52.788096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:24:53.310488 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.522 seconds
[0m12:24:53.316116 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_volume.71420bc956: Close
[0m12:24:53.461268 [info ] [Thread-1 (]: 27 of 27 PASS not_null_stock_prices_volume ..................................... [[32mPASS[0m in 0.69s]
[0m12:24:53.462916 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m12:24:53.472420 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:24:53.475772 [debug] [MainThread]: Connection 'test.stock_prediction.not_null_stock_prices_volume.71420bc956' was properly closed.
[0m12:24:53.476229 [info ] [MainThread]: 
[0m12:24:53.479291 [info ] [MainThread]: Finished running 27 data tests in 0 hours 0 minutes and 18.88 seconds (18.88s).
[0m12:24:53.484099 [debug] [MainThread]: Command end result
[0m12:24:53.518678 [info ] [MainThread]: 
[0m12:24:53.519096 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:24:53.519318 [info ] [MainThread]: 
[0m12:24:53.519528 [info ] [MainThread]: Done. PASS=27 WARN=0 ERROR=0 SKIP=0 TOTAL=27
[0m12:24:53.521802 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 19.505981, "process_user_time": 3.71017, "process_kernel_time": 0.472282, "process_mem_max_rss": "145211392", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:24:53.522460 [debug] [MainThread]: Command `dbt test` succeeded at 12:24:53.522370 after 19.51 seconds
[0m12:24:53.522912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071ff800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072f7390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072f5b30>]}
[0m12:24:53.523342 [debug] [MainThread]: Flushing usage events
[0m12:25:39.022443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045ae120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105effed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105effd90>]}


============================== 12:25:39.024588 | 78c7d9ee-ee5c-46f4-abf5-51436b00e58d ==============================
[0m12:25:39.024588 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:25:39.024886 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:25:39.187852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78c7d9ee-ee5c-46f4-abf5-51436b00e58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b65a70>]}
[0m12:25:39.210538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78c7d9ee-ee5c-46f4-abf5-51436b00e58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a54490>]}
[0m12:25:39.210934 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:25:39.219725 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:25:39.285192 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:25:39.285403 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:25:39.309434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78c7d9ee-ee5c-46f4-abf5-51436b00e58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069b4b50>]}
[0m12:25:39.365244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78c7d9ee-ee5c-46f4-abf5-51436b00e58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106be3200>]}
[0m12:25:39.365524 [info ] [MainThread]: Found 5 models, 3 snapshots, 27 data tests, 2 sources, 459 macros
[0m12:25:39.365674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78c7d9ee-ee5c-46f4-abf5-51436b00e58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e4de10>]}
[0m12:25:39.366820 [info ] [MainThread]: 
[0m12:25:39.367084 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:25:39.369120 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m12:25:39.376003 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m12:25:39.376156 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m12:25:39.376283 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:39.981613 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.605 seconds
[0m12:25:39.985844 [debug] [ThreadPool]: On list_dev: Close
[0m12:25:40.116951 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m12:25:40.128846 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m12:25:40.129203 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m12:25:40.129463 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:25:40.693843 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.564 seconds
[0m12:25:40.697990 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m12:25:40.814080 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m12:25:40.818332 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m12:25:40.818693 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m12:25:40.818966 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:25:41.291341 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.472 seconds
[0m12:25:41.295930 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m12:25:41.413472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78c7d9ee-ee5c-46f4-abf5-51436b00e58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dff860>]}
[0m12:25:41.414194 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:25:41.414544 [info ] [MainThread]: 
[0m12:25:41.417455 [debug] [Thread-1 (]: Began running node snapshot.stock_prediction.snapshot_bollinger
[0m12:25:41.418018 [info ] [Thread-1 (]: 1 of 3 START snapshot snapshot.snapshot_bollinger .............................. [RUN]
[0m12:25:41.418454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now snapshot.stock_prediction.snapshot_bollinger)
[0m12:25:41.418775 [debug] [Thread-1 (]: Began compiling node snapshot.stock_prediction.snapshot_bollinger
[0m12:25:41.426824 [debug] [Thread-1 (]: Began executing node snapshot.stock_prediction.snapshot_bollinger
[0m12:25:41.462619 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_bollinger"
[0m12:25:41.462879 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
[0m12:25:41.463049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:41.832082 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.368 seconds
[0m12:25:41.874936 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_bollinger"
[0m12:25:41.875362 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.bollinger


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m12:25:42.832297 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.956 seconds
[0m12:25:42.837683 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_bollinger"
[0m12:25:42.838302 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
[0m12:25:42.936479 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.097 seconds
[0m12:25:42.942902 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_bollinger"
[0m12:25:42.943480 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
[0m12:25:43.040336 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.096 seconds
[0m12:25:43.046471 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_bollinger"
[0m12:25:43.046829 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
[0m12:25:43.157229 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.110 seconds
[0m12:25:43.163997 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_bollinger"
[0m12:25:43.164437 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
[0m12:25:43.252348 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.087 seconds
[0m12:25:43.261012 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_bollinger"
[0m12:25:43.261565 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
[0m12:25:43.332387 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.070 seconds
[0m12:25:43.354298 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_bollinger"
[0m12:25:43.354743 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.bollinger


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m12:25:43.533352 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.178 seconds
[0m12:25:43.538148 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_bollinger"
[0m12:25:43.538856 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m12:25:43.619348 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.080 seconds
[0m12:25:43.620328 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_prediction.snapshot_bollinger"
[0m12:25:43.621811 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_bollinger"
[0m12:25:43.622038 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
BEGIN
[0m12:25:43.737478 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.115 seconds
[0m12:25:43.738587 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_bollinger"
[0m12:25:43.739142 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "SMA_20D", "UPPER_BAND", "LOWER_BAND", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "SMA_20D", "UPPER_BAND", "LOWER_BAND", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m12:25:44.176500 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.437 seconds
[0m12:25:44.177244 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_bollinger"
[0m12:25:44.177574 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
COMMIT
[0m12:25:44.673836 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.496 seconds
[0m12:25:44.689956 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_bollinger: Close
[0m12:25:44.835586 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78c7d9ee-ee5c-46f4-abf5-51436b00e58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fd1fd0>]}
[0m12:25:44.837021 [info ] [Thread-1 (]: 1 of 3 OK snapshotted snapshot.snapshot_bollinger .............................. [[32mSUCCESS 0[0m in 3.42s]
[0m12:25:44.837901 [debug] [Thread-1 (]: Finished running node snapshot.stock_prediction.snapshot_bollinger
[0m12:25:44.838432 [debug] [Thread-1 (]: Began running node snapshot.stock_prediction.snapshot_moving_avg
[0m12:25:44.839086 [info ] [Thread-1 (]: 2 of 3 START snapshot snapshot.snapshot_moving_avg ............................. [RUN]
[0m12:25:44.839624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_prediction.snapshot_bollinger, now snapshot.stock_prediction.snapshot_moving_avg)
[0m12:25:44.840017 [debug] [Thread-1 (]: Began compiling node snapshot.stock_prediction.snapshot_moving_avg
[0m12:25:44.843703 [debug] [Thread-1 (]: Began executing node snapshot.stock_prediction.snapshot_moving_avg
[0m12:25:44.848108 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:25:44.848462 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
[0m12:25:44.848773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:45.234795 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.386 seconds
[0m12:25:45.239838 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:25:45.240206 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.moving_average


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m12:25:46.005077 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.764 seconds
[0m12:25:46.010955 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:25:46.011560 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
[0m12:25:46.106231 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.094 seconds
[0m12:25:46.111335 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:25:46.111748 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
[0m12:25:46.186528 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.074 seconds
[0m12:25:46.192168 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:25:46.192610 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
[0m12:25:46.333864 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.141 seconds
[0m12:25:46.339377 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:25:46.339861 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
[0m12:25:46.470602 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.130 seconds
[0m12:25:46.480498 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:25:46.480930 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
[0m12:25:46.552335 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.071 seconds
[0m12:25:46.556916 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:25:46.557413 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.moving_average


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m12:25:46.753505 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.195 seconds
[0m12:25:46.774574 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:25:46.775906 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m12:25:46.859645 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.083 seconds
[0m12:25:46.861521 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:25:46.873323 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:25:46.873966 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
BEGIN
[0m12:25:47.019558 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.145 seconds
[0m12:25:47.021200 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:25:47.022232 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "MOVING_AVG_5D", "MOVING_AVG_20D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "MOVING_AVG_5D", "MOVING_AVG_20D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m12:25:47.499873 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.474 seconds
[0m12:25:47.506248 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:25:47.507209 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
COMMIT
[0m12:25:47.951194 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.443 seconds
[0m12:25:47.958777 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: Close
[0m12:25:48.106640 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78c7d9ee-ee5c-46f4-abf5-51436b00e58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071092e0>]}
[0m12:25:48.110980 [info ] [Thread-1 (]: 2 of 3 OK snapshotted snapshot.snapshot_moving_avg ............................. [[32mSUCCESS 0[0m in 3.27s]
[0m12:25:48.112468 [debug] [Thread-1 (]: Finished running node snapshot.stock_prediction.snapshot_moving_avg
[0m12:25:48.113232 [debug] [Thread-1 (]: Began running node snapshot.stock_prediction.snapshot_rsi
[0m12:25:48.114166 [info ] [Thread-1 (]: 3 of 3 START snapshot snapshot.snapshot_rsi .................................... [RUN]
[0m12:25:48.114992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_prediction.snapshot_moving_avg, now snapshot.stock_prediction.snapshot_rsi)
[0m12:25:48.115497 [debug] [Thread-1 (]: Began compiling node snapshot.stock_prediction.snapshot_rsi
[0m12:25:48.126099 [debug] [Thread-1 (]: Began executing node snapshot.stock_prediction.snapshot_rsi
[0m12:25:48.138423 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:25:48.139091 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m12:25:48.139576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:48.547222 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.407 seconds
[0m12:25:48.565449 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:25:48.567215 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.rsi_calculation


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m12:25:49.287941 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.720 seconds
[0m12:25:49.302371 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:25:49.305205 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m12:25:49.383044 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.076 seconds
[0m12:25:49.396622 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:25:49.397735 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m12:25:49.503613 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.105 seconds
[0m12:25:49.513646 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:25:49.514614 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m12:25:49.599412 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.084 seconds
[0m12:25:49.612535 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:25:49.614309 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m12:25:49.697219 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.081 seconds
[0m12:25:49.709147 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:25:49.710520 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m12:25:49.777638 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.066 seconds
[0m12:25:49.795378 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:25:49.796561 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.rsi_calculation


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m12:25:49.960516 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.162 seconds
[0m12:25:49.964427 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:25:49.965210 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m12:25:50.041643 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.075 seconds
[0m12:25:50.043538 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_prediction.snapshot_rsi"
[0m12:25:50.048111 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:25:50.049424 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
BEGIN
[0m12:25:50.203109 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.153 seconds
[0m12:25:50.204495 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:25:50.205446 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_RSI" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "AVG_GAIN", "AVG_LOSS", "RSI_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "AVG_GAIN", "AVG_LOSS", "RSI_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m12:25:50.817057 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.610 seconds
[0m12:25:50.818999 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:25:50.820392 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
COMMIT
[0m12:25:51.229816 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.404 seconds
[0m12:25:51.237909 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: Close
[0m12:25:51.362047 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78c7d9ee-ee5c-46f4-abf5-51436b00e58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a17110>]}
[0m12:25:51.364581 [info ] [Thread-1 (]: 3 of 3 OK snapshotted snapshot.snapshot_rsi .................................... [[32mSUCCESS 0[0m in 3.25s]
[0m12:25:51.365905 [debug] [Thread-1 (]: Finished running node snapshot.stock_prediction.snapshot_rsi
[0m12:25:51.368922 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:25:51.369400 [debug] [MainThread]: Connection 'snapshot.stock_prediction.snapshot_rsi' was properly closed.
[0m12:25:51.369900 [info ] [MainThread]: 
[0m12:25:51.370973 [info ] [MainThread]: Finished running 3 snapshots in 0 hours 0 minutes and 12.00 seconds (12.00s).
[0m12:25:51.373847 [debug] [MainThread]: Command end result
[0m12:25:51.413286 [info ] [MainThread]: 
[0m12:25:51.413884 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:25:51.414106 [info ] [MainThread]: 
[0m12:25:51.414326 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:25:51.415932 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 12.426551, "process_user_time": 1.896168, "process_kernel_time": 0.248811, "process_mem_max_rss": "136085504", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:25:51.416325 [debug] [MainThread]: Command `dbt snapshot` succeeded at 12:25:51.416252 after 12.43 seconds
[0m12:25:51.416631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c394d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a7d2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f39630>]}
[0m12:25:51.416867 [debug] [MainThread]: Flushing usage events
[0m12:25:56.877106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1025ae120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103effed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103effd90>]}


============================== 12:25:56.879340 | 4fd9c8fa-b0c6-4d67-82ba-f90db010ec5a ==============================
[0m12:25:56.879340 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:25:56.879644 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:25:57.041100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4fd9c8fa-b0c6-4d67-82ba-f90db010ec5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b69a70>]}
[0m12:25:57.063780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4fd9c8fa-b0c6-4d67-82ba-f90db010ec5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a54490>]}
[0m12:25:57.064172 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:25:57.072321 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:25:57.140227 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:25:57.140600 [debug] [MainThread]: Partial parsing: added file: stock_prediction://snapshots/snapshot_atr.sql
[0m12:25:57.259372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fd9c8fa-b0c6-4d67-82ba-f90db010ec5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104de9250>]}
[0m12:25:57.345516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fd9c8fa-b0c6-4d67-82ba-f90db010ec5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f60b90>]}
[0m12:25:57.345774 [info ] [MainThread]: Found 5 models, 4 snapshots, 27 data tests, 2 sources, 459 macros
[0m12:25:57.345929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fd9c8fa-b0c6-4d67-82ba-f90db010ec5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a70130>]}
[0m12:25:57.346989 [info ] [MainThread]: 
[0m12:25:57.347238 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:25:57.349208 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m12:25:57.355121 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m12:25:57.355272 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m12:25:57.355393 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:57.797464 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.442 seconds
[0m12:25:57.801369 [debug] [ThreadPool]: On list_dev: Close
[0m12:25:57.946194 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m12:25:57.956584 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m12:25:57.956922 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m12:25:57.957170 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:25:58.382511 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.425 seconds
[0m12:25:58.386505 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m12:25:58.509699 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m12:25:58.512973 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m12:25:58.513283 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m12:25:58.513530 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:25:58.994165 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.480 seconds
[0m12:25:58.999475 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m12:25:59.115781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fd9c8fa-b0c6-4d67-82ba-f90db010ec5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050572b0>]}
[0m12:25:59.116501 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:25:59.116840 [info ] [MainThread]: 
[0m12:25:59.119721 [debug] [Thread-1 (]: Began running node snapshot.stock_prediction.snapshot_atr
[0m12:25:59.120375 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshot.snapshot_atr .................................... [RUN]
[0m12:25:59.120806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now snapshot.stock_prediction.snapshot_atr)
[0m12:25:59.121108 [debug] [Thread-1 (]: Began compiling node snapshot.stock_prediction.snapshot_atr
[0m12:25:59.129803 [debug] [Thread-1 (]: Began executing node snapshot.stock_prediction.snapshot_atr
[0m12:25:59.178786 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_atr"
[0m12:25:59.179078 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_atr"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_atr"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id,
        date as dbt_updated_at,
        date as dbt_valid_from,
        
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to

    from (
        



SELECT * FROM dev.analytics.avg_true_range

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m12:25:59.179258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:59.622313 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.442 seconds
[0m12:25:59.631932 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_atr"
[0m12:25:59.632502 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_atr"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_atr"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m12:25:59.717928 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.085 seconds
[0m12:25:59.719941 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_prediction.snapshot_atr"
[0m12:25:59.722357 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_atr"
[0m12:25:59.722903 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_atr"} */
create or replace transient table dev.snapshot.snapshot_atr
         as
        (
    

    select *,
        md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id,
        date as dbt_updated_at,
        date as dbt_valid_from,
        
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to

    from (
        



SELECT * FROM dev.analytics.avg_true_range

    ) sbq



        );
[0m12:26:00.496886 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.773 seconds
[0m12:26:00.522876 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_atr: Close
[0m12:26:00.664253 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fd9c8fa-b0c6-4d67-82ba-f90db010ec5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105023290>]}
[0m12:26:00.665420 [info ] [Thread-1 (]: 1 of 4 OK snapshotted snapshot.snapshot_atr .................................... [[32mSUCCESS 1[0m in 1.54s]
[0m12:26:00.666120 [debug] [Thread-1 (]: Finished running node snapshot.stock_prediction.snapshot_atr
[0m12:26:00.666644 [debug] [Thread-1 (]: Began running node snapshot.stock_prediction.snapshot_bollinger
[0m12:26:00.667276 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshot.snapshot_bollinger .............................. [RUN]
[0m12:26:00.667840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_prediction.snapshot_atr, now snapshot.stock_prediction.snapshot_bollinger)
[0m12:26:00.668246 [debug] [Thread-1 (]: Began compiling node snapshot.stock_prediction.snapshot_bollinger
[0m12:26:00.672437 [debug] [Thread-1 (]: Began executing node snapshot.stock_prediction.snapshot_bollinger
[0m12:26:00.681455 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_bollinger"
[0m12:26:00.681772 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
[0m12:26:00.682030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:01.212473 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.530 seconds
[0m12:26:01.247111 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_bollinger"
[0m12:26:01.247664 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.bollinger


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m12:26:02.081846 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.833 seconds
[0m12:26:02.086582 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_bollinger"
[0m12:26:02.087119 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
[0m12:26:02.191586 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.104 seconds
[0m12:26:02.198428 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_bollinger"
[0m12:26:02.198905 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
[0m12:26:02.349666 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.150 seconds
[0m12:26:02.355303 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_bollinger"
[0m12:26:02.355670 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
[0m12:26:02.446107 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.090 seconds
[0m12:26:02.452679 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_bollinger"
[0m12:26:02.453221 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
[0m12:26:02.579803 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.126 seconds
[0m12:26:02.591143 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_bollinger"
[0m12:26:02.591505 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
[0m12:26:02.666113 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.074 seconds
[0m12:26:02.678440 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_bollinger"
[0m12:26:02.678899 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.bollinger


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m12:26:02.885104 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.205 seconds
[0m12:26:02.887950 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_bollinger"
[0m12:26:02.888510 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m12:26:03.000541 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.111 seconds
[0m12:26:03.002803 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_prediction.snapshot_bollinger"
[0m12:26:03.006932 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_bollinger"
[0m12:26:03.007395 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
BEGIN
[0m12:26:03.172710 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.165 seconds
[0m12:26:03.173733 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_bollinger"
[0m12:26:03.174205 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "SMA_20D", "UPPER_BAND", "LOWER_BAND", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "SMA_20D", "UPPER_BAND", "LOWER_BAND", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m12:26:04.027584 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.852 seconds
[0m12:26:04.028691 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_bollinger"
[0m12:26:04.029179 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
COMMIT
[0m12:26:04.607634 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.577 seconds
[0m12:26:04.615095 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_bollinger: Close
[0m12:26:04.752027 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fd9c8fa-b0c6-4d67-82ba-f90db010ec5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051dad00>]}
[0m12:26:04.753121 [info ] [Thread-1 (]: 2 of 4 OK snapshotted snapshot.snapshot_bollinger .............................. [[32mSUCCESS 0[0m in 4.08s]
[0m12:26:04.753835 [debug] [Thread-1 (]: Finished running node snapshot.stock_prediction.snapshot_bollinger
[0m12:26:04.754338 [debug] [Thread-1 (]: Began running node snapshot.stock_prediction.snapshot_moving_avg
[0m12:26:04.754971 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshot.snapshot_moving_avg ............................. [RUN]
[0m12:26:04.755534 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_prediction.snapshot_bollinger, now snapshot.stock_prediction.snapshot_moving_avg)
[0m12:26:04.755941 [debug] [Thread-1 (]: Began compiling node snapshot.stock_prediction.snapshot_moving_avg
[0m12:26:04.759431 [debug] [Thread-1 (]: Began executing node snapshot.stock_prediction.snapshot_moving_avg
[0m12:26:04.764023 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:26:04.764331 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
[0m12:26:04.764603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:05.205506 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.440 seconds
[0m12:26:05.216925 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:26:05.217580 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.moving_average


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m12:26:06.034956 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.816 seconds
[0m12:26:06.040724 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:26:06.041334 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
[0m12:26:06.170630 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.129 seconds
[0m12:26:06.176701 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:26:06.177147 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
[0m12:26:06.261433 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.084 seconds
[0m12:26:06.267613 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:26:06.268059 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
[0m12:26:06.374775 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.106 seconds
[0m12:26:06.381751 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:26:06.382035 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
[0m12:26:06.468429 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.086 seconds
[0m12:26:06.472867 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:26:06.473247 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
[0m12:26:06.556632 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.083 seconds
[0m12:26:06.563039 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:26:06.563623 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.moving_average


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m12:26:06.740804 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.176 seconds
[0m12:26:06.743696 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:26:06.744248 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m12:26:06.850310 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.105 seconds
[0m12:26:06.851666 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:26:06.854088 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:26:06.854578 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
BEGIN
[0m12:26:07.000771 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.145 seconds
[0m12:26:07.002593 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:26:07.003133 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "MOVING_AVG_5D", "MOVING_AVG_20D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "MOVING_AVG_5D", "MOVING_AVG_20D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m12:26:07.574798 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.571 seconds
[0m12:26:07.576770 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:26:07.577756 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
COMMIT
[0m12:26:07.916646 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.338 seconds
[0m12:26:07.921641 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: Close
[0m12:26:08.041297 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fd9c8fa-b0c6-4d67-82ba-f90db010ec5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105491b30>]}
[0m12:26:08.043078 [info ] [Thread-1 (]: 3 of 4 OK snapshotted snapshot.snapshot_moving_avg ............................. [[32mSUCCESS 0[0m in 3.29s]
[0m12:26:08.044014 [debug] [Thread-1 (]: Finished running node snapshot.stock_prediction.snapshot_moving_avg
[0m12:26:08.044611 [debug] [Thread-1 (]: Began running node snapshot.stock_prediction.snapshot_rsi
[0m12:26:08.045318 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshot.snapshot_rsi .................................... [RUN]
[0m12:26:08.045933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_prediction.snapshot_moving_avg, now snapshot.stock_prediction.snapshot_rsi)
[0m12:26:08.046334 [debug] [Thread-1 (]: Began compiling node snapshot.stock_prediction.snapshot_rsi
[0m12:26:08.050385 [debug] [Thread-1 (]: Began executing node snapshot.stock_prediction.snapshot_rsi
[0m12:26:08.055056 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:26:08.055406 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m12:26:08.055700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:08.428808 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.373 seconds
[0m12:26:08.438881 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:26:08.439611 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.rsi_calculation


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m12:26:09.147971 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.707 seconds
[0m12:26:09.153633 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:26:09.154150 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m12:26:09.279451 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.125 seconds
[0m12:26:09.289111 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:26:09.289553 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m12:26:09.383788 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.094 seconds
[0m12:26:09.389447 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:26:09.389993 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m12:26:09.472134 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.081 seconds
[0m12:26:09.476829 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:26:09.477220 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m12:26:09.558171 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.080 seconds
[0m12:26:09.567617 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:26:09.568104 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m12:26:09.685253 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.116 seconds
[0m12:26:09.693101 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:26:09.693733 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.rsi_calculation


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m12:26:09.877728 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.183 seconds
[0m12:26:09.880618 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:26:09.881106 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m12:26:10.003524 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.122 seconds
[0m12:26:10.007789 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_prediction.snapshot_rsi"
[0m12:26:10.012027 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:26:10.012568 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
BEGIN
[0m12:26:10.171085 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.158 seconds
[0m12:26:10.172211 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:26:10.172748 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_RSI" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "AVG_GAIN", "AVG_LOSS", "RSI_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "AVG_GAIN", "AVG_LOSS", "RSI_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m12:26:10.740671 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.567 seconds
[0m12:26:10.741596 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:26:10.742054 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
COMMIT
[0m12:26:11.196226 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.453 seconds
[0m12:26:11.202480 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: Close
[0m12:26:11.327803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fd9c8fa-b0c6-4d67-82ba-f90db010ec5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102997850>]}
[0m12:26:11.329897 [info ] [Thread-1 (]: 4 of 4 OK snapshotted snapshot.snapshot_rsi .................................... [[32mSUCCESS 0[0m in 3.28s]
[0m12:26:11.330991 [debug] [Thread-1 (]: Finished running node snapshot.stock_prediction.snapshot_rsi
[0m12:26:11.332750 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:26:11.333094 [debug] [MainThread]: Connection 'snapshot.stock_prediction.snapshot_rsi' was properly closed.
[0m12:26:11.333439 [info ] [MainThread]: 
[0m12:26:11.333758 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 13.99 seconds (13.99s).
[0m12:26:11.334901 [debug] [MainThread]: Command end result
[0m12:26:11.362539 [info ] [MainThread]: 
[0m12:26:11.362827 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:26:11.363020 [info ] [MainThread]: 
[0m12:26:11.363200 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m12:26:11.364286 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 14.518363, "process_user_time": 1.971936, "process_kernel_time": 0.219701, "process_mem_max_rss": "137953280", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:26:11.364608 [debug] [MainThread]: Command `dbt snapshot` succeeded at 12:26:11.364549 after 14.52 seconds
[0m12:26:11.364817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f3d630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1004c0210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101a70110>]}
[0m12:26:11.365021 [debug] [MainThread]: Flushing usage events
[0m12:28:28.553241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072e2120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c33d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c33ed0>]}


============================== 12:28:28.555419 | ce36cfce-8c03-4e0f-bff6-64a5ba9149f2 ==============================
[0m12:28:28.555419 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:28:28.555715 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:28:28.719874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce36cfce-8c03-4e0f-bff6-64a5ba9149f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099fdba0>]}
[0m12:28:28.742483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce36cfce-8c03-4e0f-bff6-64a5ba9149f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099d0490>]}
[0m12:28:28.742858 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:28:28.751083 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:28:28.819814 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:28:28.820030 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:28:28.844165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce36cfce-8c03-4e0f-bff6-64a5ba9149f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109930b50>]}
[0m12:28:28.853884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce36cfce-8c03-4e0f-bff6-64a5ba9149f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109db94f0>]}
[0m12:28:28.854141 [info ] [MainThread]: Found 5 models, 4 snapshots, 27 data tests, 2 sources, 459 macros
[0m12:28:28.854303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce36cfce-8c03-4e0f-bff6-64a5ba9149f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dc1710>]}
[0m12:28:28.855641 [info ] [MainThread]: 
[0m12:28:28.855912 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:28:28.858100 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_snapshot'
[0m12:28:28.867691 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m12:28:28.867878 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m12:28:28.868003 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:29.445094 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.577 seconds
[0m12:28:29.451782 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m12:28:29.579463 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m12:28:29.583515 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m12:28:29.583946 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m12:28:29.584257 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:29.994505 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.410 seconds
[0m12:28:29.998421 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m12:28:30.145191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce36cfce-8c03-4e0f-bff6-64a5ba9149f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a00aa90>]}
[0m12:28:30.146055 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:28:30.146480 [info ] [MainThread]: 
[0m12:28:30.149259 [debug] [Thread-1 (]: Began running node model.stock_prediction.stock_prices
[0m12:28:30.149742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.stock_prediction.stock_prices)
[0m12:28:30.150096 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.stock_prices
[0m12:28:30.159296 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.stock_prices"
[0m12:28:30.160158 [debug] [Thread-1 (]: Began executing node model.stock_prediction.stock_prices
[0m12:28:30.160751 [debug] [Thread-1 (]: Finished running node model.stock_prediction.stock_prices
[0m12:28:30.161510 [debug] [Thread-1 (]: Began running node model.stock_prediction.avg_true_range
[0m12:28:30.161839 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.stock_prices, now model.stock_prediction.avg_true_range)
[0m12:28:30.162109 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.avg_true_range
[0m12:28:30.164097 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.avg_true_range"
[0m12:28:30.164618 [debug] [Thread-1 (]: Began executing node model.stock_prediction.avg_true_range
[0m12:28:30.165115 [debug] [Thread-1 (]: Finished running node model.stock_prediction.avg_true_range
[0m12:28:30.165401 [debug] [Thread-1 (]: Began running node model.stock_prediction.bollinger
[0m12:28:30.165718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.avg_true_range, now model.stock_prediction.bollinger)
[0m12:28:30.166040 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.bollinger
[0m12:28:30.167843 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.bollinger"
[0m12:28:30.168271 [debug] [Thread-1 (]: Began executing node model.stock_prediction.bollinger
[0m12:28:30.168684 [debug] [Thread-1 (]: Finished running node model.stock_prediction.bollinger
[0m12:28:30.168924 [debug] [Thread-1 (]: Began running node model.stock_prediction.moving_average
[0m12:28:30.169186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.bollinger, now model.stock_prediction.moving_average)
[0m12:28:30.169460 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.moving_average
[0m12:28:30.175377 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.moving_average"
[0m12:28:30.175953 [debug] [Thread-1 (]: Began executing node model.stock_prediction.moving_average
[0m12:28:30.176378 [debug] [Thread-1 (]: Finished running node model.stock_prediction.moving_average
[0m12:28:30.176613 [debug] [Thread-1 (]: Began running node model.stock_prediction.rsi_calculation
[0m12:28:30.176870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.moving_average, now model.stock_prediction.rsi_calculation)
[0m12:28:30.177151 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.rsi_calculation
[0m12:28:30.178776 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.rsi_calculation"
[0m12:28:30.179153 [debug] [Thread-1 (]: Began executing node model.stock_prediction.rsi_calculation
[0m12:28:30.179523 [debug] [Thread-1 (]: Finished running node model.stock_prediction.rsi_calculation
[0m12:28:30.179750 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m12:28:30.179988 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.rsi_calculation, now test.stock_prediction.not_null_stock_prices_close.d7e232e1ba)
[0m12:28:30.180222 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m12:28:30.222816 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"
[0m12:28:30.223288 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m12:28:30.223612 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m12:28:30.223785 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m12:28:30.223968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_close.d7e232e1ba, now test.stock_prediction.not_null_stock_prices_date.98a7527501)
[0m12:28:30.224124 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m12:28:30.225826 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_date.98a7527501"
[0m12:28:30.226107 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m12:28:30.226370 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m12:28:30.226522 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m12:28:30.226674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_date.98a7527501, now test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc)
[0m12:28:30.226807 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m12:28:30.228569 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"
[0m12:28:30.228831 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m12:28:30.229096 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m12:28:30.229253 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m12:28:30.229402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc, now test.stock_prediction.not_null_stock_prices_low.e65294ca15)
[0m12:28:30.229534 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m12:28:30.231092 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_low.e65294ca15"
[0m12:28:30.231338 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m12:28:30.231601 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m12:28:30.231755 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m12:28:30.231913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_low.e65294ca15, now test.stock_prediction.not_null_stock_prices_open.e09b13f215)
[0m12:28:30.232060 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m12:28:30.233629 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_open.e09b13f215"
[0m12:28:30.233896 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m12:28:30.234157 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m12:28:30.234310 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m12:28:30.234463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_open.e09b13f215, now test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8)
[0m12:28:30.234596 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m12:28:30.236433 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"
[0m12:28:30.236687 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m12:28:30.236956 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m12:28:30.237114 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m12:28:30.237264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8, now test.stock_prediction.not_null_stock_prices_volume.71420bc956)
[0m12:28:30.237399 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m12:28:30.238939 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_volume.71420bc956"
[0m12:28:30.239207 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m12:28:30.239475 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m12:28:30.239638 [debug] [Thread-1 (]: Began running node snapshot.stock_prediction.snapshot_atr
[0m12:28:30.239789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_volume.71420bc956, now snapshot.stock_prediction.snapshot_atr)
[0m12:28:30.239918 [debug] [Thread-1 (]: Began compiling node snapshot.stock_prediction.snapshot_atr
[0m12:28:30.241144 [debug] [Thread-1 (]: Began executing node snapshot.stock_prediction.snapshot_atr
[0m12:28:30.241402 [debug] [Thread-1 (]: Finished running node snapshot.stock_prediction.snapshot_atr
[0m12:28:30.241556 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m12:28:30.241711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_prediction.snapshot_atr, now test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad)
[0m12:28:30.241850 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m12:28:30.243667 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad"
[0m12:28:30.243921 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m12:28:30.244185 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m12:28:30.244336 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_avg_true_range_date.4e418b835d
[0m12:28:30.244483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad, now test.stock_prediction.not_null_avg_true_range_date.4e418b835d)
[0m12:28:30.244613 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_avg_true_range_date.4e418b835d
[0m12:28:30.246119 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_avg_true_range_date.4e418b835d"
[0m12:28:30.246364 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_avg_true_range_date.4e418b835d
[0m12:28:30.246620 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_avg_true_range_date.4e418b835d
[0m12:28:30.246772 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1
[0m12:28:30.246924 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_avg_true_range_date.4e418b835d, now test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1)
[0m12:28:30.247059 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1
[0m12:28:30.248774 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1"
[0m12:28:30.249022 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1
[0m12:28:30.249284 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1
[0m12:28:30.249441 [debug] [Thread-1 (]: Began running node snapshot.stock_prediction.snapshot_bollinger
[0m12:28:30.249597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1, now snapshot.stock_prediction.snapshot_bollinger)
[0m12:28:30.249742 [debug] [Thread-1 (]: Began compiling node snapshot.stock_prediction.snapshot_bollinger
[0m12:28:30.250942 [debug] [Thread-1 (]: Began executing node snapshot.stock_prediction.snapshot_bollinger
[0m12:28:30.251203 [debug] [Thread-1 (]: Finished running node snapshot.stock_prediction.snapshot_bollinger
[0m12:28:30.251355 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_close.4ccb16a429
[0m12:28:30.251510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_prediction.snapshot_bollinger, now test.stock_prediction.not_null_bollinger_close.4ccb16a429)
[0m12:28:30.251639 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_close.4ccb16a429
[0m12:28:30.253154 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_close.4ccb16a429"
[0m12:28:30.253403 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_close.4ccb16a429
[0m12:28:30.253656 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_close.4ccb16a429
[0m12:28:30.253804 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_date.9d77bdd20c
[0m12:28:30.253952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_close.4ccb16a429, now test.stock_prediction.not_null_bollinger_date.9d77bdd20c)
[0m12:28:30.254083 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_date.9d77bdd20c
[0m12:28:30.255847 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_date.9d77bdd20c"
[0m12:28:30.256093 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_date.9d77bdd20c
[0m12:28:30.256358 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_date.9d77bdd20c
[0m12:28:30.256513 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e
[0m12:28:30.256667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_date.9d77bdd20c, now test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e)
[0m12:28:30.256799 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e
[0m12:28:30.258308 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e"
[0m12:28:30.258549 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e
[0m12:28:30.258805 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e
[0m12:28:30.258954 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3
[0m12:28:30.259103 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e, now test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3)
[0m12:28:30.259233 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3
[0m12:28:30.260958 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3"
[0m12:28:30.261215 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3
[0m12:28:30.261477 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3
[0m12:28:30.261628 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_symbol.a932e30f82
[0m12:28:30.261776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3, now test.stock_prediction.not_null_bollinger_symbol.a932e30f82)
[0m12:28:30.261908 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_symbol.a932e30f82
[0m12:28:30.263421 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_symbol.a932e30f82"
[0m12:28:30.263677 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_symbol.a932e30f82
[0m12:28:30.263941 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_symbol.a932e30f82
[0m12:28:30.264095 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_upper_band.e4db87564c
[0m12:28:30.264247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_symbol.a932e30f82, now test.stock_prediction.not_null_bollinger_upper_band.e4db87564c)
[0m12:28:30.264383 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_upper_band.e4db87564c
[0m12:28:30.265886 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_upper_band.e4db87564c"
[0m12:28:30.266127 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_upper_band.e4db87564c
[0m12:28:30.266377 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_upper_band.e4db87564c
[0m12:28:30.266528 [debug] [Thread-1 (]: Began running node snapshot.stock_prediction.snapshot_moving_avg
[0m12:28:30.266672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_upper_band.e4db87564c, now snapshot.stock_prediction.snapshot_moving_avg)
[0m12:28:30.266798 [debug] [Thread-1 (]: Began compiling node snapshot.stock_prediction.snapshot_moving_avg
[0m12:28:30.268267 [debug] [Thread-1 (]: Began executing node snapshot.stock_prediction.snapshot_moving_avg
[0m12:28:30.268538 [debug] [Thread-1 (]: Finished running node snapshot.stock_prediction.snapshot_moving_avg
[0m12:28:30.268694 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m12:28:30.268845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_prediction.snapshot_moving_avg, now test.stock_prediction.not_null_moving_average_close.6d037dd588)
[0m12:28:30.268979 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m12:28:30.270495 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_close.6d037dd588"
[0m12:28:30.270743 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m12:28:30.271015 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m12:28:30.271175 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m12:28:30.271328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_close.6d037dd588, now test.stock_prediction.not_null_moving_average_date.3ad00158b5)
[0m12:28:30.271462 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m12:28:30.272975 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_date.3ad00158b5"
[0m12:28:30.273214 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m12:28:30.273469 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m12:28:30.273622 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m12:28:30.273768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_date.3ad00158b5, now test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22)
[0m12:28:30.273900 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m12:28:30.275690 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m12:28:30.275947 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m12:28:30.276207 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m12:28:30.276357 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m12:28:30.276504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22, now test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca)
[0m12:28:30.276635 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m12:28:30.278133 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m12:28:30.278377 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m12:28:30.278634 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m12:28:30.278786 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m12:28:30.278936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca, now test.stock_prediction.not_null_moving_average_symbol.75a6f7473c)
[0m12:28:30.279068 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m12:28:30.280799 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"
[0m12:28:30.281040 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m12:28:30.281306 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m12:28:30.281462 [debug] [Thread-1 (]: Began running node snapshot.stock_prediction.snapshot_rsi
[0m12:28:30.281615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_symbol.75a6f7473c, now snapshot.stock_prediction.snapshot_rsi)
[0m12:28:30.281748 [debug] [Thread-1 (]: Began compiling node snapshot.stock_prediction.snapshot_rsi
[0m12:28:30.282951 [debug] [Thread-1 (]: Began executing node snapshot.stock_prediction.snapshot_rsi
[0m12:28:30.283221 [debug] [Thread-1 (]: Finished running node snapshot.stock_prediction.snapshot_rsi
[0m12:28:30.283374 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m12:28:30.283524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_prediction.snapshot_rsi, now test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42)
[0m12:28:30.283656 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m12:28:30.285153 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m12:28:30.285404 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m12:28:30.285659 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m12:28:30.285811 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m12:28:30.285964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42, now test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19)
[0m12:28:30.286114 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m12:28:30.287900 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m12:28:30.288163 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m12:28:30.288429 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m12:28:30.288586 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m12:28:30.288744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19, now test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d)
[0m12:28:30.288878 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m12:28:30.290381 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"
[0m12:28:30.290626 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m12:28:30.290880 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m12:28:30.291033 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m12:28:30.291183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d, now test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76)
[0m12:28:30.291315 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m12:28:30.292830 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"
[0m12:28:30.293079 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m12:28:30.293341 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m12:28:30.293496 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m12:28:30.293645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76, now test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8)
[0m12:28:30.293778 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m12:28:30.295595 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m12:28:30.295844 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m12:28:30.296106 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m12:28:30.296263 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m12:28:30.296414 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8, now test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84)
[0m12:28:30.296546 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m12:28:30.298035 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m12:28:30.298273 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m12:28:30.298524 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m12:28:30.298944 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:28:30.299068 [debug] [MainThread]: Connection 'test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84' was properly closed.
[0m12:28:30.300984 [debug] [MainThread]: Command end result
[0m12:28:30.352314 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m12:28:30.352495 [info ] [MainThread]: Building catalog
[0m12:28:30.357097 [debug] [ThreadPool]: Acquiring new snowflake connection 'dev.information_schema'
[0m12:28:30.364942 [debug] [ThreadPool]: Using snowflake connection "dev.information_schema"
[0m12:28:30.365311 [debug] [ThreadPool]: On dev.information_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "dev.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from dev.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'bollinger' and upper("table_name") = upper('bollinger')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshot' and upper("table_schema") = upper('snapshot')

                    and 
    "table_name" ilike 'snapshot_atr' and upper("table_name") = upper('snapshot_atr')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'avg_true_range' and upper("table_name") = upper('avg_true_range')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'rsi_calculation' and upper("table_name") = upper('rsi_calculation')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'moving_average' and upper("table_name") = upper('moving_average')

                )
             or 
                (
                    
    "table_schema" ilike 'raw_data' and upper("table_schema") = upper('raw_data')

                    and 
    "table_name" ilike 'stock_prices' and upper("table_name") = upper('stock_prices')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'stock_prices' and upper("table_name") = upper('stock_prices')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshot' and upper("table_schema") = upper('snapshot')

                    and 
    "table_name" ilike 'snapshot_bollinger' and upper("table_name") = upper('snapshot_bollinger')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshot' and upper("table_schema") = upper('snapshot')

                    and 
    "table_name" ilike 'snapshot_moving_avg' and upper("table_name") = upper('snapshot_moving_avg')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'stock_summary' and upper("table_name") = upper('stock_summary')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshot' and upper("table_schema") = upper('snapshot')

                    and 
    "table_name" ilike 'snapshot_rsi' and upper("table_name") = upper('snapshot_rsi')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from dev.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'bollinger' and upper("table_name") = upper('bollinger')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshot' and upper("table_schema") = upper('snapshot')

                    and 
    "table_name" ilike 'snapshot_atr' and upper("table_name") = upper('snapshot_atr')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'avg_true_range' and upper("table_name") = upper('avg_true_range')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'rsi_calculation' and upper("table_name") = upper('rsi_calculation')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'moving_average' and upper("table_name") = upper('moving_average')

                )
             or 
                (
                    
    "table_schema" ilike 'raw_data' and upper("table_schema") = upper('raw_data')

                    and 
    "table_name" ilike 'stock_prices' and upper("table_name") = upper('stock_prices')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'stock_prices' and upper("table_name") = upper('stock_prices')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshot' and upper("table_schema") = upper('snapshot')

                    and 
    "table_name" ilike 'snapshot_bollinger' and upper("table_name") = upper('snapshot_bollinger')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshot' and upper("table_schema") = upper('snapshot')

                    and 
    "table_name" ilike 'snapshot_moving_avg' and upper("table_name") = upper('snapshot_moving_avg')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'stock_summary' and upper("table_name") = upper('stock_summary')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshot' and upper("table_schema") = upper('snapshot')

                    and 
    "table_name" ilike 'snapshot_rsi' and upper("table_name") = upper('snapshot_rsi')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m12:28:30.365655 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:34.830250 [debug] [ThreadPool]: SQL status: SUCCESS 70 in 4.464 seconds
[0m12:28:34.846625 [debug] [ThreadPool]: On dev.information_schema: Close
[0m12:28:35.005849 [info ] [MainThread]: Catalog written to /Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/target/catalog.json
[0m12:28:35.007296 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 6.4864388, "process_user_time": 1.274351, "process_kernel_time": 0.173183, "process_mem_max_rss": "136019968", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:28:35.007699 [debug] [MainThread]: Command `dbt docs generate` succeeded at 12:28:35.007635 after 6.49 seconds
[0m12:28:35.007884 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:28:35.008018 [debug] [MainThread]: Connection 'dev.information_schema' was properly closed.
[0m12:28:35.008193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10895b050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab87b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab87ac0>]}
[0m12:28:35.008385 [debug] [MainThread]: Flushing usage events
[0m12:28:51.379008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10449a120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105debd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105debed0>]}


============================== 12:28:51.381083 | 7fe4b72f-cc46-4814-a02d-0a3da81e952a ==============================
[0m12:28:51.381083 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:28:51.381377 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'profiles_dir': '/Users/adi/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:28:51.539971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7fe4b72f-cc46-4814-a02d-0a3da81e952a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a4dba0>]}
[0m12:28:51.562799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7fe4b72f-cc46-4814-a02d-0a3da81e952a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069c05a0>]}
[0m12:29:29.108138 [error] [MainThread]: Encountered an error:

[0m12:29:29.118392 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/adi/Downloads/DATA226/dbtVirtual/lib/python3.13/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Users/adi/Downloads/DATA226/dbtVirtual/lib/python3.13/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/Users/adi/Downloads/DATA226/dbtVirtual/lib/python3.13/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/Users/adi/Downloads/DATA226/dbtVirtual/lib/python3.13/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/Users/adi/Downloads/DATA226/dbtVirtual/lib/python3.13/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/Users/adi/Downloads/DATA226/dbtVirtual/lib/python3.13/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/Users/adi/Downloads/DATA226/dbtVirtual/lib/python3.13/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
    ~~~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socketserver.py", line 240, in serve_forever
    self._handle_request_noblock()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socketserver.py", line 318, in _handle_request_noblock
    self.process_request(request, client_address)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socketserver.py", line 349, in process_request
    self.finish_request(request, client_address)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socketserver.py", line 362, in finish_request
    self.RequestHandlerClass(request, client_address, self)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/server.py", line 672, in __init__
    super().__init__(*args, **kwargs)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socketserver.py", line 761, in __init__
    self.handle()
    ~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/server.py", line 436, in handle
    self.handle_one_request()
    ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/server.py", line 404, in handle_one_request
    self.raw_requestline = self.rfile.readline(65537)
                           ~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 719, in readinto
    return self._sock.recv_into(b)
           ~~~~~~~~~~~~~~~~~~~~^^^
KeyboardInterrupt

[0m12:29:29.121507 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 37.77353, "process_user_time": 0.716699, "process_kernel_time": 0.125663, "process_mem_max_rss": "120520704", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:29:29.122519 [debug] [MainThread]: Command `dbt docs serve` failed at 12:29:29.122371 after 37.77 seconds
[0m12:29:29.123152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106983950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106983a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a7fc50>]}
[0m12:29:29.123593 [debug] [MainThread]: Flushing usage events
[0m12:30:44.267860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f4e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bab3ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bab3d90>]}


============================== 12:30:44.270514 | 379917ca-8c18-41a9-86cb-a4df3db99b2f ==============================
[0m12:30:44.270514 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:30:44.270809 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/adi/.dbt', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:30:44.320401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '379917ca-8c18-41a9-86cb-a4df3db99b2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11918e8b0>]}
[0m12:30:44.333747 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.09991204, "process_user_time": 0.65807, "process_kernel_time": 0.135821, "process_mem_max_rss": "100499456", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:30:44.334006 [debug] [MainThread]: Command `dbt clean` succeeded at 12:30:44.333951 after 0.10 seconds
[0m12:30:44.334153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bbf2470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bbf2580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b69e150>]}
[0m12:30:44.334293 [debug] [MainThread]: Flushing usage events
[0m12:30:49.523095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029a6120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042f7ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042f7d90>]}


============================== 12:30:49.525333 | 6d726cce-350c-4a53-81bb-8fcc79d16a9d ==============================
[0m12:30:49.525333 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:30:49.525636 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:30:49.744732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d726cce-350c-4a53-81bb-8fcc79d16a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f61a70>]}
[0m12:30:49.767388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d726cce-350c-4a53-81bb-8fcc79d16a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e4c490>]}
[0m12:30:49.768705 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:30:49.777914 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:30:49.778459 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:30:49.778633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6d726cce-350c-4a53-81bb-8fcc79d16a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dac050>]}
[0m12:30:50.347595 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:30:50.347886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6d726cce-350c-4a53-81bb-8fcc79d16a9d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10507c6e0>]}
[0m12:30:50.496495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d726cce-350c-4a53-81bb-8fcc79d16a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040dd0f0>]}
[0m12:30:50.550087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d726cce-350c-4a53-81bb-8fcc79d16a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104db53d0>]}
[0m12:30:50.550343 [info ] [MainThread]: Found 5 models, 4 snapshots, 27 data tests, 1 source, 459 macros
[0m12:30:50.550496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d726cce-350c-4a53-81bb-8fcc79d16a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053a3890>]}
[0m12:30:50.551578 [info ] [MainThread]: 
[0m12:30:50.551833 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:30:50.553923 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m12:30:50.559876 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m12:30:50.560031 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m12:30:50.560151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:30:51.155107 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.594 seconds
[0m12:30:51.158834 [debug] [ThreadPool]: On list_dev: Close
[0m12:30:51.328425 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m12:30:51.338062 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m12:30:51.338372 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m12:30:51.338602 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:30:51.830413 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.491 seconds
[0m12:30:51.837448 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m12:30:51.968112 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m12:30:51.971624 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m12:30:51.971960 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m12:30:51.972232 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:30:52.428657 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.456 seconds
[0m12:30:52.433337 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m12:30:52.577368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d726cce-350c-4a53-81bb-8fcc79d16a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056c4890>]}
[0m12:30:52.578205 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:30:52.578581 [info ] [MainThread]: 
[0m12:30:52.582860 [debug] [Thread-1 (]: Began running node model.stock_prediction.stock_prices
[0m12:30:52.583488 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stock_prices ............................. [RUN]
[0m12:30:52.583946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now model.stock_prediction.stock_prices)
[0m12:30:52.584313 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.stock_prices
[0m12:30:52.593173 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.stock_prices"
[0m12:30:52.594356 [debug] [Thread-1 (]: Began executing node model.stock_prediction.stock_prices
[0m12:30:52.615634 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.stock_prices"
[0m12:30:52.616600 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.stock_prices"
[0m12:30:52.616829 [debug] [Thread-1 (]: On model.stock_prediction.stock_prices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.stock_prices"} */
create or replace   view dev.analytics.stock_prices
  
   as (
    SELECT
    symbol,
    date,
    open,
    high,
    low,
    close,
    volume
FROM dev.raw_data.stock_prices
  );
[0m12:30:52.617016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:53.415656 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.798 seconds
[0m12:30:53.442771 [debug] [Thread-1 (]: On model.stock_prediction.stock_prices: Close
[0m12:30:53.563340 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d726cce-350c-4a53-81bb-8fcc79d16a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038b93b0>]}
[0m12:30:53.564319 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stock_prices ........................ [[32mSUCCESS 1[0m in 0.98s]
[0m12:30:53.565115 [debug] [Thread-1 (]: Finished running node model.stock_prediction.stock_prices
[0m12:30:53.566336 [debug] [Thread-1 (]: Began running node model.stock_prediction.avg_true_range
[0m12:30:53.566924 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.avg_true_range .......................... [RUN]
[0m12:30:53.567407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.stock_prices, now model.stock_prediction.avg_true_range)
[0m12:30:53.567777 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.avg_true_range
[0m12:30:53.570987 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.avg_true_range"
[0m12:30:53.572142 [debug] [Thread-1 (]: Began executing node model.stock_prediction.avg_true_range
[0m12:30:53.590434 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.avg_true_range"
[0m12:30:53.591550 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.avg_true_range"
[0m12:30:53.591827 [debug] [Thread-1 (]: On model.stock_prediction.avg_true_range: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.avg_true_range"} */
create or replace transient table dev.analytics.avg_true_range
         as
        (WITH averageTrueRanges AS (
    SELECT
        date,
        symbol,
        close,
        ABS(close - LAG(close) OVER (PARTITION BY symbol ORDER BY date)) AS true_range
    FROM dev.analytics.stock_prices
),
atr AS (
    SELECT
        date,
        symbol,
        AVG(true_range) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS atr_14d
    FROM averageTrueRanges
)
SELECT 
    date, 
    symbol, 
    COALESCE(atr_14d, 0) AS atr_14d
FROM atr
ORDER BY date, symbol
        );
[0m12:30:53.592072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:54.929335 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.337 seconds
[0m12:30:54.936095 [debug] [Thread-1 (]: On model.stock_prediction.avg_true_range: Close
[0m12:30:55.041563 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d726cce-350c-4a53-81bb-8fcc79d16a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038bc150>]}
[0m12:30:55.042690 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.avg_true_range ..................... [[32mSUCCESS 1[0m in 1.47s]
[0m12:30:55.043486 [debug] [Thread-1 (]: Finished running node model.stock_prediction.avg_true_range
[0m12:30:55.043994 [debug] [Thread-1 (]: Began running node model.stock_prediction.bollinger
[0m12:30:55.044583 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.bollinger ............................... [RUN]
[0m12:30:55.045101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.avg_true_range, now model.stock_prediction.bollinger)
[0m12:30:55.045476 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.bollinger
[0m12:30:55.049053 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.bollinger"
[0m12:30:55.050167 [debug] [Thread-1 (]: Began executing node model.stock_prediction.bollinger
[0m12:30:55.053208 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.bollinger"
[0m12:30:55.054649 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.bollinger"
[0m12:30:55.055000 [debug] [Thread-1 (]: On model.stock_prediction.bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.bollinger"} */
create or replace transient table dev.analytics.bollinger
         as
        (WITH bollinger AS (
    SELECT
        symbol,
        date,
        close,
        AVG(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) AS sma_20d,
        STDDEV(close) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
        ) AS stddev_20d
    FROM dev.analytics.stock_prices
)

SELECT
    symbol,
    date,
    close,
    COALESCE(sma_20d, 0) AS sma_20d,
    COALESCE(sma_20d + (2 * stddev_20d), 0) AS upper_band,
    COALESCE(sma_20d - (2 * stddev_20d), 0) AS lower_band
FROM bollinger
ORDER BY symbol, date
        );
[0m12:30:55.055325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:56.385934 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.330 seconds
[0m12:30:56.389698 [debug] [Thread-1 (]: On model.stock_prediction.bollinger: Close
[0m12:30:56.533941 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d726cce-350c-4a53-81bb-8fcc79d16a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028a3a80>]}
[0m12:30:56.535418 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.bollinger .......................... [[32mSUCCESS 1[0m in 1.49s]
[0m12:30:56.536341 [debug] [Thread-1 (]: Finished running node model.stock_prediction.bollinger
[0m12:30:56.537153 [debug] [Thread-1 (]: Began running node model.stock_prediction.moving_average
[0m12:30:56.537919 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.moving_average .......................... [RUN]
[0m12:30:56.538556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.bollinger, now model.stock_prediction.moving_average)
[0m12:30:56.539011 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.moving_average
[0m12:30:56.542655 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.moving_average"
[0m12:30:56.543706 [debug] [Thread-1 (]: Began executing node model.stock_prediction.moving_average
[0m12:30:56.546205 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.moving_average"
[0m12:30:56.547496 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.moving_average"
[0m12:30:56.547856 [debug] [Thread-1 (]: On model.stock_prediction.moving_average: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.moving_average"} */
create or replace transient table dev.analytics.moving_average
         as
        (WITH stock_data AS (
    SELECT
        symbol,
        date,
        close
    FROM dev.analytics.stock_prices -- assuming 'stock_prices' is the name of the raw table model in dbt
)

SELECT
    symbol,
    date,
    close,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
    ) AS moving_avg_5d,
    AVG(close) OVER (
        PARTITION BY symbol 
        ORDER BY date 
        ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
    ) AS moving_avg_20d
FROM stock_data
ORDER BY symbol, date
        );
[0m12:30:56.548185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:57.614496 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.066 seconds
[0m12:30:57.617532 [debug] [Thread-1 (]: On model.stock_prediction.moving_average: Close
[0m12:30:57.737526 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d726cce-350c-4a53-81bb-8fcc79d16a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058a66f0>]}
[0m12:30:57.738472 [info ] [Thread-1 (]: 4 of 5 OK created sql table model analytics.moving_average ..................... [[32mSUCCESS 1[0m in 1.20s]
[0m12:30:57.739252 [debug] [Thread-1 (]: Finished running node model.stock_prediction.moving_average
[0m12:30:57.739773 [debug] [Thread-1 (]: Began running node model.stock_prediction.rsi_calculation
[0m12:30:57.740322 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.rsi_calculation ......................... [RUN]
[0m12:30:57.740808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.moving_average, now model.stock_prediction.rsi_calculation)
[0m12:30:57.741169 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.rsi_calculation
[0m12:30:57.744678 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.rsi_calculation"
[0m12:30:57.745737 [debug] [Thread-1 (]: Began executing node model.stock_prediction.rsi_calculation
[0m12:30:57.747858 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_prediction.rsi_calculation"
[0m12:30:57.749593 [debug] [Thread-1 (]: Using snowflake connection "model.stock_prediction.rsi_calculation"
[0m12:30:57.749973 [debug] [Thread-1 (]: On model.stock_prediction.rsi_calculation: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "model.stock_prediction.rsi_calculation"} */
create or replace transient table dev.analytics.rsi_calculation
         as
        (WITH stock_data AS (
    SELECT
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM dev.analytics.stock_prices
),

price_changes AS (
    SELECT
        symbol,
        date,
        close,
        CASE 
            WHEN close > prev_close THEN close - prev_close
            ELSE 0 
        END AS gain,
        CASE 
            WHEN close < prev_close THEN prev_close - close
            ELSE 0 
        END AS loss
    FROM stock_data
),

average_gains_losses AS (
    SELECT
        symbol,
        date,
        close,
        -- Calculate the average gain over the last 14 days, including the current row
        AVG(gain) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain,
        -- Calculate the average loss over the last 14 days, including the current row
        AVG(loss) OVER (
            PARTITION BY symbol 
            ORDER BY date 
            ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss
    FROM price_changes
)

SELECT
    symbol,
    date,
    close,
    avg_gain,
    avg_loss,
    -- Calculate RSI, using COALESCE to set to 0 if result is NULL
    COALESCE(100 - (100 / (1 + (NULLIF(avg_gain, 0) / NULLIF(avg_loss, 0)))), 0) AS rsi_14d
FROM average_gains_losses
ORDER BY symbol, date
        );
[0m12:30:57.750345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:58.931091 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.180 seconds
[0m12:30:58.938093 [debug] [Thread-1 (]: On model.stock_prediction.rsi_calculation: Close
[0m12:30:59.078159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d726cce-350c-4a53-81bb-8fcc79d16a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058a70b0>]}
[0m12:30:59.079249 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.rsi_calculation .................... [[32mSUCCESS 1[0m in 1.34s]
[0m12:30:59.080036 [debug] [Thread-1 (]: Finished running node model.stock_prediction.rsi_calculation
[0m12:30:59.081761 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:30:59.082081 [debug] [MainThread]: Connection 'model.stock_prediction.rsi_calculation' was properly closed.
[0m12:30:59.082486 [info ] [MainThread]: 
[0m12:30:59.082801 [info ] [MainThread]: Finished running 1 view model, 4 table models in 0 hours 0 minutes and 8.53 seconds (8.53s).
[0m12:30:59.084014 [debug] [MainThread]: Command end result
[0m12:30:59.115636 [info ] [MainThread]: 
[0m12:30:59.115979 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:30:59.116171 [info ] [MainThread]: 
[0m12:30:59.116354 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:30:59.117665 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.62683, "process_user_time": 2.134198, "process_kernel_time": 0.206502, "process_mem_max_rss": "143261696", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:30:59.118084 [debug] [MainThread]: Command `dbt run` succeeded at 12:30:59.118016 after 9.63 seconds
[0m12:30:59.118332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052cd5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058a7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058a71d0>]}
[0m12:30:59.118540 [debug] [MainThread]: Flushing usage events
[0m12:31:02.976342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d16120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108667ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108667d90>]}


============================== 12:31:02.978489 | d3f5b857-994d-436a-9bc7-ecbb6eddaa6c ==============================
[0m12:31:02.978489 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:31:02.978781 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'profiles_dir': '/Users/adi/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m12:31:03.128702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3f5b857-994d-436a-9bc7-ecbb6eddaa6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092cda70>]}
[0m12:31:03.151363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3f5b857-994d-436a-9bc7-ecbb6eddaa6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10929c490>]}
[0m12:31:03.151733 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:31:03.159616 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:31:03.222852 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:31:03.223069 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:31:03.247093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3f5b857-994d-436a-9bc7-ecbb6eddaa6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091fcb50>]}
[0m12:31:03.310910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3f5b857-994d-436a-9bc7-ecbb6eddaa6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10973dd60>]}
[0m12:31:03.311202 [info ] [MainThread]: Found 5 models, 4 snapshots, 27 data tests, 1 source, 459 macros
[0m12:31:03.311361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3f5b857-994d-436a-9bc7-ecbb6eddaa6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095ef150>]}
[0m12:31:03.312773 [info ] [MainThread]: 
[0m12:31:03.313051 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:31:03.315283 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_analytics'
[0m12:31:03.323427 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m12:31:03.323603 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m12:31:03.323730 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:31:03.860164 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.536 seconds
[0m12:31:03.866444 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m12:31:03.978610 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m12:31:03.981763 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m12:31:03.982049 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m12:31:03.982285 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:31:04.450498 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.468 seconds
[0m12:31:04.454184 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m12:31:04.600509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3f5b857-994d-436a-9bc7-ecbb6eddaa6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097fc2c0>]}
[0m12:31:04.601154 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:31:04.601494 [info ] [MainThread]: 
[0m12:31:04.604573 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m12:31:04.605044 [info ] [Thread-1 (]: 1 of 27 START test not_null_avg_true_range_atr_14d ............................. [RUN]
[0m12:31:04.605501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad)
[0m12:31:04.605852 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m12:31:04.621934 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad"
[0m12:31:04.622852 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m12:31:04.636445 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad"
[0m12:31:04.637167 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad"
[0m12:31:04.637384 [debug] [Thread-1 (]: On test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select atr_14d
from dev.analytics.avg_true_range
where atr_14d is null



      
    ) dbt_internal_test
[0m12:31:04.637570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:05.148856 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.511 seconds
[0m12:31:05.160473 [debug] [Thread-1 (]: On test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad: Close
[0m12:31:05.281719 [info ] [Thread-1 (]: 1 of 27 PASS not_null_avg_true_range_atr_14d ................................... [[32mPASS[0m in 0.68s]
[0m12:31:05.282680 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m12:31:05.283255 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_avg_true_range_date.4e418b835d
[0m12:31:05.283883 [info ] [Thread-1 (]: 2 of 27 START test not_null_avg_true_range_date ................................ [RUN]
[0m12:31:05.284511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad, now test.stock_prediction.not_null_avg_true_range_date.4e418b835d)
[0m12:31:05.284956 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_avg_true_range_date.4e418b835d
[0m12:31:05.289645 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_avg_true_range_date.4e418b835d"
[0m12:31:05.290809 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_avg_true_range_date.4e418b835d
[0m12:31:05.293765 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_avg_true_range_date.4e418b835d"
[0m12:31:05.294706 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_avg_true_range_date.4e418b835d"
[0m12:31:05.295039 [debug] [Thread-1 (]: On test.stock_prediction.not_null_avg_true_range_date.4e418b835d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_avg_true_range_date.4e418b835d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.avg_true_range
where date is null



      
    ) dbt_internal_test
[0m12:31:05.295338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:05.821611 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.526 seconds
[0m12:31:05.828263 [debug] [Thread-1 (]: On test.stock_prediction.not_null_avg_true_range_date.4e418b835d: Close
[0m12:31:05.962378 [info ] [Thread-1 (]: 2 of 27 PASS not_null_avg_true_range_date ...................................... [[32mPASS[0m in 0.68s]
[0m12:31:05.963303 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_avg_true_range_date.4e418b835d
[0m12:31:05.963878 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1
[0m12:31:05.964431 [info ] [Thread-1 (]: 3 of 27 START test not_null_avg_true_range_symbol .............................. [RUN]
[0m12:31:05.964948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_avg_true_range_date.4e418b835d, now test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1)
[0m12:31:05.965377 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1
[0m12:31:05.970382 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1"
[0m12:31:05.971445 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1
[0m12:31:05.974252 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1"
[0m12:31:05.975189 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1"
[0m12:31:05.975513 [debug] [Thread-1 (]: On test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.avg_true_range
where symbol is null



      
    ) dbt_internal_test
[0m12:31:05.975806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:06.455676 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.479 seconds
[0m12:31:06.460275 [debug] [Thread-1 (]: On test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1: Close
[0m12:31:06.588641 [info ] [Thread-1 (]: 3 of 27 PASS not_null_avg_true_range_symbol .................................... [[32mPASS[0m in 0.62s]
[0m12:31:06.589599 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1
[0m12:31:06.590159 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_close.4ccb16a429
[0m12:31:06.590732 [info ] [Thread-1 (]: 4 of 27 START test not_null_bollinger_close .................................... [RUN]
[0m12:31:06.591385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1, now test.stock_prediction.not_null_bollinger_close.4ccb16a429)
[0m12:31:06.591914 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_close.4ccb16a429
[0m12:31:06.596936 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_close.4ccb16a429"
[0m12:31:06.598046 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_close.4ccb16a429
[0m12:31:06.600137 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_bollinger_close.4ccb16a429"
[0m12:31:06.601057 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_bollinger_close.4ccb16a429"
[0m12:31:06.601378 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_close.4ccb16a429: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_bollinger_close.4ccb16a429"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.bollinger
where close is null



      
    ) dbt_internal_test
[0m12:31:06.601675 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:07.121862 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.520 seconds
[0m12:31:07.125857 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_close.4ccb16a429: Close
[0m12:31:07.265885 [info ] [Thread-1 (]: 4 of 27 PASS not_null_bollinger_close .......................................... [[32mPASS[0m in 0.67s]
[0m12:31:07.266527 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_close.4ccb16a429
[0m12:31:07.266796 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_date.9d77bdd20c
[0m12:31:07.266992 [info ] [Thread-1 (]: 5 of 27 START test not_null_bollinger_date ..................................... [RUN]
[0m12:31:07.267467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_close.4ccb16a429, now test.stock_prediction.not_null_bollinger_date.9d77bdd20c)
[0m12:31:07.267895 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_date.9d77bdd20c
[0m12:31:07.271194 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_date.9d77bdd20c"
[0m12:31:07.272074 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_date.9d77bdd20c
[0m12:31:07.273654 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_bollinger_date.9d77bdd20c"
[0m12:31:07.274359 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_bollinger_date.9d77bdd20c"
[0m12:31:07.274593 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_date.9d77bdd20c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_bollinger_date.9d77bdd20c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.bollinger
where date is null



      
    ) dbt_internal_test
[0m12:31:07.274784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:07.703172 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.428 seconds
[0m12:31:07.710091 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_date.9d77bdd20c: Close
[0m12:31:07.843822 [info ] [Thread-1 (]: 5 of 27 PASS not_null_bollinger_date ........................................... [[32mPASS[0m in 0.58s]
[0m12:31:07.845349 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_date.9d77bdd20c
[0m12:31:07.845910 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e
[0m12:31:07.846419 [info ] [Thread-1 (]: 6 of 27 START test not_null_bollinger_lower_band ............................... [RUN]
[0m12:31:07.846984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_date.9d77bdd20c, now test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e)
[0m12:31:07.847318 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e
[0m12:31:07.851734 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e"
[0m12:31:07.852814 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e
[0m12:31:07.854613 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e"
[0m12:31:07.855475 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e"
[0m12:31:07.855765 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select lower_band
from dev.analytics.bollinger
where lower_band is null



      
    ) dbt_internal_test
[0m12:31:07.856035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:08.359356 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.503 seconds
[0m12:31:08.363391 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e: Close
[0m12:31:08.495476 [info ] [Thread-1 (]: 6 of 27 PASS not_null_bollinger_lower_band ..................................... [[32mPASS[0m in 0.65s]
[0m12:31:08.496367 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e
[0m12:31:08.496920 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3
[0m12:31:08.497507 [info ] [Thread-1 (]: 7 of 27 START test not_null_bollinger_sma_20d .................................. [RUN]
[0m12:31:08.498046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e, now test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3)
[0m12:31:08.498434 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3
[0m12:31:08.503340 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3"
[0m12:31:08.504370 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3
[0m12:31:08.506347 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3"
[0m12:31:08.507288 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3"
[0m12:31:08.507610 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sma_20d
from dev.analytics.bollinger
where sma_20d is null



      
    ) dbt_internal_test
[0m12:31:08.507905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:08.985029 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.476 seconds
[0m12:31:08.989087 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3: Close
[0m12:31:09.111103 [info ] [Thread-1 (]: 7 of 27 PASS not_null_bollinger_sma_20d ........................................ [[32mPASS[0m in 0.61s]
[0m12:31:09.111999 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3
[0m12:31:09.112552 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_symbol.a932e30f82
[0m12:31:09.113108 [info ] [Thread-1 (]: 8 of 27 START test not_null_bollinger_symbol ................................... [RUN]
[0m12:31:09.113739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3, now test.stock_prediction.not_null_bollinger_symbol.a932e30f82)
[0m12:31:09.114194 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_symbol.a932e30f82
[0m12:31:09.119429 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_symbol.a932e30f82"
[0m12:31:09.120511 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_symbol.a932e30f82
[0m12:31:09.122749 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_bollinger_symbol.a932e30f82"
[0m12:31:09.123678 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_bollinger_symbol.a932e30f82"
[0m12:31:09.123994 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_symbol.a932e30f82: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_bollinger_symbol.a932e30f82"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.bollinger
where symbol is null



      
    ) dbt_internal_test
[0m12:31:09.124289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:09.704557 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.580 seconds
[0m12:31:09.709122 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_symbol.a932e30f82: Close
[0m12:31:09.834486 [info ] [Thread-1 (]: 8 of 27 PASS not_null_bollinger_symbol ......................................... [[32mPASS[0m in 0.72s]
[0m12:31:09.835239 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_symbol.a932e30f82
[0m12:31:09.835704 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_upper_band.e4db87564c
[0m12:31:09.836163 [info ] [Thread-1 (]: 9 of 27 START test not_null_bollinger_upper_band ............................... [RUN]
[0m12:31:09.836665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_symbol.a932e30f82, now test.stock_prediction.not_null_bollinger_upper_band.e4db87564c)
[0m12:31:09.837037 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_upper_band.e4db87564c
[0m12:31:09.841531 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_upper_band.e4db87564c"
[0m12:31:09.842526 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_upper_band.e4db87564c
[0m12:31:09.844496 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_bollinger_upper_band.e4db87564c"
[0m12:31:09.845385 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_bollinger_upper_band.e4db87564c"
[0m12:31:09.845672 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_upper_band.e4db87564c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_bollinger_upper_band.e4db87564c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select upper_band
from dev.analytics.bollinger
where upper_band is null



      
    ) dbt_internal_test
[0m12:31:09.845930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:10.291965 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.445 seconds
[0m12:31:10.298296 [debug] [Thread-1 (]: On test.stock_prediction.not_null_bollinger_upper_band.e4db87564c: Close
[0m12:31:10.433187 [info ] [Thread-1 (]: 9 of 27 PASS not_null_bollinger_upper_band ..................................... [[32mPASS[0m in 0.60s]
[0m12:31:10.434639 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_upper_band.e4db87564c
[0m12:31:10.435246 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m12:31:10.435846 [info ] [Thread-1 (]: 10 of 27 START test not_null_moving_average_close .............................. [RUN]
[0m12:31:10.436410 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_upper_band.e4db87564c, now test.stock_prediction.not_null_moving_average_close.6d037dd588)
[0m12:31:10.436809 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m12:31:10.441735 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_close.6d037dd588"
[0m12:31:10.442713 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m12:31:10.444712 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_close.6d037dd588"
[0m12:31:10.445644 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_close.6d037dd588"
[0m12:31:10.445979 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_close.6d037dd588: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_close.6d037dd588"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.moving_average
where close is null



      
    ) dbt_internal_test
[0m12:31:10.446279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:10.979759 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.533 seconds
[0m12:31:10.984163 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_close.6d037dd588: Close
[0m12:31:11.106608 [info ] [Thread-1 (]: 10 of 27 PASS not_null_moving_average_close .................................... [[32mPASS[0m in 0.67s]
[0m12:31:11.107601 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m12:31:11.108162 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m12:31:11.108738 [info ] [Thread-1 (]: 11 of 27 START test not_null_moving_average_date ............................... [RUN]
[0m12:31:11.109364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_close.6d037dd588, now test.stock_prediction.not_null_moving_average_date.3ad00158b5)
[0m12:31:11.109757 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m12:31:11.114705 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_date.3ad00158b5"
[0m12:31:11.115805 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m12:31:11.117947 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_date.3ad00158b5"
[0m12:31:11.118872 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_date.3ad00158b5"
[0m12:31:11.119197 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_date.3ad00158b5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_date.3ad00158b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.moving_average
where date is null



      
    ) dbt_internal_test
[0m12:31:11.119495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:11.568772 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.449 seconds
[0m12:31:11.574149 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_date.3ad00158b5: Close
[0m12:31:11.713013 [info ] [Thread-1 (]: 11 of 27 PASS not_null_moving_average_date ..................................... [[32mPASS[0m in 0.60s]
[0m12:31:11.714383 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m12:31:11.714765 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m12:31:11.715131 [info ] [Thread-1 (]: 12 of 27 START test not_null_moving_average_moving_avg_20d ..................... [RUN]
[0m12:31:11.715549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_date.3ad00158b5, now test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22)
[0m12:31:11.715851 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m12:31:11.719399 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m12:31:11.720272 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m12:31:11.721819 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m12:31:11.722598 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m12:31:11.722860 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg_20d
from dev.analytics.moving_average
where moving_avg_20d is null



      
    ) dbt_internal_test
[0m12:31:11.723098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:12.233812 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.510 seconds
[0m12:31:12.238093 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22: Close
[0m12:31:12.360879 [info ] [Thread-1 (]: 12 of 27 PASS not_null_moving_average_moving_avg_20d ........................... [[32mPASS[0m in 0.65s]
[0m12:31:12.361773 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m12:31:12.362340 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m12:31:12.362887 [info ] [Thread-1 (]: 13 of 27 START test not_null_moving_average_moving_avg_5d ...................... [RUN]
[0m12:31:12.363469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22, now test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca)
[0m12:31:12.363857 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m12:31:12.368630 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m12:31:12.369650 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m12:31:12.371847 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m12:31:12.372744 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m12:31:12.373066 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg_5d
from dev.analytics.moving_average
where moving_avg_5d is null



      
    ) dbt_internal_test
[0m12:31:12.373362 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:12.844796 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.471 seconds
[0m12:31:12.849254 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca: Close
[0m12:31:13.051969 [info ] [Thread-1 (]: 13 of 27 PASS not_null_moving_average_moving_avg_5d ............................ [[32mPASS[0m in 0.69s]
[0m12:31:13.052961 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m12:31:13.053520 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m12:31:13.054064 [info ] [Thread-1 (]: 14 of 27 START test not_null_moving_average_symbol ............................. [RUN]
[0m12:31:13.054675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca, now test.stock_prediction.not_null_moving_average_symbol.75a6f7473c)
[0m12:31:13.055130 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m12:31:13.060404 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"
[0m12:31:13.061530 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m12:31:13.063614 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"
[0m12:31:13.064595 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"
[0m12:31:13.064924 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_symbol.75a6f7473c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.moving_average
where symbol is null



      
    ) dbt_internal_test
[0m12:31:13.065218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:13.605029 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.539 seconds
[0m12:31:13.607397 [debug] [Thread-1 (]: On test.stock_prediction.not_null_moving_average_symbol.75a6f7473c: Close
[0m12:31:13.725870 [info ] [Thread-1 (]: 14 of 27 PASS not_null_moving_average_symbol ................................... [[32mPASS[0m in 0.67s]
[0m12:31:13.726826 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m12:31:13.727379 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m12:31:13.727992 [info ] [Thread-1 (]: 15 of 27 START test not_null_rsi_calculation_avg_gain .......................... [RUN]
[0m12:31:13.728670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_symbol.75a6f7473c, now test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42)
[0m12:31:13.729119 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m12:31:13.734156 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m12:31:13.735335 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m12:31:13.737352 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m12:31:13.738323 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m12:31:13.738659 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_gain
from dev.analytics.rsi_calculation
where avg_gain is null



      
    ) dbt_internal_test
[0m12:31:13.738952 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:14.257168 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.517 seconds
[0m12:31:14.264939 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42: Close
[0m12:31:14.382978 [info ] [Thread-1 (]: 15 of 27 PASS not_null_rsi_calculation_avg_gain ................................ [[32mPASS[0m in 0.65s]
[0m12:31:14.388414 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m12:31:14.389783 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m12:31:14.390554 [info ] [Thread-1 (]: 16 of 27 START test not_null_rsi_calculation_avg_loss .......................... [RUN]
[0m12:31:14.391389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42, now test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19)
[0m12:31:14.391935 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m12:31:14.401449 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m12:31:14.403286 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m12:31:14.406527 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m12:31:14.407869 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m12:31:14.408346 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select avg_loss
from dev.analytics.rsi_calculation
where avg_loss is null



      
    ) dbt_internal_test
[0m12:31:14.408781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:14.926475 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.517 seconds
[0m12:31:14.932234 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19: Close
[0m12:31:15.052339 [info ] [Thread-1 (]: 16 of 27 PASS not_null_rsi_calculation_avg_loss ................................ [[32mPASS[0m in 0.66s]
[0m12:31:15.053595 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m12:31:15.054073 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m12:31:15.054554 [info ] [Thread-1 (]: 17 of 27 START test not_null_rsi_calculation_close ............................. [RUN]
[0m12:31:15.055081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19, now test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d)
[0m12:31:15.055479 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m12:31:15.063744 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"
[0m12:31:15.064984 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m12:31:15.068090 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"
[0m12:31:15.068829 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"
[0m12:31:15.069042 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.rsi_calculation
where close is null



      
    ) dbt_internal_test
[0m12:31:15.069209 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:15.567678 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.498 seconds
[0m12:31:15.572684 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d: Close
[0m12:31:15.727233 [info ] [Thread-1 (]: 17 of 27 PASS not_null_rsi_calculation_close ................................... [[32mPASS[0m in 0.67s]
[0m12:31:15.729118 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m12:31:15.730128 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m12:31:15.730874 [info ] [Thread-1 (]: 18 of 27 START test not_null_rsi_calculation_date .............................. [RUN]
[0m12:31:15.731891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d, now test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76)
[0m12:31:15.732534 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m12:31:15.739652 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"
[0m12:31:15.740910 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m12:31:15.743867 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"
[0m12:31:15.745255 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"
[0m12:31:15.745863 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.rsi_calculation
where date is null



      
    ) dbt_internal_test
[0m12:31:15.746234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:16.235802 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.485 seconds
[0m12:31:16.242234 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76: Close
[0m12:31:16.378714 [info ] [Thread-1 (]: 18 of 27 PASS not_null_rsi_calculation_date .................................... [[32mPASS[0m in 0.65s]
[0m12:31:16.381222 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m12:31:16.386733 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m12:31:16.388050 [info ] [Thread-1 (]: 19 of 27 START test not_null_rsi_calculation_rsi_14d ........................... [RUN]
[0m12:31:16.388745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76, now test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8)
[0m12:31:16.389335 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m12:31:16.396952 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m12:31:16.398217 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m12:31:16.401327 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m12:31:16.403090 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m12:31:16.403684 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_14d
from dev.analytics.rsi_calculation
where rsi_14d is null



      
    ) dbt_internal_test
[0m12:31:16.404110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:16.845893 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.441 seconds
[0m12:31:16.851435 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8: Close
[0m12:31:17.020054 [info ] [Thread-1 (]: 19 of 27 PASS not_null_rsi_calculation_rsi_14d ................................. [[32mPASS[0m in 0.63s]
[0m12:31:17.022155 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m12:31:17.023279 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m12:31:17.024273 [info ] [Thread-1 (]: 20 of 27 START test not_null_rsi_calculation_symbol ............................ [RUN]
[0m12:31:17.025449 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8, now test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84)
[0m12:31:17.026282 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m12:31:17.034158 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m12:31:17.035511 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m12:31:17.038541 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m12:31:17.039744 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m12:31:17.040177 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.rsi_calculation
where symbol is null



      
    ) dbt_internal_test
[0m12:31:17.040576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:17.502442 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.462 seconds
[0m12:31:17.507468 [debug] [Thread-1 (]: On test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84: Close
[0m12:31:17.661927 [info ] [Thread-1 (]: 20 of 27 PASS not_null_rsi_calculation_symbol .................................. [[32mPASS[0m in 0.64s]
[0m12:31:17.663659 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m12:31:17.664628 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m12:31:17.665470 [info ] [Thread-1 (]: 21 of 27 START test not_null_stock_prices_close ................................ [RUN]
[0m12:31:17.666272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84, now test.stock_prediction.not_null_stock_prices_close.d7e232e1ba)
[0m12:31:17.666906 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m12:31:17.674207 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"
[0m12:31:17.675542 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m12:31:17.678315 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"
[0m12:31:17.680071 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"
[0m12:31:17.680574 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_close.d7e232e1ba: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from dev.analytics.stock_prices
where close is null



      
    ) dbt_internal_test
[0m12:31:17.680889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:18.104666 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.423 seconds
[0m12:31:18.112361 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_close.d7e232e1ba: Close
[0m12:31:18.262351 [info ] [Thread-1 (]: 21 of 27 PASS not_null_stock_prices_close ...................................... [[32mPASS[0m in 0.60s]
[0m12:31:18.264646 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m12:31:18.265706 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m12:31:18.267242 [info ] [Thread-1 (]: 22 of 27 START test not_null_stock_prices_date ................................. [RUN]
[0m12:31:18.268630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_close.d7e232e1ba, now test.stock_prediction.not_null_stock_prices_date.98a7527501)
[0m12:31:18.269190 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m12:31:18.277019 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_date.98a7527501"
[0m12:31:18.278557 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m12:31:18.281554 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_date.98a7527501"
[0m12:31:18.282802 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_date.98a7527501"
[0m12:31:18.283280 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_date.98a7527501: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_date.98a7527501"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.stock_prices
where date is null



      
    ) dbt_internal_test
[0m12:31:18.283699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:18.797780 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.513 seconds
[0m12:31:18.806894 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_date.98a7527501: Close
[0m12:31:18.928257 [info ] [Thread-1 (]: 22 of 27 PASS not_null_stock_prices_date ....................................... [[32mPASS[0m in 0.66s]
[0m12:31:18.930439 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m12:31:18.931361 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m12:31:18.932173 [info ] [Thread-1 (]: 23 of 27 START test not_null_stock_prices_high ................................. [RUN]
[0m12:31:18.933055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_date.98a7527501, now test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc)
[0m12:31:18.933713 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m12:31:18.943323 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"
[0m12:31:18.945292 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m12:31:18.948610 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"
[0m12:31:18.949990 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"
[0m12:31:18.950476 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select high
from dev.analytics.stock_prices
where high is null



      
    ) dbt_internal_test
[0m12:31:18.950933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:19.415535 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.464 seconds
[0m12:31:19.421989 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc: Close
[0m12:31:19.610902 [info ] [Thread-1 (]: 23 of 27 PASS not_null_stock_prices_high ....................................... [[32mPASS[0m in 0.68s]
[0m12:31:19.612904 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m12:31:19.613861 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m12:31:19.614698 [info ] [Thread-1 (]: 24 of 27 START test not_null_stock_prices_low .................................. [RUN]
[0m12:31:19.615607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc, now test.stock_prediction.not_null_stock_prices_low.e65294ca15)
[0m12:31:19.616348 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m12:31:19.626066 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_low.e65294ca15"
[0m12:31:19.627622 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m12:31:19.630595 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_low.e65294ca15"
[0m12:31:19.631917 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_low.e65294ca15"
[0m12:31:19.632401 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_low.e65294ca15: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_low.e65294ca15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select low
from dev.analytics.stock_prices
where low is null



      
    ) dbt_internal_test
[0m12:31:19.632832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:20.160013 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.527 seconds
[0m12:31:20.165229 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_low.e65294ca15: Close
[0m12:31:20.300235 [info ] [Thread-1 (]: 24 of 27 PASS not_null_stock_prices_low ........................................ [[32mPASS[0m in 0.68s]
[0m12:31:20.302324 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m12:31:20.303389 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m12:31:20.305030 [info ] [Thread-1 (]: 25 of 27 START test not_null_stock_prices_open ................................. [RUN]
[0m12:31:20.305957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_low.e65294ca15, now test.stock_prediction.not_null_stock_prices_open.e09b13f215)
[0m12:31:20.306519 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m12:31:20.314923 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_open.e09b13f215"
[0m12:31:20.316496 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m12:31:20.320208 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_open.e09b13f215"
[0m12:31:20.321878 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_open.e09b13f215"
[0m12:31:20.322390 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_open.e09b13f215: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_open.e09b13f215"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from dev.analytics.stock_prices
where open is null



      
    ) dbt_internal_test
[0m12:31:20.322796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:20.780862 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.458 seconds
[0m12:31:20.787222 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_open.e09b13f215: Close
[0m12:31:20.933339 [info ] [Thread-1 (]: 25 of 27 PASS not_null_stock_prices_open ....................................... [[32mPASS[0m in 0.63s]
[0m12:31:20.935204 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m12:31:20.936266 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m12:31:20.937201 [info ] [Thread-1 (]: 26 of 27 START test not_null_stock_prices_symbol ............................... [RUN]
[0m12:31:20.937942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_open.e09b13f215, now test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8)
[0m12:31:20.938540 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m12:31:20.946486 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"
[0m12:31:20.947871 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m12:31:20.950275 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"
[0m12:31:20.951274 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"
[0m12:31:20.951545 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.stock_prices
where symbol is null



      
    ) dbt_internal_test
[0m12:31:20.951805 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:21.405387 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.453 seconds
[0m12:31:21.411750 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8: Close
[0m12:31:21.532391 [info ] [Thread-1 (]: 26 of 27 PASS not_null_stock_prices_symbol ..................................... [[32mPASS[0m in 0.59s]
[0m12:31:21.534239 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m12:31:21.535176 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m12:31:21.536024 [info ] [Thread-1 (]: 27 of 27 START test not_null_stock_prices_volume ............................... [RUN]
[0m12:31:21.539320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8, now test.stock_prediction.not_null_stock_prices_volume.71420bc956)
[0m12:31:21.540006 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m12:31:21.549616 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_volume.71420bc956"
[0m12:31:21.551087 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m12:31:21.554023 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_prediction.not_null_stock_prices_volume.71420bc956"
[0m12:31:21.555403 [debug] [Thread-1 (]: Using snowflake connection "test.stock_prediction.not_null_stock_prices_volume.71420bc956"
[0m12:31:21.555876 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_volume.71420bc956: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "test.stock_prediction.not_null_stock_prices_volume.71420bc956"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume
from dev.analytics.stock_prices
where volume is null



      
    ) dbt_internal_test
[0m12:31:21.556306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:22.024613 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.468 seconds
[0m12:31:22.032297 [debug] [Thread-1 (]: On test.stock_prediction.not_null_stock_prices_volume.71420bc956: Close
[0m12:31:22.159700 [info ] [Thread-1 (]: 27 of 27 PASS not_null_stock_prices_volume ..................................... [[32mPASS[0m in 0.62s]
[0m12:31:22.161553 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m12:31:22.165264 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:31:22.166497 [debug] [MainThread]: Connection 'test.stock_prediction.not_null_stock_prices_volume.71420bc956' was properly closed.
[0m12:31:22.168120 [info ] [MainThread]: 
[0m12:31:22.168830 [info ] [MainThread]: Finished running 27 data tests in 0 hours 0 minutes and 18.85 seconds (18.85s).
[0m12:31:22.181041 [debug] [MainThread]: Command end result
[0m12:31:22.212457 [info ] [MainThread]: 
[0m12:31:22.212846 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:31:22.213070 [info ] [MainThread]: 
[0m12:31:22.213291 [info ] [MainThread]: Done. PASS=27 WARN=0 ERROR=0 SKIP=0 TOTAL=27
[0m12:31:22.214599 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 19.269835, "process_user_time": 3.345483, "process_kernel_time": 0.398916, "process_mem_max_rss": "140705792", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:31:22.214957 [debug] [MainThread]: Command `dbt test` succeeded at 12:31:22.214891 after 19.27 seconds
[0m12:31:22.215198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10838f050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a2d860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a2ea40>]}
[0m12:31:22.215438 [debug] [MainThread]: Flushing usage events
[0m12:31:29.228475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e62120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047b3ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047b3d90>]}


============================== 12:31:29.230612 | f5332c72-62d2-455d-99f3-edcbe319ce89 ==============================
[0m12:31:29.230612 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:31:29.230910 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/adi/.dbt', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:31:29.389014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5332c72-62d2-455d-99f3-edcbe319ce89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10541da70>]}
[0m12:31:29.411592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5332c72-62d2-455d-99f3-edcbe319ce89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105308490>]}
[0m12:31:29.411963 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:31:29.419950 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:31:29.484862 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:31:29.485078 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:31:29.509253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5332c72-62d2-455d-99f3-edcbe319ce89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105268b50>]}
[0m12:31:29.565416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5332c72-62d2-455d-99f3-edcbe319ce89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105483200>]}
[0m12:31:29.565697 [info ] [MainThread]: Found 5 models, 4 snapshots, 27 data tests, 1 source, 459 macros
[0m12:31:29.565854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5332c72-62d2-455d-99f3-edcbe319ce89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056fdef0>]}
[0m12:31:29.567009 [info ] [MainThread]: 
[0m12:31:29.567292 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:31:29.569392 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m12:31:29.576368 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m12:31:29.576527 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m12:31:29.576645 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:31:30.107205 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.530 seconds
[0m12:31:30.110223 [debug] [ThreadPool]: On list_dev: Close
[0m12:31:30.268788 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m12:31:30.280088 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m12:31:30.280428 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m12:31:30.280686 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:31:30.874030 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.593 seconds
[0m12:31:30.880768 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m12:31:31.034763 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m12:31:31.039010 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m12:31:31.039432 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m12:31:31.039767 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:31:31.683744 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.644 seconds
[0m12:31:31.689390 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m12:31:31.892634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5332c72-62d2-455d-99f3-edcbe319ce89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b33d40>]}
[0m12:31:31.893193 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:31:31.893483 [info ] [MainThread]: 
[0m12:31:31.895987 [debug] [Thread-1 (]: Began running node snapshot.stock_prediction.snapshot_atr
[0m12:31:31.896551 [info ] [Thread-1 (]: 1 of 4 START snapshot snapshot.snapshot_atr .................................... [RUN]
[0m12:31:31.896964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now snapshot.stock_prediction.snapshot_atr)
[0m12:31:31.897258 [debug] [Thread-1 (]: Began compiling node snapshot.stock_prediction.snapshot_atr
[0m12:31:31.904685 [debug] [Thread-1 (]: Began executing node snapshot.stock_prediction.snapshot_atr
[0m12:31:31.939726 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_atr"
[0m12:31:31.940026 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
[0m12:31:31.940208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:32.446866 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.506 seconds
[0m12:31:32.488171 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_atr"
[0m12:31:32.488561 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_atr"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.avg_true_range


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m12:31:33.258273 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.769 seconds
[0m12:31:33.263511 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_atr"
[0m12:31:33.264120 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
[0m12:31:33.374271 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.109 seconds
[0m12:31:33.384006 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_atr"
[0m12:31:33.384586 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
[0m12:31:33.465797 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.080 seconds
[0m12:31:33.472655 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_atr"
[0m12:31:33.472964 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
[0m12:31:33.557275 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.084 seconds
[0m12:31:33.561455 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_atr"
[0m12:31:33.561848 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
[0m12:31:33.685269 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.123 seconds
[0m12:31:33.693966 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_atr"
[0m12:31:33.694344 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_atr"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp"
[0m12:31:33.767709 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.073 seconds
[0m12:31:33.796225 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_atr"
[0m12:31:33.796732 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_atr"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_atr"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.avg_true_range


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_ATR"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m12:31:33.949457 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.152 seconds
[0m12:31:33.955894 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_atr"
[0m12:31:33.956270 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_atr"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_atr"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m12:31:34.032426 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.076 seconds
[0m12:31:34.033334 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_prediction.snapshot_atr"
[0m12:31:34.035664 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_atr"
[0m12:31:34.036089 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_atr"} */
BEGIN
[0m12:31:34.191377 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.154 seconds
[0m12:31:34.192937 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_atr"
[0m12:31:34.193659 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_atr"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_ATR" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_ATR__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATE", "SYMBOL", "ATR_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATE", "SYMBOL", "ATR_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m12:31:34.787083 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.593 seconds
[0m12:31:34.787739 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_atr"
[0m12:31:34.788192 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_atr: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_atr"} */
COMMIT
[0m12:31:35.197185 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.408 seconds
[0m12:31:35.222600 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_atr: Close
[0m12:31:35.360640 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5332c72-62d2-455d-99f3-edcbe319ce89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b6a450>]}
[0m12:31:35.361760 [info ] [Thread-1 (]: 1 of 4 OK snapshotted snapshot.snapshot_atr .................................... [[32mSUCCESS 0[0m in 3.46s]
[0m12:31:35.362463 [debug] [Thread-1 (]: Finished running node snapshot.stock_prediction.snapshot_atr
[0m12:31:35.362967 [debug] [Thread-1 (]: Began running node snapshot.stock_prediction.snapshot_bollinger
[0m12:31:35.363590 [info ] [Thread-1 (]: 2 of 4 START snapshot snapshot.snapshot_bollinger .............................. [RUN]
[0m12:31:35.364112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_prediction.snapshot_atr, now snapshot.stock_prediction.snapshot_bollinger)
[0m12:31:35.364491 [debug] [Thread-1 (]: Began compiling node snapshot.stock_prediction.snapshot_bollinger
[0m12:31:35.367825 [debug] [Thread-1 (]: Began executing node snapshot.stock_prediction.snapshot_bollinger
[0m12:31:35.372078 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_bollinger"
[0m12:31:35.372379 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
[0m12:31:35.372637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:35.870624 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.497 seconds
[0m12:31:35.880947 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_bollinger"
[0m12:31:35.881613 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.bollinger


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m12:31:36.834346 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.952 seconds
[0m12:31:36.841766 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_bollinger"
[0m12:31:36.842393 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
[0m12:31:36.925130 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.082 seconds
[0m12:31:36.930376 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_bollinger"
[0m12:31:36.930933 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
[0m12:31:37.048491 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.117 seconds
[0m12:31:37.054199 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_bollinger"
[0m12:31:37.054862 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
[0m12:31:37.134367 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.079 seconds
[0m12:31:37.141538 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_bollinger"
[0m12:31:37.142007 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
[0m12:31:37.255186 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.113 seconds
[0m12:31:37.261200 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_bollinger"
[0m12:31:37.261682 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp"
[0m12:31:37.345692 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.083 seconds
[0m12:31:37.352864 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_bollinger"
[0m12:31:37.353395 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.bollinger


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m12:31:37.595159 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.241 seconds
[0m12:31:37.605300 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_bollinger"
[0m12:31:37.605781 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m12:31:37.694050 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.088 seconds
[0m12:31:37.695921 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_prediction.snapshot_bollinger"
[0m12:31:37.700259 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_bollinger"
[0m12:31:37.700959 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
BEGIN
[0m12:31:37.933953 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.232 seconds
[0m12:31:37.934592 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_bollinger"
[0m12:31:37.935092 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_BOLLINGER__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "SMA_20D", "UPPER_BAND", "LOWER_BAND", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "SMA_20D", "UPPER_BAND", "LOWER_BAND", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m12:31:38.410078 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.474 seconds
[0m12:31:38.412099 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_bollinger"
[0m12:31:38.412991 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_bollinger: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_bollinger"} */
COMMIT
[0m12:31:38.779227 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.365 seconds
[0m12:31:38.782786 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_bollinger: Close
[0m12:31:38.896383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5332c72-62d2-455d-99f3-edcbe319ce89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cc5390>]}
[0m12:31:38.897635 [info ] [Thread-1 (]: 2 of 4 OK snapshotted snapshot.snapshot_bollinger .............................. [[32mSUCCESS 0[0m in 3.53s]
[0m12:31:38.898473 [debug] [Thread-1 (]: Finished running node snapshot.stock_prediction.snapshot_bollinger
[0m12:31:38.899022 [debug] [Thread-1 (]: Began running node snapshot.stock_prediction.snapshot_moving_avg
[0m12:31:38.899602 [info ] [Thread-1 (]: 3 of 4 START snapshot snapshot.snapshot_moving_avg ............................. [RUN]
[0m12:31:38.900099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_prediction.snapshot_bollinger, now snapshot.stock_prediction.snapshot_moving_avg)
[0m12:31:38.900469 [debug] [Thread-1 (]: Began compiling node snapshot.stock_prediction.snapshot_moving_avg
[0m12:31:38.904442 [debug] [Thread-1 (]: Began executing node snapshot.stock_prediction.snapshot_moving_avg
[0m12:31:38.908777 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:31:38.909119 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
[0m12:31:38.909421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:39.267005 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.357 seconds
[0m12:31:39.277070 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:31:39.277746 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.moving_average


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m12:31:40.010286 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.732 seconds
[0m12:31:40.014589 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:31:40.015001 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
[0m12:31:40.112451 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.097 seconds
[0m12:31:40.118954 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:31:40.119409 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
[0m12:31:40.220291 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.100 seconds
[0m12:31:40.225454 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:31:40.226005 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
[0m12:31:40.334050 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.107 seconds
[0m12:31:40.339848 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:31:40.340282 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
[0m12:31:40.441836 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.101 seconds
[0m12:31:40.449958 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:31:40.450219 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp"
[0m12:31:40.557094 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.107 seconds
[0m12:31:40.561662 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:31:40.562098 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.moving_average


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m12:31:40.713768 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.151 seconds
[0m12:31:40.717087 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:31:40.717657 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m12:31:40.803500 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.085 seconds
[0m12:31:40.804777 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:31:40.807814 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:31:40.808366 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
BEGIN
[0m12:31:40.923245 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.114 seconds
[0m12:31:40.924669 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:31:40.925504 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_MOVING_AVG__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "MOVING_AVG_5D", "MOVING_AVG_20D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "MOVING_AVG_5D", "MOVING_AVG_20D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m12:31:41.405081 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.478 seconds
[0m12:31:41.406768 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_moving_avg"
[0m12:31:41.407384 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_moving_avg"} */
COMMIT
[0m12:31:41.748811 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.341 seconds
[0m12:31:41.754464 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_moving_avg: Close
[0m12:31:41.920575 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5332c72-62d2-455d-99f3-edcbe319ce89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052c98b0>]}
[0m12:31:41.921664 [info ] [Thread-1 (]: 3 of 4 OK snapshotted snapshot.snapshot_moving_avg ............................. [[32mSUCCESS 0[0m in 3.02s]
[0m12:31:41.922295 [debug] [Thread-1 (]: Finished running node snapshot.stock_prediction.snapshot_moving_avg
[0m12:31:41.922697 [debug] [Thread-1 (]: Began running node snapshot.stock_prediction.snapshot_rsi
[0m12:31:41.923186 [info ] [Thread-1 (]: 4 of 4 START snapshot snapshot.snapshot_rsi .................................... [RUN]
[0m12:31:41.923578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_prediction.snapshot_moving_avg, now snapshot.stock_prediction.snapshot_rsi)
[0m12:31:41.923855 [debug] [Thread-1 (]: Began compiling node snapshot.stock_prediction.snapshot_rsi
[0m12:31:41.927945 [debug] [Thread-1 (]: Began executing node snapshot.stock_prediction.snapshot_rsi
[0m12:31:41.931221 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:31:41.931480 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m12:31:41.931707 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:42.434399 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.502 seconds
[0m12:31:42.444364 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:31:42.445114 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.rsi_calculation


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m12:31:43.287596 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.842 seconds
[0m12:31:43.291883 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:31:43.292382 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m12:31:43.394347 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.101 seconds
[0m12:31:43.400744 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:31:43.401158 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m12:31:43.481146 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.079 seconds
[0m12:31:43.486820 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:31:43.487356 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m12:31:43.563623 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.076 seconds
[0m12:31:43.569235 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:31:43.569786 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
[0m12:31:43.647293 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.077 seconds
[0m12:31:43.652725 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:31:43.653132 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp"
[0m12:31:43.749987 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 0.096 seconds
[0m12:31:43.757379 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:31:43.758024 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.rsi_calculation


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_RSI"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m12:31:43.947158 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.189 seconds
[0m12:31:43.948653 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:31:43.949117 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m12:31:44.032699 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.083 seconds
[0m12:31:44.034310 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_prediction.snapshot_rsi"
[0m12:31:44.037101 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:31:44.037640 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
BEGIN
[0m12:31:44.206487 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.168 seconds
[0m12:31:44.207810 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:31:44.208280 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_RSI" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_RSI__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "CLOSE", "AVG_GAIN", "AVG_LOSS", "RSI_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "CLOSE", "AVG_GAIN", "AVG_LOSS", "RSI_14D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m12:31:44.825845 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.617 seconds
[0m12:31:44.826801 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_prediction.snapshot_rsi"
[0m12:31:44.827257 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "node_id": "snapshot.stock_prediction.snapshot_rsi"} */
COMMIT
[0m12:31:45.335489 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.506 seconds
[0m12:31:45.338548 [debug] [Thread-1 (]: On snapshot.stock_prediction.snapshot_rsi: Close
[0m12:31:45.481608 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5332c72-62d2-455d-99f3-edcbe319ce89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055afdd0>]}
[0m12:31:45.482447 [info ] [Thread-1 (]: 4 of 4 OK snapshotted snapshot.snapshot_rsi .................................... [[32mSUCCESS 0[0m in 3.56s]
[0m12:31:45.482904 [debug] [Thread-1 (]: Finished running node snapshot.stock_prediction.snapshot_rsi
[0m12:31:45.483836 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:31:45.483984 [debug] [MainThread]: Connection 'snapshot.stock_prediction.snapshot_rsi' was properly closed.
[0m12:31:45.484133 [info ] [MainThread]: 
[0m12:31:45.484279 [info ] [MainThread]: Finished running 4 snapshots in 0 hours 0 minutes and 15.92 seconds (15.92s).
[0m12:31:45.484750 [debug] [MainThread]: Command end result
[0m12:31:45.508341 [info ] [MainThread]: 
[0m12:31:45.508637 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:31:45.508872 [info ] [MainThread]: 
[0m12:31:45.509066 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m12:31:45.510382 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 16.314026, "process_user_time": 1.996846, "process_kernel_time": 0.232011, "process_mem_max_rss": "138280960", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:31:45.510763 [debug] [MainThread]: Command `dbt snapshot` succeeded at 12:31:45.510693 after 16.31 seconds
[0m12:31:45.511006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047ed630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100d74210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b87050>]}
[0m12:31:45.511240 [debug] [MainThread]: Flushing usage events
[0m12:31:51.344206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105366120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cb7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cb7ed0>]}


============================== 12:31:51.346466 | d0fb9772-bb8a-4d78-88e0-a8e56875b5a8 ==============================
[0m12:31:51.346466 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:31:51.346766 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:31:51.515700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0fb9772-bb8a-4d78-88e0-a8e56875b5a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107839ba0>]}
[0m12:31:51.541215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0fb9772-bb8a-4d78-88e0-a8e56875b5a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10780c490>]}
[0m12:31:51.541817 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:31:51.551228 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:31:51.621401 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:31:51.621624 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:31:51.647543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0fb9772-bb8a-4d78-88e0-a8e56875b5a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10776cb50>]}
[0m12:31:51.656664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0fb9772-bb8a-4d78-88e0-a8e56875b5a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bd94f0>]}
[0m12:31:51.656918 [info ] [MainThread]: Found 5 models, 4 snapshots, 27 data tests, 1 source, 459 macros
[0m12:31:51.657077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0fb9772-bb8a-4d78-88e0-a8e56875b5a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bf5550>]}
[0m12:31:51.658406 [info ] [MainThread]: 
[0m12:31:51.658673 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:31:51.660991 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_analytics'
[0m12:31:51.670202 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m12:31:51.670389 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m12:31:51.670520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:31:52.109983 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.439 seconds
[0m12:31:52.117589 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m12:31:52.276017 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m12:31:52.279888 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m12:31:52.280241 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m12:31:52.280520 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:31:52.841390 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.560 seconds
[0m12:31:52.847221 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m12:31:52.967721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0fb9772-bb8a-4d78-88e0-a8e56875b5a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c14940>]}
[0m12:31:52.968350 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:31:52.968711 [info ] [MainThread]: 
[0m12:31:52.971506 [debug] [Thread-1 (]: Began running node model.stock_prediction.stock_prices
[0m12:31:52.971993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now model.stock_prediction.stock_prices)
[0m12:31:52.972356 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.stock_prices
[0m12:31:52.981199 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.stock_prices"
[0m12:31:52.982159 [debug] [Thread-1 (]: Began executing node model.stock_prediction.stock_prices
[0m12:31:52.982757 [debug] [Thread-1 (]: Finished running node model.stock_prediction.stock_prices
[0m12:31:52.983517 [debug] [Thread-1 (]: Began running node model.stock_prediction.avg_true_range
[0m12:31:52.983846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.stock_prices, now model.stock_prediction.avg_true_range)
[0m12:31:52.984109 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.avg_true_range
[0m12:31:52.986110 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.avg_true_range"
[0m12:31:52.986638 [debug] [Thread-1 (]: Began executing node model.stock_prediction.avg_true_range
[0m12:31:52.987110 [debug] [Thread-1 (]: Finished running node model.stock_prediction.avg_true_range
[0m12:31:52.987366 [debug] [Thread-1 (]: Began running node model.stock_prediction.bollinger
[0m12:31:52.987633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.avg_true_range, now model.stock_prediction.bollinger)
[0m12:31:52.987898 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.bollinger
[0m12:31:52.989589 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.bollinger"
[0m12:31:52.990013 [debug] [Thread-1 (]: Began executing node model.stock_prediction.bollinger
[0m12:31:52.990401 [debug] [Thread-1 (]: Finished running node model.stock_prediction.bollinger
[0m12:31:52.990632 [debug] [Thread-1 (]: Began running node model.stock_prediction.moving_average
[0m12:31:52.990880 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.bollinger, now model.stock_prediction.moving_average)
[0m12:31:52.991140 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.moving_average
[0m12:31:52.995959 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.moving_average"
[0m12:31:52.996532 [debug] [Thread-1 (]: Began executing node model.stock_prediction.moving_average
[0m12:31:52.996946 [debug] [Thread-1 (]: Finished running node model.stock_prediction.moving_average
[0m12:31:52.997175 [debug] [Thread-1 (]: Began running node model.stock_prediction.rsi_calculation
[0m12:31:52.997421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.moving_average, now model.stock_prediction.rsi_calculation)
[0m12:31:52.997658 [debug] [Thread-1 (]: Began compiling node model.stock_prediction.rsi_calculation
[0m12:31:52.999264 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_prediction.rsi_calculation"
[0m12:31:52.999627 [debug] [Thread-1 (]: Began executing node model.stock_prediction.rsi_calculation
[0m12:31:52.999989 [debug] [Thread-1 (]: Finished running node model.stock_prediction.rsi_calculation
[0m12:31:53.000210 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m12:31:53.000433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_prediction.rsi_calculation, now test.stock_prediction.not_null_stock_prices_close.d7e232e1ba)
[0m12:31:53.000663 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m12:31:53.042548 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_close.d7e232e1ba"
[0m12:31:53.043094 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m12:31:53.043414 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_close.d7e232e1ba
[0m12:31:53.043586 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m12:31:53.043735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_close.d7e232e1ba, now test.stock_prediction.not_null_stock_prices_date.98a7527501)
[0m12:31:53.043874 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m12:31:53.045585 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_date.98a7527501"
[0m12:31:53.045892 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m12:31:53.046179 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_date.98a7527501
[0m12:31:53.046338 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m12:31:53.046501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_date.98a7527501, now test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc)
[0m12:31:53.046635 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m12:31:53.048431 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc"
[0m12:31:53.048704 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m12:31:53.048976 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc
[0m12:31:53.049136 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m12:31:53.049292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_high.0d3ed8dfcc, now test.stock_prediction.not_null_stock_prices_low.e65294ca15)
[0m12:31:53.049428 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m12:31:53.050979 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_low.e65294ca15"
[0m12:31:53.051233 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m12:31:53.051494 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_low.e65294ca15
[0m12:31:53.051650 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m12:31:53.051800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_low.e65294ca15, now test.stock_prediction.not_null_stock_prices_open.e09b13f215)
[0m12:31:53.051935 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m12:31:53.053456 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_open.e09b13f215"
[0m12:31:53.053701 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m12:31:53.053952 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_open.e09b13f215
[0m12:31:53.054101 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m12:31:53.054256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_open.e09b13f215, now test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8)
[0m12:31:53.054414 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m12:31:53.056229 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8"
[0m12:31:53.056508 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m12:31:53.056775 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8
[0m12:31:53.056929 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m12:31:53.057082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_symbol.3c41a80ff8, now test.stock_prediction.not_null_stock_prices_volume.71420bc956)
[0m12:31:53.057213 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m12:31:53.058751 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_stock_prices_volume.71420bc956"
[0m12:31:53.058998 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m12:31:53.059260 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_stock_prices_volume.71420bc956
[0m12:31:53.059416 [debug] [Thread-1 (]: Began running node snapshot.stock_prediction.snapshot_atr
[0m12:31:53.059563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_stock_prices_volume.71420bc956, now snapshot.stock_prediction.snapshot_atr)
[0m12:31:53.059693 [debug] [Thread-1 (]: Began compiling node snapshot.stock_prediction.snapshot_atr
[0m12:31:53.060947 [debug] [Thread-1 (]: Began executing node snapshot.stock_prediction.snapshot_atr
[0m12:31:53.061212 [debug] [Thread-1 (]: Finished running node snapshot.stock_prediction.snapshot_atr
[0m12:31:53.061367 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m12:31:53.061529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_prediction.snapshot_atr, now test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad)
[0m12:31:53.061662 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m12:31:53.063483 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad"
[0m12:31:53.063756 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m12:31:53.064015 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad
[0m12:31:53.064170 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_avg_true_range_date.4e418b835d
[0m12:31:53.064326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_avg_true_range_atr_14d.dccf1cc6ad, now test.stock_prediction.not_null_avg_true_range_date.4e418b835d)
[0m12:31:53.064459 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_avg_true_range_date.4e418b835d
[0m12:31:53.065968 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_avg_true_range_date.4e418b835d"
[0m12:31:53.066214 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_avg_true_range_date.4e418b835d
[0m12:31:53.066465 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_avg_true_range_date.4e418b835d
[0m12:31:53.066618 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1
[0m12:31:53.066760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_avg_true_range_date.4e418b835d, now test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1)
[0m12:31:53.066893 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1
[0m12:31:53.068631 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1"
[0m12:31:53.068881 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1
[0m12:31:53.069157 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1
[0m12:31:53.069316 [debug] [Thread-1 (]: Began running node snapshot.stock_prediction.snapshot_bollinger
[0m12:31:53.069472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_avg_true_range_symbol.e4c229c0c1, now snapshot.stock_prediction.snapshot_bollinger)
[0m12:31:53.069615 [debug] [Thread-1 (]: Began compiling node snapshot.stock_prediction.snapshot_bollinger
[0m12:31:53.070847 [debug] [Thread-1 (]: Began executing node snapshot.stock_prediction.snapshot_bollinger
[0m12:31:53.071110 [debug] [Thread-1 (]: Finished running node snapshot.stock_prediction.snapshot_bollinger
[0m12:31:53.071263 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_close.4ccb16a429
[0m12:31:53.071418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_prediction.snapshot_bollinger, now test.stock_prediction.not_null_bollinger_close.4ccb16a429)
[0m12:31:53.071550 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_close.4ccb16a429
[0m12:31:53.073077 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_close.4ccb16a429"
[0m12:31:53.073349 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_close.4ccb16a429
[0m12:31:53.073600 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_close.4ccb16a429
[0m12:31:53.073751 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_date.9d77bdd20c
[0m12:31:53.073902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_close.4ccb16a429, now test.stock_prediction.not_null_bollinger_date.9d77bdd20c)
[0m12:31:53.074031 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_date.9d77bdd20c
[0m12:31:53.075809 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_date.9d77bdd20c"
[0m12:31:53.076056 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_date.9d77bdd20c
[0m12:31:53.076307 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_date.9d77bdd20c
[0m12:31:53.076456 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e
[0m12:31:53.076602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_date.9d77bdd20c, now test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e)
[0m12:31:53.076732 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e
[0m12:31:53.078227 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e"
[0m12:31:53.078470 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e
[0m12:31:53.078717 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e
[0m12:31:53.078862 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3
[0m12:31:53.079004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_lower_band.10fb75ad4e, now test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3)
[0m12:31:53.079134 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3
[0m12:31:53.080642 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3"
[0m12:31:53.080879 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3
[0m12:31:53.081128 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3
[0m12:31:53.081280 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_symbol.a932e30f82
[0m12:31:53.081432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_sma_20d.26c74c44b3, now test.stock_prediction.not_null_bollinger_symbol.a932e30f82)
[0m12:31:53.081577 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_symbol.a932e30f82
[0m12:31:53.083391 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_symbol.a932e30f82"
[0m12:31:53.083638 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_symbol.a932e30f82
[0m12:31:53.083891 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_symbol.a932e30f82
[0m12:31:53.084045 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_bollinger_upper_band.e4db87564c
[0m12:31:53.084199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_symbol.a932e30f82, now test.stock_prediction.not_null_bollinger_upper_band.e4db87564c)
[0m12:31:53.084333 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_bollinger_upper_band.e4db87564c
[0m12:31:53.085836 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_bollinger_upper_band.e4db87564c"
[0m12:31:53.086094 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_bollinger_upper_band.e4db87564c
[0m12:31:53.086346 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_bollinger_upper_band.e4db87564c
[0m12:31:53.086499 [debug] [Thread-1 (]: Began running node snapshot.stock_prediction.snapshot_moving_avg
[0m12:31:53.086647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_bollinger_upper_band.e4db87564c, now snapshot.stock_prediction.snapshot_moving_avg)
[0m12:31:53.086779 [debug] [Thread-1 (]: Began compiling node snapshot.stock_prediction.snapshot_moving_avg
[0m12:31:53.088211 [debug] [Thread-1 (]: Began executing node snapshot.stock_prediction.snapshot_moving_avg
[0m12:31:53.088477 [debug] [Thread-1 (]: Finished running node snapshot.stock_prediction.snapshot_moving_avg
[0m12:31:53.088630 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m12:31:53.088782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_prediction.snapshot_moving_avg, now test.stock_prediction.not_null_moving_average_close.6d037dd588)
[0m12:31:53.088915 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m12:31:53.090445 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_close.6d037dd588"
[0m12:31:53.090688 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m12:31:53.090941 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_close.6d037dd588
[0m12:31:53.091094 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m12:31:53.091243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_close.6d037dd588, now test.stock_prediction.not_null_moving_average_date.3ad00158b5)
[0m12:31:53.091374 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m12:31:53.092904 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_date.3ad00158b5"
[0m12:31:53.093146 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m12:31:53.093399 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_date.3ad00158b5
[0m12:31:53.093550 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m12:31:53.093697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_date.3ad00158b5, now test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22)
[0m12:31:53.093829 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m12:31:53.095611 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22"
[0m12:31:53.095862 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m12:31:53.096124 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22
[0m12:31:53.096278 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m12:31:53.096427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_moving_avg_20d.57e57c7d22, now test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca)
[0m12:31:53.096560 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m12:31:53.098070 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca"
[0m12:31:53.098331 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m12:31:53.098591 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca
[0m12:31:53.098743 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m12:31:53.098893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_moving_avg_5d.9a12e3e8ca, now test.stock_prediction.not_null_moving_average_symbol.75a6f7473c)
[0m12:31:53.099036 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m12:31:53.100810 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_moving_average_symbol.75a6f7473c"
[0m12:31:53.101099 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m12:31:53.101364 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_moving_average_symbol.75a6f7473c
[0m12:31:53.101521 [debug] [Thread-1 (]: Began running node snapshot.stock_prediction.snapshot_rsi
[0m12:31:53.101674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_moving_average_symbol.75a6f7473c, now snapshot.stock_prediction.snapshot_rsi)
[0m12:31:53.101808 [debug] [Thread-1 (]: Began compiling node snapshot.stock_prediction.snapshot_rsi
[0m12:31:53.102996 [debug] [Thread-1 (]: Began executing node snapshot.stock_prediction.snapshot_rsi
[0m12:31:53.103249 [debug] [Thread-1 (]: Finished running node snapshot.stock_prediction.snapshot_rsi
[0m12:31:53.103399 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m12:31:53.103558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.stock_prediction.snapshot_rsi, now test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42)
[0m12:31:53.103704 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m12:31:53.105231 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42"
[0m12:31:53.105495 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m12:31:53.105759 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42
[0m12:31:53.105912 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m12:31:53.106064 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_avg_gain.c5480cff42, now test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19)
[0m12:31:53.106196 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m12:31:53.107990 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19"
[0m12:31:53.108238 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m12:31:53.108492 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19
[0m12:31:53.108644 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m12:31:53.108797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_avg_loss.367dd1fd19, now test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d)
[0m12:31:53.108931 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m12:31:53.110450 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d"
[0m12:31:53.110690 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m12:31:53.110955 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d
[0m12:31:53.111112 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m12:31:53.111260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_close.c21314fd4d, now test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76)
[0m12:31:53.111390 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m12:31:53.112902 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76"
[0m12:31:53.113146 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m12:31:53.113401 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76
[0m12:31:53.113551 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m12:31:53.113696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_date.f9fd5f6d76, now test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8)
[0m12:31:53.113826 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m12:31:53.115616 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8"
[0m12:31:53.115865 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m12:31:53.116125 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8
[0m12:31:53.116280 [debug] [Thread-1 (]: Began running node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m12:31:53.116429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_prediction.not_null_rsi_calculation_rsi_14d.a02bdbc6b8, now test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84)
[0m12:31:53.116560 [debug] [Thread-1 (]: Began compiling node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m12:31:53.118079 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84"
[0m12:31:53.118322 [debug] [Thread-1 (]: Began executing node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m12:31:53.118573 [debug] [Thread-1 (]: Finished running node test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84
[0m12:31:53.119059 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:31:53.119179 [debug] [MainThread]: Connection 'test.stock_prediction.not_null_rsi_calculation_symbol.0f9fdcec84' was properly closed.
[0m12:31:53.121080 [debug] [MainThread]: Command end result
[0m12:31:53.173170 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m12:31:53.173363 [info ] [MainThread]: Building catalog
[0m12:31:53.178147 [debug] [ThreadPool]: Acquiring new snowflake connection 'dev.information_schema'
[0m12:31:53.186592 [debug] [ThreadPool]: Using snowflake connection "dev.information_schema"
[0m12:31:53.187000 [debug] [ThreadPool]: On dev.information_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_prediction", "target_name": "dev", "connection_name": "dev.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from dev.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'bollinger' and upper("table_name") = upper('bollinger')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshot' and upper("table_schema") = upper('snapshot')

                    and 
    "table_name" ilike 'snapshot_rsi' and upper("table_name") = upper('snapshot_rsi')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'rsi_calculation' and upper("table_name") = upper('rsi_calculation')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'stock_prices' and upper("table_name") = upper('stock_prices')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshot' and upper("table_schema") = upper('snapshot')

                    and 
    "table_name" ilike 'snapshot_bollinger' and upper("table_name") = upper('snapshot_bollinger')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'avg_true_range' and upper("table_name") = upper('avg_true_range')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshot' and upper("table_schema") = upper('snapshot')

                    and 
    "table_name" ilike 'snapshot_atr' and upper("table_name") = upper('snapshot_atr')

                )
             or 
                (
                    
    "table_schema" ilike 'raw_data' and upper("table_schema") = upper('raw_data')

                    and 
    "table_name" ilike 'stock_prices' and upper("table_name") = upper('stock_prices')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshot' and upper("table_schema") = upper('snapshot')

                    and 
    "table_name" ilike 'snapshot_moving_avg' and upper("table_name") = upper('snapshot_moving_avg')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'moving_average' and upper("table_name") = upper('moving_average')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from dev.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'bollinger' and upper("table_name") = upper('bollinger')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshot' and upper("table_schema") = upper('snapshot')

                    and 
    "table_name" ilike 'snapshot_rsi' and upper("table_name") = upper('snapshot_rsi')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'rsi_calculation' and upper("table_name") = upper('rsi_calculation')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'stock_prices' and upper("table_name") = upper('stock_prices')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshot' and upper("table_schema") = upper('snapshot')

                    and 
    "table_name" ilike 'snapshot_bollinger' and upper("table_name") = upper('snapshot_bollinger')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'avg_true_range' and upper("table_name") = upper('avg_true_range')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshot' and upper("table_schema") = upper('snapshot')

                    and 
    "table_name" ilike 'snapshot_atr' and upper("table_name") = upper('snapshot_atr')

                )
             or 
                (
                    
    "table_schema" ilike 'raw_data' and upper("table_schema") = upper('raw_data')

                    and 
    "table_name" ilike 'stock_prices' and upper("table_name") = upper('stock_prices')

                )
             or 
                (
                    
    "table_schema" ilike 'snapshot' and upper("table_schema") = upper('snapshot')

                    and 
    "table_name" ilike 'snapshot_moving_avg' and upper("table_name") = upper('snapshot_moving_avg')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'moving_average' and upper("table_name") = upper('moving_average')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m12:31:53.187332 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:31:57.419796 [debug] [ThreadPool]: SQL status: SUCCESS 70 in 4.232 seconds
[0m12:31:57.436728 [debug] [ThreadPool]: On dev.information_schema: Close
[0m12:31:57.600514 [info ] [MainThread]: Catalog written to /Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/target/catalog.json
[0m12:31:57.601651 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 6.291874, "process_user_time": 1.270722, "process_kernel_time": 0.17413, "process_mem_max_rss": "138117120", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:31:57.602008 [debug] [MainThread]: Command `dbt docs generate` succeeded at 12:31:57.601949 after 6.29 seconds
[0m12:31:57.602182 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:31:57.602307 [debug] [MainThread]: Connection 'dev.information_schema' was properly closed.
[0m12:31:57.602477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069df050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e4bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e4bd80>]}
[0m12:31:57.602665 [debug] [MainThread]: Flushing usage events
[0m12:33:50.056438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10489e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061efed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061efd90>]}


============================== 12:33:50.059354 | c438d31e-188e-4f7b-bc3a-1ba7e597510a ==============================
[0m12:33:50.059354 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:33:50.059651 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/models', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:33:50.109384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c438d31e-188e-4f7b-bc3a-1ba7e597510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10508e8b0>]}
[0m12:33:50.124656 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.10246454, "process_user_time": 0.60526, "process_kernel_time": 0.116368, "process_mem_max_rss": "98271232", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:33:50.124914 [debug] [MainThread]: Command `dbt clean` succeeded at 12:33:50.124865 after 0.10 seconds
[0m12:33:50.125071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10632e470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10632e580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f9e150>]}
[0m12:33:50.125218 [debug] [MainThread]: Flushing usage events
[0m12:34:47.186506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102682120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fd3ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fd3d90>]}


============================== 12:34:47.188727 | 11041104-80fc-4ff4-af32-96fa63d0b8bd ==============================
[0m12:34:47.188727 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:34:47.189036 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/adi/Downloads/DATA226/sjsu-data226/week8/airflow/stock_prediction/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:34:47.236358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11041104-80fc-4ff4-af32-96fa63d0b8bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e728b0>]}
[0m12:34:47.241827 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.090141706, "process_user_time": 0.605393, "process_kernel_time": 0.093791, "process_mem_max_rss": "98336768", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:34:47.242135 [debug] [MainThread]: Command `dbt clean` succeeded at 12:34:47.242080 after 0.09 seconds
[0m12:34:47.242313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104116470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104116580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d82150>]}
[0m12:34:47.242450 [debug] [MainThread]: Flushing usage events
